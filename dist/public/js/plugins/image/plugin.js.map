{"version":3,"sources":["../../../../../public/js/plugins/image/plugin.js"],"names":["domGlobals","global$1","tinymce","util","Tools","resolve","noop","constant","value","identity","x","die","msg","Error","never","always","none","NONE","eq","o","isNone","call","thunk","id","n","me","fold","s","is","isSome","getOr","getOrThunk","getOrDie","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","Object","freeze","some","a","constant_a","self","f","v","elementEq","b","from","Option","typeOf","t","Array","prototype","isPrototypeOf","constructor","name","String","isType","type","isString","isObject","isArray","isBoolean","isFunction","nativeSlice","slice","nativePush","push","xs","i","len","length","flatten","r","apply","head","from$1","__assign","assign","arguments","p","hasOwnProperty","exports$1","module","exports","define","require","amd","g","window","global","EphoxContactWrapper","e","c","u","code","process","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","setTimeout","clearTimeout","runTimeout","fun","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","concat","drainQueue","timeout","run","nextTick","args","Item","array","title","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","setImmediate","root","setTimeoutFunc","fn","thisArg","Promise","TypeError","_state","_handled","_value","_deferreds","doResolve","handle","deferred","_immediateFn","cb","onFulfilled","onRejected","reject","promise","ret","newValue","then","finale","_unhandledRejectionFn","Handler","done","reason","ex","prom","all","arr","remaining","res","val","race","values","err","console","warn","_setImmediateFn","_setUnhandledRejectionFn","clearImmediate","Function","immediateIds","nextImmediateId","Timeout","setInterval","clearInterval","close","clearFn","_id","_clearFn","unref","ref","enroll","item","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","active","onTimeout","_onTimeout","onNextTick","promisePolyfill","Global","boltExport","nu","baseFn","data","callbacks","nCallback","get","isReady","set","cbs","pure","callback","LazyValue","errorReporter","make","fab","aFutureB","toPromise","anonBind","futureB","toLazy","toCached","cache","nu$1","pure$1","Future","opt","mapError","_","onValue","toOption","isValue","isError","error","message","onError","fromOption","Result","wrap","delegate","bindFuture","resA","bindResult","mapResult","foldResult","whenError","whenValue","withTimeout","errorThunk","timedOut","timer","result","nu$2","worker","value$1","error$1","fromResult","fromFuture","future","fromPromise","completer","FutureResult","shallow","old","deep","bothObjects","deepMerge","baseMerge","merger","objects","j","curObject","key","merge","makeItems","info","imageUrl","filetype","label","imageList","items","imageDescription","imageTitle","imageDimensions","classList","caption","hasDescription","hasImageTitle","hasDimensions","columns","hasImageCaption","makeTab","MainTab","global$2","global$3","global$4","editor","getParam","hasAdvTab","hasUploadTab","getPrependUrl","getClassList","getImageList","hasUploadUrl","getUploadUrl","hasUploadHandler","getUploadHandler","getUploadBasePath","getUploadCredentials","Settings","parseIntAndGetMax","val1","val2","Math","max","parseInt","getImageSize","url","img","document","createElement","dimensions","parentNode","removeChild","onload","width","clientWidth","height","clientHeight","onerror","style","visibility","position","bottom","left","body","appendChild","src","removePixelSuffix","replace","addPixelSuffix","test","mergeMargins","css","margin","splitMargin","split","createImageList","send","success","text","JSON","parse","waitLoadImage","imgElm","selectImage","selection","select","nodeChanged","dom","setAttribs","blobToDataUri","blob","reader","FileReader","readAsDataURL","isPlaceholderImage","nodeName","hasAttribute","Utils","DOM","getHspace","image","marginLeft","marginRight","getVspace","marginTop","marginBottom","getBorder","borderWidth","getAttrib","getAttribute","getStyle","hasCaption","setAttrib","setAttribute","wrapInFigure","figureElm","create","class","insertAfter","contentEditable","removeFigure","remove","toggleCaption","normalizeStyle","normalizeCss","attrValue","removeAttribute","setSize","getSize","setHspace","pxValue","setVspace","setBorder","setBorderStyle","borderStyle","getBorderStyle","isFigure","elm","isImage","defaultData","alt","hspace","vspace","border","getStyleValue","write","figure","read","updateProp","oldData","newData","normalized","_name","cssText","styles","mergedCss","compressed","serialize","getSelectedImage","getNode","getParent","splitTextBlock","textBlock","node","schema","getTextBlockElements","getBody","readImageDataFromSelection","insertImageAtCaret","focus","setContent","outerHTML","insertedElm","syncSrcAttr","deleteImage","isEmpty","setCursorLocation","writeImageDataToSelection","insertOrUpdateImage","findMap","global$5","getValue","sanitizeList","list","extractValue","out","menu","sanitizer","extracter","sanitize","isGroup","findEntryDelegate","findEntry","optList","ListUtils","pathJoin","path1","path2","Uploader","settings","defaultHandler","blobInfo","failure","progress","xhr","formData","XMLHttpRequest","open","withCredentials","credentials","upload","onprogress","loaded","total","status","json","responseText","location","basePath","FormData","append","filename","uploadBlob","handler","isDefaultHandler","extend","makeTab$1","inputMode","AdvTab","collect","urlListSanitizer","convertURL","futureImageList","prependURL","preUrl","makeTab$2","UploadTab","createState","prevImage","prevAlt","fromImageData","meta","images","classes","borderstyle","fileinput","toImageData","addPrependUrl2","srcURL","prependUrl","substring","addPrependUrl","api","getData","setData","formFillFromMeta2","entry","formFillFromMeta","calculateImageSize","helpers","state","imageSize","size","updateImagesDropdown","changeSrc","changeImages","updateAlt","calcVSpace","matchingTopBottom","calcHSpace","matchingLeftRight","calcBorderWidth","calcBorderStyle","calcStyle","parseStyle","serializeStyle","changeStyle2","dataCopy","changeStyle","changeAStyle","changeFileInput","block","unblock","file","blobUri","URL","createObjectURL","uploader","finalize","revokeObjectURL","dataUrl","createBlobCache","showTab","catch","alertErr","changeHandler","evt","closeHandler","makeDialogBody","tabPanel","tabs","panel","makeDialog","buttons","primary","initialData","onSubmit","onChange","onClose","submitHandler","undoManager","transact","editorUpload","uploadImagesAuto","documentBaseURI","toAbsolute","blobCache","base64","windowManager","alert","normalizeCss$1","stylesArg","Dialog","spec","register","addCommand","Commands","hasImageClass","className","attr","toggleContentEditableState","nodes","toggleContentEditable","getAll","setup","parser","addNodeFilter","serializer","FilterContent","register$1","ui","registry","addToggleButton","icon","tooltip","onAction","onSetup","buttonApi","selectorChangedWithUnbind","setActive","unbind","addMenuItem","addContextMenu","update","element","Buttons","Plugin","add"],"mappings":"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","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.1.0 (2019-10-17)\n */\n(function (domGlobals) {\n    'use strict';\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var noop = function () {\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var identity = function (x) {\n      return x;\n    };\n    var die = function (msg) {\n      return function () {\n        throw new Error(msg);\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      if (Object.freeze) {\n        Object.freeze(me);\n      }\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Option = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var typeOf = function (x) {\n      if (x === null) {\n        return 'null';\n      }\n      var t = typeof x;\n      if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      }\n      if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      }\n      return t;\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isString = isType('string');\n    var isObject = isType('object');\n    var isArray = isType('array');\n    var isBoolean = isType('boolean');\n    var isFunction = isType('function');\n\n    var nativeSlice = Array.prototype.slice;\n    var nativePush = Array.prototype.push;\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var head = function (xs) {\n      return xs.length === 0 ? Option.none() : Option.some(xs[0]);\n    };\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n\n    var exports$1 = {}, module = { exports: exports$1 };\n    (function (define, exports, module, require) {\n      (function (f) {\n        if (typeof exports === 'object' && typeof module !== 'undefined') {\n          module.exports = f();\n        } else if (typeof define === 'function' && define.amd) {\n          define([], f);\n        } else {\n          var g;\n          if (typeof window !== 'undefined') {\n            g = window;\n          } else if (typeof global !== 'undefined') {\n            g = global;\n          } else if (typeof self !== 'undefined') {\n            g = self;\n          } else {\n            g = this;\n          }\n          g.EphoxContactWrapper = f();\n        }\n      }(function () {\n        return function () {\n          function r(e, n, t) {\n            function o(i, f) {\n              if (!n[i]) {\n                if (!e[i]) {\n                  var c = 'function' == typeof require && require;\n                  if (!f && c)\n                    return c(i, !0);\n                  if (u)\n                    return u(i, !0);\n                  var a = new Error('Cannot find module \\'' + i + '\\'');\n                  throw a.code = 'MODULE_NOT_FOUND', a;\n                }\n                var p = n[i] = { exports: {} };\n                e[i][0].call(p.exports, function (r) {\n                  var n = e[i][1][r];\n                  return o(n || r);\n                }, p, p.exports, r, e, n, t);\n              }\n              return n[i].exports;\n            }\n            for (var u = 'function' == typeof require && require, i = 0; i < t.length; i++)\n              o(t[i]);\n            return o;\n          }\n          return r;\n        }()({\n          1: [\n            function (require, module, exports) {\n              var process = module.exports = {};\n              var cachedSetTimeout;\n              var cachedClearTimeout;\n              function defaultSetTimout() {\n                throw new Error('setTimeout has not been defined');\n              }\n              function defaultClearTimeout() {\n                throw new Error('clearTimeout has not been defined');\n              }\n              (function () {\n                try {\n                  if (typeof setTimeout === 'function') {\n                    cachedSetTimeout = setTimeout;\n                  } else {\n                    cachedSetTimeout = defaultSetTimout;\n                  }\n                } catch (e) {\n                  cachedSetTimeout = defaultSetTimout;\n                }\n                try {\n                  if (typeof clearTimeout === 'function') {\n                    cachedClearTimeout = clearTimeout;\n                  } else {\n                    cachedClearTimeout = defaultClearTimeout;\n                  }\n                } catch (e) {\n                  cachedClearTimeout = defaultClearTimeout;\n                }\n              }());\n              function runTimeout(fun) {\n                if (cachedSetTimeout === setTimeout) {\n                  return setTimeout(fun, 0);\n                }\n                if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n                  cachedSetTimeout = setTimeout;\n                  return setTimeout(fun, 0);\n                }\n                try {\n                  return cachedSetTimeout(fun, 0);\n                } catch (e) {\n                  try {\n                    return cachedSetTimeout.call(null, fun, 0);\n                  } catch (e) {\n                    return cachedSetTimeout.call(this, fun, 0);\n                  }\n                }\n              }\n              function runClearTimeout(marker) {\n                if (cachedClearTimeout === clearTimeout) {\n                  return clearTimeout(marker);\n                }\n                if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n                  cachedClearTimeout = clearTimeout;\n                  return clearTimeout(marker);\n                }\n                try {\n                  return cachedClearTimeout(marker);\n                } catch (e) {\n                  try {\n                    return cachedClearTimeout.call(null, marker);\n                  } catch (e) {\n                    return cachedClearTimeout.call(this, marker);\n                  }\n                }\n              }\n              var queue = [];\n              var draining = false;\n              var currentQueue;\n              var queueIndex = -1;\n              function cleanUpNextTick() {\n                if (!draining || !currentQueue) {\n                  return;\n                }\n                draining = false;\n                if (currentQueue.length) {\n                  queue = currentQueue.concat(queue);\n                } else {\n                  queueIndex = -1;\n                }\n                if (queue.length) {\n                  drainQueue();\n                }\n              }\n              function drainQueue() {\n                if (draining) {\n                  return;\n                }\n                var timeout = runTimeout(cleanUpNextTick);\n                draining = true;\n                var len = queue.length;\n                while (len) {\n                  currentQueue = queue;\n                  queue = [];\n                  while (++queueIndex < len) {\n                    if (currentQueue) {\n                      currentQueue[queueIndex].run();\n                    }\n                  }\n                  queueIndex = -1;\n                  len = queue.length;\n                }\n                currentQueue = null;\n                draining = false;\n                runClearTimeout(timeout);\n              }\n              process.nextTick = function (fun) {\n                var args = new Array(arguments.length - 1);\n                if (arguments.length > 1) {\n                  for (var i = 1; i < arguments.length; i++) {\n                    args[i - 1] = arguments[i];\n                  }\n                }\n                queue.push(new Item(fun, args));\n                if (queue.length === 1 && !draining) {\n                  runTimeout(drainQueue);\n                }\n              };\n              function Item(fun, array) {\n                this.fun = fun;\n                this.array = array;\n              }\n              Item.prototype.run = function () {\n                this.fun.apply(null, this.array);\n              };\n              process.title = 'browser';\n              process.browser = true;\n              process.env = {};\n              process.argv = [];\n              process.version = '';\n              process.versions = {};\n              function noop() {\n              }\n              process.on = noop;\n              process.addListener = noop;\n              process.once = noop;\n              process.off = noop;\n              process.removeListener = noop;\n              process.removeAllListeners = noop;\n              process.emit = noop;\n              process.prependListener = noop;\n              process.prependOnceListener = noop;\n              process.listeners = function (name) {\n                return [];\n              };\n              process.binding = function (name) {\n                throw new Error('process.binding is not supported');\n              };\n              process.cwd = function () {\n                return '/';\n              };\n              process.chdir = function (dir) {\n                throw new Error('process.chdir is not supported');\n              };\n              process.umask = function () {\n                return 0;\n              };\n            },\n            {}\n          ],\n          2: [\n            function (require, module, exports) {\n              (function (setImmediate) {\n                (function (root) {\n                  var setTimeoutFunc = setTimeout;\n                  function noop() {\n                  }\n                  function bind(fn, thisArg) {\n                    return function () {\n                      fn.apply(thisArg, arguments);\n                    };\n                  }\n                  function Promise(fn) {\n                    if (typeof this !== 'object')\n                      throw new TypeError('Promises must be constructed via new');\n                    if (typeof fn !== 'function')\n                      throw new TypeError('not a function');\n                    this._state = 0;\n                    this._handled = false;\n                    this._value = undefined;\n                    this._deferreds = [];\n                    doResolve(fn, this);\n                  }\n                  function handle(self, deferred) {\n                    while (self._state === 3) {\n                      self = self._value;\n                    }\n                    if (self._state === 0) {\n                      self._deferreds.push(deferred);\n                      return;\n                    }\n                    self._handled = true;\n                    Promise._immediateFn(function () {\n                      var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n                      if (cb === null) {\n                        (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n                        return;\n                      }\n                      var ret;\n                      try {\n                        ret = cb(self._value);\n                      } catch (e) {\n                        reject(deferred.promise, e);\n                        return;\n                      }\n                      resolve(deferred.promise, ret);\n                    });\n                  }\n                  function resolve(self, newValue) {\n                    try {\n                      if (newValue === self)\n                        throw new TypeError('A promise cannot be resolved with itself.');\n                      if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n                        var then = newValue.then;\n                        if (newValue instanceof Promise) {\n                          self._state = 3;\n                          self._value = newValue;\n                          finale(self);\n                          return;\n                        } else if (typeof then === 'function') {\n                          doResolve(bind(then, newValue), self);\n                          return;\n                        }\n                      }\n                      self._state = 1;\n                      self._value = newValue;\n                      finale(self);\n                    } catch (e) {\n                      reject(self, e);\n                    }\n                  }\n                  function reject(self, newValue) {\n                    self._state = 2;\n                    self._value = newValue;\n                    finale(self);\n                  }\n                  function finale(self) {\n                    if (self._state === 2 && self._deferreds.length === 0) {\n                      Promise._immediateFn(function () {\n                        if (!self._handled) {\n                          Promise._unhandledRejectionFn(self._value);\n                        }\n                      });\n                    }\n                    for (var i = 0, len = self._deferreds.length; i < len; i++) {\n                      handle(self, self._deferreds[i]);\n                    }\n                    self._deferreds = null;\n                  }\n                  function Handler(onFulfilled, onRejected, promise) {\n                    this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n                    this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n                    this.promise = promise;\n                  }\n                  function doResolve(fn, self) {\n                    var done = false;\n                    try {\n                      fn(function (value) {\n                        if (done)\n                          return;\n                        done = true;\n                        resolve(self, value);\n                      }, function (reason) {\n                        if (done)\n                          return;\n                        done = true;\n                        reject(self, reason);\n                      });\n                    } catch (ex) {\n                      if (done)\n                        return;\n                      done = true;\n                      reject(self, ex);\n                    }\n                  }\n                  Promise.prototype['catch'] = function (onRejected) {\n                    return this.then(null, onRejected);\n                  };\n                  Promise.prototype.then = function (onFulfilled, onRejected) {\n                    var prom = new this.constructor(noop);\n                    handle(this, new Handler(onFulfilled, onRejected, prom));\n                    return prom;\n                  };\n                  Promise.all = function (arr) {\n                    var args = Array.prototype.slice.call(arr);\n                    return new Promise(function (resolve, reject) {\n                      if (args.length === 0)\n                        return resolve([]);\n                      var remaining = args.length;\n                      function res(i, val) {\n                        try {\n                          if (val && (typeof val === 'object' || typeof val === 'function')) {\n                            var then = val.then;\n                            if (typeof then === 'function') {\n                              then.call(val, function (val) {\n                                res(i, val);\n                              }, reject);\n                              return;\n                            }\n                          }\n                          args[i] = val;\n                          if (--remaining === 0) {\n                            resolve(args);\n                          }\n                        } catch (ex) {\n                          reject(ex);\n                        }\n                      }\n                      for (var i = 0; i < args.length; i++) {\n                        res(i, args[i]);\n                      }\n                    });\n                  };\n                  Promise.resolve = function (value) {\n                    if (value && typeof value === 'object' && value.constructor === Promise) {\n                      return value;\n                    }\n                    return new Promise(function (resolve) {\n                      resolve(value);\n                    });\n                  };\n                  Promise.reject = function (value) {\n                    return new Promise(function (resolve, reject) {\n                      reject(value);\n                    });\n                  };\n                  Promise.race = function (values) {\n                    return new Promise(function (resolve, reject) {\n                      for (var i = 0, len = values.length; i < len; i++) {\n                        values[i].then(resolve, reject);\n                      }\n                    });\n                  };\n                  Promise._immediateFn = typeof setImmediate === 'function' ? function (fn) {\n                    setImmediate(fn);\n                  } : function (fn) {\n                    setTimeoutFunc(fn, 0);\n                  };\n                  Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n                    if (typeof console !== 'undefined' && console) {\n                      console.warn('Possible Unhandled Promise Rejection:', err);\n                    }\n                  };\n                  Promise._setImmediateFn = function _setImmediateFn(fn) {\n                    Promise._immediateFn = fn;\n                  };\n                  Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n                    Promise._unhandledRejectionFn = fn;\n                  };\n                  if (typeof module !== 'undefined' && module.exports) {\n                    module.exports = Promise;\n                  } else if (!root.Promise) {\n                    root.Promise = Promise;\n                  }\n                }(this));\n              }.call(this, require('timers').setImmediate));\n            },\n            { 'timers': 3 }\n          ],\n          3: [\n            function (require, module, exports) {\n              (function (setImmediate, clearImmediate) {\n                var nextTick = require('process/browser.js').nextTick;\n                var apply = Function.prototype.apply;\n                var slice = Array.prototype.slice;\n                var immediateIds = {};\n                var nextImmediateId = 0;\n                exports.setTimeout = function () {\n                  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n                };\n                exports.setInterval = function () {\n                  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n                };\n                exports.clearTimeout = exports.clearInterval = function (timeout) {\n                  timeout.close();\n                };\n                function Timeout(id, clearFn) {\n                  this._id = id;\n                  this._clearFn = clearFn;\n                }\n                Timeout.prototype.unref = Timeout.prototype.ref = function () {\n                };\n                Timeout.prototype.close = function () {\n                  this._clearFn.call(window, this._id);\n                };\n                exports.enroll = function (item, msecs) {\n                  clearTimeout(item._idleTimeoutId);\n                  item._idleTimeout = msecs;\n                };\n                exports.unenroll = function (item) {\n                  clearTimeout(item._idleTimeoutId);\n                  item._idleTimeout = -1;\n                };\n                exports._unrefActive = exports.active = function (item) {\n                  clearTimeout(item._idleTimeoutId);\n                  var msecs = item._idleTimeout;\n                  if (msecs >= 0) {\n                    item._idleTimeoutId = setTimeout(function onTimeout() {\n                      if (item._onTimeout)\n                        item._onTimeout();\n                    }, msecs);\n                  }\n                };\n                exports.setImmediate = typeof setImmediate === 'function' ? setImmediate : function (fn) {\n                  var id = nextImmediateId++;\n                  var args = arguments.length < 2 ? false : slice.call(arguments, 1);\n                  immediateIds[id] = true;\n                  nextTick(function onNextTick() {\n                    if (immediateIds[id]) {\n                      if (args) {\n                        fn.apply(null, args);\n                      } else {\n                        fn.call(null);\n                      }\n                      exports.clearImmediate(id);\n                    }\n                  });\n                  return id;\n                };\n                exports.clearImmediate = typeof clearImmediate === 'function' ? clearImmediate : function (id) {\n                  delete immediateIds[id];\n                };\n              }.call(this, require('timers').setImmediate, require('timers').clearImmediate));\n            },\n            {\n              'process/browser.js': 1,\n              'timers': 3\n            }\n          ],\n          4: [\n            function (require, module, exports) {\n              var promisePolyfill = require('promise-polyfill');\n              var Global = function () {\n                if (typeof window !== 'undefined') {\n                  return window;\n                } else {\n                  return Function('return this;')();\n                }\n              }();\n              module.exports = { boltExport: Global.Promise || promisePolyfill };\n            },\n            { 'promise-polyfill': 2 }\n          ]\n        }, {}, [4])(4);\n      }));\n    }(undefined, exports$1, module, undefined));\n    var Promise = module.exports.boltExport;\n\n    var nu = function (baseFn) {\n      var data = Option.none();\n      var callbacks = [];\n      var map = function (f) {\n        return nu(function (nCallback) {\n          get(function (data) {\n            nCallback(f(data));\n          });\n        });\n      };\n      var get = function (nCallback) {\n        if (isReady()) {\n          call(nCallback);\n        } else {\n          callbacks.push(nCallback);\n        }\n      };\n      var set = function (x) {\n        data = Option.some(x);\n        run(callbacks);\n        callbacks = [];\n      };\n      var isReady = function () {\n        return data.isSome();\n      };\n      var run = function (cbs) {\n        each(cbs, call);\n      };\n      var call = function (cb) {\n        data.each(function (x) {\n          domGlobals.setTimeout(function () {\n            cb(x);\n          }, 0);\n        });\n      };\n      baseFn(set);\n      return {\n        get: get,\n        map: map,\n        isReady: isReady\n      };\n    };\n    var pure = function (a) {\n      return nu(function (callback) {\n        callback(a);\n      });\n    };\n    var LazyValue = {\n      nu: nu,\n      pure: pure\n    };\n\n    var errorReporter = function (err) {\n      domGlobals.setTimeout(function () {\n        throw err;\n      }, 0);\n    };\n    var make = function (run) {\n      var get = function (callback) {\n        run().then(callback, errorReporter);\n      };\n      var map = function (fab) {\n        return make(function () {\n          return run().then(fab);\n        });\n      };\n      var bind = function (aFutureB) {\n        return make(function () {\n          return run().then(function (v) {\n            return aFutureB(v).toPromise();\n          });\n        });\n      };\n      var anonBind = function (futureB) {\n        return make(function () {\n          return run().then(function () {\n            return futureB.toPromise();\n          });\n        });\n      };\n      var toLazy = function () {\n        return LazyValue.nu(get);\n      };\n      var toCached = function () {\n        var cache = null;\n        return make(function () {\n          if (cache === null) {\n            cache = run();\n          }\n          return cache;\n        });\n      };\n      var toPromise = run;\n      return {\n        map: map,\n        bind: bind,\n        anonBind: anonBind,\n        toLazy: toLazy,\n        toCached: toCached,\n        toPromise: toPromise,\n        get: get\n      };\n    };\n    var nu$1 = function (baseFn) {\n      return make(function () {\n        return new Promise(baseFn);\n      });\n    };\n    var pure$1 = function (a) {\n      return make(function () {\n        return Promise.resolve(a);\n      });\n    };\n    var Future = {\n      nu: nu$1,\n      pure: pure$1\n    };\n\n    var value = function (o) {\n      var is = function (v) {\n        return o === v;\n      };\n      var or = function (opt) {\n        return value(o);\n      };\n      var orThunk = function (f) {\n        return value(o);\n      };\n      var map = function (f) {\n        return value(f(o));\n      };\n      var mapError = function (f) {\n        return value(o);\n      };\n      var each = function (f) {\n        f(o);\n      };\n      var bind = function (f) {\n        return f(o);\n      };\n      var fold = function (_, onValue) {\n        return onValue(o);\n      };\n      var exists = function (f) {\n        return f(o);\n      };\n      var forall = function (f) {\n        return f(o);\n      };\n      var toOption = function () {\n        return Option.some(o);\n      };\n      return {\n        is: is,\n        isValue: always,\n        isError: never,\n        getOr: constant(o),\n        getOrThunk: constant(o),\n        getOrDie: constant(o),\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: each,\n        bind: bind,\n        exists: exists,\n        forall: forall,\n        toOption: toOption\n      };\n    };\n    var error = function (message) {\n      var getOrThunk = function (f) {\n        return f();\n      };\n      var getOrDie = function () {\n        return die(String(message))();\n      };\n      var or = function (opt) {\n        return opt;\n      };\n      var orThunk = function (f) {\n        return f();\n      };\n      var map = function (f) {\n        return error(message);\n      };\n      var mapError = function (f) {\n        return error(f(message));\n      };\n      var bind = function (f) {\n        return error(message);\n      };\n      var fold = function (onError, _) {\n        return onError(message);\n      };\n      return {\n        is: never,\n        isValue: never,\n        isError: always,\n        getOr: identity,\n        getOrThunk: getOrThunk,\n        getOrDie: getOrDie,\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: noop,\n        bind: bind,\n        exists: never,\n        forall: always,\n        toOption: Option.none\n      };\n    };\n    var fromOption = function (opt, err) {\n      return opt.fold(function () {\n        return error(err);\n      }, value);\n    };\n    var Result = {\n      value: value,\n      error: error,\n      fromOption: fromOption\n    };\n\n    var wrap = function (delegate) {\n      var toCached = function () {\n        return wrap(delegate.toCached());\n      };\n      var bindFuture = function (f) {\n        return wrap(delegate.bind(function (resA) {\n          return resA.fold(function (err) {\n            return Future.pure(Result.error(err));\n          }, function (a) {\n            return f(a);\n          });\n        }));\n      };\n      var bindResult = function (f) {\n        return wrap(delegate.map(function (resA) {\n          return resA.bind(f);\n        }));\n      };\n      var mapResult = function (f) {\n        return wrap(delegate.map(function (resA) {\n          return resA.map(f);\n        }));\n      };\n      var mapError = function (f) {\n        return wrap(delegate.map(function (resA) {\n          return resA.mapError(f);\n        }));\n      };\n      var foldResult = function (whenError, whenValue) {\n        return delegate.map(function (res) {\n          return res.fold(whenError, whenValue);\n        });\n      };\n      var withTimeout = function (timeout, errorThunk) {\n        return wrap(Future.nu(function (callback) {\n          var timedOut = false;\n          var timer = domGlobals.setTimeout(function () {\n            timedOut = true;\n            callback(Result.error(errorThunk()));\n          }, timeout);\n          delegate.get(function (result) {\n            if (!timedOut) {\n              domGlobals.clearTimeout(timer);\n              callback(result);\n            }\n          });\n        }));\n      };\n      return __assign(__assign({}, delegate), {\n        toCached: toCached,\n        bindFuture: bindFuture,\n        bindResult: bindResult,\n        mapResult: mapResult,\n        mapError: mapError,\n        foldResult: foldResult,\n        withTimeout: withTimeout\n      });\n    };\n    var nu$2 = function (worker) {\n      return wrap(Future.nu(worker));\n    };\n    var value$1 = function (value) {\n      return wrap(Future.pure(Result.value(value)));\n    };\n    var error$1 = function (error) {\n      return wrap(Future.pure(Result.error(error)));\n    };\n    var fromResult = function (result) {\n      return wrap(Future.pure(result));\n    };\n    var fromFuture = function (future) {\n      return wrap(future.map(Result.value));\n    };\n    var fromPromise = function (promise) {\n      return nu$2(function (completer) {\n        promise.then(function (value) {\n          completer(Result.value(value));\n        }, function (error) {\n          completer(Result.error(error));\n        });\n      });\n    };\n    var FutureResult = {\n      nu: nu$2,\n      wrap: wrap,\n      pure: value$1,\n      value: value$1,\n      error: error$1,\n      fromResult: fromResult,\n      fromFuture: fromFuture,\n      fromPromise: fromPromise\n    };\n\n    var hasOwnProperty = Object.prototype.hasOwnProperty;\n    var shallow = function (old, nu) {\n      return nu;\n    };\n    var deep = function (old, nu) {\n      var bothObjects = isObject(old) && isObject(nu);\n      return bothObjects ? deepMerge(old, nu) : nu;\n    };\n    var baseMerge = function (merger) {\n      return function () {\n        var objects = new Array(arguments.length);\n        for (var i = 0; i < objects.length; i++) {\n          objects[i] = arguments[i];\n        }\n        if (objects.length === 0) {\n          throw new Error('Can\\'t merge zero objects');\n        }\n        var ret = {};\n        for (var j = 0; j < objects.length; j++) {\n          var curObject = objects[j];\n          for (var key in curObject) {\n            if (hasOwnProperty.call(curObject, key)) {\n              ret[key] = merger(ret[key], curObject[key]);\n            }\n          }\n        }\n        return ret;\n      };\n    };\n    var deepMerge = baseMerge(deep);\n    var merge = baseMerge(shallow);\n\n    var makeItems = function (info) {\n      var imageUrl = {\n        name: 'src',\n        type: 'urlinput',\n        filetype: 'image',\n        label: 'Source'\n      };\n      var imageList = info.imageList.map(function (items) {\n        return {\n          name: 'images',\n          type: 'selectbox',\n          label: 'Image list',\n          items: items\n        };\n      });\n      var imageDescription = {\n        name: 'alt',\n        type: 'input',\n        label: 'Image description'\n      };\n      var imageTitle = {\n        name: 'title',\n        type: 'input',\n        label: 'Image title'\n      };\n      var imageDimensions = {\n        name: 'dimensions',\n        type: 'sizeinput'\n      };\n      var classList = info.classList.map(function (items) {\n        return {\n          name: 'classes',\n          type: 'selectbox',\n          label: 'Class',\n          items: items\n        };\n      });\n      var caption = {\n        type: 'label',\n        label: 'Caption',\n        items: [{\n            type: 'checkbox',\n            name: 'caption',\n            label: 'Show caption'\n          }]\n      };\n      return flatten([\n        [imageUrl],\n        imageList.toArray(),\n        info.hasDescription ? [imageDescription] : [],\n        info.hasImageTitle ? [imageTitle] : [],\n        info.hasDimensions ? [imageDimensions] : [],\n        [{\n            type: 'grid',\n            columns: 2,\n            items: flatten([\n              classList.toArray(),\n              info.hasImageCaption ? [caption] : []\n            ])\n          }]\n      ]);\n    };\n    var makeTab = function (info) {\n      return {\n        title: 'General',\n        name: 'general',\n        items: makeItems(info)\n      };\n    };\n    var MainTab = {\n      makeTab: makeTab,\n      makeItems: makeItems\n    };\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.util.Promise');\n\n    var global$4 = tinymce.util.Tools.resolve('tinymce.util.XHR');\n\n    var hasDimensions = function (editor) {\n      return editor.getParam('image_dimensions', true, 'boolean');\n    };\n    var hasAdvTab = function (editor) {\n      return editor.getParam('image_advtab', false, 'boolean');\n    };\n    var hasUploadTab = function (editor) {\n      return editor.getParam('image_uploadtab', true, 'boolean');\n    };\n    var getPrependUrl = function (editor) {\n      return editor.getParam('image_prepend_url', '', 'string');\n    };\n    var getClassList = function (editor) {\n      return editor.getParam('image_class_list');\n    };\n    var hasDescription = function (editor) {\n      return editor.getParam('image_description', true, 'boolean');\n    };\n    var hasImageTitle = function (editor) {\n      return editor.getParam('image_title', false, 'boolean');\n    };\n    var hasImageCaption = function (editor) {\n      return editor.getParam('image_caption', false, 'boolean');\n    };\n    var getImageList = function (editor) {\n      return editor.getParam('image_list', false);\n    };\n    var hasUploadUrl = function (editor) {\n      return !!getUploadUrl(editor);\n    };\n    var hasUploadHandler = function (editor) {\n      return !!getUploadHandler(editor);\n    };\n    var getUploadUrl = function (editor) {\n      return editor.getParam('images_upload_url', '', 'string');\n    };\n    var getUploadHandler = function (editor) {\n      return editor.getParam('images_upload_handler', undefined, 'function');\n    };\n    var getUploadBasePath = function (editor) {\n      return editor.getParam('images_upload_base_path', undefined, 'string');\n    };\n    var getUploadCredentials = function (editor) {\n      return editor.getParam('images_upload_credentials', false, 'boolean');\n    };\n    var Settings = {\n      hasDimensions: hasDimensions,\n      hasUploadTab: hasUploadTab,\n      hasAdvTab: hasAdvTab,\n      getPrependUrl: getPrependUrl,\n      getClassList: getClassList,\n      hasDescription: hasDescription,\n      hasImageTitle: hasImageTitle,\n      hasImageCaption: hasImageCaption,\n      getImageList: getImageList,\n      hasUploadUrl: hasUploadUrl,\n      hasUploadHandler: hasUploadHandler,\n      getUploadUrl: getUploadUrl,\n      getUploadHandler: getUploadHandler,\n      getUploadBasePath: getUploadBasePath,\n      getUploadCredentials: getUploadCredentials\n    };\n\n    var parseIntAndGetMax = function (val1, val2) {\n      return Math.max(parseInt(val1, 10), parseInt(val2, 10));\n    };\n    var getImageSize = function (url, callback) {\n      var img = domGlobals.document.createElement('img');\n      var done = function (dimensions) {\n        if (img.parentNode) {\n          img.parentNode.removeChild(img);\n        }\n        callback(dimensions);\n      };\n      img.onload = function () {\n        var width = parseIntAndGetMax(img.width, img.clientWidth);\n        var height = parseIntAndGetMax(img.height, img.clientHeight);\n        var dimensions = {\n          width: width,\n          height: height\n        };\n        done(Result.value(dimensions));\n      };\n      img.onerror = function () {\n        done(Result.error('Failed to get image dimensions for: ' + url));\n      };\n      var style = img.style;\n      style.visibility = 'hidden';\n      style.position = 'fixed';\n      style.bottom = style.left = '0px';\n      style.width = style.height = 'auto';\n      domGlobals.document.body.appendChild(img);\n      img.src = url;\n    };\n    var removePixelSuffix = function (value) {\n      if (value) {\n        value = value.replace(/px$/, '');\n      }\n      return value;\n    };\n    var addPixelSuffix = function (value) {\n      if (value.length > 0 && /^[0-9]+$/.test(value)) {\n        value += 'px';\n      }\n      return value;\n    };\n    var mergeMargins = function (css) {\n      if (css.margin) {\n        var splitMargin = String(css.margin).split(' ');\n        switch (splitMargin.length) {\n        case 1:\n          css['margin-top'] = css['margin-top'] || splitMargin[0];\n          css['margin-right'] = css['margin-right'] || splitMargin[0];\n          css['margin-bottom'] = css['margin-bottom'] || splitMargin[0];\n          css['margin-left'] = css['margin-left'] || splitMargin[0];\n          break;\n        case 2:\n          css['margin-top'] = css['margin-top'] || splitMargin[0];\n          css['margin-right'] = css['margin-right'] || splitMargin[1];\n          css['margin-bottom'] = css['margin-bottom'] || splitMargin[0];\n          css['margin-left'] = css['margin-left'] || splitMargin[1];\n          break;\n        case 3:\n          css['margin-top'] = css['margin-top'] || splitMargin[0];\n          css['margin-right'] = css['margin-right'] || splitMargin[1];\n          css['margin-bottom'] = css['margin-bottom'] || splitMargin[2];\n          css['margin-left'] = css['margin-left'] || splitMargin[1];\n          break;\n        case 4:\n          css['margin-top'] = css['margin-top'] || splitMargin[0];\n          css['margin-right'] = css['margin-right'] || splitMargin[1];\n          css['margin-bottom'] = css['margin-bottom'] || splitMargin[2];\n          css['margin-left'] = css['margin-left'] || splitMargin[3];\n        }\n        delete css.margin;\n      }\n      return css;\n    };\n    var createImageList = function (editor, callback) {\n      var imageList = Settings.getImageList(editor);\n      if (typeof imageList === 'string') {\n        global$4.send({\n          url: imageList,\n          success: function (text) {\n            callback(JSON.parse(text));\n          }\n        });\n      } else if (typeof imageList === 'function') {\n        imageList(callback);\n      } else {\n        callback(imageList);\n      }\n    };\n    var waitLoadImage = function (editor, data, imgElm) {\n      var selectImage = function () {\n        imgElm.onload = imgElm.onerror = null;\n        if (editor.selection) {\n          editor.selection.select(imgElm);\n          editor.nodeChanged();\n        }\n      };\n      imgElm.onload = function () {\n        if (!data.width && !data.height && Settings.hasDimensions(editor)) {\n          editor.dom.setAttribs(imgElm, {\n            width: String(imgElm.clientWidth),\n            height: String(imgElm.clientHeight)\n          });\n        }\n        selectImage();\n      };\n      imgElm.onerror = selectImage;\n    };\n    var blobToDataUri = function (blob) {\n      return new global$3(function (resolve, reject) {\n        var reader = new domGlobals.FileReader();\n        reader.onload = function () {\n          resolve(reader.result);\n        };\n        reader.onerror = function () {\n          reject(reader.error.message);\n        };\n        reader.readAsDataURL(blob);\n      });\n    };\n    var isPlaceholderImage = function (imgElm) {\n      return imgElm.nodeName === 'IMG' && (imgElm.hasAttribute('data-mce-object') || imgElm.hasAttribute('data-mce-placeholder'));\n    };\n    var Utils = {\n      getImageSize: getImageSize,\n      removePixelSuffix: removePixelSuffix,\n      addPixelSuffix: addPixelSuffix,\n      mergeMargins: mergeMargins,\n      createImageList: createImageList,\n      waitLoadImage: waitLoadImage,\n      blobToDataUri: blobToDataUri,\n      isPlaceholderImage: isPlaceholderImage\n    };\n\n    var DOM = global$2.DOM;\n    var getHspace = function (image) {\n      if (image.style.marginLeft && image.style.marginRight && image.style.marginLeft === image.style.marginRight) {\n        return Utils.removePixelSuffix(image.style.marginLeft);\n      } else {\n        return '';\n      }\n    };\n    var getVspace = function (image) {\n      if (image.style.marginTop && image.style.marginBottom && image.style.marginTop === image.style.marginBottom) {\n        return Utils.removePixelSuffix(image.style.marginTop);\n      } else {\n        return '';\n      }\n    };\n    var getBorder = function (image) {\n      if (image.style.borderWidth) {\n        return Utils.removePixelSuffix(image.style.borderWidth);\n      } else {\n        return '';\n      }\n    };\n    var getAttrib = function (image, name) {\n      if (image.hasAttribute(name)) {\n        return image.getAttribute(name);\n      } else {\n        return '';\n      }\n    };\n    var getStyle = function (image, name) {\n      return image.style[name] ? image.style[name] : '';\n    };\n    var hasCaption = function (image) {\n      return image.parentNode !== null && image.parentNode.nodeName === 'FIGURE';\n    };\n    var setAttrib = function (image, name, value) {\n      image.setAttribute(name, value);\n    };\n    var wrapInFigure = function (image) {\n      var figureElm = DOM.create('figure', { class: 'image' });\n      DOM.insertAfter(figureElm, image);\n      figureElm.appendChild(image);\n      figureElm.appendChild(DOM.create('figcaption', { contentEditable: 'true' }, 'Caption'));\n      figureElm.contentEditable = 'false';\n    };\n    var removeFigure = function (image) {\n      var figureElm = image.parentNode;\n      DOM.insertAfter(image, figureElm);\n      DOM.remove(figureElm);\n    };\n    var toggleCaption = function (image) {\n      if (hasCaption(image)) {\n        removeFigure(image);\n      } else {\n        wrapInFigure(image);\n      }\n    };\n    var normalizeStyle = function (image, normalizeCss) {\n      var attrValue = image.getAttribute('style');\n      var value = normalizeCss(attrValue !== null ? attrValue : '');\n      if (value.length > 0) {\n        image.setAttribute('style', value);\n        image.setAttribute('data-mce-style', value);\n      } else {\n        image.removeAttribute('style');\n      }\n    };\n    var setSize = function (name, normalizeCss) {\n      return function (image, name, value) {\n        if (image.style[name]) {\n          image.style[name] = Utils.addPixelSuffix(value);\n          normalizeStyle(image, normalizeCss);\n        } else {\n          setAttrib(image, name, value);\n        }\n      };\n    };\n    var getSize = function (image, name) {\n      if (image.style[name]) {\n        return Utils.removePixelSuffix(image.style[name]);\n      } else {\n        return getAttrib(image, name);\n      }\n    };\n    var setHspace = function (image, value) {\n      var pxValue = Utils.addPixelSuffix(value);\n      image.style.marginLeft = pxValue;\n      image.style.marginRight = pxValue;\n    };\n    var setVspace = function (image, value) {\n      var pxValue = Utils.addPixelSuffix(value);\n      image.style.marginTop = pxValue;\n      image.style.marginBottom = pxValue;\n    };\n    var setBorder = function (image, value) {\n      var pxValue = Utils.addPixelSuffix(value);\n      image.style.borderWidth = pxValue;\n    };\n    var setBorderStyle = function (image, value) {\n      image.style.borderStyle = value;\n    };\n    var getBorderStyle = function (image) {\n      return getStyle(image, 'borderStyle');\n    };\n    var isFigure = function (elm) {\n      return elm.nodeName === 'FIGURE';\n    };\n    var isImage = function (elm) {\n      return elm.nodeName === 'IMG';\n    };\n    var defaultData = function () {\n      return {\n        src: '',\n        alt: '',\n        title: '',\n        width: '',\n        height: '',\n        class: '',\n        style: '',\n        caption: false,\n        hspace: '',\n        vspace: '',\n        border: '',\n        borderStyle: ''\n      };\n    };\n    var getStyleValue = function (normalizeCss, data) {\n      var image = domGlobals.document.createElement('img');\n      setAttrib(image, 'style', data.style);\n      if (getHspace(image) || data.hspace !== '') {\n        setHspace(image, data.hspace);\n      }\n      if (getVspace(image) || data.vspace !== '') {\n        setVspace(image, data.vspace);\n      }\n      if (getBorder(image) || data.border !== '') {\n        setBorder(image, data.border);\n      }\n      if (getBorderStyle(image) || data.borderStyle !== '') {\n        setBorderStyle(image, data.borderStyle);\n      }\n      return normalizeCss(image.getAttribute('style'));\n    };\n    var create = function (normalizeCss, data) {\n      var image = domGlobals.document.createElement('img');\n      write(normalizeCss, merge(data, { caption: false }), image);\n      setAttrib(image, 'alt', data.alt);\n      if (data.caption) {\n        var figure = DOM.create('figure', { class: 'image' });\n        figure.appendChild(image);\n        figure.appendChild(DOM.create('figcaption', { contentEditable: 'true' }, 'Caption'));\n        figure.contentEditable = 'false';\n        return figure;\n      } else {\n        return image;\n      }\n    };\n    var read = function (normalizeCss, image) {\n      return {\n        src: getAttrib(image, 'src'),\n        alt: getAttrib(image, 'alt'),\n        title: getAttrib(image, 'title'),\n        width: getSize(image, 'width'),\n        height: getSize(image, 'height'),\n        class: getAttrib(image, 'class'),\n        style: normalizeCss(getAttrib(image, 'style')),\n        caption: hasCaption(image),\n        hspace: getHspace(image),\n        vspace: getVspace(image),\n        border: getBorder(image),\n        borderStyle: getStyle(image, 'borderStyle')\n      };\n    };\n    var updateProp = function (image, oldData, newData, name, set) {\n      if (newData[name] !== oldData[name]) {\n        set(image, name, newData[name]);\n      }\n    };\n    var normalized = function (set, normalizeCss) {\n      return function (image, name, value) {\n        set(image, value);\n        normalizeStyle(image, normalizeCss);\n      };\n    };\n    var write = function (normalizeCss, newData, image) {\n      var oldData = read(normalizeCss, image);\n      updateProp(image, oldData, newData, 'caption', function (image, _name, _value) {\n        return toggleCaption(image);\n      });\n      updateProp(image, oldData, newData, 'src', setAttrib);\n      updateProp(image, oldData, newData, 'alt', setAttrib);\n      updateProp(image, oldData, newData, 'title', setAttrib);\n      updateProp(image, oldData, newData, 'width', setSize('width', normalizeCss));\n      updateProp(image, oldData, newData, 'height', setSize('height', normalizeCss));\n      updateProp(image, oldData, newData, 'class', setAttrib);\n      updateProp(image, oldData, newData, 'style', normalized(function (image, value) {\n        return setAttrib(image, 'style', value);\n      }, normalizeCss));\n      updateProp(image, oldData, newData, 'hspace', normalized(setHspace, normalizeCss));\n      updateProp(image, oldData, newData, 'vspace', normalized(setVspace, normalizeCss));\n      updateProp(image, oldData, newData, 'border', normalized(setBorder, normalizeCss));\n      updateProp(image, oldData, newData, 'borderStyle', normalized(setBorderStyle, normalizeCss));\n    };\n\n    var normalizeCss = function (editor, cssText) {\n      var css = editor.dom.styles.parse(cssText);\n      var mergedCss = Utils.mergeMargins(css);\n      var compressed = editor.dom.styles.parse(editor.dom.styles.serialize(mergedCss));\n      return editor.dom.styles.serialize(compressed);\n    };\n    var getSelectedImage = function (editor) {\n      var imgElm = editor.selection.getNode();\n      var figureElm = editor.dom.getParent(imgElm, 'figure.image');\n      if (figureElm) {\n        return editor.dom.select('img', figureElm)[0];\n      }\n      if (imgElm && (imgElm.nodeName !== 'IMG' || Utils.isPlaceholderImage(imgElm))) {\n        return null;\n      }\n      return imgElm;\n    };\n    var splitTextBlock = function (editor, figure) {\n      var dom = editor.dom;\n      var textBlock = dom.getParent(figure.parentNode, function (node) {\n        return editor.schema.getTextBlockElements()[node.nodeName];\n      }, editor.getBody());\n      if (textBlock) {\n        return dom.split(textBlock, figure);\n      } else {\n        return figure;\n      }\n    };\n    var readImageDataFromSelection = function (editor) {\n      var image = getSelectedImage(editor);\n      return image ? read(function (css) {\n        return normalizeCss(editor, css);\n      }, image) : defaultData();\n    };\n    var insertImageAtCaret = function (editor, data) {\n      var elm = create(function (css) {\n        return normalizeCss(editor, css);\n      }, data);\n      editor.dom.setAttrib(elm, 'data-mce-id', '__mcenew');\n      editor.focus();\n      editor.selection.setContent(elm.outerHTML);\n      var insertedElm = editor.dom.select('*[data-mce-id=\"__mcenew\"]')[0];\n      editor.dom.setAttrib(insertedElm, 'data-mce-id', null);\n      if (isFigure(insertedElm)) {\n        var figure = splitTextBlock(editor, insertedElm);\n        editor.selection.select(figure);\n      } else {\n        editor.selection.select(insertedElm);\n      }\n    };\n    var syncSrcAttr = function (editor, image) {\n      editor.dom.setAttrib(image, 'src', image.getAttribute('src'));\n    };\n    var deleteImage = function (editor, image) {\n      if (image) {\n        var elm = editor.dom.is(image.parentNode, 'figure.image') ? image.parentNode : image;\n        editor.dom.remove(elm);\n        editor.focus();\n        editor.nodeChanged();\n        if (editor.dom.isEmpty(editor.getBody())) {\n          editor.setContent('');\n          editor.selection.setCursorLocation();\n        }\n      }\n    };\n    var writeImageDataToSelection = function (editor, data) {\n      var image = getSelectedImage(editor);\n      write(function (css) {\n        return normalizeCss(editor, css);\n      }, data, image);\n      syncSrcAttr(editor, image);\n      if (isFigure(image.parentNode)) {\n        var figure = image.parentNode;\n        splitTextBlock(editor, figure);\n        editor.selection.select(image.parentNode);\n      } else {\n        editor.selection.select(image);\n        Utils.waitLoadImage(editor, data, image);\n      }\n    };\n    var insertOrUpdateImage = function (editor, data) {\n      var image = getSelectedImage(editor);\n      if (image) {\n        if (data.src) {\n          writeImageDataToSelection(editor, data);\n        } else {\n          deleteImage(editor, image);\n        }\n      } else if (data.src) {\n        insertImageAtCaret(editor, data);\n      }\n    };\n\n    var findMap = function (arr, f) {\n      for (var i = 0; i < arr.length; i++) {\n        var r = f(arr[i], i);\n        if (r.isSome()) {\n          return r;\n        }\n      }\n      return Option.none();\n    };\n\n    var global$5 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var getValue = function (item) {\n      return isString(item.value) ? item.value : '';\n    };\n    var sanitizeList = function (list, extractValue) {\n      var out = [];\n      global$5.each(list, function (item) {\n        var text = isString(item.text) ? item.text : isString(item.title) ? item.title : '';\n        if (item.menu !== undefined) {\n          var items = sanitizeList(item.menu, extractValue);\n          out.push({\n            text: text,\n            items: items\n          });\n        } else {\n          var value = extractValue(item);\n          out.push({\n            text: text,\n            value: value\n          });\n        }\n      });\n      return out;\n    };\n    var sanitizer = function (extracter) {\n      if (extracter === void 0) {\n        extracter = getValue;\n      }\n      return function (list) {\n        if (list) {\n          return Option.from(list).map(function (list) {\n            return sanitizeList(list, extracter);\n          });\n        } else {\n          return Option.none();\n        }\n      };\n    };\n    var sanitize = function (list) {\n      return sanitizer(getValue)(list);\n    };\n    var isGroup = function (item) {\n      return Object.prototype.hasOwnProperty.call(item, 'items');\n    };\n    var findEntryDelegate = function (list, value) {\n      return findMap(list, function (item) {\n        if (isGroup(item)) {\n          return findEntryDelegate(item.items, value);\n        } else if (item.value === value) {\n          return Option.some(item);\n        } else {\n          return Option.none();\n        }\n      });\n    };\n    var findEntry = function (optList, value) {\n      return optList.bind(function (list) {\n        return findEntryDelegate(list, value);\n      });\n    };\n    var ListUtils = {\n      sanitizer: sanitizer,\n      sanitize: sanitize,\n      findEntry: findEntry\n    };\n\n    var pathJoin = function (path1, path2) {\n      if (path1) {\n        return path1.replace(/\\/$/, '') + '/' + path2.replace(/^\\//, '');\n      }\n      return path2;\n    };\n    function Uploader (settings) {\n      var defaultHandler = function (blobInfo, success, failure, progress) {\n        var xhr, formData;\n        xhr = new domGlobals.XMLHttpRequest();\n        xhr.open('POST', settings.url);\n        xhr.withCredentials = settings.credentials;\n        xhr.upload.onprogress = function (e) {\n          progress(e.loaded / e.total * 100);\n        };\n        xhr.onerror = function () {\n          failure('Image upload failed due to a XHR Transport error. Code: ' + xhr.status);\n        };\n        xhr.onload = function () {\n          var json;\n          if (xhr.status < 200 || xhr.status >= 300) {\n            failure('HTTP Error: ' + xhr.status);\n            return;\n          }\n          json = JSON.parse(xhr.responseText);\n          if (!json || typeof json.location !== 'string') {\n            failure('Invalid JSON: ' + xhr.responseText);\n            return;\n          }\n          success(pathJoin(settings.basePath, json.location));\n        };\n        formData = new domGlobals.FormData();\n        formData.append('file', blobInfo.blob(), blobInfo.filename());\n        xhr.send(formData);\n      };\n      var uploadBlob = function (blobInfo, handler) {\n        return new global$3(function (resolve, reject) {\n          try {\n            handler(blobInfo, resolve, reject, noop);\n          } catch (ex) {\n            reject(ex.message);\n          }\n        });\n      };\n      var isDefaultHandler = function (handler) {\n        return handler === defaultHandler;\n      };\n      var upload = function (blobInfo) {\n        return !settings.url && isDefaultHandler(settings.handler) ? global$3.reject('Upload url missing from the settings.') : uploadBlob(blobInfo, settings.handler);\n      };\n      settings = global$5.extend({\n        credentials: false,\n        handler: defaultHandler\n      }, settings);\n      return { upload: upload };\n    }\n\n    var makeTab$1 = function (info) {\n      return {\n        title: 'Advanced',\n        name: 'advanced',\n        items: [\n          {\n            type: 'input',\n            label: 'Style',\n            name: 'style'\n          },\n          {\n            type: 'grid',\n            columns: 2,\n            items: [\n              {\n                type: 'input',\n                label: 'Vertical space',\n                name: 'vspace',\n                inputMode: 'numeric'\n              },\n              {\n                type: 'input',\n                label: 'Horizontal space',\n                name: 'hspace',\n                inputMode: 'numeric'\n              },\n              {\n                type: 'input',\n                label: 'Border width',\n                name: 'border',\n                inputMode: 'numeric'\n              },\n              {\n                type: 'selectbox',\n                name: 'borderstyle',\n                label: 'Border style',\n                items: [\n                  {\n                    text: 'Select...',\n                    value: ''\n                  },\n                  {\n                    text: 'Solid',\n                    value: 'solid'\n                  },\n                  {\n                    text: 'Dotted',\n                    value: 'dotted'\n                  },\n                  {\n                    text: 'Dashed',\n                    value: 'dashed'\n                  },\n                  {\n                    text: 'Double',\n                    value: 'double'\n                  },\n                  {\n                    text: 'Groove',\n                    value: 'groove'\n                  },\n                  {\n                    text: 'Ridge',\n                    value: 'ridge'\n                  },\n                  {\n                    text: 'Inset',\n                    value: 'inset'\n                  },\n                  {\n                    text: 'Outset',\n                    value: 'outset'\n                  },\n                  {\n                    text: 'None',\n                    value: 'none'\n                  },\n                  {\n                    text: 'Hidden',\n                    value: 'hidden'\n                  }\n                ]\n              }\n            ]\n          }\n        ]\n      };\n    };\n    var AdvTab = { makeTab: makeTab$1 };\n\n    var collect = function (editor) {\n      var urlListSanitizer = ListUtils.sanitizer(function (item) {\n        return editor.convertURL(item.value || item.url, 'src');\n      });\n      var futureImageList = Future.nu(function (completer) {\n        Utils.createImageList(editor, function (imageList) {\n          completer(urlListSanitizer(imageList).map(function (items) {\n            return flatten([\n              [{\n                  text: 'None',\n                  value: ''\n                }],\n              items\n            ]);\n          }));\n        });\n      });\n      var classList = ListUtils.sanitize(Settings.getClassList(editor));\n      var hasAdvTab = Settings.hasAdvTab(editor);\n      var hasUploadTab = Settings.hasUploadTab(editor);\n      var hasUploadUrl = Settings.hasUploadUrl(editor);\n      var hasUploadHandler = Settings.hasUploadHandler(editor);\n      var image = readImageDataFromSelection(editor);\n      var hasDescription = Settings.hasDescription(editor);\n      var hasImageTitle = Settings.hasImageTitle(editor);\n      var hasDimensions = Settings.hasDimensions(editor);\n      var hasImageCaption = Settings.hasImageCaption(editor);\n      var url = Settings.getUploadUrl(editor);\n      var basePath = Settings.getUploadBasePath(editor);\n      var credentials = Settings.getUploadCredentials(editor);\n      var handler = Settings.getUploadHandler(editor);\n      var prependURL = Option.some(Settings.getPrependUrl(editor)).filter(function (preUrl) {\n        return isString(preUrl) && preUrl.length > 0;\n      });\n      return futureImageList.map(function (imageList) {\n        return {\n          image: image,\n          imageList: imageList,\n          classList: classList,\n          hasAdvTab: hasAdvTab,\n          hasUploadTab: hasUploadTab,\n          hasUploadUrl: hasUploadUrl,\n          hasUploadHandler: hasUploadHandler,\n          hasDescription: hasDescription,\n          hasImageTitle: hasImageTitle,\n          hasDimensions: hasDimensions,\n          hasImageCaption: hasImageCaption,\n          url: url,\n          basePath: basePath,\n          credentials: credentials,\n          handler: handler,\n          prependURL: prependURL\n        };\n      });\n    };\n\n    var makeTab$2 = function (info) {\n      var items = [{\n          type: 'dropzone',\n          name: 'fileinput'\n        }];\n      return {\n        title: 'Upload',\n        name: 'upload',\n        items: items\n      };\n    };\n    var UploadTab = { makeTab: makeTab$2 };\n\n    var createState = function (info) {\n      return {\n        prevImage: ListUtils.findEntry(info.imageList, info.image.src),\n        prevAlt: info.image.alt,\n        open: true\n      };\n    };\n    var fromImageData = function (image) {\n      return {\n        src: {\n          value: image.src,\n          meta: {}\n        },\n        images: image.src,\n        alt: image.alt,\n        title: image.title,\n        dimensions: {\n          width: image.width,\n          height: image.height\n        },\n        classes: image.class,\n        caption: image.caption,\n        style: image.style,\n        vspace: image.vspace,\n        border: image.border,\n        hspace: image.hspace,\n        borderstyle: image.borderStyle,\n        fileinput: []\n      };\n    };\n    var toImageData = function (data) {\n      return {\n        src: data.src.value,\n        alt: data.alt,\n        title: data.title,\n        width: data.dimensions.width,\n        height: data.dimensions.height,\n        class: data.classes,\n        style: data.style,\n        caption: data.caption,\n        hspace: data.hspace,\n        vspace: data.vspace,\n        border: data.border,\n        borderStyle: data.borderstyle\n      };\n    };\n    var addPrependUrl2 = function (info, srcURL) {\n      if (!/^(?:[a-zA-Z]+:)?\\/\\//.test(srcURL)) {\n        return info.prependURL.bind(function (prependUrl) {\n          if (srcURL.substring(0, prependUrl.length) !== prependUrl) {\n            return Option.some(prependUrl + srcURL);\n          }\n          return Option.none();\n        });\n      }\n      return Option.none();\n    };\n    var addPrependUrl = function (info, api) {\n      var data = api.getData();\n      addPrependUrl2(info, data.src.value).each(function (srcURL) {\n        api.setData({\n          src: {\n            value: srcURL,\n            meta: data.src.meta\n          }\n        });\n      });\n    };\n    var formFillFromMeta2 = function (info, data, meta) {\n      if (info.hasDescription && isString(meta.alt)) {\n        data.alt = meta.alt;\n      }\n      if (info.hasImageTitle && isString(meta.title)) {\n        data.title = meta.title;\n      }\n      if (info.hasDimensions) {\n        if (isString(meta.width)) {\n          data.dimensions.width = meta.width;\n        }\n        if (isString(meta.height)) {\n          data.dimensions.height = meta.height;\n        }\n      }\n      if (isString(meta.class)) {\n        ListUtils.findEntry(info.classList, meta.class).each(function (entry) {\n          data.classes = entry.value;\n        });\n      }\n      if (info.hasImageCaption) {\n        if (isBoolean(meta.caption)) {\n          data.caption = meta.caption;\n        }\n      }\n      if (info.hasAdvTab) {\n        if (isString(meta.vspace)) {\n          data.vspace = meta.vspace;\n        }\n        if (isString(meta.border)) {\n          data.border = meta.border;\n        }\n        if (isString(meta.hspace)) {\n          data.hspace = meta.hspace;\n        }\n        if (isString(meta.borderstyle)) {\n          data.borderstyle = meta.borderstyle;\n        }\n      }\n    };\n    var formFillFromMeta = function (info, api) {\n      var data = api.getData();\n      var meta = data.src.meta;\n      if (meta !== undefined) {\n        var newData = deepMerge({}, data);\n        formFillFromMeta2(info, newData, meta);\n        api.setData(newData);\n      }\n    };\n    var calculateImageSize = function (helpers, info, state, api) {\n      var data = api.getData();\n      var url = data.src.value;\n      var meta = data.src.meta || {};\n      if (!meta.width && !meta.height && info.hasDimensions) {\n        helpers.imageSize(url).get(function (result) {\n          result.each(function (size) {\n            if (state.open) {\n              api.setData({ dimensions: size });\n            }\n          });\n        });\n      }\n    };\n    var updateImagesDropdown = function (info, state, api) {\n      var data = api.getData();\n      var image = ListUtils.findEntry(info.imageList, data.src.value);\n      state.prevImage = image;\n      api.setData({\n        images: image.map(function (entry) {\n          return entry.value;\n        }).getOr('')\n      });\n    };\n    var changeSrc = function (helpers, info, state, api) {\n      addPrependUrl(info, api);\n      formFillFromMeta(info, api);\n      calculateImageSize(helpers, info, state, api);\n      updateImagesDropdown(info, state, api);\n    };\n    var changeImages = function (helpers, info, state, api) {\n      var data = api.getData();\n      var image = ListUtils.findEntry(info.imageList, data.images);\n      image.each(function (img) {\n        var updateAlt = data.alt === '' || state.prevImage.map(function (image) {\n          return image.text === data.alt;\n        }).getOr(false);\n        if (updateAlt) {\n          if (img.value === '') {\n            api.setData({\n              src: img,\n              alt: state.prevAlt\n            });\n          } else {\n            api.setData({\n              src: img,\n              alt: img.text\n            });\n          }\n        } else {\n          api.setData({ src: img });\n        }\n      });\n      state.prevImage = image;\n      changeSrc(helpers, info, state, api);\n    };\n    var calcVSpace = function (css) {\n      var matchingTopBottom = css['margin-top'] && css['margin-bottom'] && css['margin-top'] === css['margin-bottom'];\n      return matchingTopBottom ? Utils.removePixelSuffix(String(css['margin-top'])) : '';\n    };\n    var calcHSpace = function (css) {\n      var matchingLeftRight = css['margin-right'] && css['margin-left'] && css['margin-right'] === css['margin-left'];\n      return matchingLeftRight ? Utils.removePixelSuffix(String(css['margin-right'])) : '';\n    };\n    var calcBorderWidth = function (css) {\n      return css['border-width'] ? Utils.removePixelSuffix(String(css['border-width'])) : '';\n    };\n    var calcBorderStyle = function (css) {\n      return css['border-style'] ? String(css['border-style']) : '';\n    };\n    var calcStyle = function (parseStyle, serializeStyle, css) {\n      return serializeStyle(parseStyle(serializeStyle(css)));\n    };\n    var changeStyle2 = function (parseStyle, serializeStyle, data) {\n      var css = Utils.mergeMargins(parseStyle(data.style));\n      var dataCopy = deepMerge({}, data);\n      dataCopy.vspace = calcVSpace(css);\n      dataCopy.hspace = calcHSpace(css);\n      dataCopy.border = calcBorderWidth(css);\n      dataCopy.borderstyle = calcBorderStyle(css);\n      dataCopy.style = calcStyle(parseStyle, serializeStyle, css);\n      return dataCopy;\n    };\n    var changeStyle = function (helpers, api) {\n      var data = api.getData();\n      var newData = changeStyle2(helpers.parseStyle, helpers.serializeStyle, data);\n      api.setData(newData);\n    };\n    var changeAStyle = function (helpers, info, api) {\n      var data = deepMerge(fromImageData(info.image), api.getData());\n      var style = getStyleValue(helpers.normalizeCss, toImageData(data));\n      api.setData({ style: style });\n    };\n    var changeFileInput = function (helpers, info, state, api) {\n      var data = api.getData();\n      api.block('Uploading image');\n      head(data.fileinput).fold(function () {\n        api.unblock();\n      }, function (file) {\n        var blobUri = domGlobals.URL.createObjectURL(file);\n        var uploader = Uploader({\n          url: info.url,\n          basePath: info.basePath,\n          credentials: info.credentials,\n          handler: info.handler\n        });\n        var finalize = function () {\n          api.unblock();\n          domGlobals.URL.revokeObjectURL(blobUri);\n        };\n        Utils.blobToDataUri(file).then(function (dataUrl) {\n          var blobInfo = helpers.createBlobCache(file, blobUri, dataUrl);\n          uploader.upload(blobInfo).then(function (url) {\n            api.setData({\n              src: {\n                value: url,\n                meta: {}\n              }\n            });\n            api.showTab('general');\n            changeSrc(helpers, info, state, api);\n            finalize();\n          }).catch(function (err) {\n            finalize();\n            helpers.alertErr(api, err);\n          });\n        });\n      });\n    };\n    var changeHandler = function (helpers, info, state) {\n      return function (api, evt) {\n        if (evt.name === 'src') {\n          changeSrc(helpers, info, state, api);\n        } else if (evt.name === 'images') {\n          changeImages(helpers, info, state, api);\n        } else if (evt.name === 'alt') {\n          state.prevAlt = api.getData().alt;\n        } else if (evt.name === 'style') {\n          changeStyle(helpers, api);\n        } else if (evt.name === 'vspace' || evt.name === 'hspace' || evt.name === 'border' || evt.name === 'borderstyle') {\n          changeAStyle(helpers, info, api);\n        } else if (evt.name === 'fileinput') {\n          changeFileInput(helpers, info, state, api);\n        }\n      };\n    };\n    var closeHandler = function (state) {\n      return function () {\n        state.open = false;\n      };\n    };\n    var makeDialogBody = function (info) {\n      if (info.hasAdvTab || info.hasUploadUrl || info.hasUploadHandler) {\n        var tabPanel = {\n          type: 'tabpanel',\n          tabs: flatten([\n            [MainTab.makeTab(info)],\n            info.hasAdvTab ? [AdvTab.makeTab(info)] : [],\n            info.hasUploadTab && (info.hasUploadUrl || info.hasUploadHandler) ? [UploadTab.makeTab(info)] : []\n          ])\n        };\n        return tabPanel;\n      } else {\n        var panel = {\n          type: 'panel',\n          items: MainTab.makeItems(info)\n        };\n        return panel;\n      }\n    };\n    var makeDialog = function (helpers) {\n      return function (info) {\n        var state = createState(info);\n        return {\n          title: 'Insert/Edit Image',\n          size: 'normal',\n          body: makeDialogBody(info),\n          buttons: [\n            {\n              type: 'cancel',\n              name: 'cancel',\n              text: 'Cancel'\n            },\n            {\n              type: 'submit',\n              name: 'save',\n              text: 'Save',\n              primary: true\n            }\n          ],\n          initialData: fromImageData(info.image),\n          onSubmit: helpers.onSubmit(info),\n          onChange: changeHandler(helpers, info, state),\n          onClose: closeHandler(state)\n        };\n      };\n    };\n    var submitHandler = function (editor) {\n      return function (info) {\n        return function (api) {\n          var data = deepMerge(fromImageData(info.image), api.getData());\n          editor.undoManager.transact(function () {\n            insertOrUpdateImage(editor, toImageData(data));\n          });\n          editor.editorUpload.uploadImagesAuto();\n          api.close();\n        };\n      };\n    };\n    var imageSize = function (editor) {\n      return function (url) {\n        return FutureResult.nu(function (completer) {\n          Utils.getImageSize(editor.documentBaseURI.toAbsolute(url), function (data) {\n            var result = data.map(function (dimensions) {\n              return {\n                width: String(dimensions.width),\n                height: String(dimensions.height)\n              };\n            });\n            completer(result);\n          });\n        });\n      };\n    };\n    var createBlobCache = function (editor) {\n      return function (file, blobUri, dataUrl) {\n        return editor.editorUpload.blobCache.create({\n          blob: file,\n          blobUri: blobUri,\n          name: file.name ? file.name.replace(/\\.[^\\.]+$/, '') : null,\n          base64: dataUrl.split(',')[1]\n        });\n      };\n    };\n    var alertErr = function (editor) {\n      return function (api, message) {\n        editor.windowManager.alert(message, api.close);\n      };\n    };\n    var normalizeCss$1 = function (editor) {\n      return function (cssText) {\n        return normalizeCss(editor, cssText);\n      };\n    };\n    var parseStyle = function (editor) {\n      return function (cssText) {\n        return editor.dom.parseStyle(cssText);\n      };\n    };\n    var serializeStyle = function (editor) {\n      return function (stylesArg, name) {\n        return editor.dom.serializeStyle(stylesArg, name);\n      };\n    };\n    var Dialog = function (editor) {\n      var helpers = {\n        onSubmit: submitHandler(editor),\n        imageSize: imageSize(editor),\n        createBlobCache: createBlobCache(editor),\n        alertErr: alertErr(editor),\n        normalizeCss: normalizeCss$1(editor),\n        parseStyle: parseStyle(editor),\n        serializeStyle: serializeStyle(editor)\n      };\n      var open = function () {\n        return collect(editor).map(makeDialog(helpers)).get(function (spec) {\n          editor.windowManager.open(spec);\n        });\n      };\n      return { open: open };\n    };\n\n    var register = function (editor) {\n      editor.addCommand('mceImage', Dialog(editor).open);\n    };\n    var Commands = { register: register };\n\n    var hasImageClass = function (node) {\n      var className = node.attr('class');\n      return className && /\\bimage\\b/.test(className);\n    };\n    var toggleContentEditableState = function (state) {\n      return function (nodes) {\n        var i = nodes.length;\n        var toggleContentEditable = function (node) {\n          node.attr('contenteditable', state ? 'true' : null);\n        };\n        while (i--) {\n          var node = nodes[i];\n          if (hasImageClass(node)) {\n            node.attr('contenteditable', state ? 'false' : null);\n            global$5.each(node.getAll('figcaption'), toggleContentEditable);\n          }\n        }\n      };\n    };\n    var setup = function (editor) {\n      editor.on('PreInit', function () {\n        editor.parser.addNodeFilter('figure', toggleContentEditableState(true));\n        editor.serializer.addNodeFilter('figure', toggleContentEditableState(false));\n      });\n    };\n    var FilterContent = { setup: setup };\n\n    var register$1 = function (editor) {\n      editor.ui.registry.addToggleButton('image', {\n        icon: 'image',\n        tooltip: 'Insert/edit image',\n        onAction: Dialog(editor).open,\n        onSetup: function (buttonApi) {\n          return editor.selection.selectorChangedWithUnbind('img:not([data-mce-object],[data-mce-placeholder]),figure.image', buttonApi.setActive).unbind;\n        }\n      });\n      editor.ui.registry.addMenuItem('image', {\n        icon: 'image',\n        text: 'Image...',\n        onAction: Dialog(editor).open\n      });\n      editor.ui.registry.addContextMenu('image', {\n        update: function (element) {\n          return isFigure(element) || isImage(element) && !Utils.isPlaceholderImage(element) ? ['image'] : [];\n        }\n      });\n    };\n    var Buttons = { register: register$1 };\n\n    function Plugin () {\n      global$1.add('image', function (editor) {\n        FilterContent.setup(editor);\n        Buttons.register(editor);\n        Commands.register(editor);\n      });\n    }\n\n    Plugin();\n\n}(window));\n"]}