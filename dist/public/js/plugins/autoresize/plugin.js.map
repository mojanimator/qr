{"version":3,"sources":["../../../../../public/js/plugins/autoresize/plugin.js"],"names":["Cell","initial","value","get","set","v","clone","global","tinymce","util","Tools","resolve","global$1","global$2","fireResizeEditor","editor","fire","Events","getAutoResizeMinHeight","getParam","getElement","offsetHeight","getAutoResizeMaxHeight","getAutoResizeOverflowPadding","getAutoResizeBottomMargin","shouldAutoResizeOnInit","Settings","isFullscreen","plugins","fullscreen","wait","oldSize","times","interval","callback","setEditorTimeout","resize","toggleScrolling","state","body","getBody","style","overflowY","scrollTop","parseCssValueToInt","dom","elm","name","computed","parseInt","getStyle","isNaN","deltaSize","resizeHeight","contentHeight","doc","getDoc","docEle","documentElement","resizeBottomMargin","marginTop","marginBottom","containerHeight","getContainer","contentAreaHeight","getContentAreaContainer","chromeHeight","maxHeight","setStyle","browser","isSafari","mac","win","getWin","scrollTo","pageXOffset","pageYOffset","hasFocus","selection","scrollIntoView","getNode","webkit","setup","on","overflowPadding","setStyles","Resize","register","addCommand","Commands","Plugin","add","settings","hasOwnProperty","inline"],"mappings":"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","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.1.0 (2019-10-17)\n */\n(function () {\n    'use strict';\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      var clone = function () {\n        return Cell(get());\n      };\n      return {\n        get: get,\n        set: set,\n        clone: clone\n      };\n    };\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.Env');\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.util.Delay');\n\n    var fireResizeEditor = function (editor) {\n      return editor.fire('ResizeEditor');\n    };\n    var Events = { fireResizeEditor: fireResizeEditor };\n\n    var getAutoResizeMinHeight = function (editor) {\n      return editor.getParam('min_height', editor.getElement().offsetHeight, 'number');\n    };\n    var getAutoResizeMaxHeight = function (editor) {\n      return editor.getParam('max_height', 0, 'number');\n    };\n    var getAutoResizeOverflowPadding = function (editor) {\n      return editor.getParam('autoresize_overflow_padding', 1, 'number');\n    };\n    var getAutoResizeBottomMargin = function (editor) {\n      return editor.getParam('autoresize_bottom_margin', 50, 'number');\n    };\n    var shouldAutoResizeOnInit = function (editor) {\n      return editor.getParam('autoresize_on_init', true, 'boolean');\n    };\n    var Settings = {\n      getAutoResizeMinHeight: getAutoResizeMinHeight,\n      getAutoResizeMaxHeight: getAutoResizeMaxHeight,\n      getAutoResizeOverflowPadding: getAutoResizeOverflowPadding,\n      getAutoResizeBottomMargin: getAutoResizeBottomMargin,\n      shouldAutoResizeOnInit: shouldAutoResizeOnInit\n    };\n\n    var isFullscreen = function (editor) {\n      return editor.plugins.fullscreen && editor.plugins.fullscreen.isFullscreen();\n    };\n    var wait = function (editor, oldSize, times, interval, callback) {\n      global$2.setEditorTimeout(editor, function () {\n        resize(editor, oldSize);\n        if (times--) {\n          wait(editor, oldSize, times, interval, callback);\n        } else if (callback) {\n          callback();\n        }\n      }, interval);\n    };\n    var toggleScrolling = function (editor, state) {\n      var body = editor.getBody();\n      if (body) {\n        body.style.overflowY = state ? '' : 'hidden';\n        if (!state) {\n          body.scrollTop = 0;\n        }\n      }\n    };\n    var parseCssValueToInt = function (dom, elm, name, computed) {\n      var value = parseInt(dom.getStyle(elm, name, computed), 10);\n      return isNaN(value) ? 0 : value;\n    };\n    var resize = function (editor, oldSize) {\n      var deltaSize, resizeHeight, contentHeight;\n      var dom = editor.dom;\n      var doc = editor.getDoc();\n      if (!doc) {\n        return;\n      }\n      if (isFullscreen(editor)) {\n        toggleScrolling(editor, true);\n        return;\n      }\n      var docEle = doc.documentElement;\n      var resizeBottomMargin = Settings.getAutoResizeBottomMargin(editor);\n      resizeHeight = Settings.getAutoResizeMinHeight(editor);\n      var marginTop = parseCssValueToInt(dom, docEle, 'margin-top', true);\n      var marginBottom = parseCssValueToInt(dom, docEle, 'margin-bottom', true);\n      contentHeight = docEle.offsetHeight + marginTop + marginBottom + resizeBottomMargin;\n      if (contentHeight < 0) {\n        contentHeight = 0;\n      }\n      var containerHeight = editor.getContainer().offsetHeight;\n      var contentAreaHeight = editor.getContentAreaContainer().offsetHeight;\n      var chromeHeight = containerHeight - contentAreaHeight;\n      if (contentHeight + chromeHeight > Settings.getAutoResizeMinHeight(editor)) {\n        resizeHeight = contentHeight + chromeHeight;\n      }\n      var maxHeight = Settings.getAutoResizeMaxHeight(editor);\n      if (maxHeight && resizeHeight > maxHeight) {\n        resizeHeight = maxHeight;\n        toggleScrolling(editor, true);\n      } else {\n        toggleScrolling(editor, false);\n      }\n      if (resizeHeight !== oldSize.get()) {\n        deltaSize = resizeHeight - oldSize.get();\n        dom.setStyle(editor.getContainer(), 'height', resizeHeight + 'px');\n        oldSize.set(resizeHeight);\n        Events.fireResizeEditor(editor);\n        if (global$1.browser.isSafari() && global$1.mac) {\n          var win = editor.getWin();\n          win.scrollTo(win.pageXOffset, win.pageYOffset);\n        }\n        if (editor.hasFocus()) {\n          editor.selection.scrollIntoView(editor.selection.getNode());\n        }\n        if (global$1.webkit && deltaSize < 0) {\n          resize(editor, oldSize);\n        }\n      }\n    };\n    var setup = function (editor, oldSize) {\n      editor.on('init', function () {\n        var overflowPadding = Settings.getAutoResizeOverflowPadding(editor);\n        var dom = editor.dom;\n        dom.setStyles(editor.getBody(), {\n          'paddingLeft': overflowPadding,\n          'paddingRight': overflowPadding,\n          'min-height': 0\n        });\n      });\n      editor.on('NodeChange SetContent keyup FullscreenStateChanged ResizeContent', function () {\n        resize(editor, oldSize);\n      });\n      if (Settings.shouldAutoResizeOnInit(editor)) {\n        editor.on('init', function () {\n          wait(editor, oldSize, 20, 100, function () {\n            wait(editor, oldSize, 5, 1000);\n          });\n        });\n      }\n    };\n    var Resize = {\n      setup: setup,\n      resize: resize\n    };\n\n    var register = function (editor, oldSize) {\n      editor.addCommand('mceAutoResize', function () {\n        Resize.resize(editor, oldSize);\n      });\n    };\n    var Commands = { register: register };\n\n    function Plugin () {\n      global.add('autoresize', function (editor) {\n        if (!editor.settings.hasOwnProperty('resize')) {\n          editor.settings.resize = false;\n        }\n        if (!editor.inline) {\n          var oldSize = Cell(0);\n          Commands.register(editor, oldSize);\n          Resize.setup(editor, oldSize);\n        }\n      });\n    }\n\n    Plugin();\n\n}());\n"]}