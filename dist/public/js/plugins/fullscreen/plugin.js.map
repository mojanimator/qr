{"version":3,"sources":["../../../../../public/js/plugins/fullscreen/plugin.js"],"names":["domGlobals","Cell","initial","value","get","set","v","clone","global","tinymce","util","Tools","resolve","fullscreenState","isFullscreen","Api","noop","constant","never","always","none","NONE","eq","o","isNone","call","thunk","id","n","me","fold","s","is","isSome","getOr","getOrThunk","getOrDie","msg","Error","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","Object","freeze","some","a","constant_a","self","f","elementEq","b","from","Option","subject","clear","on","isSet","typeOf","x","t","Array","prototype","isPrototypeOf","constructor","name","String","isType","type","isString","isArray","isBoolean","isFunction","isNumber","nativeSlice","slice","nativePush","push","xs","len","length","r","i","pred","find","flatten","apply","output","from$1","keys","each$1","obj","props","k","contains","str","substr","indexOf","isSupported","dom","style","getPropertyValue","fromHtml","html","scope","doc","document","div","createElement","innerHTML","hasChildNodes","childNodes","console","error","fromDom","fromTag","tag","node","fromText","text","createTextNode","fromPoint","docElm","y","elementFromPoint","Element","ATTRIBUTE","Node","ATTRIBUTE_NODE","CDATA_SECTION","CDATA_SECTION_NODE","COMMENT","COMMENT_NODE","DOCUMENT","DOCUMENT_NODE","DOCUMENT_TYPE","DOCUMENT_TYPE_NODE","DOCUMENT_FRAGMENT","DOCUMENT_FRAGMENT_NODE","ELEMENT","ELEMENT_NODE","TEXT","TEXT_NODE","PROCESSING_INSTRUCTION","PROCESSING_INSTRUCTION_NODE","ENTITY_REFERENCE","ENTITY_REFERENCE_NODE","ENTITY","ENTITY_NODE","NOTATION","NOTATION_NODE","Global","window","Function","element","nodeType","isType$1","isText","inBody","parentNode","ownerDocument","body","rawSet","key","setAttribute","get$1","getAttribute","remove","removeAttribute","internalSet","property","setProperty","setAll","css","get$2","styles","getComputedStyle","getUnsafeProperty","firstMatch","regexes","test","find$1","agent","major","minor","group","Number","replace","nu","detect","versionRegexes","cleanedAgent","toLowerCase","unknown","Version","edge","chrome","ie","opera","firefox","safari","isBrowser","current","unknown$1","nu$1","version","info","isEdge","isChrome","isIE","isOpera","isFirefox","isSafari","Browser","windows","ios","android","linux","osx","solaris","freebsd","isOS","unknown$2","nu$2","isWindows","isiOS","isAndroid","isOSX","isLinux","isSolaris","isFreeBSD","OperatingSystem","DeviceType","os","browser","userAgent","mediaMatch","isiPad","isiPhone","isMobile","isTouch","isTablet","isPhone","iOSwebview","isDesktop","isWebView","detect$1","candidates","candidate","search","detectBrowser","browsers","detectOs","oses","UaString","normalVersionRegex","checkContains","target","uastring","PlatformInfo","detect$2","deviceType","PlatformDetection","query","matchMedia","matches","platform","navigator","detect$3","Immutable","fields","_i","arguments","values","struct","compareDocumentPosition","match","documentPositionPreceding","DOCUMENT_POSITION_PRECEDING","documentPositionContainedBy","DOCUMENT_POSITION_CONTAINED_BY","ELEMENT$1","DOCUMENT$1","selector","elem","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","bypassSelector","childElementCount","all","base","querySelectorAll","e1","e2","regularContains","d1","d2","ieContains","contains$1","parent","parents","isRoot","stop","ret","rawParent","p","siblings","filterSelf","elements","children","spot","left","top","translate","Position","get$3","_DOC","scrollLeft","documentElement","scrollTop","bounds","width","height","right","bottom","getBounds","_win","win","visualViewport","pageLeft","pageTop","scroll","clientWidth","clientHeight","fireFullscreenStateChanged","editor","state","fire","Events","global$1","global$2","global$3","ancestors","predicate","siblings$1","all$1","ancestors$1","e","siblings$2","attr","siblingStyles","ancestorPosition","ancestorStyles","bgFallback","matchColor","editorBody","color","clobberStyles","container","gatherSibilings","clobber","clobberStyle","backup","trim","bgColor","containerStyles","restoreStyles","clobberedEls","restore","Thor","DOM","getScrollPos","vp","setScrollPos","pos","scrollTo","isSafari$1","viewportUpdate","unbind","update","editorContainer","refreshScroll","refreshVisualViewport","requestAnimationFrame","offsetTop","offsetLeft","throttle","addEventListener","removeEventListener","toggleFullscreen","editorContainerStyle","iframe","iframeStyle","getContainer","editorContainerS","fullscreenInfo","getBody","getContentAreaContainer","firstChild","newFullScreenInfo","scrollPos","containerWidth","containerHeight","containerTop","containerLeft","iframeWidth","iframeHeight","addClass","removeClass","off","Actions","register","addCommand","Commands","makeSetupHandler","api","setActive","editorEventCallback","register$1","ui","registry","addToggleMenuItem","shortcut","onAction","execCommand","onSetup","addToggleButton","tooltip","icon","Buttons","Plugin","add","settings","inline","addShortcut"],"mappings":"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","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.1.0 (2019-10-17)\n */\n(function (domGlobals) {\n    'use strict';\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      var clone = function () {\n        return Cell(get());\n      };\n      return {\n        get: get,\n        set: set,\n        clone: clone\n      };\n    };\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var get = function (fullscreenState) {\n      return {\n        isFullscreen: function () {\n          return fullscreenState.get() !== null;\n        }\n      };\n    };\n    var Api = { get: get };\n\n    var noop = function () {\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      if (Object.freeze) {\n        Object.freeze(me);\n      }\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Option = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var value = function () {\n      var subject = Cell(Option.none());\n      var clear = function () {\n        subject.set(Option.none());\n      };\n      var set = function (s) {\n        subject.set(Option.some(s));\n      };\n      var on = function (f) {\n        subject.get().each(f);\n      };\n      var isSet = function () {\n        return subject.get().isSome();\n      };\n      return {\n        clear: clear,\n        set: set,\n        isSet: isSet,\n        on: on\n      };\n    };\n\n    var typeOf = function (x) {\n      if (x === null) {\n        return 'null';\n      }\n      var t = typeof x;\n      if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      }\n      if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      }\n      return t;\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isString = isType('string');\n    var isArray = isType('array');\n    var isBoolean = isType('boolean');\n    var isFunction = isType('function');\n    var isNumber = isType('number');\n\n    var nativeSlice = Array.prototype.slice;\n    var nativePush = Array.prototype.push;\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var filter = function (xs, pred) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          r.push(x);\n        }\n      }\n      return r;\n    };\n    var find = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Option.some(x);\n        }\n      }\n      return Option.none();\n    };\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var bind = function (xs, f) {\n      var output = map(xs, f);\n      return flatten(output);\n    };\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n\n    var keys = Object.keys;\n    var each$1 = function (obj, f) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        f(x, i);\n      }\n    };\n\n    var contains = function (str, substr) {\n      return str.indexOf(substr) !== -1;\n    };\n\n    var isSupported = function (dom) {\n      return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n    };\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || domGlobals.document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        domGlobals.console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: constant(node) };\n    };\n    var fromPoint = function (docElm, x, y) {\n      var doc = docElm.dom();\n      return Option.from(doc.elementFromPoint(x, y)).map(fromDom);\n    };\n    var Element = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    var ATTRIBUTE = domGlobals.Node.ATTRIBUTE_NODE;\n    var CDATA_SECTION = domGlobals.Node.CDATA_SECTION_NODE;\n    var COMMENT = domGlobals.Node.COMMENT_NODE;\n    var DOCUMENT = domGlobals.Node.DOCUMENT_NODE;\n    var DOCUMENT_TYPE = domGlobals.Node.DOCUMENT_TYPE_NODE;\n    var DOCUMENT_FRAGMENT = domGlobals.Node.DOCUMENT_FRAGMENT_NODE;\n    var ELEMENT = domGlobals.Node.ELEMENT_NODE;\n    var TEXT = domGlobals.Node.TEXT_NODE;\n    var PROCESSING_INSTRUCTION = domGlobals.Node.PROCESSING_INSTRUCTION_NODE;\n    var ENTITY_REFERENCE = domGlobals.Node.ENTITY_REFERENCE_NODE;\n    var ENTITY = domGlobals.Node.ENTITY_NODE;\n    var NOTATION = domGlobals.Node.NOTATION_NODE;\n\n    var Global = typeof domGlobals.window !== 'undefined' ? domGlobals.window : Function('return this;')();\n\n    var type = function (element) {\n      return element.dom().nodeType;\n    };\n    var isType$1 = function (t) {\n      return function (element) {\n        return type(element) === t;\n      };\n    };\n    var isText = isType$1(TEXT);\n\n    var inBody = function (element) {\n      var dom = isText(element) ? element.dom().parentNode : element.dom();\n      return dom !== undefined && dom !== null && dom.ownerDocument.body.contains(dom);\n    };\n\n    var rawSet = function (dom, key, value) {\n      if (isString(value) || isBoolean(value) || isNumber(value)) {\n        dom.setAttribute(key, value + '');\n      } else {\n        domGlobals.console.error('Invalid call to Attr.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n        throw new Error('Attribute value was not simple');\n      }\n    };\n    var set = function (element, key, value) {\n      rawSet(element.dom(), key, value);\n    };\n    var get$1 = function (element, key) {\n      var v = element.dom().getAttribute(key);\n      return v === null ? undefined : v;\n    };\n    var remove = function (element, key) {\n      element.dom().removeAttribute(key);\n    };\n\n    var internalSet = function (dom, property, value) {\n      if (!isString(value)) {\n        domGlobals.console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n        throw new Error('CSS value must be a string: ' + value);\n      }\n      if (isSupported(dom)) {\n        dom.style.setProperty(property, value);\n      }\n    };\n    var setAll = function (element, css) {\n      var dom = element.dom();\n      each$1(css, function (v, k) {\n        internalSet(dom, k, v);\n      });\n    };\n    var get$2 = function (element, property) {\n      var dom = element.dom();\n      var styles = domGlobals.window.getComputedStyle(dom);\n      var r = styles.getPropertyValue(property);\n      var v = r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n      return v === null ? undefined : v;\n    };\n    var getUnsafeProperty = function (dom, property) {\n      return isSupported(dom) ? dom.style.getPropertyValue(property) : '';\n    };\n\n    var firstMatch = function (regexes, s) {\n      for (var i = 0; i < regexes.length; i++) {\n        var x = regexes[i];\n        if (x.test(s)) {\n          return x;\n        }\n      }\n      return undefined;\n    };\n    var find$1 = function (regexes, agent) {\n      var r = firstMatch(regexes, agent);\n      if (!r) {\n        return {\n          major: 0,\n          minor: 0\n        };\n      }\n      var group = function (i) {\n        return Number(agent.replace(r, '$' + i));\n      };\n      return nu(group(1), group(2));\n    };\n    var detect = function (versionRegexes, agent) {\n      var cleanedAgent = String(agent).toLowerCase();\n      if (versionRegexes.length === 0) {\n        return unknown();\n      }\n      return find$1(versionRegexes, cleanedAgent);\n    };\n    var unknown = function () {\n      return nu(0, 0);\n    };\n    var nu = function (major, minor) {\n      return {\n        major: major,\n        minor: minor\n      };\n    };\n    var Version = {\n      nu: nu,\n      detect: detect,\n      unknown: unknown\n    };\n\n    var edge = 'Edge';\n    var chrome = 'Chrome';\n    var ie = 'IE';\n    var opera = 'Opera';\n    var firefox = 'Firefox';\n    var safari = 'Safari';\n    var isBrowser = function (name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n    var unknown$1 = function () {\n      return nu$1({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$1 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isEdge: isBrowser(edge, current),\n        isChrome: isBrowser(chrome, current),\n        isIE: isBrowser(ie, current),\n        isOpera: isBrowser(opera, current),\n        isFirefox: isBrowser(firefox, current),\n        isSafari: isBrowser(safari, current)\n      };\n    };\n    var Browser = {\n      unknown: unknown$1,\n      nu: nu$1,\n      edge: constant(edge),\n      chrome: constant(chrome),\n      ie: constant(ie),\n      opera: constant(opera),\n      firefox: constant(firefox),\n      safari: constant(safari)\n    };\n\n    var windows = 'Windows';\n    var ios = 'iOS';\n    var android = 'Android';\n    var linux = 'Linux';\n    var osx = 'OSX';\n    var solaris = 'Solaris';\n    var freebsd = 'FreeBSD';\n    var isOS = function (name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n    var unknown$2 = function () {\n      return nu$2({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$2 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isWindows: isOS(windows, current),\n        isiOS: isOS(ios, current),\n        isAndroid: isOS(android, current),\n        isOSX: isOS(osx, current),\n        isLinux: isOS(linux, current),\n        isSolaris: isOS(solaris, current),\n        isFreeBSD: isOS(freebsd, current)\n      };\n    };\n    var OperatingSystem = {\n      unknown: unknown$2,\n      nu: nu$2,\n      windows: constant(windows),\n      ios: constant(ios),\n      android: constant(android),\n      linux: constant(linux),\n      osx: constant(osx),\n      solaris: constant(solaris),\n      freebsd: constant(freebsd)\n    };\n\n    var DeviceType = function (os, browser, userAgent, mediaMatch) {\n      var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n      var isiPhone = os.isiOS() && !isiPad;\n      var isMobile = os.isiOS() || os.isAndroid();\n      var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n      var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n      var isPhone = isiPhone || isMobile && !isTablet;\n      var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n      var isDesktop = !isPhone && !isTablet && !iOSwebview;\n      return {\n        isiPad: constant(isiPad),\n        isiPhone: constant(isiPhone),\n        isTablet: constant(isTablet),\n        isPhone: constant(isPhone),\n        isTouch: constant(isTouch),\n        isAndroid: os.isAndroid,\n        isiOS: os.isiOS,\n        isWebView: constant(iOSwebview),\n        isDesktop: constant(isDesktop)\n      };\n    };\n\n    var detect$1 = function (candidates, userAgent) {\n      var agent = String(userAgent).toLowerCase();\n      return find(candidates, function (candidate) {\n        return candidate.search(agent);\n      });\n    };\n    var detectBrowser = function (browsers, userAgent) {\n      return detect$1(browsers, userAgent).map(function (browser) {\n        var version = Version.detect(browser.versionRegexes, userAgent);\n        return {\n          current: browser.name,\n          version: version\n        };\n      });\n    };\n    var detectOs = function (oses, userAgent) {\n      return detect$1(oses, userAgent).map(function (os) {\n        var version = Version.detect(os.versionRegexes, userAgent);\n        return {\n          current: os.name,\n          version: version\n        };\n      });\n    };\n    var UaString = {\n      detectBrowser: detectBrowser,\n      detectOs: detectOs\n    };\n\n    var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n    var checkContains = function (target) {\n      return function (uastring) {\n        return contains(uastring, target);\n      };\n    };\n    var browsers = [\n      {\n        name: 'Edge',\n        versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n        search: function (uastring) {\n          return contains(uastring, 'edge/') && contains(uastring, 'chrome') && contains(uastring, 'safari') && contains(uastring, 'applewebkit');\n        }\n      },\n      {\n        name: 'Chrome',\n        versionRegexes: [\n          /.*?chrome\\/([0-9]+)\\.([0-9]+).*/,\n          normalVersionRegex\n        ],\n        search: function (uastring) {\n          return contains(uastring, 'chrome') && !contains(uastring, 'chromeframe');\n        }\n      },\n      {\n        name: 'IE',\n        versionRegexes: [\n          /.*?msie\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*?rv:([0-9]+)\\.([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return contains(uastring, 'msie') || contains(uastring, 'trident');\n        }\n      },\n      {\n        name: 'Opera',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?opera\\/([0-9]+)\\.([0-9]+).*/\n        ],\n        search: checkContains('opera')\n      },\n      {\n        name: 'Firefox',\n        versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n        search: checkContains('firefox')\n      },\n      {\n        name: 'Safari',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?cpu os ([0-9]+)_([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return (contains(uastring, 'safari') || contains(uastring, 'mobile/')) && contains(uastring, 'applewebkit');\n        }\n      }\n    ];\n    var oses = [\n      {\n        name: 'Windows',\n        search: checkContains('win'),\n        versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'iOS',\n        search: function (uastring) {\n          return contains(uastring, 'iphone') || contains(uastring, 'ipad');\n        },\n        versionRegexes: [\n          /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*cpu os ([0-9]+)_([0-9]+).*/,\n          /.*cpu iphone os ([0-9]+)_([0-9]+).*/\n        ]\n      },\n      {\n        name: 'Android',\n        search: checkContains('android'),\n        versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'OSX',\n        search: checkContains('os x'),\n        versionRegexes: [/.*?os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n      },\n      {\n        name: 'Linux',\n        search: checkContains('linux'),\n        versionRegexes: []\n      },\n      {\n        name: 'Solaris',\n        search: checkContains('sunos'),\n        versionRegexes: []\n      },\n      {\n        name: 'FreeBSD',\n        search: checkContains('freebsd'),\n        versionRegexes: []\n      }\n    ];\n    var PlatformInfo = {\n      browsers: constant(browsers),\n      oses: constant(oses)\n    };\n\n    var detect$2 = function (userAgent, mediaMatch) {\n      var browsers = PlatformInfo.browsers();\n      var oses = PlatformInfo.oses();\n      var browser = UaString.detectBrowser(browsers, userAgent).fold(Browser.unknown, Browser.nu);\n      var os = UaString.detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n      var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n      return {\n        browser: browser,\n        os: os,\n        deviceType: deviceType\n      };\n    };\n    var PlatformDetection = { detect: detect$2 };\n\n    var mediaMatch = function (query) {\n      return domGlobals.window.matchMedia(query).matches;\n    };\n    var platform = Cell(PlatformDetection.detect(domGlobals.navigator.userAgent, mediaMatch));\n    var detect$3 = function () {\n      return platform.get();\n    };\n\n    var Immutable = function () {\n      var fields = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        fields[_i] = arguments[_i];\n      }\n      return function () {\n        var values = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          values[_i] = arguments[_i];\n        }\n        if (fields.length !== values.length) {\n          throw new Error('Wrong number of arguments to struct. Expected \"[' + fields.length + ']\", got ' + values.length + ' arguments');\n        }\n        var struct = {};\n        each(fields, function (name, i) {\n          struct[name] = constant(values[i]);\n        });\n        return struct;\n      };\n    };\n\n    var compareDocumentPosition = function (a, b, match) {\n      return (a.compareDocumentPosition(b) & match) !== 0;\n    };\n    var documentPositionPreceding = function (a, b) {\n      return compareDocumentPosition(a, b, domGlobals.Node.DOCUMENT_POSITION_PRECEDING);\n    };\n    var documentPositionContainedBy = function (a, b) {\n      return compareDocumentPosition(a, b, domGlobals.Node.DOCUMENT_POSITION_CONTAINED_BY);\n    };\n    var Node = {\n      documentPositionPreceding: documentPositionPreceding,\n      documentPositionContainedBy: documentPositionContainedBy\n    };\n\n    var ELEMENT$1 = ELEMENT;\n    var DOCUMENT$1 = DOCUMENT;\n    var is = function (element, selector) {\n      var dom = element.dom();\n      if (dom.nodeType !== ELEMENT$1) {\n        return false;\n      } else {\n        var elem = dom;\n        if (elem.matches !== undefined) {\n          return elem.matches(selector);\n        } else if (elem.msMatchesSelector !== undefined) {\n          return elem.msMatchesSelector(selector);\n        } else if (elem.webkitMatchesSelector !== undefined) {\n          return elem.webkitMatchesSelector(selector);\n        } else if (elem.mozMatchesSelector !== undefined) {\n          return elem.mozMatchesSelector(selector);\n        } else {\n          throw new Error('Browser lacks native selectors');\n        }\n      }\n    };\n    var bypassSelector = function (dom) {\n      return dom.nodeType !== ELEMENT$1 && dom.nodeType !== DOCUMENT$1 || dom.childElementCount === 0;\n    };\n    var all = function (selector, scope) {\n      var base = scope === undefined ? domGlobals.document : scope.dom();\n      return bypassSelector(base) ? [] : map(base.querySelectorAll(selector), Element.fromDom);\n    };\n\n    var eq = function (e1, e2) {\n      return e1.dom() === e2.dom();\n    };\n    var regularContains = function (e1, e2) {\n      var d1 = e1.dom();\n      var d2 = e2.dom();\n      return d1 === d2 ? false : d1.contains(d2);\n    };\n    var ieContains = function (e1, e2) {\n      return Node.documentPositionContainedBy(e1.dom(), e2.dom());\n    };\n    var browser = detect$3().browser;\n    var contains$1 = browser.isIE() ? ieContains : regularContains;\n\n    var parent = function (element) {\n      return Option.from(element.dom().parentNode).map(Element.fromDom);\n    };\n    var parents = function (element, isRoot) {\n      var stop = isFunction(isRoot) ? isRoot : never;\n      var dom = element.dom();\n      var ret = [];\n      while (dom.parentNode !== null && dom.parentNode !== undefined) {\n        var rawParent = dom.parentNode;\n        var p = Element.fromDom(rawParent);\n        ret.push(p);\n        if (stop(p) === true) {\n          break;\n        } else {\n          dom = rawParent;\n        }\n      }\n      return ret;\n    };\n    var siblings = function (element) {\n      var filterSelf = function (elements) {\n        return filter(elements, function (x) {\n          return !eq(element, x);\n        });\n      };\n      return parent(element).map(children).map(filterSelf).getOr([]);\n    };\n    var children = function (element) {\n      return map(element.dom().childNodes, Element.fromDom);\n    };\n    var spot = Immutable('element', 'offset');\n\n    var r = function (left, top) {\n      var translate = function (x, y) {\n        return r(left + x, top + y);\n      };\n      return {\n        left: constant(left),\n        top: constant(top),\n        translate: translate\n      };\n    };\n    var Position = r;\n\n    var isSafari = detect$3().browser.isSafari();\n    var get$3 = function (_DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom() : domGlobals.document;\n      var x = doc.body.scrollLeft || doc.documentElement.scrollLeft;\n      var y = doc.body.scrollTop || doc.documentElement.scrollTop;\n      return Position(x, y);\n    };\n\n    var bounds = function (x, y, width, height) {\n      return {\n        x: constant(x),\n        y: constant(y),\n        width: constant(width),\n        height: constant(height),\n        right: constant(x + width),\n        bottom: constant(y + height)\n      };\n    };\n    var getBounds = function (_win) {\n      var win = _win === undefined ? domGlobals.window : _win;\n      var visualViewport = win['visualViewport'];\n      if (visualViewport !== undefined) {\n        return bounds(visualViewport.pageLeft, visualViewport.pageTop, visualViewport.width, visualViewport.height);\n      } else {\n        var doc = Element.fromDom(win.document);\n        var html = win.document.documentElement;\n        var scroll = get$3(doc);\n        var width = html.clientWidth;\n        var height = html.clientHeight;\n        return bounds(scroll.left(), scroll.top(), width, height);\n      }\n    };\n\n    var fireFullscreenStateChanged = function (editor, state) {\n      editor.fire('FullscreenStateChanged', { state: state });\n    };\n    var Events = { fireFullscreenStateChanged: fireFullscreenStateChanged };\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.Env');\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.util.Delay');\n\n    var ancestors = function (scope, predicate, isRoot) {\n      return filter(parents(scope, isRoot), predicate);\n    };\n    var siblings$1 = function (scope, predicate) {\n      return filter(siblings(scope), predicate);\n    };\n\n    var all$1 = function (selector) {\n      return all(selector);\n    };\n    var ancestors$1 = function (scope, selector, isRoot) {\n      return ancestors(scope, function (e) {\n        return is(e, selector);\n      }, isRoot);\n    };\n    var siblings$2 = function (scope, selector) {\n      return siblings$1(scope, function (e) {\n        return is(e, selector);\n      });\n    };\n\n    var attr = 'data-ephox-mobile-fullscreen-style';\n    var siblingStyles = 'display:none!important;';\n    var ancestorPosition = 'position:absolute!important;';\n    var ancestorStyles = 'top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;';\n    var bgFallback = 'background-color:rgb(255,255,255)!important;';\n    var isAndroid = global$2.os.isAndroid();\n    var matchColor = function (editorBody) {\n      var color = get$2(editorBody, 'background-color');\n      return color !== undefined && color !== '' ? 'background-color:' + color + '!important' : bgFallback;\n    };\n    var clobberStyles = function (container, editorBody) {\n      var gatherSibilings = function (element) {\n        var siblings = siblings$2(element, '*:not(.tox-silver-sink)');\n        return siblings;\n      };\n      var clobber = function (clobberStyle) {\n        return function (element) {\n          var styles = get$1(element, 'style');\n          var backup = styles === undefined ? 'no-styles' : styles.trim();\n          if (backup === clobberStyle) {\n            return;\n          } else {\n            set(element, attr, backup);\n            set(element, 'style', clobberStyle);\n          }\n        };\n      };\n      var ancestors = ancestors$1(container, '*');\n      var siblings = bind(ancestors, gatherSibilings);\n      var bgColor = matchColor(editorBody);\n      each(siblings, clobber(siblingStyles));\n      each(ancestors, clobber(ancestorPosition + ancestorStyles + bgColor));\n      var containerStyles = isAndroid === true ? '' : ancestorPosition;\n      clobber(containerStyles + ancestorStyles + bgColor)(container);\n    };\n    var restoreStyles = function () {\n      var clobberedEls = all$1('[' + attr + ']');\n      each(clobberedEls, function (element) {\n        var restore = get$1(element, attr);\n        if (restore !== 'no-styles') {\n          set(element, 'style', restore);\n        } else {\n          remove(element, 'style');\n        }\n        remove(element, attr);\n      });\n    };\n    var Thor = {\n      clobberStyles: clobberStyles,\n      restoreStyles: restoreStyles\n    };\n\n    var DOM = global$1.DOM;\n    var getScrollPos = function () {\n      var vp = getBounds(domGlobals.window);\n      return {\n        x: vp.x(),\n        y: vp.y()\n      };\n    };\n    var setScrollPos = function (pos) {\n      domGlobals.window.scrollTo(pos.x, pos.y);\n    };\n    var visualViewport = domGlobals.window['visualViewport'];\n    var isSafari$1 = global$2.browser.isSafari();\n    var viewportUpdate = !isSafari$1 || visualViewport === undefined ? {\n      bind: noop,\n      unbind: noop,\n      update: noop\n    } : function () {\n      var editorContainer = value();\n      var refreshScroll = function () {\n        domGlobals.document.body.scrollTop = 0;\n        domGlobals.document.documentElement.scrollTop = 0;\n      };\n      var refreshVisualViewport = function () {\n        domGlobals.window.requestAnimationFrame(function () {\n          editorContainer.on(function (container) {\n            return setAll(container, {\n              top: visualViewport.offsetTop + 'px',\n              left: visualViewport.offsetLeft + 'px',\n              height: visualViewport.height + 'px',\n              width: visualViewport.width + 'px'\n            });\n          });\n        });\n      };\n      var update = global$3.throttle(function () {\n        refreshScroll();\n        refreshVisualViewport();\n      }, 50);\n      var bind = function (element) {\n        editorContainer.set(element);\n        update();\n        visualViewport.addEventListener('resize', update);\n        visualViewport.addEventListener('scroll', update);\n      };\n      var unbind = function () {\n        editorContainer.on(function () {\n          visualViewport.removeEventListener('scroll', update);\n          visualViewport.removeEventListener('resize', update);\n        });\n        editorContainer.clear();\n      };\n      return {\n        bind: bind,\n        unbind: unbind\n      };\n    }();\n    var toggleFullscreen = function (editor, fullscreenState) {\n      var body = domGlobals.document.body;\n      var documentElement = domGlobals.document.documentElement;\n      var editorContainerStyle;\n      var editorContainer, iframe, iframeStyle;\n      editorContainer = editor.getContainer();\n      var editorContainerS = Element.fromDom(editorContainer);\n      var fullscreenInfo = fullscreenState.get();\n      var editorBody = Element.fromDom(editor.getBody());\n      var isTouch = global$2.deviceType.isTouch();\n      editorContainerStyle = editorContainer.style;\n      iframe = editor.getContentAreaContainer().firstChild;\n      iframeStyle = iframe.style;\n      if (!fullscreenInfo) {\n        var newFullScreenInfo = {\n          scrollPos: getScrollPos(),\n          containerWidth: editorContainerStyle.width,\n          containerHeight: editorContainerStyle.height,\n          containerTop: editorContainerStyle.top,\n          containerLeft: editorContainerStyle.left,\n          iframeWidth: iframeStyle.width,\n          iframeHeight: iframeStyle.height\n        };\n        if (isTouch) {\n          Thor.clobberStyles(editorContainerS, editorBody);\n        }\n        iframeStyle.width = iframeStyle.height = '100%';\n        editorContainerStyle.width = editorContainerStyle.height = '';\n        DOM.addClass(body, 'tox-fullscreen');\n        DOM.addClass(documentElement, 'tox-fullscreen');\n        DOM.addClass(editorContainer, 'tox-fullscreen');\n        viewportUpdate.bind(editorContainerS);\n        editor.on('remove', viewportUpdate.unbind);\n        fullscreenState.set(newFullScreenInfo);\n        Events.fireFullscreenStateChanged(editor, true);\n      } else {\n        iframeStyle.width = fullscreenInfo.iframeWidth;\n        iframeStyle.height = fullscreenInfo.iframeHeight;\n        editorContainerStyle.width = fullscreenInfo.containerWidth;\n        editorContainerStyle.height = fullscreenInfo.containerHeight;\n        editorContainerStyle.top = fullscreenInfo.containerTop;\n        editorContainerStyle.left = fullscreenInfo.containerLeft;\n        if (isTouch) {\n          Thor.restoreStyles();\n        }\n        DOM.removeClass(body, 'tox-fullscreen');\n        DOM.removeClass(documentElement, 'tox-fullscreen');\n        DOM.removeClass(editorContainer, 'tox-fullscreen');\n        setScrollPos(fullscreenInfo.scrollPos);\n        fullscreenState.set(null);\n        Events.fireFullscreenStateChanged(editor, false);\n        viewportUpdate.unbind();\n        editor.off('remove', viewportUpdate.unbind);\n      }\n    };\n    var Actions = { toggleFullscreen: toggleFullscreen };\n\n    var register = function (editor, fullscreenState) {\n      editor.addCommand('mceFullScreen', function () {\n        Actions.toggleFullscreen(editor, fullscreenState);\n      });\n    };\n    var Commands = { register: register };\n\n    var makeSetupHandler = function (editor, fullscreenState) {\n      return function (api) {\n        api.setActive(fullscreenState.get() !== null);\n        var editorEventCallback = function (e) {\n          return api.setActive(e.state);\n        };\n        editor.on('FullscreenStateChanged', editorEventCallback);\n        return function () {\n          return editor.off('FullscreenStateChanged', editorEventCallback);\n        };\n      };\n    };\n    var register$1 = function (editor, fullscreenState) {\n      editor.ui.registry.addToggleMenuItem('fullscreen', {\n        text: 'Fullscreen',\n        shortcut: 'Meta+Shift+F',\n        onAction: function () {\n          return editor.execCommand('mceFullScreen');\n        },\n        onSetup: makeSetupHandler(editor, fullscreenState)\n      });\n      editor.ui.registry.addToggleButton('fullscreen', {\n        tooltip: 'Fullscreen',\n        icon: 'fullscreen',\n        onAction: function () {\n          return editor.execCommand('mceFullScreen');\n        },\n        onSetup: makeSetupHandler(editor, fullscreenState)\n      });\n    };\n    var Buttons = { register: register$1 };\n\n    function Plugin () {\n      global.add('fullscreen', function (editor) {\n        var fullscreenState = Cell(null);\n        if (editor.settings.inline) {\n          return Api.get(fullscreenState);\n        }\n        Commands.register(editor, fullscreenState);\n        Buttons.register(editor, fullscreenState);\n        editor.addShortcut('Meta+Shift+F', '', 'mceFullScreen');\n        return Api.get(fullscreenState);\n      });\n    }\n\n    Plugin();\n\n}(window));\n"]}