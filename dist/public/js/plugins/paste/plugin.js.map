{"version":3,"sources":["../../../../../public/js/plugins/paste/plugin.js"],"names":["domGlobals","Cell","initial","value","get","set","v","clone","global$1","tinymce","util","Tools","resolve","hasProPlugin","editor","test","settings","plugins","window","console","log","DetectProPlugin","clipboard","quirks","Api","firePastePreProcess","html","internal","isWordHtml","fire","content","wordContent","firePastePostProcess","node","firePastePlainTextToggle","state","firePaste","ieFake","Events","togglePlainTextPaste","pasteFormat","focus","Actions","register","addCommand","ui","pasteHtml","text","pasteText","Commands","noop","constant","never","always","none","NONE","eq","o","isNone","call","thunk","id","n","me","fold","s","is","isSome","getOr","getOrThunk","getOrDie","msg","Error","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","Object","freeze","some","a","constant_a","self","f","elementEq","b","from","Option","typeOf","x","t","Array","prototype","isPrototypeOf","constructor","name","String","isType","type","isFunction","nativeSlice","slice","xs","len","length","r","i","pred","push","foldl","acc","from$1","exports$1","module","exports","define","require","amd","g","global","EphoxContactWrapper","e","c","u","code","p","process","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","setTimeout","clearTimeout","runTimeout","fun","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","concat","drainQueue","timeout","run","nextTick","args","arguments","Item","array","apply","title","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","setImmediate","root","setTimeoutFunc","fn","thisArg","Promise","TypeError","_state","_handled","_value","_deferreds","doResolve","handle","deferred","_immediateFn","cb","onFulfilled","onRejected","reject","promise","ret","newValue","then","finale","_unhandledRejectionFn","Handler","done","reason","ex","prom","all","arr","remaining","res","val","race","values","err","warn","_setImmediateFn","_setUnhandledRejectionFn","clearImmediate","Function","immediateIds","nextImmediateId","Timeout","setInterval","clearInterval","close","clearFn","_id","_clearFn","unref","ref","enroll","item","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","active","onTimeout","_onTimeout","onNextTick","promisePolyfill","Global","boltExport","nu","baseFn","data","callbacks","nCallback","isReady","cbs","pure","callback","LazyValue","errorReporter","make","fab","aFutureB","toPromise","anonBind","futureB","toLazy","toCached","cache","nu$1","pure$1","Future","par","asyncValues","count","asyncValue","par$1","futures","traverse","subject","clear","isSet","global$2","global$3","global$4","global$5","internalMimeType","internalMark","mark","unmark","replace","isMarked","indexOf","InternalHtml","internalHtmlMime","global$6","isPlainText","toBRs","openContainer","rootTag","rootAttrs","key","attrs","tag","hasOwnProperty","encodeAllRaw","join","toBlockElements","blocks","split","tagOpen","tagClose","paragraphs","stitch","convert","Newlines","global$7","global$8","global$9","global$a","shouldBlockDrop","getParam","shouldPasteDataImages","shouldFilterDrop","getPreProcess","getPostProcess","getWebkitStyles","shouldRemoveWebKitStyles","shouldMergeFormats","isSmartPasteEnabled","isPasteAsTextEnabled","getRetainStyleProps","getWordValidElements","defaultValidElements","shouldConvertWordFakeLists","shouldUseDefaultFilters","Settings","filter$1","items","RegExp","innerText","schema","domParser","shortEndedElements","getShortEndedElements","ignoreElements","makeMap","blockElements","getBlockElements","walk","currentNode","shortEnded","firstChild","next","parse","trimHtml","trimSpaces","s1","s2","createIdGenerator","prefix","isMsEdge","navigator","userAgent","Utils","isWordContent","isNumericList","found","patterns","pattern","isBulletList","convertFakeListsToProperLists","currentListNode","prevListNode","lastLevel","getText","txt","trimListStart","regExp","removeIgnoredNodes","_listIgnore","remove","convertParagraphToLi","paragraphNode","listName","start","level","_listLevel","parent","attr","wrap","append","lastChild","elements","child","nodeText","matches","exec","parseInt","filterStyles","validStyles","styleValue","outputStyles","styles","dom","parseStyle","serializeStyle","filterWordContent","retainStyleProperties","str","spaces","Math","floor","validElements","valid_elements","valid_children","rule","attributes","class","attributesOrder","style","addAttributeFilter","nodes","unwrap","className","addNodeFilter","href","rootNode","validate","serialize","preProcess","WordFilter","processResult","cancelled","postProcessFilter","tempBody","create","postProcessArgs","innerHTML","isDefaultPrevented","filterContent","preProcessArgs","hasEventListeners","ProcessFilters","removeMeta","body","querySelectorAll","elm","parentNode","removeChild","insertContent","merge","paste","isAbsoluteUrl","url","isImageUrl","createImage","pasteHtmlFn","undoManager","extra","createLink","execCommand","linkSelection","selection","isCollapsed","insertImage","smartInsertContent","action","SmartPaste","isCollapsibleWhitespace","isNewLineChar","isNewline","idx","normalizeWhitespace","result","pcIsSpace","pasteHtml$1","internalFlag","encodedText","encode","normalizedText","forced_root_block","forced_root_block_attrs","getDataTransferItems","dataTransfer","mceInternalUrlPrefix","getData","legacyText","types","contentType","getClipboardContent","clipboardEvent","clipboardData","getDoc","extend","hasContentType","clipboardContent","mimeType","hasHtmlOrText","getBase64FromUri","uri","substr","isValidDataUriImage","imgElm","images_dataimg_filter","extractFilename","m","match","uniqueId","pasteImage","imageItem","base64","images_reuse_filename","blob","img","Image","src","blobCache","editorUpload","blobInfo","existingBlobInfo","findFirst","cachedBlobInfo","add","blobUri","isClipboardEvent","event","readBlobsAsDataUris","getAsFile","reader","FileReader","onload","readAsDataURL","getImagesFromDataTransfer","files","images","file","pasteImageData","rng","paste_data_images","preventDefault","blobResults","setRng","isBrokenAndroidClipboardEvent","isKeyboardPasteEvent","metaKeyPressed","keyCode","shiftKey","registerEventHandlers","pasteBin","keyboardPasteEvent","keyboardPastePlainTextState","removePasteBinOnKeyUp","webkit","stopImmediatePropagation","ie","insertClipboardContent","isKeyBoardPaste","plainTextMode","isPlainTextHtml","getHtml","isDefaultContent","windowManager","alert","getLastRng","getRng","getEl","stopPropagation","setEditorTimeout","registerEventsAndFilters","parser","isPasteInsert","transparentSrc","isWebKitFakeUrl","isDataUri","allow_html_data_urls","getPasteBinParent","inline","document","getBody","isExternalPasteBin","delegatePasteEvents","pasteBinElm","pasteBinDefaultContent","isDefault","lastRngCell","gecko","setStyle","getStyle","select","pasteBinClone","lastRng","unbind","pasteBinClones","dirtyWrappers","cleanWrapper","copyAndRemove","toElm","fromElm","appendChild","grep","childNodes","shift","insertBefore","isPasteBin","PasteBin","Clipboard","noop$1","hasWorkingClipboardApi","iOS","setData","setHtml5Clipboard","clearData","setClipboardData","evt","fallback","markedHtml","outer","inner","contenteditable","setStyles","position","top","left","width","overflow","range","offscreenRange","createRng","selectNodeContents","getContent","contextual","format","isTableSelection","getParent","getStart","hasSelectedContent","cut","copy","register$1","CutCopy","global$b","getCaretRangeFromEvent","getCaretRangeFromPoint","clientX","clientY","isPlainTextFileUrl","plainTextContent","setFocusedRange","setup","draggingInternallyState","dropContent","content_1","transact","DragDrop","setup$1","plugin","postProcess","PrePostProcess","addPreProcessFilter","filterFunc","addPostProcessFilter","removeExplorerBrElementsAfterBlocks","block","blockName","explorerBlocksRegExp","removeWebKitStyles","webKitStylesSetting","webKitStyles","dom_1","node_1","getNode","before","after","inputStyles","decode","inputValue","currentValue","toHex","removeUnderlineAndFontInAnchor","$","find","setup$2","Quirks","makeSetupHandler","api","setActive","pastePlainTextToggleHandler","register$2","registry","addToggleButton","icon","tooltip","onAction","onSetup","addToggleMenuItem","Buttons","Plugin"],"mappings":"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","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.1.0 (2019-10-17)\n */\n(function (domGlobals) {\n    'use strict';\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      var clone = function () {\n        return Cell(get());\n      };\n      return {\n        get: get,\n        set: set,\n        clone: clone\n      };\n    };\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var hasProPlugin = function (editor) {\n      if (/(^|[ ,])powerpaste([, ]|$)/.test(editor.settings.plugins) && global$1.get('powerpaste')) {\n        if (typeof domGlobals.window.console !== 'undefined' && domGlobals.window.console.log) {\n          domGlobals.window.console.log('PowerPaste is incompatible with Paste plugin! Remove \\'paste\\' from the \\'plugins\\' option.');\n        }\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var DetectProPlugin = { hasProPlugin: hasProPlugin };\n\n    var get = function (clipboard, quirks) {\n      return {\n        clipboard: clipboard,\n        quirks: quirks\n      };\n    };\n    var Api = { get: get };\n\n    var firePastePreProcess = function (editor, html, internal, isWordHtml) {\n      return editor.fire('PastePreProcess', {\n        content: html,\n        internal: internal,\n        wordContent: isWordHtml\n      });\n    };\n    var firePastePostProcess = function (editor, node, internal, isWordHtml) {\n      return editor.fire('PastePostProcess', {\n        node: node,\n        internal: internal,\n        wordContent: isWordHtml\n      });\n    };\n    var firePastePlainTextToggle = function (editor, state) {\n      return editor.fire('PastePlainTextToggle', { state: state });\n    };\n    var firePaste = function (editor, ieFake) {\n      return editor.fire('paste', { ieFake: ieFake });\n    };\n    var Events = {\n      firePastePreProcess: firePastePreProcess,\n      firePastePostProcess: firePastePostProcess,\n      firePastePlainTextToggle: firePastePlainTextToggle,\n      firePaste: firePaste\n    };\n\n    var togglePlainTextPaste = function (editor, clipboard) {\n      if (clipboard.pasteFormat.get() === 'text') {\n        clipboard.pasteFormat.set('html');\n        Events.firePastePlainTextToggle(editor, false);\n      } else {\n        clipboard.pasteFormat.set('text');\n        Events.firePastePlainTextToggle(editor, true);\n      }\n      editor.focus();\n    };\n    var Actions = { togglePlainTextPaste: togglePlainTextPaste };\n\n    var register = function (editor, clipboard) {\n      editor.addCommand('mceTogglePlainTextPaste', function () {\n        Actions.togglePlainTextPaste(editor, clipboard);\n      });\n      editor.addCommand('mceInsertClipboardContent', function (ui, value) {\n        if (value.content) {\n          clipboard.pasteHtml(value.content, value.internal);\n        }\n        if (value.text) {\n          clipboard.pasteText(value.text);\n        }\n      });\n    };\n    var Commands = { register: register };\n\n    var noop = function () {\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      if (Object.freeze) {\n        Object.freeze(me);\n      }\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Option = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var typeOf = function (x) {\n      if (x === null) {\n        return 'null';\n      }\n      var t = typeof x;\n      if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      }\n      if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      }\n      return t;\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isFunction = isType('function');\n\n    var nativeSlice = Array.prototype.slice;\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var filter = function (xs, pred) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          r.push(x);\n        }\n      }\n      return r;\n    };\n    var foldl = function (xs, f, acc) {\n      each(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n\n    var exports$1 = {}, module = { exports: exports$1 };\n    (function (define, exports, module, require) {\n      (function (f) {\n        if (typeof exports === 'object' && typeof module !== 'undefined') {\n          module.exports = f();\n        } else if (typeof define === 'function' && define.amd) {\n          define([], f);\n        } else {\n          var g;\n          if (typeof window !== 'undefined') {\n            g = window;\n          } else if (typeof global !== 'undefined') {\n            g = global;\n          } else if (typeof self !== 'undefined') {\n            g = self;\n          } else {\n            g = this;\n          }\n          g.EphoxContactWrapper = f();\n        }\n      }(function () {\n        return function () {\n          function r(e, n, t) {\n            function o(i, f) {\n              if (!n[i]) {\n                if (!e[i]) {\n                  var c = 'function' == typeof require && require;\n                  if (!f && c)\n                    return c(i, !0);\n                  if (u)\n                    return u(i, !0);\n                  var a = new Error('Cannot find module \\'' + i + '\\'');\n                  throw a.code = 'MODULE_NOT_FOUND', a;\n                }\n                var p = n[i] = { exports: {} };\n                e[i][0].call(p.exports, function (r) {\n                  var n = e[i][1][r];\n                  return o(n || r);\n                }, p, p.exports, r, e, n, t);\n              }\n              return n[i].exports;\n            }\n            for (var u = 'function' == typeof require && require, i = 0; i < t.length; i++)\n              o(t[i]);\n            return o;\n          }\n          return r;\n        }()({\n          1: [\n            function (require, module, exports) {\n              var process = module.exports = {};\n              var cachedSetTimeout;\n              var cachedClearTimeout;\n              function defaultSetTimout() {\n                throw new Error('setTimeout has not been defined');\n              }\n              function defaultClearTimeout() {\n                throw new Error('clearTimeout has not been defined');\n              }\n              (function () {\n                try {\n                  if (typeof setTimeout === 'function') {\n                    cachedSetTimeout = setTimeout;\n                  } else {\n                    cachedSetTimeout = defaultSetTimout;\n                  }\n                } catch (e) {\n                  cachedSetTimeout = defaultSetTimout;\n                }\n                try {\n                  if (typeof clearTimeout === 'function') {\n                    cachedClearTimeout = clearTimeout;\n                  } else {\n                    cachedClearTimeout = defaultClearTimeout;\n                  }\n                } catch (e) {\n                  cachedClearTimeout = defaultClearTimeout;\n                }\n              }());\n              function runTimeout(fun) {\n                if (cachedSetTimeout === setTimeout) {\n                  return setTimeout(fun, 0);\n                }\n                if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n                  cachedSetTimeout = setTimeout;\n                  return setTimeout(fun, 0);\n                }\n                try {\n                  return cachedSetTimeout(fun, 0);\n                } catch (e) {\n                  try {\n                    return cachedSetTimeout.call(null, fun, 0);\n                  } catch (e) {\n                    return cachedSetTimeout.call(this, fun, 0);\n                  }\n                }\n              }\n              function runClearTimeout(marker) {\n                if (cachedClearTimeout === clearTimeout) {\n                  return clearTimeout(marker);\n                }\n                if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n                  cachedClearTimeout = clearTimeout;\n                  return clearTimeout(marker);\n                }\n                try {\n                  return cachedClearTimeout(marker);\n                } catch (e) {\n                  try {\n                    return cachedClearTimeout.call(null, marker);\n                  } catch (e) {\n                    return cachedClearTimeout.call(this, marker);\n                  }\n                }\n              }\n              var queue = [];\n              var draining = false;\n              var currentQueue;\n              var queueIndex = -1;\n              function cleanUpNextTick() {\n                if (!draining || !currentQueue) {\n                  return;\n                }\n                draining = false;\n                if (currentQueue.length) {\n                  queue = currentQueue.concat(queue);\n                } else {\n                  queueIndex = -1;\n                }\n                if (queue.length) {\n                  drainQueue();\n                }\n              }\n              function drainQueue() {\n                if (draining) {\n                  return;\n                }\n                var timeout = runTimeout(cleanUpNextTick);\n                draining = true;\n                var len = queue.length;\n                while (len) {\n                  currentQueue = queue;\n                  queue = [];\n                  while (++queueIndex < len) {\n                    if (currentQueue) {\n                      currentQueue[queueIndex].run();\n                    }\n                  }\n                  queueIndex = -1;\n                  len = queue.length;\n                }\n                currentQueue = null;\n                draining = false;\n                runClearTimeout(timeout);\n              }\n              process.nextTick = function (fun) {\n                var args = new Array(arguments.length - 1);\n                if (arguments.length > 1) {\n                  for (var i = 1; i < arguments.length; i++) {\n                    args[i - 1] = arguments[i];\n                  }\n                }\n                queue.push(new Item(fun, args));\n                if (queue.length === 1 && !draining) {\n                  runTimeout(drainQueue);\n                }\n              };\n              function Item(fun, array) {\n                this.fun = fun;\n                this.array = array;\n              }\n              Item.prototype.run = function () {\n                this.fun.apply(null, this.array);\n              };\n              process.title = 'browser';\n              process.browser = true;\n              process.env = {};\n              process.argv = [];\n              process.version = '';\n              process.versions = {};\n              function noop() {\n              }\n              process.on = noop;\n              process.addListener = noop;\n              process.once = noop;\n              process.off = noop;\n              process.removeListener = noop;\n              process.removeAllListeners = noop;\n              process.emit = noop;\n              process.prependListener = noop;\n              process.prependOnceListener = noop;\n              process.listeners = function (name) {\n                return [];\n              };\n              process.binding = function (name) {\n                throw new Error('process.binding is not supported');\n              };\n              process.cwd = function () {\n                return '/';\n              };\n              process.chdir = function (dir) {\n                throw new Error('process.chdir is not supported');\n              };\n              process.umask = function () {\n                return 0;\n              };\n            },\n            {}\n          ],\n          2: [\n            function (require, module, exports) {\n              (function (setImmediate) {\n                (function (root) {\n                  var setTimeoutFunc = setTimeout;\n                  function noop() {\n                  }\n                  function bind(fn, thisArg) {\n                    return function () {\n                      fn.apply(thisArg, arguments);\n                    };\n                  }\n                  function Promise(fn) {\n                    if (typeof this !== 'object')\n                      throw new TypeError('Promises must be constructed via new');\n                    if (typeof fn !== 'function')\n                      throw new TypeError('not a function');\n                    this._state = 0;\n                    this._handled = false;\n                    this._value = undefined;\n                    this._deferreds = [];\n                    doResolve(fn, this);\n                  }\n                  function handle(self, deferred) {\n                    while (self._state === 3) {\n                      self = self._value;\n                    }\n                    if (self._state === 0) {\n                      self._deferreds.push(deferred);\n                      return;\n                    }\n                    self._handled = true;\n                    Promise._immediateFn(function () {\n                      var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n                      if (cb === null) {\n                        (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n                        return;\n                      }\n                      var ret;\n                      try {\n                        ret = cb(self._value);\n                      } catch (e) {\n                        reject(deferred.promise, e);\n                        return;\n                      }\n                      resolve(deferred.promise, ret);\n                    });\n                  }\n                  function resolve(self, newValue) {\n                    try {\n                      if (newValue === self)\n                        throw new TypeError('A promise cannot be resolved with itself.');\n                      if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n                        var then = newValue.then;\n                        if (newValue instanceof Promise) {\n                          self._state = 3;\n                          self._value = newValue;\n                          finale(self);\n                          return;\n                        } else if (typeof then === 'function') {\n                          doResolve(bind(then, newValue), self);\n                          return;\n                        }\n                      }\n                      self._state = 1;\n                      self._value = newValue;\n                      finale(self);\n                    } catch (e) {\n                      reject(self, e);\n                    }\n                  }\n                  function reject(self, newValue) {\n                    self._state = 2;\n                    self._value = newValue;\n                    finale(self);\n                  }\n                  function finale(self) {\n                    if (self._state === 2 && self._deferreds.length === 0) {\n                      Promise._immediateFn(function () {\n                        if (!self._handled) {\n                          Promise._unhandledRejectionFn(self._value);\n                        }\n                      });\n                    }\n                    for (var i = 0, len = self._deferreds.length; i < len; i++) {\n                      handle(self, self._deferreds[i]);\n                    }\n                    self._deferreds = null;\n                  }\n                  function Handler(onFulfilled, onRejected, promise) {\n                    this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n                    this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n                    this.promise = promise;\n                  }\n                  function doResolve(fn, self) {\n                    var done = false;\n                    try {\n                      fn(function (value) {\n                        if (done)\n                          return;\n                        done = true;\n                        resolve(self, value);\n                      }, function (reason) {\n                        if (done)\n                          return;\n                        done = true;\n                        reject(self, reason);\n                      });\n                    } catch (ex) {\n                      if (done)\n                        return;\n                      done = true;\n                      reject(self, ex);\n                    }\n                  }\n                  Promise.prototype['catch'] = function (onRejected) {\n                    return this.then(null, onRejected);\n                  };\n                  Promise.prototype.then = function (onFulfilled, onRejected) {\n                    var prom = new this.constructor(noop);\n                    handle(this, new Handler(onFulfilled, onRejected, prom));\n                    return prom;\n                  };\n                  Promise.all = function (arr) {\n                    var args = Array.prototype.slice.call(arr);\n                    return new Promise(function (resolve, reject) {\n                      if (args.length === 0)\n                        return resolve([]);\n                      var remaining = args.length;\n                      function res(i, val) {\n                        try {\n                          if (val && (typeof val === 'object' || typeof val === 'function')) {\n                            var then = val.then;\n                            if (typeof then === 'function') {\n                              then.call(val, function (val) {\n                                res(i, val);\n                              }, reject);\n                              return;\n                            }\n                          }\n                          args[i] = val;\n                          if (--remaining === 0) {\n                            resolve(args);\n                          }\n                        } catch (ex) {\n                          reject(ex);\n                        }\n                      }\n                      for (var i = 0; i < args.length; i++) {\n                        res(i, args[i]);\n                      }\n                    });\n                  };\n                  Promise.resolve = function (value) {\n                    if (value && typeof value === 'object' && value.constructor === Promise) {\n                      return value;\n                    }\n                    return new Promise(function (resolve) {\n                      resolve(value);\n                    });\n                  };\n                  Promise.reject = function (value) {\n                    return new Promise(function (resolve, reject) {\n                      reject(value);\n                    });\n                  };\n                  Promise.race = function (values) {\n                    return new Promise(function (resolve, reject) {\n                      for (var i = 0, len = values.length; i < len; i++) {\n                        values[i].then(resolve, reject);\n                      }\n                    });\n                  };\n                  Promise._immediateFn = typeof setImmediate === 'function' ? function (fn) {\n                    setImmediate(fn);\n                  } : function (fn) {\n                    setTimeoutFunc(fn, 0);\n                  };\n                  Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n                    if (typeof console !== 'undefined' && console) {\n                      console.warn('Possible Unhandled Promise Rejection:', err);\n                    }\n                  };\n                  Promise._setImmediateFn = function _setImmediateFn(fn) {\n                    Promise._immediateFn = fn;\n                  };\n                  Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n                    Promise._unhandledRejectionFn = fn;\n                  };\n                  if (typeof module !== 'undefined' && module.exports) {\n                    module.exports = Promise;\n                  } else if (!root.Promise) {\n                    root.Promise = Promise;\n                  }\n                }(this));\n              }.call(this, require('timers').setImmediate));\n            },\n            { 'timers': 3 }\n          ],\n          3: [\n            function (require, module, exports) {\n              (function (setImmediate, clearImmediate) {\n                var nextTick = require('process/browser.js').nextTick;\n                var apply = Function.prototype.apply;\n                var slice = Array.prototype.slice;\n                var immediateIds = {};\n                var nextImmediateId = 0;\n                exports.setTimeout = function () {\n                  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n                };\n                exports.setInterval = function () {\n                  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n                };\n                exports.clearTimeout = exports.clearInterval = function (timeout) {\n                  timeout.close();\n                };\n                function Timeout(id, clearFn) {\n                  this._id = id;\n                  this._clearFn = clearFn;\n                }\n                Timeout.prototype.unref = Timeout.prototype.ref = function () {\n                };\n                Timeout.prototype.close = function () {\n                  this._clearFn.call(window, this._id);\n                };\n                exports.enroll = function (item, msecs) {\n                  clearTimeout(item._idleTimeoutId);\n                  item._idleTimeout = msecs;\n                };\n                exports.unenroll = function (item) {\n                  clearTimeout(item._idleTimeoutId);\n                  item._idleTimeout = -1;\n                };\n                exports._unrefActive = exports.active = function (item) {\n                  clearTimeout(item._idleTimeoutId);\n                  var msecs = item._idleTimeout;\n                  if (msecs >= 0) {\n                    item._idleTimeoutId = setTimeout(function onTimeout() {\n                      if (item._onTimeout)\n                        item._onTimeout();\n                    }, msecs);\n                  }\n                };\n                exports.setImmediate = typeof setImmediate === 'function' ? setImmediate : function (fn) {\n                  var id = nextImmediateId++;\n                  var args = arguments.length < 2 ? false : slice.call(arguments, 1);\n                  immediateIds[id] = true;\n                  nextTick(function onNextTick() {\n                    if (immediateIds[id]) {\n                      if (args) {\n                        fn.apply(null, args);\n                      } else {\n                        fn.call(null);\n                      }\n                      exports.clearImmediate(id);\n                    }\n                  });\n                  return id;\n                };\n                exports.clearImmediate = typeof clearImmediate === 'function' ? clearImmediate : function (id) {\n                  delete immediateIds[id];\n                };\n              }.call(this, require('timers').setImmediate, require('timers').clearImmediate));\n            },\n            {\n              'process/browser.js': 1,\n              'timers': 3\n            }\n          ],\n          4: [\n            function (require, module, exports) {\n              var promisePolyfill = require('promise-polyfill');\n              var Global = function () {\n                if (typeof window !== 'undefined') {\n                  return window;\n                } else {\n                  return Function('return this;')();\n                }\n              }();\n              module.exports = { boltExport: Global.Promise || promisePolyfill };\n            },\n            { 'promise-polyfill': 2 }\n          ]\n        }, {}, [4])(4);\n      }));\n    }(undefined, exports$1, module, undefined));\n    var Promise = module.exports.boltExport;\n\n    var nu = function (baseFn) {\n      var data = Option.none();\n      var callbacks = [];\n      var map = function (f) {\n        return nu(function (nCallback) {\n          get(function (data) {\n            nCallback(f(data));\n          });\n        });\n      };\n      var get = function (nCallback) {\n        if (isReady()) {\n          call(nCallback);\n        } else {\n          callbacks.push(nCallback);\n        }\n      };\n      var set = function (x) {\n        data = Option.some(x);\n        run(callbacks);\n        callbacks = [];\n      };\n      var isReady = function () {\n        return data.isSome();\n      };\n      var run = function (cbs) {\n        each(cbs, call);\n      };\n      var call = function (cb) {\n        data.each(function (x) {\n          domGlobals.setTimeout(function () {\n            cb(x);\n          }, 0);\n        });\n      };\n      baseFn(set);\n      return {\n        get: get,\n        map: map,\n        isReady: isReady\n      };\n    };\n    var pure = function (a) {\n      return nu(function (callback) {\n        callback(a);\n      });\n    };\n    var LazyValue = {\n      nu: nu,\n      pure: pure\n    };\n\n    var errorReporter = function (err) {\n      domGlobals.setTimeout(function () {\n        throw err;\n      }, 0);\n    };\n    var make = function (run) {\n      var get = function (callback) {\n        run().then(callback, errorReporter);\n      };\n      var map = function (fab) {\n        return make(function () {\n          return run().then(fab);\n        });\n      };\n      var bind = function (aFutureB) {\n        return make(function () {\n          return run().then(function (v) {\n            return aFutureB(v).toPromise();\n          });\n        });\n      };\n      var anonBind = function (futureB) {\n        return make(function () {\n          return run().then(function () {\n            return futureB.toPromise();\n          });\n        });\n      };\n      var toLazy = function () {\n        return LazyValue.nu(get);\n      };\n      var toCached = function () {\n        var cache = null;\n        return make(function () {\n          if (cache === null) {\n            cache = run();\n          }\n          return cache;\n        });\n      };\n      var toPromise = run;\n      return {\n        map: map,\n        bind: bind,\n        anonBind: anonBind,\n        toLazy: toLazy,\n        toCached: toCached,\n        toPromise: toPromise,\n        get: get\n      };\n    };\n    var nu$1 = function (baseFn) {\n      return make(function () {\n        return new Promise(baseFn);\n      });\n    };\n    var pure$1 = function (a) {\n      return make(function () {\n        return Promise.resolve(a);\n      });\n    };\n    var Future = {\n      nu: nu$1,\n      pure: pure$1\n    };\n\n    var par = function (asyncValues, nu) {\n      return nu(function (callback) {\n        var r = [];\n        var count = 0;\n        var cb = function (i) {\n          return function (value) {\n            r[i] = value;\n            count++;\n            if (count >= asyncValues.length) {\n              callback(r);\n            }\n          };\n        };\n        if (asyncValues.length === 0) {\n          callback([]);\n        } else {\n          each(asyncValues, function (asyncValue, i) {\n            asyncValue.get(cb(i));\n          });\n        }\n      });\n    };\n\n    var par$1 = function (futures) {\n      return par(futures, Future.nu);\n    };\n    var traverse = function (array, fn) {\n      return par$1(map(array, fn));\n    };\n\n    var value = function () {\n      var subject = Cell(Option.none());\n      var clear = function () {\n        subject.set(Option.none());\n      };\n      var set = function (s) {\n        subject.set(Option.some(s));\n      };\n      var on = function (f) {\n        subject.get().each(f);\n      };\n      var isSet = function () {\n        return subject.get().isSome();\n      };\n      return {\n        clear: clear,\n        set: set,\n        isSet: isSet,\n        on: on\n      };\n    };\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.Env');\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.util.Delay');\n\n    var global$4 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var global$5 = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n    var internalMimeType = 'x-tinymce/html';\n    var internalMark = '<!-- ' + internalMimeType + ' -->';\n    var mark = function (html) {\n      return internalMark + html;\n    };\n    var unmark = function (html) {\n      return html.replace(internalMark, '');\n    };\n    var isMarked = function (html) {\n      return html.indexOf(internalMark) !== -1;\n    };\n    var InternalHtml = {\n      mark: mark,\n      unmark: unmark,\n      isMarked: isMarked,\n      internalHtmlMime: function () {\n        return internalMimeType;\n      }\n    };\n\n    var global$6 = tinymce.util.Tools.resolve('tinymce.html.Entities');\n\n    var isPlainText = function (text) {\n      return !/<(?:\\/?(?!(?:div|p|br|span)>)\\w+|(?:(?!(?:span style=\"white-space:\\s?pre;?\">)|br\\s?\\/>))\\w+\\s[^>]+)>/i.test(text);\n    };\n    var toBRs = function (text) {\n      return text.replace(/\\r?\\n/g, '<br>');\n    };\n    var openContainer = function (rootTag, rootAttrs) {\n      var key;\n      var attrs = [];\n      var tag = '<' + rootTag;\n      if (typeof rootAttrs === 'object') {\n        for (key in rootAttrs) {\n          if (rootAttrs.hasOwnProperty(key)) {\n            attrs.push(key + '=\"' + global$6.encodeAllRaw(rootAttrs[key]) + '\"');\n          }\n        }\n        if (attrs.length) {\n          tag += ' ' + attrs.join(' ');\n        }\n      }\n      return tag + '>';\n    };\n    var toBlockElements = function (text, rootTag, rootAttrs) {\n      var blocks = text.split(/\\n\\n/);\n      var tagOpen = openContainer(rootTag, rootAttrs);\n      var tagClose = '</' + rootTag + '>';\n      var paragraphs = global$4.map(blocks, function (p) {\n        return p.split(/\\n/).join('<br />');\n      });\n      var stitch = function (p) {\n        return tagOpen + p + tagClose;\n      };\n      return paragraphs.length === 1 ? paragraphs[0] : global$4.map(paragraphs, stitch).join('');\n    };\n    var convert = function (text, rootTag, rootAttrs) {\n      return rootTag ? toBlockElements(text, rootTag === true ? 'p' : rootTag, rootAttrs) : toBRs(text);\n    };\n    var Newlines = {\n      isPlainText: isPlainText,\n      convert: convert,\n      toBRs: toBRs,\n      toBlockElements: toBlockElements\n    };\n\n    var global$7 = tinymce.util.Tools.resolve('tinymce.html.DomParser');\n\n    var global$8 = tinymce.util.Tools.resolve('tinymce.html.Node');\n\n    var global$9 = tinymce.util.Tools.resolve('tinymce.html.Schema');\n\n    var global$a = tinymce.util.Tools.resolve('tinymce.html.Serializer');\n\n    var shouldBlockDrop = function (editor) {\n      return editor.getParam('paste_block_drop', false);\n    };\n    var shouldPasteDataImages = function (editor) {\n      return editor.getParam('paste_data_images', false);\n    };\n    var shouldFilterDrop = function (editor) {\n      return editor.getParam('paste_filter_drop', true);\n    };\n    var getPreProcess = function (editor) {\n      return editor.getParam('paste_preprocess');\n    };\n    var getPostProcess = function (editor) {\n      return editor.getParam('paste_postprocess');\n    };\n    var getWebkitStyles = function (editor) {\n      return editor.getParam('paste_webkit_styles');\n    };\n    var shouldRemoveWebKitStyles = function (editor) {\n      return editor.getParam('paste_remove_styles_if_webkit', true);\n    };\n    var shouldMergeFormats = function (editor) {\n      return editor.getParam('paste_merge_formats', true);\n    };\n    var isSmartPasteEnabled = function (editor) {\n      return editor.getParam('smart_paste', true);\n    };\n    var isPasteAsTextEnabled = function (editor) {\n      return editor.getParam('paste_as_text', false);\n    };\n    var getRetainStyleProps = function (editor) {\n      return editor.getParam('paste_retain_style_properties');\n    };\n    var getWordValidElements = function (editor) {\n      var defaultValidElements = '-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,' + '-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,' + 'td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody';\n      return editor.getParam('paste_word_valid_elements', defaultValidElements);\n    };\n    var shouldConvertWordFakeLists = function (editor) {\n      return editor.getParam('paste_convert_word_fake_lists', true);\n    };\n    var shouldUseDefaultFilters = function (editor) {\n      return editor.getParam('paste_enable_default_filters', true);\n    };\n    var Settings = {\n      shouldBlockDrop: shouldBlockDrop,\n      shouldPasteDataImages: shouldPasteDataImages,\n      shouldFilterDrop: shouldFilterDrop,\n      getPreProcess: getPreProcess,\n      getPostProcess: getPostProcess,\n      getWebkitStyles: getWebkitStyles,\n      shouldRemoveWebKitStyles: shouldRemoveWebKitStyles,\n      shouldMergeFormats: shouldMergeFormats,\n      isSmartPasteEnabled: isSmartPasteEnabled,\n      isPasteAsTextEnabled: isPasteAsTextEnabled,\n      getRetainStyleProps: getRetainStyleProps,\n      getWordValidElements: getWordValidElements,\n      shouldConvertWordFakeLists: shouldConvertWordFakeLists,\n      shouldUseDefaultFilters: shouldUseDefaultFilters\n    };\n\n    function filter$1(content, items) {\n      global$4.each(items, function (v) {\n        if (v.constructor === RegExp) {\n          content = content.replace(v, '');\n        } else {\n          content = content.replace(v[0], v[1]);\n        }\n      });\n      return content;\n    }\n    function innerText(html) {\n      var schema = global$9();\n      var domParser = global$7({}, schema);\n      var text = '';\n      var shortEndedElements = schema.getShortEndedElements();\n      var ignoreElements = global$4.makeMap('script noscript style textarea video audio iframe object', ' ');\n      var blockElements = schema.getBlockElements();\n      function walk(node) {\n        var name = node.name, currentNode = node;\n        if (name === 'br') {\n          text += '\\n';\n          return;\n        }\n        if (name === 'wbr') {\n          return;\n        }\n        if (shortEndedElements[name]) {\n          text += ' ';\n        }\n        if (ignoreElements[name]) {\n          text += ' ';\n          return;\n        }\n        if (node.type === 3) {\n          text += node.value;\n        }\n        if (!node.shortEnded) {\n          if (node = node.firstChild) {\n            do {\n              walk(node);\n            } while (node = node.next);\n          }\n        }\n        if (blockElements[name] && currentNode.next) {\n          text += '\\n';\n          if (name === 'p') {\n            text += '\\n';\n          }\n        }\n      }\n      html = filter$1(html, [/<!\\[[^\\]]+\\]>/g]);\n      walk(domParser.parse(html));\n      return text;\n    }\n    function trimHtml(html) {\n      function trimSpaces(all, s1, s2) {\n        if (!s1 && !s2) {\n          return ' ';\n        }\n        return '\\xA0';\n      }\n      html = filter$1(html, [\n        /^[\\s\\S]*<body[^>]*>\\s*|\\s*<\\/body[^>]*>[\\s\\S]*$/ig,\n        /<!--StartFragment-->|<!--EndFragment-->/g,\n        [\n          /( ?)<span class=\"Apple-converted-space\">\\u00a0<\\/span>( ?)/g,\n          trimSpaces\n        ],\n        /<br class=\"Apple-interchange-newline\">/g,\n        /<br>$/i\n      ]);\n      return html;\n    }\n    function createIdGenerator(prefix) {\n      var count = 0;\n      return function () {\n        return prefix + count++;\n      };\n    }\n    var isMsEdge = function () {\n      return domGlobals.navigator.userAgent.indexOf(' Edge/') !== -1;\n    };\n    var Utils = {\n      filter: filter$1,\n      innerText: innerText,\n      trimHtml: trimHtml,\n      createIdGenerator: createIdGenerator,\n      isMsEdge: isMsEdge\n    };\n\n    function isWordContent(content) {\n      return /<font face=\"Times New Roman\"|class=\"?Mso|style=\"[^\"]*\\bmso-|style='[^'']*\\bmso-|w:WordDocument/i.test(content) || /class=\"OutlineElement/.test(content) || /id=\"?docs\\-internal\\-guid\\-/.test(content);\n    }\n    function isNumericList(text) {\n      var found, patterns;\n      patterns = [\n        /^[IVXLMCD]{1,2}\\.[ \\u00a0]/,\n        /^[ivxlmcd]{1,2}\\.[ \\u00a0]/,\n        /^[a-z]{1,2}[\\.\\)][ \\u00a0]/,\n        /^[A-Z]{1,2}[\\.\\)][ \\u00a0]/,\n        /^[0-9]+\\.[ \\u00a0]/,\n        /^[\\u3007\\u4e00\\u4e8c\\u4e09\\u56db\\u4e94\\u516d\\u4e03\\u516b\\u4e5d]+\\.[ \\u00a0]/,\n        /^[\\u58f1\\u5f10\\u53c2\\u56db\\u4f0d\\u516d\\u4e03\\u516b\\u4e5d\\u62fe]+\\.[ \\u00a0]/\n      ];\n      text = text.replace(/^[\\u00a0 ]+/, '');\n      global$4.each(patterns, function (pattern) {\n        if (pattern.test(text)) {\n          found = true;\n          return false;\n        }\n      });\n      return found;\n    }\n    function isBulletList(text) {\n      return /^[\\s\\u00a0]*[\\u2022\\u00b7\\u00a7\\u25CF]\\s*/.test(text);\n    }\n    function convertFakeListsToProperLists(node) {\n      var currentListNode, prevListNode, lastLevel = 1;\n      function getText(node) {\n        var txt = '';\n        if (node.type === 3) {\n          return node.value;\n        }\n        if (node = node.firstChild) {\n          do {\n            txt += getText(node);\n          } while (node = node.next);\n        }\n        return txt;\n      }\n      function trimListStart(node, regExp) {\n        if (node.type === 3) {\n          if (regExp.test(node.value)) {\n            node.value = node.value.replace(regExp, '');\n            return false;\n          }\n        }\n        if (node = node.firstChild) {\n          do {\n            if (!trimListStart(node, regExp)) {\n              return false;\n            }\n          } while (node = node.next);\n        }\n        return true;\n      }\n      function removeIgnoredNodes(node) {\n        if (node._listIgnore) {\n          node.remove();\n          return;\n        }\n        if (node = node.firstChild) {\n          do {\n            removeIgnoredNodes(node);\n          } while (node = node.next);\n        }\n      }\n      function convertParagraphToLi(paragraphNode, listName, start) {\n        var level = paragraphNode._listLevel || lastLevel;\n        if (level !== lastLevel) {\n          if (level < lastLevel) {\n            if (currentListNode) {\n              currentListNode = currentListNode.parent.parent;\n            }\n          } else {\n            prevListNode = currentListNode;\n            currentListNode = null;\n          }\n        }\n        if (!currentListNode || currentListNode.name !== listName) {\n          prevListNode = prevListNode || currentListNode;\n          currentListNode = new global$8(listName, 1);\n          if (start > 1) {\n            currentListNode.attr('start', '' + start);\n          }\n          paragraphNode.wrap(currentListNode);\n        } else {\n          currentListNode.append(paragraphNode);\n        }\n        paragraphNode.name = 'li';\n        if (level > lastLevel && prevListNode) {\n          prevListNode.lastChild.append(currentListNode);\n        }\n        lastLevel = level;\n        removeIgnoredNodes(paragraphNode);\n        trimListStart(paragraphNode, /^\\u00a0+/);\n        trimListStart(paragraphNode, /^\\s*([\\u2022\\u00b7\\u00a7\\u25CF]|\\w+\\.)/);\n        trimListStart(paragraphNode, /^\\u00a0+/);\n      }\n      var elements = [];\n      var child = node.firstChild;\n      while (typeof child !== 'undefined' && child !== null) {\n        elements.push(child);\n        child = child.walk();\n        if (child !== null) {\n          while (typeof child !== 'undefined' && child.parent !== node) {\n            child = child.walk();\n          }\n        }\n      }\n      for (var i = 0; i < elements.length; i++) {\n        node = elements[i];\n        if (node.name === 'p' && node.firstChild) {\n          var nodeText = getText(node);\n          if (isBulletList(nodeText)) {\n            convertParagraphToLi(node, 'ul');\n            continue;\n          }\n          if (isNumericList(nodeText)) {\n            var matches = /([0-9]+)\\./.exec(nodeText);\n            var start = 1;\n            if (matches) {\n              start = parseInt(matches[1], 10);\n            }\n            convertParagraphToLi(node, 'ol', start);\n            continue;\n          }\n          if (node._listLevel) {\n            convertParagraphToLi(node, 'ul', 1);\n            continue;\n          }\n          currentListNode = null;\n        } else {\n          prevListNode = currentListNode;\n          currentListNode = null;\n        }\n      }\n    }\n    function filterStyles(editor, validStyles, node, styleValue) {\n      var outputStyles = {}, matches;\n      var styles = editor.dom.parseStyle(styleValue);\n      global$4.each(styles, function (value, name) {\n        switch (name) {\n        case 'mso-list':\n          matches = /\\w+ \\w+([0-9]+)/i.exec(styleValue);\n          if (matches) {\n            node._listLevel = parseInt(matches[1], 10);\n          }\n          if (/Ignore/i.test(value) && node.firstChild) {\n            node._listIgnore = true;\n            node.firstChild._listIgnore = true;\n          }\n          break;\n        case 'horiz-align':\n          name = 'text-align';\n          break;\n        case 'vert-align':\n          name = 'vertical-align';\n          break;\n        case 'font-color':\n        case 'mso-foreground':\n          name = 'color';\n          break;\n        case 'mso-background':\n        case 'mso-highlight':\n          name = 'background';\n          break;\n        case 'font-weight':\n        case 'font-style':\n          if (value !== 'normal') {\n            outputStyles[name] = value;\n          }\n          return;\n        case 'mso-element':\n          if (/^(comment|comment-list)$/i.test(value)) {\n            node.remove();\n            return;\n          }\n          break;\n        }\n        if (name.indexOf('mso-comment') === 0) {\n          node.remove();\n          return;\n        }\n        if (name.indexOf('mso-') === 0) {\n          return;\n        }\n        if (Settings.getRetainStyleProps(editor) === 'all' || validStyles && validStyles[name]) {\n          outputStyles[name] = value;\n        }\n      });\n      if (/(bold)/i.test(outputStyles['font-weight'])) {\n        delete outputStyles['font-weight'];\n        node.wrap(new global$8('b', 1));\n      }\n      if (/(italic)/i.test(outputStyles['font-style'])) {\n        delete outputStyles['font-style'];\n        node.wrap(new global$8('i', 1));\n      }\n      outputStyles = editor.dom.serializeStyle(outputStyles, node.name);\n      if (outputStyles) {\n        return outputStyles;\n      }\n      return null;\n    }\n    var filterWordContent = function (editor, content) {\n      var retainStyleProperties, validStyles;\n      retainStyleProperties = Settings.getRetainStyleProps(editor);\n      if (retainStyleProperties) {\n        validStyles = global$4.makeMap(retainStyleProperties.split(/[, ]/));\n      }\n      content = Utils.filter(content, [\n        /<br class=\"?Apple-interchange-newline\"?>/gi,\n        /<b[^>]+id=\"?docs-internal-[^>]*>/gi,\n        /<!--[\\s\\S]+?-->/gi,\n        /<(!|script[^>]*>.*?<\\/script(?=[>\\s])|\\/?(\\?xml(:\\w+)?|img|meta|link|style|\\w:\\w+)(?=[\\s\\/>]))[^>]*>/gi,\n        [\n          /<(\\/?)s>/gi,\n          '<$1strike>'\n        ],\n        [\n          /&nbsp;/gi,\n          '\\xA0'\n        ],\n        [\n          /<span\\s+style\\s*=\\s*\"\\s*mso-spacerun\\s*:\\s*yes\\s*;?\\s*\"\\s*>([\\s\\u00a0]*)<\\/span>/gi,\n          function (str, spaces) {\n            return spaces.length > 0 ? spaces.replace(/./, ' ').slice(Math.floor(spaces.length / 2)).split('').join('\\xA0') : '';\n          }\n        ]\n      ]);\n      var validElements = Settings.getWordValidElements(editor);\n      var schema = global$9({\n        valid_elements: validElements,\n        valid_children: '-li[p]'\n      });\n      global$4.each(schema.elements, function (rule) {\n        if (!rule.attributes.class) {\n          rule.attributes.class = {};\n          rule.attributesOrder.push('class');\n        }\n        if (!rule.attributes.style) {\n          rule.attributes.style = {};\n          rule.attributesOrder.push('style');\n        }\n      });\n      var domParser = global$7({}, schema);\n      domParser.addAttributeFilter('style', function (nodes) {\n        var i = nodes.length, node;\n        while (i--) {\n          node = nodes[i];\n          node.attr('style', filterStyles(editor, validStyles, node, node.attr('style')));\n          if (node.name === 'span' && node.parent && !node.attributes.length) {\n            node.unwrap();\n          }\n        }\n      });\n      domParser.addAttributeFilter('class', function (nodes) {\n        var i = nodes.length, node, className;\n        while (i--) {\n          node = nodes[i];\n          className = node.attr('class');\n          if (/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(className)) {\n            node.remove();\n          }\n          node.attr('class', null);\n        }\n      });\n      domParser.addNodeFilter('del', function (nodes) {\n        var i = nodes.length;\n        while (i--) {\n          nodes[i].remove();\n        }\n      });\n      domParser.addNodeFilter('a', function (nodes) {\n        var i = nodes.length, node, href, name;\n        while (i--) {\n          node = nodes[i];\n          href = node.attr('href');\n          name = node.attr('name');\n          if (href && href.indexOf('#_msocom_') !== -1) {\n            node.remove();\n            continue;\n          }\n          if (href && href.indexOf('file://') === 0) {\n            href = href.split('#')[1];\n            if (href) {\n              href = '#' + href;\n            }\n          }\n          if (!href && !name) {\n            node.unwrap();\n          } else {\n            if (name && !/^_?(?:toc|edn|ftn)/i.test(name)) {\n              node.unwrap();\n              continue;\n            }\n            node.attr({\n              href: href,\n              name: name\n            });\n          }\n        }\n      });\n      var rootNode = domParser.parse(content);\n      if (Settings.shouldConvertWordFakeLists(editor)) {\n        convertFakeListsToProperLists(rootNode);\n      }\n      content = global$a({ validate: editor.settings.validate }, schema).serialize(rootNode);\n      return content;\n    };\n    var preProcess = function (editor, content) {\n      return Settings.shouldUseDefaultFilters(editor) ? filterWordContent(editor, content) : content;\n    };\n    var WordFilter = {\n      preProcess: preProcess,\n      isWordContent: isWordContent\n    };\n\n    var processResult = function (content, cancelled) {\n      return {\n        content: content,\n        cancelled: cancelled\n      };\n    };\n    var postProcessFilter = function (editor, html, internal, isWordHtml) {\n      var tempBody = editor.dom.create('div', { style: 'display:none' }, html);\n      var postProcessArgs = Events.firePastePostProcess(editor, tempBody, internal, isWordHtml);\n      return processResult(postProcessArgs.node.innerHTML, postProcessArgs.isDefaultPrevented());\n    };\n    var filterContent = function (editor, content, internal, isWordHtml) {\n      var preProcessArgs = Events.firePastePreProcess(editor, content, internal, isWordHtml);\n      if (editor.hasEventListeners('PastePostProcess') && !preProcessArgs.isDefaultPrevented()) {\n        return postProcessFilter(editor, preProcessArgs.content, internal, isWordHtml);\n      } else {\n        return processResult(preProcessArgs.content, preProcessArgs.isDefaultPrevented());\n      }\n    };\n    var process = function (editor, html, internal) {\n      var isWordHtml = WordFilter.isWordContent(html);\n      var content = isWordHtml ? WordFilter.preProcess(editor, html) : html;\n      return filterContent(editor, content, internal, isWordHtml);\n    };\n    var ProcessFilters = { process: process };\n\n    var removeMeta = function (editor, html) {\n      var body = editor.dom.create('body', {}, html);\n      global$4.each(body.querySelectorAll('meta'), function (elm) {\n        return elm.parentNode.removeChild(elm);\n      });\n      return body.innerHTML;\n    };\n    var pasteHtml = function (editor, html) {\n      editor.insertContent(removeMeta(editor, html), {\n        merge: Settings.shouldMergeFormats(editor),\n        paste: true\n      });\n      return true;\n    };\n    var isAbsoluteUrl = function (url) {\n      return /^https?:\\/\\/[\\w\\?\\-\\/+=.&%@~#]+$/i.test(url);\n    };\n    var isImageUrl = function (url) {\n      return isAbsoluteUrl(url) && /.(gif|jpe?g|png)$/.test(url);\n    };\n    var createImage = function (editor, url, pasteHtmlFn) {\n      editor.undoManager.extra(function () {\n        pasteHtmlFn(editor, url);\n      }, function () {\n        editor.insertContent('<img src=\"' + url + '\">');\n      });\n      return true;\n    };\n    var createLink = function (editor, url, pasteHtmlFn) {\n      editor.undoManager.extra(function () {\n        pasteHtmlFn(editor, url);\n      }, function () {\n        editor.execCommand('mceInsertLink', false, url);\n      });\n      return true;\n    };\n    var linkSelection = function (editor, html, pasteHtmlFn) {\n      return editor.selection.isCollapsed() === false && isAbsoluteUrl(html) ? createLink(editor, html, pasteHtmlFn) : false;\n    };\n    var insertImage = function (editor, html, pasteHtmlFn) {\n      return isImageUrl(html) ? createImage(editor, html, pasteHtmlFn) : false;\n    };\n    var smartInsertContent = function (editor, html) {\n      global$4.each([\n        linkSelection,\n        insertImage,\n        pasteHtml\n      ], function (action) {\n        return action(editor, html, pasteHtml) !== true;\n      });\n    };\n    var insertContent = function (editor, html) {\n      if (Settings.isSmartPasteEnabled(editor) === false) {\n        pasteHtml(editor, html);\n      } else {\n        smartInsertContent(editor, html);\n      }\n    };\n    var SmartPaste = {\n      isImageUrl: isImageUrl,\n      isAbsoluteUrl: isAbsoluteUrl,\n      insertContent: insertContent\n    };\n\n    var isCollapsibleWhitespace = function (c) {\n      return ' \\f\\t\\x0B'.indexOf(c) !== -1;\n    };\n    var isNewLineChar = function (c) {\n      return c === '\\n' || c === '\\r';\n    };\n    var isNewline = function (text, idx) {\n      return idx < text.length && idx >= 0 ? isNewLineChar(text[idx]) : false;\n    };\n    var normalizeWhitespace = function (text) {\n      var result = foldl(text, function (acc, c) {\n        if (isCollapsibleWhitespace(c) || c === '\\xA0') {\n          if (acc.pcIsSpace || acc.str === '' || acc.str.length === text.length - 1 || isNewline(text, acc.str.length + 1)) {\n            return {\n              pcIsSpace: false,\n              str: acc.str + '\\xA0'\n            };\n          } else {\n            return {\n              pcIsSpace: true,\n              str: acc.str + ' '\n            };\n          }\n        } else {\n          return {\n            pcIsSpace: isNewLineChar(c),\n            str: acc.str + c\n          };\n        }\n      }, {\n        pcIsSpace: false,\n        str: ''\n      });\n      return result.str;\n    };\n\n    var pasteHtml$1 = function (editor, html, internalFlag) {\n      var internal = internalFlag ? internalFlag : InternalHtml.isMarked(html);\n      var args = ProcessFilters.process(editor, InternalHtml.unmark(html), internal);\n      if (args.cancelled === false) {\n        SmartPaste.insertContent(editor, args.content);\n      }\n    };\n    var pasteText = function (editor, text) {\n      var encodedText = editor.dom.encode(text).replace(/\\r\\n/g, '\\n');\n      var normalizedText = normalizeWhitespace(encodedText);\n      var html = Newlines.convert(normalizedText, editor.settings.forced_root_block, editor.settings.forced_root_block_attrs);\n      pasteHtml$1(editor, html, false);\n    };\n    var getDataTransferItems = function (dataTransfer) {\n      var items = {};\n      var mceInternalUrlPrefix = 'data:text/mce-internal,';\n      if (dataTransfer) {\n        if (dataTransfer.getData) {\n          var legacyText = dataTransfer.getData('Text');\n          if (legacyText && legacyText.length > 0) {\n            if (legacyText.indexOf(mceInternalUrlPrefix) === -1) {\n              items['text/plain'] = legacyText;\n            }\n          }\n        }\n        if (dataTransfer.types) {\n          for (var i = 0; i < dataTransfer.types.length; i++) {\n            var contentType = dataTransfer.types[i];\n            try {\n              items[contentType] = dataTransfer.getData(contentType);\n            } catch (ex) {\n              items[contentType] = '';\n            }\n          }\n        }\n      }\n      return items;\n    };\n    var getClipboardContent = function (editor, clipboardEvent) {\n      var content = getDataTransferItems(clipboardEvent.clipboardData || editor.getDoc().dataTransfer);\n      return Utils.isMsEdge() ? global$4.extend(content, { 'text/html': '' }) : content;\n    };\n    var hasContentType = function (clipboardContent, mimeType) {\n      return mimeType in clipboardContent && clipboardContent[mimeType].length > 0;\n    };\n    var hasHtmlOrText = function (content) {\n      return hasContentType(content, 'text/html') || hasContentType(content, 'text/plain');\n    };\n    var getBase64FromUri = function (uri) {\n      var idx;\n      idx = uri.indexOf(',');\n      if (idx !== -1) {\n        return uri.substr(idx + 1);\n      }\n      return null;\n    };\n    var isValidDataUriImage = function (settings, imgElm) {\n      return settings.images_dataimg_filter ? settings.images_dataimg_filter(imgElm) : true;\n    };\n    var extractFilename = function (editor, str) {\n      var m = str.match(/([\\s\\S]+?)\\.(?:jpeg|jpg|png|gif)$/i);\n      return m ? editor.dom.encode(m[1]) : null;\n    };\n    var uniqueId = Utils.createIdGenerator('mceclip');\n    var pasteImage = function (editor, imageItem) {\n      var base64 = getBase64FromUri(imageItem.uri);\n      var id = uniqueId();\n      var name = editor.settings.images_reuse_filename && imageItem.blob.name ? extractFilename(editor, imageItem.blob.name) : id;\n      var img = new domGlobals.Image();\n      img.src = imageItem.uri;\n      if (isValidDataUriImage(editor.settings, img)) {\n        var blobCache = editor.editorUpload.blobCache;\n        var blobInfo = void 0, existingBlobInfo = void 0;\n        existingBlobInfo = blobCache.findFirst(function (cachedBlobInfo) {\n          return cachedBlobInfo.base64() === base64;\n        });\n        if (!existingBlobInfo) {\n          blobInfo = blobCache.create(id, imageItem.blob, base64, name);\n          blobCache.add(blobInfo);\n        } else {\n          blobInfo = existingBlobInfo;\n        }\n        pasteHtml$1(editor, '<img src=\"' + blobInfo.blobUri() + '\">', false);\n      } else {\n        pasteHtml$1(editor, '<img src=\"' + imageItem.uri + '\">', false);\n      }\n    };\n    var isClipboardEvent = function (event) {\n      return event.type === 'paste';\n    };\n    var readBlobsAsDataUris = function (items) {\n      return traverse(items, function (item) {\n        return Future.nu(function (resolve) {\n          var blob = item.getAsFile ? item.getAsFile() : item;\n          var reader = new window.FileReader();\n          reader.onload = function () {\n            resolve({\n              blob: blob,\n              uri: reader.result\n            });\n          };\n          reader.readAsDataURL(blob);\n        });\n      });\n    };\n    var getImagesFromDataTransfer = function (dataTransfer) {\n      var items = dataTransfer.items ? map(from$1(dataTransfer.items), function (item) {\n        return item.getAsFile();\n      }) : [];\n      var files = dataTransfer.files ? from$1(dataTransfer.files) : [];\n      var images = filter(items.length > 0 ? items : files, function (file) {\n        return /^image\\/(jpeg|png|gif|bmp)$/.test(file.type);\n      });\n      return images;\n    };\n    var pasteImageData = function (editor, e, rng) {\n      var dataTransfer = isClipboardEvent(e) ? e.clipboardData : e.dataTransfer;\n      if (editor.settings.paste_data_images && dataTransfer) {\n        var images = getImagesFromDataTransfer(dataTransfer);\n        if (images.length > 0) {\n          e.preventDefault();\n          readBlobsAsDataUris(images).get(function (blobResults) {\n            if (rng) {\n              editor.selection.setRng(rng);\n            }\n            each(blobResults, function (result) {\n              pasteImage(editor, result);\n            });\n          });\n          return true;\n        }\n      }\n      return false;\n    };\n    var isBrokenAndroidClipboardEvent = function (e) {\n      var clipboardData = e.clipboardData;\n      return domGlobals.navigator.userAgent.indexOf('Android') !== -1 && clipboardData && clipboardData.items && clipboardData.items.length === 0;\n    };\n    var isKeyboardPasteEvent = function (e) {\n      return global$5.metaKeyPressed(e) && e.keyCode === 86 || e.shiftKey && e.keyCode === 45;\n    };\n    var registerEventHandlers = function (editor, pasteBin, pasteFormat) {\n      var keyboardPasteEvent = value();\n      var keyboardPastePlainTextState;\n      editor.on('keydown', function (e) {\n        function removePasteBinOnKeyUp(e) {\n          if (isKeyboardPasteEvent(e) && !e.isDefaultPrevented()) {\n            pasteBin.remove();\n          }\n        }\n        if (isKeyboardPasteEvent(e) && !e.isDefaultPrevented()) {\n          keyboardPastePlainTextState = e.shiftKey && e.keyCode === 86;\n          if (keyboardPastePlainTextState && global$2.webkit && domGlobals.navigator.userAgent.indexOf('Version/') !== -1) {\n            return;\n          }\n          e.stopImmediatePropagation();\n          keyboardPasteEvent.set(e);\n          window.setTimeout(function () {\n            keyboardPasteEvent.clear();\n          }, 100);\n          if (global$2.ie && keyboardPastePlainTextState) {\n            e.preventDefault();\n            Events.firePaste(editor, true);\n            return;\n          }\n          pasteBin.remove();\n          pasteBin.create();\n          editor.once('keyup', removePasteBinOnKeyUp);\n          editor.once('paste', function () {\n            editor.off('keyup', removePasteBinOnKeyUp);\n          });\n        }\n      });\n      function insertClipboardContent(clipboardContent, isKeyBoardPaste, plainTextMode, internal) {\n        var content, isPlainTextHtml;\n        if (hasContentType(clipboardContent, 'text/html')) {\n          content = clipboardContent['text/html'];\n        } else {\n          content = pasteBin.getHtml();\n          internal = internal ? internal : InternalHtml.isMarked(content);\n          if (pasteBin.isDefaultContent(content)) {\n            plainTextMode = true;\n          }\n        }\n        content = Utils.trimHtml(content);\n        pasteBin.remove();\n        isPlainTextHtml = internal === false && Newlines.isPlainText(content);\n        if (!content.length || isPlainTextHtml) {\n          plainTextMode = true;\n        }\n        if (plainTextMode) {\n          if (hasContentType(clipboardContent, 'text/plain') && isPlainTextHtml) {\n            content = clipboardContent['text/plain'];\n          } else {\n            content = Utils.innerText(content);\n          }\n        }\n        if (pasteBin.isDefaultContent(content)) {\n          if (!isKeyBoardPaste) {\n            editor.windowManager.alert('Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents.');\n          }\n          return;\n        }\n        if (plainTextMode) {\n          pasteText(editor, content);\n        } else {\n          pasteHtml$1(editor, content, internal);\n        }\n      }\n      var getLastRng = function () {\n        return pasteBin.getLastRng() || editor.selection.getRng();\n      };\n      editor.on('paste', function (e) {\n        var isKeyBoardPaste = keyboardPasteEvent.isSet();\n        var clipboardContent = getClipboardContent(editor, e);\n        var plainTextMode = pasteFormat.get() === 'text' || keyboardPastePlainTextState;\n        var internal = hasContentType(clipboardContent, InternalHtml.internalHtmlMime());\n        keyboardPastePlainTextState = false;\n        if (e.isDefaultPrevented() || isBrokenAndroidClipboardEvent(e)) {\n          pasteBin.remove();\n          return;\n        }\n        if (!hasHtmlOrText(clipboardContent) && pasteImageData(editor, e, getLastRng())) {\n          pasteBin.remove();\n          return;\n        }\n        if (!isKeyBoardPaste) {\n          e.preventDefault();\n        }\n        if (global$2.ie && (!isKeyBoardPaste || e.ieFake) && !hasContentType(clipboardContent, 'text/html')) {\n          pasteBin.create();\n          editor.dom.bind(pasteBin.getEl(), 'paste', function (e) {\n            e.stopPropagation();\n          });\n          editor.getDoc().execCommand('Paste', false, null);\n          clipboardContent['text/html'] = pasteBin.getHtml();\n        }\n        if (hasContentType(clipboardContent, 'text/html')) {\n          e.preventDefault();\n          if (!internal) {\n            internal = InternalHtml.isMarked(clipboardContent['text/html']);\n          }\n          insertClipboardContent(clipboardContent, isKeyBoardPaste, plainTextMode, internal);\n        } else {\n          global$3.setEditorTimeout(editor, function () {\n            insertClipboardContent(clipboardContent, isKeyBoardPaste, plainTextMode, internal);\n          }, 0);\n        }\n      });\n    };\n    var registerEventsAndFilters = function (editor, pasteBin, pasteFormat) {\n      registerEventHandlers(editor, pasteBin, pasteFormat);\n      var src;\n      editor.parser.addNodeFilter('img', function (nodes, name, args) {\n        var isPasteInsert = function (args) {\n          return args.data && args.data.paste === true;\n        };\n        var remove = function (node) {\n          if (!node.attr('data-mce-object') && src !== global$2.transparentSrc) {\n            node.remove();\n          }\n        };\n        var isWebKitFakeUrl = function (src) {\n          return src.indexOf('webkit-fake-url') === 0;\n        };\n        var isDataUri = function (src) {\n          return src.indexOf('data:') === 0;\n        };\n        if (!editor.settings.paste_data_images && isPasteInsert(args)) {\n          var i = nodes.length;\n          while (i--) {\n            src = nodes[i].attr('src');\n            if (!src) {\n              continue;\n            }\n            if (isWebKitFakeUrl(src)) {\n              remove(nodes[i]);\n            } else if (!editor.settings.allow_html_data_urls && isDataUri(src)) {\n              remove(nodes[i]);\n            }\n          }\n        }\n      });\n    };\n\n    var getPasteBinParent = function (editor) {\n      return global$2.ie && editor.inline ? domGlobals.document.body : editor.getBody();\n    };\n    var isExternalPasteBin = function (editor) {\n      return getPasteBinParent(editor) !== editor.getBody();\n    };\n    var delegatePasteEvents = function (editor, pasteBinElm, pasteBinDefaultContent) {\n      if (isExternalPasteBin(editor)) {\n        editor.dom.bind(pasteBinElm, 'paste keyup', function (e) {\n          if (!isDefault(editor, pasteBinDefaultContent)) {\n            editor.fire('paste');\n          }\n        });\n      }\n    };\n    var create = function (editor, lastRngCell, pasteBinDefaultContent) {\n      var dom = editor.dom, body = editor.getBody();\n      var pasteBinElm;\n      lastRngCell.set(editor.selection.getRng());\n      pasteBinElm = editor.dom.add(getPasteBinParent(editor), 'div', {\n        'id': 'mcepastebin',\n        'class': 'mce-pastebin',\n        'contentEditable': true,\n        'data-mce-bogus': 'all',\n        'style': 'position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0'\n      }, pasteBinDefaultContent);\n      if (global$2.ie || global$2.gecko) {\n        dom.setStyle(pasteBinElm, 'left', dom.getStyle(body, 'direction', true) === 'rtl' ? 65535 : -65535);\n      }\n      dom.bind(pasteBinElm, 'beforedeactivate focusin focusout', function (e) {\n        e.stopPropagation();\n      });\n      delegatePasteEvents(editor, pasteBinElm, pasteBinDefaultContent);\n      pasteBinElm.focus();\n      editor.selection.select(pasteBinElm, true);\n    };\n    var remove = function (editor, lastRngCell) {\n      if (getEl(editor)) {\n        var pasteBinClone = void 0;\n        var lastRng = lastRngCell.get();\n        while (pasteBinClone = editor.dom.get('mcepastebin')) {\n          editor.dom.remove(pasteBinClone);\n          editor.dom.unbind(pasteBinClone);\n        }\n        if (lastRng) {\n          editor.selection.setRng(lastRng);\n        }\n      }\n      lastRngCell.set(null);\n    };\n    var getEl = function (editor) {\n      return editor.dom.get('mcepastebin');\n    };\n    var getHtml = function (editor) {\n      var pasteBinElm, pasteBinClones, i, dirtyWrappers, cleanWrapper;\n      var copyAndRemove = function (toElm, fromElm) {\n        toElm.appendChild(fromElm);\n        editor.dom.remove(fromElm, true);\n      };\n      pasteBinClones = global$4.grep(getPasteBinParent(editor).childNodes, function (elm) {\n        return elm.id === 'mcepastebin';\n      });\n      pasteBinElm = pasteBinClones.shift();\n      global$4.each(pasteBinClones, function (pasteBinClone) {\n        copyAndRemove(pasteBinElm, pasteBinClone);\n      });\n      dirtyWrappers = editor.dom.select('div[id=mcepastebin]', pasteBinElm);\n      for (i = dirtyWrappers.length - 1; i >= 0; i--) {\n        cleanWrapper = editor.dom.create('div');\n        pasteBinElm.insertBefore(cleanWrapper, dirtyWrappers[i]);\n        copyAndRemove(cleanWrapper, dirtyWrappers[i]);\n      }\n      return pasteBinElm ? pasteBinElm.innerHTML : '';\n    };\n    var getLastRng = function (lastRng) {\n      return lastRng.get();\n    };\n    var isDefaultContent = function (pasteBinDefaultContent, content) {\n      return content === pasteBinDefaultContent;\n    };\n    var isPasteBin = function (elm) {\n      return elm && elm.id === 'mcepastebin';\n    };\n    var isDefault = function (editor, pasteBinDefaultContent) {\n      var pasteBinElm = getEl(editor);\n      return isPasteBin(pasteBinElm) && isDefaultContent(pasteBinDefaultContent, pasteBinElm.innerHTML);\n    };\n    var PasteBin = function (editor) {\n      var lastRng = Cell(null);\n      var pasteBinDefaultContent = '%MCEPASTEBIN%';\n      return {\n        create: function () {\n          return create(editor, lastRng, pasteBinDefaultContent);\n        },\n        remove: function () {\n          return remove(editor, lastRng);\n        },\n        getEl: function () {\n          return getEl(editor);\n        },\n        getHtml: function () {\n          return getHtml(editor);\n        },\n        getLastRng: function () {\n          return getLastRng(lastRng);\n        },\n        isDefault: function () {\n          return isDefault(editor, pasteBinDefaultContent);\n        },\n        isDefaultContent: function (content) {\n          return isDefaultContent(pasteBinDefaultContent, content);\n        }\n      };\n    };\n\n    var Clipboard = function (editor, pasteFormat) {\n      var pasteBin = PasteBin(editor);\n      editor.on('PreInit', function () {\n        return registerEventsAndFilters(editor, pasteBin, pasteFormat);\n      });\n      return {\n        pasteFormat: pasteFormat,\n        pasteHtml: function (html, internalFlag) {\n          return pasteHtml$1(editor, html, internalFlag);\n        },\n        pasteText: function (text) {\n          return pasteText(editor, text);\n        },\n        pasteImageData: function (e, rng) {\n          return pasteImageData(editor, e, rng);\n        },\n        getDataTransferItems: getDataTransferItems,\n        hasHtmlOrText: hasHtmlOrText,\n        hasContentType: hasContentType\n      };\n    };\n\n    var noop$1 = function () {\n    };\n    var hasWorkingClipboardApi = function (clipboardData) {\n      return global$2.iOS === false && clipboardData !== undefined && typeof clipboardData.setData === 'function' && Utils.isMsEdge() !== true;\n    };\n    var setHtml5Clipboard = function (clipboardData, html, text) {\n      if (hasWorkingClipboardApi(clipboardData)) {\n        try {\n          clipboardData.clearData();\n          clipboardData.setData('text/html', html);\n          clipboardData.setData('text/plain', text);\n          clipboardData.setData(InternalHtml.internalHtmlMime(), html);\n          return true;\n        } catch (e) {\n          return false;\n        }\n      } else {\n        return false;\n      }\n    };\n    var setClipboardData = function (evt, data, fallback, done) {\n      if (setHtml5Clipboard(evt.clipboardData, data.html, data.text)) {\n        evt.preventDefault();\n        done();\n      } else {\n        fallback(data.html, done);\n      }\n    };\n    var fallback = function (editor) {\n      return function (html, done) {\n        var markedHtml = InternalHtml.mark(html);\n        var outer = editor.dom.create('div', {\n          'contenteditable': 'false',\n          'data-mce-bogus': 'all'\n        });\n        var inner = editor.dom.create('div', { contenteditable: 'true' }, markedHtml);\n        editor.dom.setStyles(outer, {\n          position: 'fixed',\n          top: '0',\n          left: '-3000px',\n          width: '1000px',\n          overflow: 'hidden'\n        });\n        outer.appendChild(inner);\n        editor.dom.add(editor.getBody(), outer);\n        var range = editor.selection.getRng();\n        inner.focus();\n        var offscreenRange = editor.dom.createRng();\n        offscreenRange.selectNodeContents(inner);\n        editor.selection.setRng(offscreenRange);\n        global$3.setTimeout(function () {\n          editor.selection.setRng(range);\n          outer.parentNode.removeChild(outer);\n          done();\n        }, 0);\n      };\n    };\n    var getData = function (editor) {\n      return {\n        html: editor.selection.getContent({ contextual: true }),\n        text: editor.selection.getContent({ format: 'text' })\n      };\n    };\n    var isTableSelection = function (editor) {\n      return !!editor.dom.getParent(editor.selection.getStart(), 'td[data-mce-selected],th[data-mce-selected]', editor.getBody());\n    };\n    var hasSelectedContent = function (editor) {\n      return !editor.selection.isCollapsed() || isTableSelection(editor);\n    };\n    var cut = function (editor) {\n      return function (evt) {\n        if (hasSelectedContent(editor)) {\n          setClipboardData(evt, getData(editor), fallback(editor), function () {\n            global$3.setTimeout(function () {\n              editor.execCommand('Delete');\n            }, 0);\n          });\n        }\n      };\n    };\n    var copy = function (editor) {\n      return function (evt) {\n        if (hasSelectedContent(editor)) {\n          setClipboardData(evt, getData(editor), fallback(editor), noop$1);\n        }\n      };\n    };\n    var register$1 = function (editor) {\n      editor.on('cut', cut(editor));\n      editor.on('copy', copy(editor));\n    };\n    var CutCopy = { register: register$1 };\n\n    var global$b = tinymce.util.Tools.resolve('tinymce.dom.RangeUtils');\n\n    var getCaretRangeFromEvent = function (editor, e) {\n      return global$b.getCaretRangeFromPoint(e.clientX, e.clientY, editor.getDoc());\n    };\n    var isPlainTextFileUrl = function (content) {\n      var plainTextContent = content['text/plain'];\n      return plainTextContent ? plainTextContent.indexOf('file://') === 0 : false;\n    };\n    var setFocusedRange = function (editor, rng) {\n      editor.focus();\n      editor.selection.setRng(rng);\n    };\n    var setup = function (editor, clipboard, draggingInternallyState) {\n      if (Settings.shouldBlockDrop(editor)) {\n        editor.on('dragend dragover draggesture dragdrop drop drag', function (e) {\n          e.preventDefault();\n          e.stopPropagation();\n        });\n      }\n      if (!Settings.shouldPasteDataImages(editor)) {\n        editor.on('drop', function (e) {\n          var dataTransfer = e.dataTransfer;\n          if (dataTransfer && dataTransfer.files && dataTransfer.files.length > 0) {\n            e.preventDefault();\n          }\n        });\n      }\n      editor.on('drop', function (e) {\n        var dropContent, rng;\n        rng = getCaretRangeFromEvent(editor, e);\n        if (e.isDefaultPrevented() || draggingInternallyState.get()) {\n          return;\n        }\n        dropContent = clipboard.getDataTransferItems(e.dataTransfer);\n        var internal = clipboard.hasContentType(dropContent, InternalHtml.internalHtmlMime());\n        if ((!clipboard.hasHtmlOrText(dropContent) || isPlainTextFileUrl(dropContent)) && clipboard.pasteImageData(e, rng)) {\n          return;\n        }\n        if (rng && Settings.shouldFilterDrop(editor)) {\n          var content_1 = dropContent['mce-internal'] || dropContent['text/html'] || dropContent['text/plain'];\n          if (content_1) {\n            e.preventDefault();\n            global$3.setEditorTimeout(editor, function () {\n              editor.undoManager.transact(function () {\n                if (dropContent['mce-internal']) {\n                  editor.execCommand('Delete');\n                }\n                setFocusedRange(editor, rng);\n                content_1 = Utils.trimHtml(content_1);\n                if (!dropContent['text/html']) {\n                  clipboard.pasteText(content_1);\n                } else {\n                  clipboard.pasteHtml(content_1, internal);\n                }\n              });\n            });\n          }\n        }\n      });\n      editor.on('dragstart', function (e) {\n        draggingInternallyState.set(true);\n      });\n      editor.on('dragover dragend', function (e) {\n        if (Settings.shouldPasteDataImages(editor) && draggingInternallyState.get() === false) {\n          e.preventDefault();\n          setFocusedRange(editor, getCaretRangeFromEvent(editor, e));\n        }\n        if (e.type === 'dragend') {\n          draggingInternallyState.set(false);\n        }\n      });\n    };\n    var DragDrop = { setup: setup };\n\n    var setup$1 = function (editor) {\n      var plugin = editor.plugins.paste;\n      var preProcess = Settings.getPreProcess(editor);\n      if (preProcess) {\n        editor.on('PastePreProcess', function (e) {\n          preProcess.call(plugin, plugin, e);\n        });\n      }\n      var postProcess = Settings.getPostProcess(editor);\n      if (postProcess) {\n        editor.on('PastePostProcess', function (e) {\n          postProcess.call(plugin, plugin, e);\n        });\n      }\n    };\n    var PrePostProcess = { setup: setup$1 };\n\n    function addPreProcessFilter(editor, filterFunc) {\n      editor.on('PastePreProcess', function (e) {\n        e.content = filterFunc(editor, e.content, e.internal, e.wordContent);\n      });\n    }\n    function addPostProcessFilter(editor, filterFunc) {\n      editor.on('PastePostProcess', function (e) {\n        filterFunc(editor, e.node);\n      });\n    }\n    function removeExplorerBrElementsAfterBlocks(editor, html) {\n      if (!WordFilter.isWordContent(html)) {\n        return html;\n      }\n      var blockElements = [];\n      global$4.each(editor.schema.getBlockElements(), function (block, blockName) {\n        blockElements.push(blockName);\n      });\n      var explorerBlocksRegExp = new RegExp('(?:<br>&nbsp;[\\\\s\\\\r\\\\n]+|<br>)*(<\\\\/?(' + blockElements.join('|') + ')[^>]*>)(?:<br>&nbsp;[\\\\s\\\\r\\\\n]+|<br>)*', 'g');\n      html = Utils.filter(html, [[\n          explorerBlocksRegExp,\n          '$1'\n        ]]);\n      html = Utils.filter(html, [\n        [\n          /<br><br>/g,\n          '<BR><BR>'\n        ],\n        [\n          /<br>/g,\n          ' '\n        ],\n        [\n          /<BR><BR>/g,\n          '<br>'\n        ]\n      ]);\n      return html;\n    }\n    function removeWebKitStyles(editor, content, internal, isWordHtml) {\n      if (isWordHtml || internal) {\n        return content;\n      }\n      var webKitStylesSetting = Settings.getWebkitStyles(editor);\n      var webKitStyles;\n      if (Settings.shouldRemoveWebKitStyles(editor) === false || webKitStylesSetting === 'all') {\n        return content;\n      }\n      if (webKitStylesSetting) {\n        webKitStyles = webKitStylesSetting.split(/[, ]/);\n      }\n      if (webKitStyles) {\n        var dom_1 = editor.dom, node_1 = editor.selection.getNode();\n        content = content.replace(/(<[^>]+) style=\"([^\"]*)\"([^>]*>)/gi, function (all, before, value, after) {\n          var inputStyles = dom_1.parseStyle(dom_1.decode(value));\n          var outputStyles = {};\n          if (webKitStyles === 'none') {\n            return before + after;\n          }\n          for (var i = 0; i < webKitStyles.length; i++) {\n            var inputValue = inputStyles[webKitStyles[i]], currentValue = dom_1.getStyle(node_1, webKitStyles[i], true);\n            if (/color/.test(webKitStyles[i])) {\n              inputValue = dom_1.toHex(inputValue);\n              currentValue = dom_1.toHex(currentValue);\n            }\n            if (currentValue !== inputValue) {\n              outputStyles[webKitStyles[i]] = inputValue;\n            }\n          }\n          outputStyles = dom_1.serializeStyle(outputStyles, 'span');\n          if (outputStyles) {\n            return before + ' style=\"' + outputStyles + '\"' + after;\n          }\n          return before + after;\n        });\n      } else {\n        content = content.replace(/(<[^>]+) style=\"([^\"]*)\"([^>]*>)/gi, '$1$3');\n      }\n      content = content.replace(/(<[^>]+) data-mce-style=\"([^\"]+)\"([^>]*>)/gi, function (all, before, value, after) {\n        return before + ' style=\"' + value + '\"' + after;\n      });\n      return content;\n    }\n    function removeUnderlineAndFontInAnchor(editor, root) {\n      editor.$('a', root).find('font,u').each(function (i, node) {\n        editor.dom.remove(node, true);\n      });\n    }\n    var setup$2 = function (editor) {\n      if (global$2.webkit) {\n        addPreProcessFilter(editor, removeWebKitStyles);\n      }\n      if (global$2.ie) {\n        addPreProcessFilter(editor, removeExplorerBrElementsAfterBlocks);\n        addPostProcessFilter(editor, removeUnderlineAndFontInAnchor);\n      }\n    };\n    var Quirks = { setup: setup$2 };\n\n    var makeSetupHandler = function (editor, clipboard) {\n      return function (api) {\n        api.setActive(clipboard.pasteFormat.get() === 'text');\n        var pastePlainTextToggleHandler = function (e) {\n          return api.setActive(e.state);\n        };\n        editor.on('PastePlainTextToggle', pastePlainTextToggleHandler);\n        return function () {\n          return editor.off('PastePlainTextToggle', pastePlainTextToggleHandler);\n        };\n      };\n    };\n    var register$2 = function (editor, clipboard) {\n      editor.ui.registry.addToggleButton('pastetext', {\n        active: false,\n        icon: 'paste-text',\n        tooltip: 'Paste as text',\n        onAction: function () {\n          return editor.execCommand('mceTogglePlainTextPaste');\n        },\n        onSetup: makeSetupHandler(editor, clipboard)\n      });\n      editor.ui.registry.addToggleMenuItem('pastetext', {\n        text: 'Paste as text',\n        onAction: function () {\n          return editor.execCommand('mceTogglePlainTextPaste');\n        },\n        onSetup: makeSetupHandler(editor, clipboard)\n      });\n    };\n    var Buttons = { register: register$2 };\n\n    function Plugin () {\n      global$1.add('paste', function (editor) {\n        if (DetectProPlugin.hasProPlugin(editor) === false) {\n          var draggingInternallyState = Cell(false);\n          var pasteFormat = Cell(Settings.isPasteAsTextEnabled(editor) ? 'text' : 'html');\n          var clipboard = Clipboard(editor, pasteFormat);\n          var quirks = Quirks.setup(editor);\n          Buttons.register(editor, clipboard);\n          Commands.register(editor, clipboard);\n          PrePostProcess.setup(editor);\n          CutCopy.register(editor);\n          DragDrop.setup(editor, clipboard, draggingInternallyState);\n          return Api.get(clipboard, quirks);\n        }\n      });\n    }\n\n    Plugin();\n\n}(window));\n"]}