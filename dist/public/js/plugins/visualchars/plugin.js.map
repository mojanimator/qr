{"version":3,"sources":["../../../../../public/js/plugins/visualchars/plugin.js"],"names":["domGlobals","Cell","initial","value","get","set","v","clone","global","tinymce","util","Tools","resolve","toggleState","isEnabled","Api","fireVisualChars","editor","state","fire","Events","noop","constant","never","always","none","NONE","eq","o","isNone","call","thunk","id","n","me","fold","s","is","isSome","getOr","getOrThunk","getOrDie","msg","Error","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","Object","freeze","some","a","constant_a","self","f","elementEq","b","from","Option","typeOf","x","t","Array","prototype","isPrototypeOf","constructor","name","String","isType","type","isString","isBoolean","isFunction","isNumber","nativeSlice","slice","xs","len","length","r","i","pred","push","from$1","ATTRIBUTE","Node","ATTRIBUTE_NODE","CDATA_SECTION","CDATA_SECTION_NODE","COMMENT","COMMENT_NODE","DOCUMENT","DOCUMENT_NODE","DOCUMENT_TYPE","DOCUMENT_TYPE_NODE","DOCUMENT_FRAGMENT","DOCUMENT_FRAGMENT_NODE","ELEMENT","ELEMENT_NODE","TEXT","TEXT_NODE","PROCESSING_INSTRUCTION","PROCESSING_INSTRUCTION_NODE","ENTITY_REFERENCE","ENTITY_REFERENCE_NODE","ENTITY","ENTITY_NODE","NOTATION","NOTATION_NODE","Global","window","Function","element","dom","nodeType","nodeValue","isType$1","isText","rawSet","key","setAttribute","console","error","get$1","getAttribute","remove","removeAttribute","read","attr","split","add","old","nu","concat","join","remove$1","supports","classList","get$2","add$1","clazz","remove$2","add$2","cleanClass","remove$3","fromHtml","html","scope","doc","document","div","createElement","innerHTML","hasChildNodes","childNodes","fromDom","fromTag","tag","node","fromText","text","createTextNode","fromPoint","docElm","y","elementFromPoint","Element","charMap","charMapToRegExp","regExp","RegExp","charMapToSelector","selector","Data","regExpGlobal","nbspClass","wrapCharWithSpan","Html","isMatch","test","filterDescendants","predicate","result","children","findParentElm","elm","rootElm","parentNode","replaceWithSpans","replace","Nodes","isWrappedNbsp","nodeName","toLowerCase","contains","show","nodeList","parent","withSpans","create","lastChild","insertAfter","hide","select","toggle","body","getBody","bookmark","selection","getBookmark","getNode","moveToBookmark","VisualChars","toggleVisualChars","Actions","register","addCommand","Commands","global$1","setup","debouncedToggle","debounce","settings","forced_root_block","on","e","keyCode","Keyboard","isEnabledByDefault","getParam","Settings","setup$1","valueForToggling","Bindings","toggleActiveState","enabledStated","api","setActive","editorEventCallback","off","register$1","ui","registry","addToggleButton","tooltip","icon","onAction","execCommand","onSetup","addToggleMenuItem","Plugin"],"mappings":"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","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.1.0 (2019-10-17)\n */\n(function (domGlobals) {\n    'use strict';\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      var clone = function () {\n        return Cell(get());\n      };\n      return {\n        get: get,\n        set: set,\n        clone: clone\n      };\n    };\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var get = function (toggleState) {\n      var isEnabled = function () {\n        return toggleState.get();\n      };\n      return { isEnabled: isEnabled };\n    };\n    var Api = { get: get };\n\n    var fireVisualChars = function (editor, state) {\n      return editor.fire('VisualChars', { state: state });\n    };\n    var Events = { fireVisualChars: fireVisualChars };\n\n    var noop = function () {\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      if (Object.freeze) {\n        Object.freeze(me);\n      }\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Option = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var typeOf = function (x) {\n      if (x === null) {\n        return 'null';\n      }\n      var t = typeof x;\n      if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      }\n      if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      }\n      return t;\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isString = isType('string');\n    var isBoolean = isType('boolean');\n    var isFunction = isType('function');\n    var isNumber = isType('number');\n\n    var nativeSlice = Array.prototype.slice;\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var filter = function (xs, pred) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          r.push(x);\n        }\n      }\n      return r;\n    };\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n\n    var ATTRIBUTE = domGlobals.Node.ATTRIBUTE_NODE;\n    var CDATA_SECTION = domGlobals.Node.CDATA_SECTION_NODE;\n    var COMMENT = domGlobals.Node.COMMENT_NODE;\n    var DOCUMENT = domGlobals.Node.DOCUMENT_NODE;\n    var DOCUMENT_TYPE = domGlobals.Node.DOCUMENT_TYPE_NODE;\n    var DOCUMENT_FRAGMENT = domGlobals.Node.DOCUMENT_FRAGMENT_NODE;\n    var ELEMENT = domGlobals.Node.ELEMENT_NODE;\n    var TEXT = domGlobals.Node.TEXT_NODE;\n    var PROCESSING_INSTRUCTION = domGlobals.Node.PROCESSING_INSTRUCTION_NODE;\n    var ENTITY_REFERENCE = domGlobals.Node.ENTITY_REFERENCE_NODE;\n    var ENTITY = domGlobals.Node.ENTITY_NODE;\n    var NOTATION = domGlobals.Node.NOTATION_NODE;\n\n    var Global = typeof domGlobals.window !== 'undefined' ? domGlobals.window : Function('return this;')();\n\n    var type = function (element) {\n      return element.dom().nodeType;\n    };\n    var value = function (element) {\n      return element.dom().nodeValue;\n    };\n    var isType$1 = function (t) {\n      return function (element) {\n        return type(element) === t;\n      };\n    };\n    var isText = isType$1(TEXT);\n\n    var rawSet = function (dom, key, value) {\n      if (isString(value) || isBoolean(value) || isNumber(value)) {\n        dom.setAttribute(key, value + '');\n      } else {\n        domGlobals.console.error('Invalid call to Attr.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n        throw new Error('Attribute value was not simple');\n      }\n    };\n    var set = function (element, key, value) {\n      rawSet(element.dom(), key, value);\n    };\n    var get$1 = function (element, key) {\n      var v = element.dom().getAttribute(key);\n      return v === null ? undefined : v;\n    };\n    var remove = function (element, key) {\n      element.dom().removeAttribute(key);\n    };\n\n    var read = function (element, attr) {\n      var value = get$1(element, attr);\n      return value === undefined || value === '' ? [] : value.split(' ');\n    };\n    var add = function (element, attr, id) {\n      var old = read(element, attr);\n      var nu = old.concat([id]);\n      set(element, attr, nu.join(' '));\n      return true;\n    };\n    var remove$1 = function (element, attr, id) {\n      var nu = filter(read(element, attr), function (v) {\n        return v !== id;\n      });\n      if (nu.length > 0) {\n        set(element, attr, nu.join(' '));\n      } else {\n        remove(element, attr);\n      }\n      return false;\n    };\n\n    var supports = function (element) {\n      return element.dom().classList !== undefined;\n    };\n    var get$2 = function (element) {\n      return read(element, 'class');\n    };\n    var add$1 = function (element, clazz) {\n      return add(element, 'class', clazz);\n    };\n    var remove$2 = function (element, clazz) {\n      return remove$1(element, 'class', clazz);\n    };\n\n    var add$2 = function (element, clazz) {\n      if (supports(element)) {\n        element.dom().classList.add(clazz);\n      } else {\n        add$1(element, clazz);\n      }\n    };\n    var cleanClass = function (element) {\n      var classList = supports(element) ? element.dom().classList : get$2(element);\n      if (classList.length === 0) {\n        remove(element, 'class');\n      }\n    };\n    var remove$3 = function (element, clazz) {\n      if (supports(element)) {\n        var classList = element.dom().classList;\n        classList.remove(clazz);\n      } else {\n        remove$2(element, clazz);\n      }\n      cleanClass(element);\n    };\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || domGlobals.document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        domGlobals.console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: constant(node) };\n    };\n    var fromPoint = function (docElm, x, y) {\n      var doc = docElm.dom();\n      return Option.from(doc.elementFromPoint(x, y)).map(fromDom);\n    };\n    var Element = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    var charMap = {\n      '\\xA0': 'nbsp',\n      '\\xAD': 'shy'\n    };\n    var charMapToRegExp = function (charMap, global) {\n      var key, regExp = '';\n      for (key in charMap) {\n        regExp += key;\n      }\n      return new RegExp('[' + regExp + ']', global ? 'g' : '');\n    };\n    var charMapToSelector = function (charMap) {\n      var key, selector = '';\n      for (key in charMap) {\n        if (selector) {\n          selector += ',';\n        }\n        selector += 'span.mce-' + charMap[key];\n      }\n      return selector;\n    };\n    var Data = {\n      charMap: charMap,\n      regExp: charMapToRegExp(charMap),\n      regExpGlobal: charMapToRegExp(charMap, true),\n      selector: charMapToSelector(charMap),\n      nbspClass: 'mce-nbsp',\n      charMapToRegExp: charMapToRegExp,\n      charMapToSelector: charMapToSelector\n    };\n\n    var wrapCharWithSpan = function (value) {\n      return '<span data-mce-bogus=\"1\" class=\"mce-' + Data.charMap[value] + '\">' + value + '</span>';\n    };\n    var Html = { wrapCharWithSpan: wrapCharWithSpan };\n\n    var isMatch = function (n) {\n      return isText(n) && value(n) !== undefined && Data.regExp.test(value(n));\n    };\n    var filterDescendants = function (scope, predicate) {\n      var result = [];\n      var dom = scope.dom();\n      var children = map(dom.childNodes, Element.fromDom);\n      each(children, function (x) {\n        if (predicate(x)) {\n          result = result.concat([x]);\n        }\n        result = result.concat(filterDescendants(x, predicate));\n      });\n      return result;\n    };\n    var findParentElm = function (elm, rootElm) {\n      while (elm.parentNode) {\n        if (elm.parentNode === rootElm) {\n          return elm;\n        }\n        elm = elm.parentNode;\n      }\n    };\n    var replaceWithSpans = function (html) {\n      return html.replace(Data.regExpGlobal, Html.wrapCharWithSpan);\n    };\n    var Nodes = {\n      isMatch: isMatch,\n      filterDescendants: filterDescendants,\n      findParentElm: findParentElm,\n      replaceWithSpans: replaceWithSpans\n    };\n\n    var isWrappedNbsp = function (node) {\n      return node.nodeName.toLowerCase() === 'span' && node.classList.contains('mce-nbsp-wrap');\n    };\n    var show = function (editor, rootElm) {\n      var nodeList = Nodes.filterDescendants(Element.fromDom(rootElm), Nodes.isMatch);\n      each(nodeList, function (n) {\n        var parent = n.dom().parentNode;\n        if (isWrappedNbsp(parent)) {\n          add$2(Element.fromDom(parent), Data.nbspClass);\n        } else {\n          var withSpans = Nodes.replaceWithSpans(value(n));\n          var div = editor.dom.create('div', null, withSpans);\n          var node = void 0;\n          while (node = div.lastChild) {\n            editor.dom.insertAfter(node, n.dom());\n          }\n          editor.dom.remove(n.dom());\n        }\n      });\n    };\n    var hide = function (editor, rootElm) {\n      var nodeList = editor.dom.select(Data.selector, rootElm);\n      each(nodeList, function (node) {\n        if (isWrappedNbsp(node)) {\n          remove$3(Element.fromDom(node), Data.nbspClass);\n        } else {\n          editor.dom.remove(node, true);\n        }\n      });\n    };\n    var toggle = function (editor) {\n      var body = editor.getBody();\n      var bookmark = editor.selection.getBookmark();\n      var parentNode = Nodes.findParentElm(editor.selection.getNode(), body);\n      parentNode = parentNode !== undefined ? parentNode : body;\n      hide(editor, parentNode);\n      show(editor, parentNode);\n      editor.selection.moveToBookmark(bookmark);\n    };\n    var VisualChars = {\n      show: show,\n      hide: hide,\n      toggle: toggle\n    };\n\n    var toggleVisualChars = function (editor, toggleState) {\n      var body = editor.getBody();\n      var selection = editor.selection;\n      var bookmark;\n      toggleState.set(!toggleState.get());\n      Events.fireVisualChars(editor, toggleState.get());\n      bookmark = selection.getBookmark();\n      if (toggleState.get() === true) {\n        VisualChars.show(editor, body);\n      } else {\n        VisualChars.hide(editor, body);\n      }\n      selection.moveToBookmark(bookmark);\n    };\n    var Actions = { toggleVisualChars: toggleVisualChars };\n\n    var register = function (editor, toggleState) {\n      editor.addCommand('mceVisualChars', function () {\n        Actions.toggleVisualChars(editor, toggleState);\n      });\n    };\n    var Commands = { register: register };\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.Delay');\n\n    var setup = function (editor, toggleState) {\n      var debouncedToggle = global$1.debounce(function () {\n        VisualChars.toggle(editor);\n      }, 300);\n      if (editor.settings.forced_root_block !== false) {\n        editor.on('keydown', function (e) {\n          if (toggleState.get() === true) {\n            e.keyCode === 13 ? VisualChars.toggle(editor) : debouncedToggle();\n          }\n        });\n      }\n    };\n    var Keyboard = { setup: setup };\n\n    var isEnabledByDefault = function (editor) {\n      return editor.getParam('visualchars_default_state', false);\n    };\n    var Settings = { isEnabledByDefault: isEnabledByDefault };\n\n    var setup$1 = function (editor, toggleState) {\n      editor.on('init', function () {\n        var valueForToggling = !Settings.isEnabledByDefault(editor);\n        toggleState.set(valueForToggling);\n        Actions.toggleVisualChars(editor, toggleState);\n      });\n    };\n    var Bindings = { setup: setup$1 };\n\n    var toggleActiveState = function (editor, enabledStated) {\n      return function (api) {\n        api.setActive(enabledStated.get());\n        var editorEventCallback = function (e) {\n          return api.setActive(e.state);\n        };\n        editor.on('VisualChars', editorEventCallback);\n        return function () {\n          return editor.off('VisualChars', editorEventCallback);\n        };\n      };\n    };\n    var register$1 = function (editor, toggleState) {\n      editor.ui.registry.addToggleButton('visualchars', {\n        tooltip: 'Show invisible characters',\n        icon: 'visualchars',\n        onAction: function () {\n          return editor.execCommand('mceVisualChars');\n        },\n        onSetup: toggleActiveState(editor, toggleState)\n      });\n      editor.ui.registry.addToggleMenuItem('visualchars', {\n        text: 'Show invisible characters',\n        onAction: function () {\n          return editor.execCommand('mceVisualChars');\n        },\n        onSetup: toggleActiveState(editor, toggleState)\n      });\n    };\n\n    function Plugin () {\n      global.add('visualchars', function (editor) {\n        var toggleState = Cell(false);\n        Commands.register(editor, toggleState);\n        register$1(editor, toggleState);\n        Keyboard.setup(editor, toggleState);\n        Bindings.setup(editor, toggleState);\n        return Api.get(toggleState);\n      });\n    }\n\n    Plugin();\n\n}(window));\n"]}