{"version":3,"sources":["../../../../../public/js/plugins/quickbars/plugin.js"],"names":["domGlobals","global","tinymce","util","Tools","resolve","unique","generate","prefix","date","Date","time","getTime","random","Math","floor","String","createTableHtml","cols","rows","x","y","html","getInsertedElement","editor","elms","dom","select","insertTableHtml","undoManager","transact","tableElm","cellElm","insertContent","removeAttribute","selection","setCursorLocation","insertTable","plugins","table","insertBlob","base64","blob","blobCache","blobInfo","editorUpload","create","add","createHTML","src","blobUri","Actions","global$1","blobToBase64","reader","FileReader","onloadend","result","split","readAsDataURL","Conversions","pickFile","fileInput","document","createElement","type","style","position","left","top","opacity","body","appendChild","onchange","e","Array","prototype","slice","call","target","files","click","parentNode","removeChild","Picker","setupButtons","ui","registry","addButton","icon","tooltip","onAction","then","InsertButtons","noop","constant","value","never","always","none","NONE","eq","o","isNone","thunk","id","n","me","fold","s","is","isSome","getOr","getOrThunk","getOrDie","msg","Error","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","Object","freeze","some","a","constant_a","self","f","v","elementEq","b","from","Option","fromHtml","scope","doc","div","innerHTML","hasChildNodes","childNodes","length","console","error","fromDom","fromTag","tag","node","fromText","text","createTextNode","fromPoint","docElm","elementFromPoint","Element","ATTRIBUTE","Node","ATTRIBUTE_NODE","CDATA_SECTION","CDATA_SECTION_NODE","COMMENT","COMMENT_NODE","DOCUMENT","DOCUMENT_NODE","DOCUMENT_TYPE","DOCUMENT_TYPE_NODE","DOCUMENT_FRAGMENT","DOCUMENT_FRAGMENT_NODE","ELEMENT","ELEMENT_NODE","TEXT","TEXT_NODE","PROCESSING_INSTRUCTION","PROCESSING_INSTRUCTION_NODE","ENTITY_REFERENCE","ENTITY_REFERENCE_NODE","ENTITY","ENTITY_NODE","NOTATION","NOTATION_NODE","Global","window","Function","name","element","r","nodeName","toLowerCase","typeOf","t","isPrototypeOf","constructor","isType","isString","isObject","isArray","isBoolean","isUndefined","isFunction","nativeSlice","find","xs","pred","i","len","from$1","ClosestOrAncestor","ancestor","isRoot","compareDocumentPosition","match","documentPositionPreceding","DOCUMENT_POSITION_PRECEDING","documentPositionContainedBy","DOCUMENT_POSITION_CONTAINED_BY","Cell","initial","get","set","clone","firstMatch","regexes","test","find$1","agent","major","minor","group","Number","replace","nu","detect","versionRegexes","cleanedAgent","unknown","Version","edge","chrome","ie","opera","firefox","safari","isBrowser","current","unknown$1","nu$1","version","info","isEdge","isChrome","isIE","isOpera","isFirefox","isSafari","Browser","windows","ios","android","linux","osx","solaris","freebsd","isOS","unknown$2","nu$2","isWindows","isiOS","isAndroid","isOSX","isLinux","isSolaris","isFreeBSD","OperatingSystem","DeviceType","os","browser","userAgent","mediaMatch","isiPad","isiPhone","isMobile","isTouch","isTablet","isPhone","iOSwebview","isDesktop","isWebView","detect$1","candidates","candidate","search","detectBrowser","browsers","detectOs","oses","UaString","contains","str","substr","indexOf","normalVersionRegex","checkContains","uastring","PlatformInfo","detect$2","deviceType","PlatformDetection","query","matchMedia","matches","platform","navigator","detect$3","ELEMENT$1","selector","nodeType","elem","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","regularContains","e1","e2","d1","d2","ieContains","contains$1","predicate","stop","el","closest","ancestor$1","closest$1","validDefaultOrDie","items","defaultValue","getToolbarItemsOr","getParam","EditorSettings","getTextSelectionToolbarItems","getInsertToolbarItems","Settings","addToEditor","insertToolbarItems","trim","addContextToolbar","sugarNode","textBlockElementsMap","schema","getTextBlockElements","getBody","isEmpty","InsertToolbars","addToEditor$1","className","textToolbarItems","isCollapsed","SelectionToolbars","Plugin"],"mappings":"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","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.1.0 (2019-10-17)\n */\n(function (domGlobals) {\n    'use strict';\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var unique = 0;\n    var generate = function (prefix) {\n      var date = new Date();\n      var time = date.getTime();\n      var random = Math.floor(Math.random() * 1000000000);\n      unique++;\n      return prefix + '_' + random + unique + String(time);\n    };\n\n    var createTableHtml = function (cols, rows) {\n      var x, y, html;\n      html = '<table data-mce-id=\"mce\" style=\"width: 100%\">';\n      html += '<tbody>';\n      for (y = 0; y < rows; y++) {\n        html += '<tr>';\n        for (x = 0; x < cols; x++) {\n          html += '<td><br></td>';\n        }\n        html += '</tr>';\n      }\n      html += '</tbody>';\n      html += '</table>';\n      return html;\n    };\n    var getInsertedElement = function (editor) {\n      var elms = editor.dom.select('*[data-mce-id]');\n      return elms[0];\n    };\n    var insertTableHtml = function (editor, cols, rows) {\n      editor.undoManager.transact(function () {\n        var tableElm, cellElm;\n        editor.insertContent(createTableHtml(cols, rows));\n        tableElm = getInsertedElement(editor);\n        tableElm.removeAttribute('data-mce-id');\n        cellElm = editor.dom.select('td,th', tableElm);\n        editor.selection.setCursorLocation(cellElm[0], 0);\n      });\n    };\n    var insertTable = function (editor, cols, rows) {\n      editor.plugins.table ? editor.plugins.table.insertTable(cols, rows) : insertTableHtml(editor, cols, rows);\n    };\n    var insertBlob = function (editor, base64, blob) {\n      var blobCache, blobInfo;\n      blobCache = editor.editorUpload.blobCache;\n      blobInfo = blobCache.create(generate('mceu'), blob, base64);\n      blobCache.add(blobInfo);\n      editor.insertContent(editor.dom.createHTML('img', { src: blobInfo.blobUri() }));\n    };\n    var Actions = {\n      insertTable: insertTable,\n      insertBlob: insertBlob\n    };\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.Promise');\n\n    var blobToBase64 = function (blob) {\n      return new global$1(function (resolve) {\n        var reader = new domGlobals.FileReader();\n        reader.onloadend = function () {\n          resolve(reader.result.split(',')[1]);\n        };\n        reader.readAsDataURL(blob);\n      });\n    };\n    var Conversions = { blobToBase64: blobToBase64 };\n\n    var pickFile = function () {\n      return new global$1(function (resolve) {\n        var fileInput;\n        fileInput = domGlobals.document.createElement('input');\n        fileInput.type = 'file';\n        fileInput.style.position = 'fixed';\n        fileInput.style.left = 0;\n        fileInput.style.top = 0;\n        fileInput.style.opacity = 0.001;\n        domGlobals.document.body.appendChild(fileInput);\n        fileInput.onchange = function (e) {\n          resolve(Array.prototype.slice.call(e.target.files));\n        };\n        fileInput.click();\n        fileInput.parentNode.removeChild(fileInput);\n      });\n    };\n    var Picker = { pickFile: pickFile };\n\n    var setupButtons = function (editor) {\n      editor.ui.registry.addButton('quickimage', {\n        icon: 'image',\n        tooltip: 'Insert image',\n        onAction: function () {\n          Picker.pickFile().then(function (files) {\n            var blob = files[0];\n            Conversions.blobToBase64(blob).then(function (base64) {\n              Actions.insertBlob(editor, base64, blob);\n            });\n          });\n        }\n      });\n      editor.ui.registry.addButton('quicktable', {\n        icon: 'table',\n        tooltip: 'Insert table',\n        onAction: function () {\n          Actions.insertTable(editor, 2, 2);\n        }\n      });\n    };\n    var InsertButtons = { setupButtons: setupButtons };\n\n    var noop = function () {\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      if (Object.freeze) {\n        Object.freeze(me);\n      }\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Option = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || domGlobals.document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        domGlobals.console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: constant(node) };\n    };\n    var fromPoint = function (docElm, x, y) {\n      var doc = docElm.dom();\n      return Option.from(doc.elementFromPoint(x, y)).map(fromDom);\n    };\n    var Element = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    var ATTRIBUTE = domGlobals.Node.ATTRIBUTE_NODE;\n    var CDATA_SECTION = domGlobals.Node.CDATA_SECTION_NODE;\n    var COMMENT = domGlobals.Node.COMMENT_NODE;\n    var DOCUMENT = domGlobals.Node.DOCUMENT_NODE;\n    var DOCUMENT_TYPE = domGlobals.Node.DOCUMENT_TYPE_NODE;\n    var DOCUMENT_FRAGMENT = domGlobals.Node.DOCUMENT_FRAGMENT_NODE;\n    var ELEMENT = domGlobals.Node.ELEMENT_NODE;\n    var TEXT = domGlobals.Node.TEXT_NODE;\n    var PROCESSING_INSTRUCTION = domGlobals.Node.PROCESSING_INSTRUCTION_NODE;\n    var ENTITY_REFERENCE = domGlobals.Node.ENTITY_REFERENCE_NODE;\n    var ENTITY = domGlobals.Node.ENTITY_NODE;\n    var NOTATION = domGlobals.Node.NOTATION_NODE;\n\n    var Global = typeof domGlobals.window !== 'undefined' ? domGlobals.window : Function('return this;')();\n\n    var name = function (element) {\n      var r = element.dom().nodeName;\n      return r.toLowerCase();\n    };\n\n    var typeOf = function (x) {\n      if (x === null) {\n        return 'null';\n      }\n      var t = typeof x;\n      if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      }\n      if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      }\n      return t;\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isString = isType('string');\n    var isObject = isType('object');\n    var isArray = isType('array');\n    var isBoolean = isType('boolean');\n    var isUndefined = isType('undefined');\n    var isFunction = isType('function');\n\n    var nativeSlice = Array.prototype.slice;\n    var find = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Option.some(x);\n        }\n      }\n      return Option.none();\n    };\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n\n    function ClosestOrAncestor (is, ancestor, scope, a, isRoot) {\n      return is(scope, a) ? Option.some(scope) : isFunction(isRoot) && isRoot(scope) ? Option.none() : ancestor(scope, a, isRoot);\n    }\n\n    var compareDocumentPosition = function (a, b, match) {\n      return (a.compareDocumentPosition(b) & match) !== 0;\n    };\n    var documentPositionPreceding = function (a, b) {\n      return compareDocumentPosition(a, b, domGlobals.Node.DOCUMENT_POSITION_PRECEDING);\n    };\n    var documentPositionContainedBy = function (a, b) {\n      return compareDocumentPosition(a, b, domGlobals.Node.DOCUMENT_POSITION_CONTAINED_BY);\n    };\n    var Node = {\n      documentPositionPreceding: documentPositionPreceding,\n      documentPositionContainedBy: documentPositionContainedBy\n    };\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      var clone = function () {\n        return Cell(get());\n      };\n      return {\n        get: get,\n        set: set,\n        clone: clone\n      };\n    };\n\n    var firstMatch = function (regexes, s) {\n      for (var i = 0; i < regexes.length; i++) {\n        var x = regexes[i];\n        if (x.test(s)) {\n          return x;\n        }\n      }\n      return undefined;\n    };\n    var find$1 = function (regexes, agent) {\n      var r = firstMatch(regexes, agent);\n      if (!r) {\n        return {\n          major: 0,\n          minor: 0\n        };\n      }\n      var group = function (i) {\n        return Number(agent.replace(r, '$' + i));\n      };\n      return nu(group(1), group(2));\n    };\n    var detect = function (versionRegexes, agent) {\n      var cleanedAgent = String(agent).toLowerCase();\n      if (versionRegexes.length === 0) {\n        return unknown();\n      }\n      return find$1(versionRegexes, cleanedAgent);\n    };\n    var unknown = function () {\n      return nu(0, 0);\n    };\n    var nu = function (major, minor) {\n      return {\n        major: major,\n        minor: minor\n      };\n    };\n    var Version = {\n      nu: nu,\n      detect: detect,\n      unknown: unknown\n    };\n\n    var edge = 'Edge';\n    var chrome = 'Chrome';\n    var ie = 'IE';\n    var opera = 'Opera';\n    var firefox = 'Firefox';\n    var safari = 'Safari';\n    var isBrowser = function (name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n    var unknown$1 = function () {\n      return nu$1({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$1 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isEdge: isBrowser(edge, current),\n        isChrome: isBrowser(chrome, current),\n        isIE: isBrowser(ie, current),\n        isOpera: isBrowser(opera, current),\n        isFirefox: isBrowser(firefox, current),\n        isSafari: isBrowser(safari, current)\n      };\n    };\n    var Browser = {\n      unknown: unknown$1,\n      nu: nu$1,\n      edge: constant(edge),\n      chrome: constant(chrome),\n      ie: constant(ie),\n      opera: constant(opera),\n      firefox: constant(firefox),\n      safari: constant(safari)\n    };\n\n    var windows = 'Windows';\n    var ios = 'iOS';\n    var android = 'Android';\n    var linux = 'Linux';\n    var osx = 'OSX';\n    var solaris = 'Solaris';\n    var freebsd = 'FreeBSD';\n    var isOS = function (name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n    var unknown$2 = function () {\n      return nu$2({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$2 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isWindows: isOS(windows, current),\n        isiOS: isOS(ios, current),\n        isAndroid: isOS(android, current),\n        isOSX: isOS(osx, current),\n        isLinux: isOS(linux, current),\n        isSolaris: isOS(solaris, current),\n        isFreeBSD: isOS(freebsd, current)\n      };\n    };\n    var OperatingSystem = {\n      unknown: unknown$2,\n      nu: nu$2,\n      windows: constant(windows),\n      ios: constant(ios),\n      android: constant(android),\n      linux: constant(linux),\n      osx: constant(osx),\n      solaris: constant(solaris),\n      freebsd: constant(freebsd)\n    };\n\n    var DeviceType = function (os, browser, userAgent, mediaMatch) {\n      var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n      var isiPhone = os.isiOS() && !isiPad;\n      var isMobile = os.isiOS() || os.isAndroid();\n      var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n      var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n      var isPhone = isiPhone || isMobile && !isTablet;\n      var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n      var isDesktop = !isPhone && !isTablet && !iOSwebview;\n      return {\n        isiPad: constant(isiPad),\n        isiPhone: constant(isiPhone),\n        isTablet: constant(isTablet),\n        isPhone: constant(isPhone),\n        isTouch: constant(isTouch),\n        isAndroid: os.isAndroid,\n        isiOS: os.isiOS,\n        isWebView: constant(iOSwebview),\n        isDesktop: constant(isDesktop)\n      };\n    };\n\n    var detect$1 = function (candidates, userAgent) {\n      var agent = String(userAgent).toLowerCase();\n      return find(candidates, function (candidate) {\n        return candidate.search(agent);\n      });\n    };\n    var detectBrowser = function (browsers, userAgent) {\n      return detect$1(browsers, userAgent).map(function (browser) {\n        var version = Version.detect(browser.versionRegexes, userAgent);\n        return {\n          current: browser.name,\n          version: version\n        };\n      });\n    };\n    var detectOs = function (oses, userAgent) {\n      return detect$1(oses, userAgent).map(function (os) {\n        var version = Version.detect(os.versionRegexes, userAgent);\n        return {\n          current: os.name,\n          version: version\n        };\n      });\n    };\n    var UaString = {\n      detectBrowser: detectBrowser,\n      detectOs: detectOs\n    };\n\n    var contains = function (str, substr) {\n      return str.indexOf(substr) !== -1;\n    };\n\n    var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n    var checkContains = function (target) {\n      return function (uastring) {\n        return contains(uastring, target);\n      };\n    };\n    var browsers = [\n      {\n        name: 'Edge',\n        versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n        search: function (uastring) {\n          return contains(uastring, 'edge/') && contains(uastring, 'chrome') && contains(uastring, 'safari') && contains(uastring, 'applewebkit');\n        }\n      },\n      {\n        name: 'Chrome',\n        versionRegexes: [\n          /.*?chrome\\/([0-9]+)\\.([0-9]+).*/,\n          normalVersionRegex\n        ],\n        search: function (uastring) {\n          return contains(uastring, 'chrome') && !contains(uastring, 'chromeframe');\n        }\n      },\n      {\n        name: 'IE',\n        versionRegexes: [\n          /.*?msie\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*?rv:([0-9]+)\\.([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return contains(uastring, 'msie') || contains(uastring, 'trident');\n        }\n      },\n      {\n        name: 'Opera',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?opera\\/([0-9]+)\\.([0-9]+).*/\n        ],\n        search: checkContains('opera')\n      },\n      {\n        name: 'Firefox',\n        versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n        search: checkContains('firefox')\n      },\n      {\n        name: 'Safari',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?cpu os ([0-9]+)_([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return (contains(uastring, 'safari') || contains(uastring, 'mobile/')) && contains(uastring, 'applewebkit');\n        }\n      }\n    ];\n    var oses = [\n      {\n        name: 'Windows',\n        search: checkContains('win'),\n        versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'iOS',\n        search: function (uastring) {\n          return contains(uastring, 'iphone') || contains(uastring, 'ipad');\n        },\n        versionRegexes: [\n          /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*cpu os ([0-9]+)_([0-9]+).*/,\n          /.*cpu iphone os ([0-9]+)_([0-9]+).*/\n        ]\n      },\n      {\n        name: 'Android',\n        search: checkContains('android'),\n        versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'OSX',\n        search: checkContains('os x'),\n        versionRegexes: [/.*?os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n      },\n      {\n        name: 'Linux',\n        search: checkContains('linux'),\n        versionRegexes: []\n      },\n      {\n        name: 'Solaris',\n        search: checkContains('sunos'),\n        versionRegexes: []\n      },\n      {\n        name: 'FreeBSD',\n        search: checkContains('freebsd'),\n        versionRegexes: []\n      }\n    ];\n    var PlatformInfo = {\n      browsers: constant(browsers),\n      oses: constant(oses)\n    };\n\n    var detect$2 = function (userAgent, mediaMatch) {\n      var browsers = PlatformInfo.browsers();\n      var oses = PlatformInfo.oses();\n      var browser = UaString.detectBrowser(browsers, userAgent).fold(Browser.unknown, Browser.nu);\n      var os = UaString.detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n      var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n      return {\n        browser: browser,\n        os: os,\n        deviceType: deviceType\n      };\n    };\n    var PlatformDetection = { detect: detect$2 };\n\n    var mediaMatch = function (query) {\n      return domGlobals.window.matchMedia(query).matches;\n    };\n    var platform = Cell(PlatformDetection.detect(domGlobals.navigator.userAgent, mediaMatch));\n    var detect$3 = function () {\n      return platform.get();\n    };\n\n    var ELEMENT$1 = ELEMENT;\n    var is = function (element, selector) {\n      var dom = element.dom();\n      if (dom.nodeType !== ELEMENT$1) {\n        return false;\n      } else {\n        var elem = dom;\n        if (elem.matches !== undefined) {\n          return elem.matches(selector);\n        } else if (elem.msMatchesSelector !== undefined) {\n          return elem.msMatchesSelector(selector);\n        } else if (elem.webkitMatchesSelector !== undefined) {\n          return elem.webkitMatchesSelector(selector);\n        } else if (elem.mozMatchesSelector !== undefined) {\n          return elem.mozMatchesSelector(selector);\n        } else {\n          throw new Error('Browser lacks native selectors');\n        }\n      }\n    };\n\n    var regularContains = function (e1, e2) {\n      var d1 = e1.dom();\n      var d2 = e2.dom();\n      return d1 === d2 ? false : d1.contains(d2);\n    };\n    var ieContains = function (e1, e2) {\n      return Node.documentPositionContainedBy(e1.dom(), e2.dom());\n    };\n    var browser = detect$3().browser;\n    var contains$1 = browser.isIE() ? ieContains : regularContains;\n\n    var ancestor = function (scope, predicate, isRoot) {\n      var element = scope.dom();\n      var stop = isFunction(isRoot) ? isRoot : constant(false);\n      while (element.parentNode) {\n        element = element.parentNode;\n        var el = Element.fromDom(element);\n        if (predicate(el)) {\n          return Option.some(el);\n        } else if (stop(el)) {\n          break;\n        }\n      }\n      return Option.none();\n    };\n    var closest = function (scope, predicate, isRoot) {\n      var is = function (s, test) {\n        return test(s);\n      };\n      return ClosestOrAncestor(is, ancestor, scope, predicate, isRoot);\n    };\n\n    var ancestor$1 = function (scope, selector, isRoot) {\n      return ancestor(scope, function (e) {\n        return is(e, selector);\n      }, isRoot);\n    };\n    var closest$1 = function (scope, selector, isRoot) {\n      return ClosestOrAncestor(is, ancestor$1, scope, selector, isRoot);\n    };\n\n    var validDefaultOrDie = function (value, predicate) {\n      if (predicate(value)) {\n        return true;\n      }\n      throw new Error('Default value doesn\\'t match requested type.');\n    };\n    var items = function (value, defaultValue) {\n      if (isArray(value) || isObject(value)) {\n        throw new Error('expected a string but found: ' + value);\n      }\n      if (isUndefined(value)) {\n        return defaultValue;\n      }\n      if (isBoolean(value)) {\n        return value === false ? '' : defaultValue;\n      }\n      return value;\n    };\n    var getToolbarItemsOr = function (predicate) {\n      return function (editor, name, defaultValue) {\n        validDefaultOrDie(defaultValue, predicate);\n        var value = editor.getParam(name, defaultValue);\n        return items(value, defaultValue);\n      };\n    };\n    var EditorSettings = { getToolbarItemsOr: getToolbarItemsOr(isString) };\n\n    var getTextSelectionToolbarItems = function (editor) {\n      return EditorSettings.getToolbarItemsOr(editor, 'quickbars_selection_toolbar', 'bold italic | quicklink h2 h3 blockquote');\n    };\n    var getInsertToolbarItems = function (editor) {\n      return EditorSettings.getToolbarItemsOr(editor, 'quickbars_insert_toolbar', 'quickimage quicktable');\n    };\n    var Settings = {\n      getTextSelectionToolbarItems: getTextSelectionToolbarItems,\n      getInsertToolbarItems: getInsertToolbarItems\n    };\n\n    var addToEditor = function (editor) {\n      var insertToolbarItems = Settings.getInsertToolbarItems(editor);\n      if (insertToolbarItems.trim().length > 0) {\n        editor.ui.registry.addContextToolbar('quickblock', {\n          predicate: function (node) {\n            var sugarNode = Element.fromDom(node);\n            var textBlockElementsMap = editor.schema.getTextBlockElements();\n            var isRoot = function (elem) {\n              return elem.dom() === editor.getBody();\n            };\n            return closest$1(sugarNode, 'table', isRoot).fold(function () {\n              return closest(sugarNode, function (elem) {\n                return name(elem) in textBlockElementsMap && editor.dom.isEmpty(elem.dom());\n              }, isRoot).isSome();\n            }, function () {\n              return false;\n            });\n          },\n          items: insertToolbarItems,\n          position: 'line',\n          scope: 'editor'\n        });\n      }\n    };\n    var InsertToolbars = { addToEditor: addToEditor };\n\n    var addToEditor$1 = function (editor) {\n      editor.ui.registry.addContextToolbar('imageselection', {\n        predicate: function (node) {\n          return node.nodeName === 'IMG' || node.nodeName === 'FIGURE' && /image/i.test(node.className);\n        },\n        items: 'alignleft aligncenter alignright',\n        position: 'node'\n      });\n      var textToolbarItems = Settings.getTextSelectionToolbarItems(editor);\n      if (textToolbarItems.trim().length > 0) {\n        editor.ui.registry.addContextToolbar('textselection', {\n          predicate: function (node) {\n            return !editor.selection.isCollapsed();\n          },\n          items: textToolbarItems,\n          position: 'selection'\n        });\n      }\n    };\n    var SelectionToolbars = { addToEditor: addToEditor$1 };\n\n    function Plugin () {\n      global.add('quickbars', function (editor) {\n        InsertButtons.setupButtons(editor);\n        InsertToolbars.addToEditor(editor);\n        SelectionToolbars.addToEditor(editor);\n      });\n    }\n\n    Plugin();\n\n}(window));\n"]}