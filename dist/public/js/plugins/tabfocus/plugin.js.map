{"version":3,"sources":["../../../../../public/js/plugins/tabfocus/plugin.js"],"names":["domGlobals","global","tinymce","util","Tools","resolve","global$1","global$2","global$3","global$4","global$5","global$6","getTabFocusElements","editor","getParam","getTabFocus","Settings","DOM","tabCancel","e","keyCode","TAB","ctrlKey","altKey","metaKey","preventDefault","setup","tabHandler","x","el","v","i","isDefaultPrevented","find","direction","select","canSelectRecursive","nodeName","type","style","display","visibility","parentNode","canSelect","test","tagName","get","id","tabIndex","each","length","explode","shiftKey","focusEditor","name","focus","setTimeout","webkit","window","on","inline","setAttrib","getBody","gecko","Keyboard","Plugin","add"],"mappings":"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","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.1.0 (2019-10-17)\n */\n(function (domGlobals) {\n    'use strict';\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.EditorManager');\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.Env');\n\n    var global$4 = tinymce.util.Tools.resolve('tinymce.util.Delay');\n\n    var global$5 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var global$6 = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n    var getTabFocusElements = function (editor) {\n      return editor.getParam('tabfocus_elements', ':prev,:next');\n    };\n    var getTabFocus = function (editor) {\n      return editor.getParam('tab_focus', getTabFocusElements(editor));\n    };\n    var Settings = { getTabFocus: getTabFocus };\n\n    var DOM = global$1.DOM;\n    var tabCancel = function (e) {\n      if (e.keyCode === global$6.TAB && !e.ctrlKey && !e.altKey && !e.metaKey) {\n        e.preventDefault();\n      }\n    };\n    var setup = function (editor) {\n      function tabHandler(e) {\n        var x, el, v, i;\n        if (e.keyCode !== global$6.TAB || e.ctrlKey || e.altKey || e.metaKey || e.isDefaultPrevented()) {\n          return;\n        }\n        function find(direction) {\n          el = DOM.select(':input:enabled,*[tabindex]:not(iframe)');\n          function canSelectRecursive(e) {\n            return e.nodeName === 'BODY' || e.type !== 'hidden' && e.style.display !== 'none' && e.style.visibility !== 'hidden' && canSelectRecursive(e.parentNode);\n          }\n          function canSelect(el) {\n            return /INPUT|TEXTAREA|BUTTON/.test(el.tagName) && global$2.get(e.id) && el.tabIndex !== -1 && canSelectRecursive(el);\n          }\n          global$5.each(el, function (e, i) {\n            if (e.id === editor.id) {\n              x = i;\n              return false;\n            }\n          });\n          if (direction > 0) {\n            for (i = x + 1; i < el.length; i++) {\n              if (canSelect(el[i])) {\n                return el[i];\n              }\n            }\n          } else {\n            for (i = x - 1; i >= 0; i--) {\n              if (canSelect(el[i])) {\n                return el[i];\n              }\n            }\n          }\n          return null;\n        }\n        v = global$5.explode(Settings.getTabFocus(editor));\n        if (v.length === 1) {\n          v[1] = v[0];\n          v[0] = ':prev';\n        }\n        if (e.shiftKey) {\n          if (v[0] === ':prev') {\n            el = find(-1);\n          } else {\n            el = DOM.get(v[0]);\n          }\n        } else {\n          if (v[1] === ':next') {\n            el = find(1);\n          } else {\n            el = DOM.get(v[1]);\n          }\n        }\n        if (el) {\n          var focusEditor = global$2.get(el.id || el.name);\n          if (el.id && focusEditor) {\n            focusEditor.focus();\n          } else {\n            global$4.setTimeout(function () {\n              if (!global$3.webkit) {\n                domGlobals.window.focus();\n              }\n              el.focus();\n            }, 10);\n          }\n          e.preventDefault();\n        }\n      }\n      editor.on('init', function () {\n        if (editor.inline) {\n          DOM.setAttrib(editor.getBody(), 'tabIndex', null);\n        }\n        editor.on('keyup', tabCancel);\n        if (global$3.gecko) {\n          editor.on('keypress keydown', tabHandler);\n        } else {\n          editor.on('keydown', tabHandler);\n        }\n      });\n    };\n    var Keyboard = { setup: setup };\n\n    function Plugin () {\n      global.add('tabfocus', function (editor) {\n        Keyboard.setup(editor);\n      });\n    }\n\n    Plugin();\n\n}(window));\n"]}