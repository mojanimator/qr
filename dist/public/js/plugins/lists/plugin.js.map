{"version":3,"sources":["../../../../../public/js/plugins/lists/plugin.js"],"names":["domGlobals","global","tinymce","util","Tools","resolve","noop","constant","value","not","f","args","_i","arguments","length","apply","never","always","none","NONE","eq","o","isNone","call","thunk","id","n","me","fold","s","is","isSome","getOr","getOrThunk","getOrDie","msg","Error","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","Object","freeze","some","a","constant_a","self","v","elementEq","b","from","Option","typeOf","x","t","Array","prototype","isPrototypeOf","constructor","name","String","isType","type","isString","isArray","isBoolean","isFunction","isNumber","nativeSlice","slice","nativePush","push","xs","len","r","i","pred","groupBy","wasType","group","foldl","acc","find","flatten","output","reverse","head","last","from$1","compareDocumentPosition","match","documentPositionPreceding","Node","DOCUMENT_POSITION_PRECEDING","documentPositionContainedBy","DOCUMENT_POSITION_CONTAINED_BY","Cell","initial","get","set","clone","firstMatch","regexes","test","find$1","agent","major","minor","Number","replace","nu","detect","versionRegexes","cleanedAgent","toLowerCase","unknown","Version","edge","chrome","ie","opera","firefox","safari","isBrowser","current","unknown$1","nu$1","version","info","isEdge","isChrome","isIE","isOpera","isFirefox","isSafari","Browser","windows","ios","android","linux","osx","solaris","freebsd","isOS","unknown$2","nu$2","isWindows","isiOS","isAndroid","isOSX","isLinux","isSolaris","isFreeBSD","OperatingSystem","DeviceType","os","browser","userAgent","mediaMatch","isiPad","isiPhone","isMobile","isTouch","isTablet","isPhone","iOSwebview","isDesktop","isWebView","detect$1","candidates","candidate","search","detectBrowser","browsers","detectOs","oses","UaString","contains","str","substr","indexOf","normalVersionRegex","checkContains","target","uastring","PlatformInfo","detect$2","deviceType","PlatformDetection","query","window","matchMedia","matches","platform","navigator","detect$3","fromHtml","html","scope","doc","document","div","createElement","innerHTML","hasChildNodes","childNodes","console","error","fromDom","fromTag","tag","node","fromText","text","createTextNode","dom","fromPoint","docElm","y","elementFromPoint","Element","ATTRIBUTE","ATTRIBUTE_NODE","CDATA_SECTION","CDATA_SECTION_NODE","COMMENT","COMMENT_NODE","DOCUMENT","DOCUMENT_NODE","DOCUMENT_TYPE","DOCUMENT_TYPE_NODE","DOCUMENT_FRAGMENT","DOCUMENT_FRAGMENT_NODE","ELEMENT","ELEMENT_NODE","TEXT","TEXT_NODE","PROCESSING_INSTRUCTION","PROCESSING_INSTRUCTION_NODE","ENTITY_REFERENCE","ENTITY_REFERENCE_NODE","ENTITY","ENTITY_NODE","NOTATION","NOTATION_NODE","ELEMENT$1","element","selector","nodeType","elem","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","e1","e2","regularContains","d1","d2","ieContains","contains$1","is$1","global$1","global$2","global$3","lift2","oa","ob","fromElements","elements","fragment","createDocumentFragment","appendChild","Immutable","fields","values","struct","keys","each$1","obj","props","k","parent","parentNode","children","child","index","cs","firstChild","lastChild","spot","before","marker","parent$1","insertBefore","append","before$1","append$1","remove","removeChild","fireListEvent","editor","action","fire","Global","Function","path","parts","p","split","unsafe","actual","Global$1","htmlElement","HTMLElement","global$4","global$5","isTextNode","isListNode","nodeName","isOlUlNode","isListItemNode","isDlItemNode","isTableCellNode","isBr","isFirstChild","isLastChild","isTextBlock","schema","getTextBlockElements","isBlock","blockElements","isBogusBr","nextSibling","previousSibling","isEmpty","elm","keepBookmarks","empty","select","isChildOfBody","isChildOf","getRoot","NodeType","getParentList","selectionStart","selection","getStart","getParent","getClosestListRootElm","isParentListSelected","parentList","selectedBlocks","findSubLists","grep","querySelectorAll","getSelectedSubLists","getSelectedBlocks","findParentListItemsNodes","elms","listItemsElms","parentLi","unique","getSelectedListItems","block","getSelectedDlItems","parentTableCell","getParents","root","getBody","findLastParentListNode","parentLists","getSelectedLists","firstList","subsequentLists","concat","getSelectedListRoots","selectedLists","getUniqueListRoots","lists","listRoots","list","isList","Selection","createTextBlock","contentNode","getBlockElements","createFragment","textBlock","blockName","hasContentNode","settings","forced_root_block","create","tagName","setAttribs","forced_root_block_attrs","getAttribute","isType$1","isElement","rawSet","key","setAttribute","setAll","attrs","attributes","attr","isSupported","style","getPropertyValue","internalSet","property","setProperty","clone$1","original","isDeep","cloneNode","deep","shallowAs","mutate","children$1","joinSegment","item","joinSegments","segments","appendSegments","head$1","tail","createSegment","listType","segment","createSegments","entry","size","populateSegments","listAttributes","itemAttributes","content","normalizeSegment","createItem","appendItem","writeShallow","cast","newCast","depth","writeDeep","composeList","entries","isList$1","el","hasFirstChildList","hasLastChildList","isIndented","isSelected","cloneItemContent","li","createEntry","indentEntry","indentation","hasOwnProperty","shallow","old","baseMerge","merger","objects","ret","j","curObject","merge","cloneListProperties","source","previousSiblingEntry","start","normalizeEntries","matchingEntry","parseItem","itemSelection","selectionState","currentItemEntry","end","childListEntries","parseList","parser","newDepth","parseLists","initialDepth","sourceList","outdentedComposer","indentedComposer","contentDocument","composeEntries","groupIsIndented","indentSelectedEntries","getItemSelection","selectedListItems","listIndentation","entrySets","entrySet","composedLists","composedList","global$6","DOM","splitList","ul","tmpRng","bookmarks","newBlock","removeAndKeepBookmarks","targetNode","createRng","setStartAfter","setEndAfter","extractContents","insertAfter","SplitList","outdentDlItem","dl","indentDlItem","dlIndentation","dlItems","getNormalizedPoint","container","offset","getNode","data","normalizeRange","rng","outRng","cloneRange","rangeStart","startContainer","startOffset","setStart","rangeEnd","endContainer","endOffset","setEnd","Range","selectionIndentation","isHandled","bookmark","getBookmark","moveToBookmark","setRng","getRng","nodeChanged","indentListSelection","outdentListSelection","flattenListSelection","global$7","DOM$1","createBookmark","setupEndPoint","offsetNode","Math","min","collapsed","resolveBookmark","restoreEndPoint","nodeIndex","idx","Bookmark","isCustomList","className","listToggleActionFromListName","listName","updateListStyle","detail","setStyle","updateListAttrs","updateListWithDetails","removeStyles","styles","_a","getEndPointNode","getSelectedTextBlocks","textBlocks","startNode","endNode","siblings","isBookmarkNode","hasCompatibleStyle","sib","sibStyle","getStyle","detailStyle","applyList","listItemName","getContentEditable","toUpperCase","listBlock","sibling","rename","mergeWithAdjacentLists","isValidLists","list1","list2","hasSameListStyle","targetStyle","hasSameClasses","elm1","elm2","shouldMerge","updateList","newList","toggleMultipleLists","hasListStyleDetail","toggleSingleList","toggleList","selectedSubLists","ToggleList","DOM$2","normalizeList","normalizeLists","NormalizeLists","findNextCaretContainer","isForward","nonEmptyBlocks","getNonEmptyElements","walker","next","hasOnlyOneBlockChild","unwrapSingleBlockChild","moveChildren","fromElm","toElm","targetElm","mergeLiElements","listNode","$","nestedLists","mergeIntoEmptyLi","fromLi","toLi","setCursorLocation","mergeForward","mergeBackward","resolvedBookmark","backspaceDeleteFromListToListCaret","selectionStartElm","rng_1","otherLi_1","undoManager","transact","removeBlock","parentBlock","backspaceDeleteIntoListCaret","otherLi_2","collapse","backspaceDeleteCaret","backspaceDeleteRange","startListParent","execCommand","backspaceDelete","isCollapsed","setup","on","e","keyCode","BACKSPACE","preventDefault","DELETE","Delete","Api","queryListCommandState","register","cmd","command","addCommand","ui","addQueryStateHandler","Commands","shouldIndentOnTab","getParam","Settings","setupTabKey","TAB","metaKeyPressed","shiftKey","setup$1","Keyboard","findIndex","predicate","listState","buttonApi","nodeChangeHandler","tableCellIndex","parents","setActive","off","register$1","hasPlugin","plugin","plugins","inArray","exec","registry","addToggleButton","icon","active","tooltip","onAction","onSetup","Buttons","Plugin","add"],"mappings":"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","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.1.0 (2019-10-17)\n */\n(function (domGlobals) {\n    'use strict';\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var noop = function () {\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var not = function (f) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return !f.apply(null, args);\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      if (Object.freeze) {\n        Object.freeze(me);\n      }\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Option = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var typeOf = function (x) {\n      if (x === null) {\n        return 'null';\n      }\n      var t = typeof x;\n      if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      }\n      if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      }\n      return t;\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isString = isType('string');\n    var isArray = isType('array');\n    var isBoolean = isType('boolean');\n    var isFunction = isType('function');\n    var isNumber = isType('number');\n\n    var nativeSlice = Array.prototype.slice;\n    var nativePush = Array.prototype.push;\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var filter = function (xs, pred) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          r.push(x);\n        }\n      }\n      return r;\n    };\n    var groupBy = function (xs, f) {\n      if (xs.length === 0) {\n        return [];\n      } else {\n        var wasType = f(xs[0]);\n        var r = [];\n        var group = [];\n        for (var i = 0, len = xs.length; i < len; i++) {\n          var x = xs[i];\n          var type = f(x);\n          if (type !== wasType) {\n            r.push(group);\n            group = [];\n          }\n          wasType = type;\n          group.push(x);\n        }\n        if (group.length !== 0) {\n          r.push(group);\n        }\n        return r;\n      }\n    };\n    var foldl = function (xs, f, acc) {\n      each(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var find = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Option.some(x);\n        }\n      }\n      return Option.none();\n    };\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var bind = function (xs, f) {\n      var output = map(xs, f);\n      return flatten(output);\n    };\n    var reverse = function (xs) {\n      var r = nativeSlice.call(xs, 0);\n      r.reverse();\n      return r;\n    };\n    var head = function (xs) {\n      return xs.length === 0 ? Option.none() : Option.some(xs[0]);\n    };\n    var last = function (xs) {\n      return xs.length === 0 ? Option.none() : Option.some(xs[xs.length - 1]);\n    };\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n\n    var compareDocumentPosition = function (a, b, match) {\n      return (a.compareDocumentPosition(b) & match) !== 0;\n    };\n    var documentPositionPreceding = function (a, b) {\n      return compareDocumentPosition(a, b, domGlobals.Node.DOCUMENT_POSITION_PRECEDING);\n    };\n    var documentPositionContainedBy = function (a, b) {\n      return compareDocumentPosition(a, b, domGlobals.Node.DOCUMENT_POSITION_CONTAINED_BY);\n    };\n    var Node = {\n      documentPositionPreceding: documentPositionPreceding,\n      documentPositionContainedBy: documentPositionContainedBy\n    };\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      var clone = function () {\n        return Cell(get());\n      };\n      return {\n        get: get,\n        set: set,\n        clone: clone\n      };\n    };\n\n    var firstMatch = function (regexes, s) {\n      for (var i = 0; i < regexes.length; i++) {\n        var x = regexes[i];\n        if (x.test(s)) {\n          return x;\n        }\n      }\n      return undefined;\n    };\n    var find$1 = function (regexes, agent) {\n      var r = firstMatch(regexes, agent);\n      if (!r) {\n        return {\n          major: 0,\n          minor: 0\n        };\n      }\n      var group = function (i) {\n        return Number(agent.replace(r, '$' + i));\n      };\n      return nu(group(1), group(2));\n    };\n    var detect = function (versionRegexes, agent) {\n      var cleanedAgent = String(agent).toLowerCase();\n      if (versionRegexes.length === 0) {\n        return unknown();\n      }\n      return find$1(versionRegexes, cleanedAgent);\n    };\n    var unknown = function () {\n      return nu(0, 0);\n    };\n    var nu = function (major, minor) {\n      return {\n        major: major,\n        minor: minor\n      };\n    };\n    var Version = {\n      nu: nu,\n      detect: detect,\n      unknown: unknown\n    };\n\n    var edge = 'Edge';\n    var chrome = 'Chrome';\n    var ie = 'IE';\n    var opera = 'Opera';\n    var firefox = 'Firefox';\n    var safari = 'Safari';\n    var isBrowser = function (name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n    var unknown$1 = function () {\n      return nu$1({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$1 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isEdge: isBrowser(edge, current),\n        isChrome: isBrowser(chrome, current),\n        isIE: isBrowser(ie, current),\n        isOpera: isBrowser(opera, current),\n        isFirefox: isBrowser(firefox, current),\n        isSafari: isBrowser(safari, current)\n      };\n    };\n    var Browser = {\n      unknown: unknown$1,\n      nu: nu$1,\n      edge: constant(edge),\n      chrome: constant(chrome),\n      ie: constant(ie),\n      opera: constant(opera),\n      firefox: constant(firefox),\n      safari: constant(safari)\n    };\n\n    var windows = 'Windows';\n    var ios = 'iOS';\n    var android = 'Android';\n    var linux = 'Linux';\n    var osx = 'OSX';\n    var solaris = 'Solaris';\n    var freebsd = 'FreeBSD';\n    var isOS = function (name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n    var unknown$2 = function () {\n      return nu$2({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$2 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isWindows: isOS(windows, current),\n        isiOS: isOS(ios, current),\n        isAndroid: isOS(android, current),\n        isOSX: isOS(osx, current),\n        isLinux: isOS(linux, current),\n        isSolaris: isOS(solaris, current),\n        isFreeBSD: isOS(freebsd, current)\n      };\n    };\n    var OperatingSystem = {\n      unknown: unknown$2,\n      nu: nu$2,\n      windows: constant(windows),\n      ios: constant(ios),\n      android: constant(android),\n      linux: constant(linux),\n      osx: constant(osx),\n      solaris: constant(solaris),\n      freebsd: constant(freebsd)\n    };\n\n    var DeviceType = function (os, browser, userAgent, mediaMatch) {\n      var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n      var isiPhone = os.isiOS() && !isiPad;\n      var isMobile = os.isiOS() || os.isAndroid();\n      var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n      var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n      var isPhone = isiPhone || isMobile && !isTablet;\n      var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n      var isDesktop = !isPhone && !isTablet && !iOSwebview;\n      return {\n        isiPad: constant(isiPad),\n        isiPhone: constant(isiPhone),\n        isTablet: constant(isTablet),\n        isPhone: constant(isPhone),\n        isTouch: constant(isTouch),\n        isAndroid: os.isAndroid,\n        isiOS: os.isiOS,\n        isWebView: constant(iOSwebview),\n        isDesktop: constant(isDesktop)\n      };\n    };\n\n    var detect$1 = function (candidates, userAgent) {\n      var agent = String(userAgent).toLowerCase();\n      return find(candidates, function (candidate) {\n        return candidate.search(agent);\n      });\n    };\n    var detectBrowser = function (browsers, userAgent) {\n      return detect$1(browsers, userAgent).map(function (browser) {\n        var version = Version.detect(browser.versionRegexes, userAgent);\n        return {\n          current: browser.name,\n          version: version\n        };\n      });\n    };\n    var detectOs = function (oses, userAgent) {\n      return detect$1(oses, userAgent).map(function (os) {\n        var version = Version.detect(os.versionRegexes, userAgent);\n        return {\n          current: os.name,\n          version: version\n        };\n      });\n    };\n    var UaString = {\n      detectBrowser: detectBrowser,\n      detectOs: detectOs\n    };\n\n    var contains = function (str, substr) {\n      return str.indexOf(substr) !== -1;\n    };\n\n    var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n    var checkContains = function (target) {\n      return function (uastring) {\n        return contains(uastring, target);\n      };\n    };\n    var browsers = [\n      {\n        name: 'Edge',\n        versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n        search: function (uastring) {\n          return contains(uastring, 'edge/') && contains(uastring, 'chrome') && contains(uastring, 'safari') && contains(uastring, 'applewebkit');\n        }\n      },\n      {\n        name: 'Chrome',\n        versionRegexes: [\n          /.*?chrome\\/([0-9]+)\\.([0-9]+).*/,\n          normalVersionRegex\n        ],\n        search: function (uastring) {\n          return contains(uastring, 'chrome') && !contains(uastring, 'chromeframe');\n        }\n      },\n      {\n        name: 'IE',\n        versionRegexes: [\n          /.*?msie\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*?rv:([0-9]+)\\.([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return contains(uastring, 'msie') || contains(uastring, 'trident');\n        }\n      },\n      {\n        name: 'Opera',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?opera\\/([0-9]+)\\.([0-9]+).*/\n        ],\n        search: checkContains('opera')\n      },\n      {\n        name: 'Firefox',\n        versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n        search: checkContains('firefox')\n      },\n      {\n        name: 'Safari',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?cpu os ([0-9]+)_([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return (contains(uastring, 'safari') || contains(uastring, 'mobile/')) && contains(uastring, 'applewebkit');\n        }\n      }\n    ];\n    var oses = [\n      {\n        name: 'Windows',\n        search: checkContains('win'),\n        versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'iOS',\n        search: function (uastring) {\n          return contains(uastring, 'iphone') || contains(uastring, 'ipad');\n        },\n        versionRegexes: [\n          /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*cpu os ([0-9]+)_([0-9]+).*/,\n          /.*cpu iphone os ([0-9]+)_([0-9]+).*/\n        ]\n      },\n      {\n        name: 'Android',\n        search: checkContains('android'),\n        versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'OSX',\n        search: checkContains('os x'),\n        versionRegexes: [/.*?os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n      },\n      {\n        name: 'Linux',\n        search: checkContains('linux'),\n        versionRegexes: []\n      },\n      {\n        name: 'Solaris',\n        search: checkContains('sunos'),\n        versionRegexes: []\n      },\n      {\n        name: 'FreeBSD',\n        search: checkContains('freebsd'),\n        versionRegexes: []\n      }\n    ];\n    var PlatformInfo = {\n      browsers: constant(browsers),\n      oses: constant(oses)\n    };\n\n    var detect$2 = function (userAgent, mediaMatch) {\n      var browsers = PlatformInfo.browsers();\n      var oses = PlatformInfo.oses();\n      var browser = UaString.detectBrowser(browsers, userAgent).fold(Browser.unknown, Browser.nu);\n      var os = UaString.detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n      var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n      return {\n        browser: browser,\n        os: os,\n        deviceType: deviceType\n      };\n    };\n    var PlatformDetection = { detect: detect$2 };\n\n    var mediaMatch = function (query) {\n      return domGlobals.window.matchMedia(query).matches;\n    };\n    var platform = Cell(PlatformDetection.detect(domGlobals.navigator.userAgent, mediaMatch));\n    var detect$3 = function () {\n      return platform.get();\n    };\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || domGlobals.document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        domGlobals.console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: constant(node) };\n    };\n    var fromPoint = function (docElm, x, y) {\n      var doc = docElm.dom();\n      return Option.from(doc.elementFromPoint(x, y)).map(fromDom);\n    };\n    var Element = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    var ATTRIBUTE = domGlobals.Node.ATTRIBUTE_NODE;\n    var CDATA_SECTION = domGlobals.Node.CDATA_SECTION_NODE;\n    var COMMENT = domGlobals.Node.COMMENT_NODE;\n    var DOCUMENT = domGlobals.Node.DOCUMENT_NODE;\n    var DOCUMENT_TYPE = domGlobals.Node.DOCUMENT_TYPE_NODE;\n    var DOCUMENT_FRAGMENT = domGlobals.Node.DOCUMENT_FRAGMENT_NODE;\n    var ELEMENT = domGlobals.Node.ELEMENT_NODE;\n    var TEXT = domGlobals.Node.TEXT_NODE;\n    var PROCESSING_INSTRUCTION = domGlobals.Node.PROCESSING_INSTRUCTION_NODE;\n    var ENTITY_REFERENCE = domGlobals.Node.ENTITY_REFERENCE_NODE;\n    var ENTITY = domGlobals.Node.ENTITY_NODE;\n    var NOTATION = domGlobals.Node.NOTATION_NODE;\n\n    var ELEMENT$1 = ELEMENT;\n    var is = function (element, selector) {\n      var dom = element.dom();\n      if (dom.nodeType !== ELEMENT$1) {\n        return false;\n      } else {\n        var elem = dom;\n        if (elem.matches !== undefined) {\n          return elem.matches(selector);\n        } else if (elem.msMatchesSelector !== undefined) {\n          return elem.msMatchesSelector(selector);\n        } else if (elem.webkitMatchesSelector !== undefined) {\n          return elem.webkitMatchesSelector(selector);\n        } else if (elem.mozMatchesSelector !== undefined) {\n          return elem.mozMatchesSelector(selector);\n        } else {\n          throw new Error('Browser lacks native selectors');\n        }\n      }\n    };\n\n    var eq = function (e1, e2) {\n      return e1.dom() === e2.dom();\n    };\n    var regularContains = function (e1, e2) {\n      var d1 = e1.dom();\n      var d2 = e2.dom();\n      return d1 === d2 ? false : d1.contains(d2);\n    };\n    var ieContains = function (e1, e2) {\n      return Node.documentPositionContainedBy(e1.dom(), e2.dom());\n    };\n    var browser = detect$3().browser;\n    var contains$1 = browser.isIE() ? ieContains : regularContains;\n    var is$1 = is;\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.dom.RangeUtils');\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.dom.TreeWalker');\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n    var lift2 = function (oa, ob, f) {\n      return oa.isSome() && ob.isSome() ? Option.some(f(oa.getOrDie(), ob.getOrDie())) : Option.none();\n    };\n\n    var fromElements = function (elements, scope) {\n      var doc = scope || domGlobals.document;\n      var fragment = doc.createDocumentFragment();\n      each(elements, function (element) {\n        fragment.appendChild(element.dom());\n      });\n      return Element.fromDom(fragment);\n    };\n\n    var Immutable = function () {\n      var fields = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        fields[_i] = arguments[_i];\n      }\n      return function () {\n        var values = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          values[_i] = arguments[_i];\n        }\n        if (fields.length !== values.length) {\n          throw new Error('Wrong number of arguments to struct. Expected \"[' + fields.length + ']\", got ' + values.length + ' arguments');\n        }\n        var struct = {};\n        each(fields, function (name, i) {\n          struct[name] = constant(values[i]);\n        });\n        return struct;\n      };\n    };\n\n    var keys = Object.keys;\n    var each$1 = function (obj, f) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        f(x, i);\n      }\n    };\n\n    var parent = function (element) {\n      return Option.from(element.dom().parentNode).map(Element.fromDom);\n    };\n    var children = function (element) {\n      return map(element.dom().childNodes, Element.fromDom);\n    };\n    var child = function (element, index) {\n      var cs = element.dom().childNodes;\n      return Option.from(cs[index]).map(Element.fromDom);\n    };\n    var firstChild = function (element) {\n      return child(element, 0);\n    };\n    var lastChild = function (element) {\n      return child(element, element.dom().childNodes.length - 1);\n    };\n    var spot = Immutable('element', 'offset');\n\n    var before = function (marker, element) {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        v.dom().insertBefore(element.dom(), marker.dom());\n      });\n    };\n    var append = function (parent, element) {\n      parent.dom().appendChild(element.dom());\n    };\n\n    var before$1 = function (marker, elements) {\n      each(elements, function (x) {\n        before(marker, x);\n      });\n    };\n    var append$1 = function (parent, elements) {\n      each(elements, function (x) {\n        append(parent, x);\n      });\n    };\n\n    var remove = function (element) {\n      var dom = element.dom();\n      if (dom.parentNode !== null) {\n        dom.parentNode.removeChild(dom);\n      }\n    };\n\n    var fireListEvent = function (editor, action, element) {\n      return editor.fire('ListMutation', {\n        action: action,\n        element: element\n      });\n    };\n\n    var Global = typeof domGlobals.window !== 'undefined' ? domGlobals.window : Function('return this;')();\n\n    var path = function (parts, scope) {\n      var o = scope !== undefined && scope !== null ? scope : Global;\n      for (var i = 0; i < parts.length && o !== undefined && o !== null; ++i) {\n        o = o[parts[i]];\n      }\n      return o;\n    };\n    var resolve = function (p, scope) {\n      var parts = p.split('.');\n      return path(parts, scope);\n    };\n\n    var unsafe = function (name, scope) {\n      return resolve(name, scope);\n    };\n    var getOrDie = function (name, scope) {\n      var actual = unsafe(name, scope);\n      if (actual === undefined || actual === null) {\n        throw new Error(name + ' not available on this browser');\n      }\n      return actual;\n    };\n    var Global$1 = { getOrDie: getOrDie };\n\n    var htmlElement = function (scope) {\n      return Global$1.getOrDie('HTMLElement', scope);\n    };\n    var isPrototypeOf = function (x) {\n      var scope = resolve('ownerDocument.defaultView', x);\n      return htmlElement(scope).prototype.isPrototypeOf(x);\n    };\n    var HTMLElement = { isPrototypeOf: isPrototypeOf };\n\n    var global$4 = tinymce.util.Tools.resolve('tinymce.dom.DomQuery');\n\n    var global$5 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var isTextNode = function (node) {\n      return node && node.nodeType === 3;\n    };\n    var isListNode = function (node) {\n      return node && /^(OL|UL|DL)$/.test(node.nodeName);\n    };\n    var isOlUlNode = function (node) {\n      return node && /^(OL|UL)$/.test(node.nodeName);\n    };\n    var isListItemNode = function (node) {\n      return node && /^(LI|DT|DD)$/.test(node.nodeName);\n    };\n    var isDlItemNode = function (node) {\n      return node && /^(DT|DD)$/.test(node.nodeName);\n    };\n    var isTableCellNode = function (node) {\n      return node && /^(TH|TD)$/.test(node.nodeName);\n    };\n    var isBr = function (node) {\n      return node && node.nodeName === 'BR';\n    };\n    var isFirstChild = function (node) {\n      return node.parentNode.firstChild === node;\n    };\n    var isLastChild = function (node) {\n      return node.parentNode.lastChild === node;\n    };\n    var isTextBlock = function (editor, node) {\n      return node && !!editor.schema.getTextBlockElements()[node.nodeName];\n    };\n    var isBlock = function (node, blockElements) {\n      return node && node.nodeName in blockElements;\n    };\n    var isBogusBr = function (dom, node) {\n      if (!isBr(node)) {\n        return false;\n      }\n      if (dom.isBlock(node.nextSibling) && !isBr(node.previousSibling)) {\n        return true;\n      }\n      return false;\n    };\n    var isEmpty = function (dom, elm, keepBookmarks) {\n      var empty = dom.isEmpty(elm);\n      if (keepBookmarks && dom.select('span[data-mce-type=bookmark]', elm).length > 0) {\n        return false;\n      }\n      return empty;\n    };\n    var isChildOfBody = function (dom, elm) {\n      return dom.isChildOf(elm, dom.getRoot());\n    };\n    var NodeType = {\n      isTextNode: isTextNode,\n      isListNode: isListNode,\n      isOlUlNode: isOlUlNode,\n      isDlItemNode: isDlItemNode,\n      isListItemNode: isListItemNode,\n      isTableCellNode: isTableCellNode,\n      isBr: isBr,\n      isFirstChild: isFirstChild,\n      isLastChild: isLastChild,\n      isTextBlock: isTextBlock,\n      isBlock: isBlock,\n      isBogusBr: isBogusBr,\n      isEmpty: isEmpty,\n      isChildOfBody: isChildOfBody\n    };\n\n    var getParentList = function (editor) {\n      var selectionStart = editor.selection.getStart(true);\n      return editor.dom.getParent(selectionStart, 'OL,UL,DL', getClosestListRootElm(editor, selectionStart));\n    };\n    var isParentListSelected = function (parentList, selectedBlocks) {\n      return parentList && selectedBlocks.length === 1 && selectedBlocks[0] === parentList;\n    };\n    var findSubLists = function (parentList) {\n      return global$5.grep(parentList.querySelectorAll('ol,ul,dl'), function (elm) {\n        return NodeType.isListNode(elm);\n      });\n    };\n    var getSelectedSubLists = function (editor) {\n      var parentList = getParentList(editor);\n      var selectedBlocks = editor.selection.getSelectedBlocks();\n      if (isParentListSelected(parentList, selectedBlocks)) {\n        return findSubLists(parentList);\n      } else {\n        return global$5.grep(selectedBlocks, function (elm) {\n          return NodeType.isListNode(elm) && parentList !== elm;\n        });\n      }\n    };\n    var findParentListItemsNodes = function (editor, elms) {\n      var listItemsElms = global$5.map(elms, function (elm) {\n        var parentLi = editor.dom.getParent(elm, 'li,dd,dt', getClosestListRootElm(editor, elm));\n        return parentLi ? parentLi : elm;\n      });\n      return global$4.unique(listItemsElms);\n    };\n    var getSelectedListItems = function (editor) {\n      var selectedBlocks = editor.selection.getSelectedBlocks();\n      return global$5.grep(findParentListItemsNodes(editor, selectedBlocks), function (block) {\n        return NodeType.isListItemNode(block);\n      });\n    };\n    var getSelectedDlItems = function (editor) {\n      return filter(getSelectedListItems(editor), NodeType.isDlItemNode);\n    };\n    var getClosestListRootElm = function (editor, elm) {\n      var parentTableCell = editor.dom.getParents(elm, 'TD,TH');\n      var root = parentTableCell.length > 0 ? parentTableCell[0] : editor.getBody();\n      return root;\n    };\n    var findLastParentListNode = function (editor, elm) {\n      var parentLists = editor.dom.getParents(elm, 'ol,ul', getClosestListRootElm(editor, elm));\n      return last(parentLists);\n    };\n    var getSelectedLists = function (editor) {\n      var firstList = findLastParentListNode(editor, editor.selection.getStart());\n      var subsequentLists = filter(editor.selection.getSelectedBlocks(), NodeType.isOlUlNode);\n      return firstList.toArray().concat(subsequentLists);\n    };\n    var getSelectedListRoots = function (editor) {\n      var selectedLists = getSelectedLists(editor);\n      return getUniqueListRoots(editor, selectedLists);\n    };\n    var getUniqueListRoots = function (editor, lists) {\n      var listRoots = map(lists, function (list) {\n        return findLastParentListNode(editor, list).getOr(list);\n      });\n      return global$4.unique(listRoots);\n    };\n    var isList = function (editor) {\n      var list = getParentList(editor);\n      return HTMLElement.isPrototypeOf(list);\n    };\n    var Selection = {\n      isList: isList,\n      getParentList: getParentList,\n      getSelectedSubLists: getSelectedSubLists,\n      getSelectedListItems: getSelectedListItems,\n      getClosestListRootElm: getClosestListRootElm,\n      getSelectedDlItems: getSelectedDlItems,\n      getSelectedListRoots: getSelectedListRoots\n    };\n\n    var createTextBlock = function (editor, contentNode) {\n      var dom = editor.dom;\n      var blockElements = editor.schema.getBlockElements();\n      var fragment = dom.createFragment();\n      var node, textBlock, blockName, hasContentNode;\n      if (editor.settings.forced_root_block) {\n        blockName = editor.settings.forced_root_block;\n      }\n      if (blockName) {\n        textBlock = dom.create(blockName);\n        if (textBlock.tagName === editor.settings.forced_root_block) {\n          dom.setAttribs(textBlock, editor.settings.forced_root_block_attrs);\n        }\n        if (!NodeType.isBlock(contentNode.firstChild, blockElements)) {\n          fragment.appendChild(textBlock);\n        }\n      }\n      if (contentNode) {\n        while (node = contentNode.firstChild) {\n          var nodeName = node.nodeName;\n          if (!hasContentNode && (nodeName !== 'SPAN' || node.getAttribute('data-mce-type') !== 'bookmark')) {\n            hasContentNode = true;\n          }\n          if (NodeType.isBlock(node, blockElements)) {\n            fragment.appendChild(node);\n            textBlock = null;\n          } else {\n            if (blockName) {\n              if (!textBlock) {\n                textBlock = dom.create(blockName);\n                fragment.appendChild(textBlock);\n              }\n              textBlock.appendChild(node);\n            } else {\n              fragment.appendChild(node);\n            }\n          }\n        }\n      }\n      if (!editor.settings.forced_root_block) {\n        fragment.appendChild(dom.create('br'));\n      } else {\n        if (!hasContentNode) {\n          textBlock.appendChild(dom.create('br', { 'data-mce-bogus': '1' }));\n        }\n      }\n      return fragment;\n    };\n\n    var name = function (element) {\n      var r = element.dom().nodeName;\n      return r.toLowerCase();\n    };\n    var type = function (element) {\n      return element.dom().nodeType;\n    };\n    var isType$1 = function (t) {\n      return function (element) {\n        return type(element) === t;\n      };\n    };\n    var isElement = isType$1(ELEMENT);\n\n    var rawSet = function (dom, key, value) {\n      if (isString(value) || isBoolean(value) || isNumber(value)) {\n        dom.setAttribute(key, value + '');\n      } else {\n        domGlobals.console.error('Invalid call to Attr.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n        throw new Error('Attribute value was not simple');\n      }\n    };\n    var setAll = function (element, attrs) {\n      var dom = element.dom();\n      each$1(attrs, function (v, k) {\n        rawSet(dom, k, v);\n      });\n    };\n    var clone = function (element) {\n      return foldl(element.dom().attributes, function (acc, attr) {\n        acc[attr.name] = attr.value;\n        return acc;\n      }, {});\n    };\n\n    var isSupported = function (dom) {\n      return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n    };\n\n    var internalSet = function (dom, property, value) {\n      if (!isString(value)) {\n        domGlobals.console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n        throw new Error('CSS value must be a string: ' + value);\n      }\n      if (isSupported(dom)) {\n        dom.style.setProperty(property, value);\n      }\n    };\n    var set = function (element, property, value) {\n      var dom = element.dom();\n      internalSet(dom, property, value);\n    };\n\n    var clone$1 = function (original, isDeep) {\n      return Element.fromDom(original.dom().cloneNode(isDeep));\n    };\n    var deep = function (original) {\n      return clone$1(original, true);\n    };\n    var shallowAs = function (original, tag) {\n      var nu = Element.fromTag(tag);\n      var attributes = clone(original);\n      setAll(nu, attributes);\n      return nu;\n    };\n    var mutate = function (original, tag) {\n      var nu = shallowAs(original, tag);\n      before(original, nu);\n      var children$1 = children(original);\n      append$1(nu, children$1);\n      remove(original);\n      return nu;\n    };\n\n    var joinSegment = function (parent, child) {\n      append(parent.item, child.list);\n    };\n    var joinSegments = function (segments) {\n      for (var i = 1; i < segments.length; i++) {\n        joinSegment(segments[i - 1], segments[i]);\n      }\n    };\n    var appendSegments = function (head$1, tail) {\n      lift2(last(head$1), head(tail), joinSegment);\n    };\n    var createSegment = function (scope, listType) {\n      var segment = {\n        list: Element.fromTag(listType, scope),\n        item: Element.fromTag('li', scope)\n      };\n      append(segment.list, segment.item);\n      return segment;\n    };\n    var createSegments = function (scope, entry, size) {\n      var segments = [];\n      for (var i = 0; i < size; i++) {\n        segments.push(createSegment(scope, entry.listType));\n      }\n      return segments;\n    };\n    var populateSegments = function (segments, entry) {\n      for (var i = 0; i < segments.length - 1; i++) {\n        set(segments[i].item, 'list-style-type', 'none');\n      }\n      last(segments).each(function (segment) {\n        setAll(segment.list, entry.listAttributes);\n        setAll(segment.item, entry.itemAttributes);\n        append$1(segment.item, entry.content);\n      });\n    };\n    var normalizeSegment = function (segment, entry) {\n      if (name(segment.list) !== entry.listType) {\n        segment.list = mutate(segment.list, entry.listType);\n      }\n      setAll(segment.list, entry.listAttributes);\n    };\n    var createItem = function (scope, attr, content) {\n      var item = Element.fromTag('li', scope);\n      setAll(item, attr);\n      append$1(item, content);\n      return item;\n    };\n    var appendItem = function (segment, item) {\n      append(segment.list, item);\n      segment.item = item;\n    };\n    var writeShallow = function (scope, cast, entry) {\n      var newCast = cast.slice(0, entry.depth);\n      last(newCast).each(function (segment) {\n        var item = createItem(scope, entry.itemAttributes, entry.content);\n        appendItem(segment, item);\n        normalizeSegment(segment, entry);\n      });\n      return newCast;\n    };\n    var writeDeep = function (scope, cast, entry) {\n      var segments = createSegments(scope, entry, entry.depth - cast.length);\n      joinSegments(segments);\n      populateSegments(segments, entry);\n      appendSegments(cast, segments);\n      return cast.concat(segments);\n    };\n    var composeList = function (scope, entries) {\n      var cast = foldl(entries, function (cast, entry) {\n        return entry.depth > cast.length ? writeDeep(scope, cast, entry) : writeShallow(scope, cast, entry);\n      }, []);\n      return head(cast).map(function (segment) {\n        return segment.list;\n      });\n    };\n\n    var isList$1 = function (el) {\n      return is$1(el, 'OL,UL');\n    };\n    var hasFirstChildList = function (el) {\n      return firstChild(el).map(isList$1).getOr(false);\n    };\n    var hasLastChildList = function (el) {\n      return lastChild(el).map(isList$1).getOr(false);\n    };\n\n    var isIndented = function (entry) {\n      return entry.depth > 0;\n    };\n    var isSelected = function (entry) {\n      return entry.isSelected;\n    };\n    var cloneItemContent = function (li) {\n      var children$1 = children(li);\n      var content = hasLastChildList(li) ? children$1.slice(0, -1) : children$1;\n      return map(content, deep);\n    };\n    var createEntry = function (li, depth, isSelected) {\n      return parent(li).filter(isElement).map(function (list) {\n        return {\n          depth: depth,\n          isSelected: isSelected,\n          content: cloneItemContent(li),\n          itemAttributes: clone(li),\n          listAttributes: clone(list),\n          listType: name(list)\n        };\n      });\n    };\n\n    var indentEntry = function (indentation, entry) {\n      switch (indentation) {\n      case 'Indent':\n        entry.depth++;\n        break;\n      case 'Outdent':\n        entry.depth--;\n        break;\n      case 'Flatten':\n        entry.depth = 0;\n      }\n    };\n\n    var hasOwnProperty = Object.prototype.hasOwnProperty;\n    var shallow = function (old, nu) {\n      return nu;\n    };\n    var baseMerge = function (merger) {\n      return function () {\n        var objects = new Array(arguments.length);\n        for (var i = 0; i < objects.length; i++) {\n          objects[i] = arguments[i];\n        }\n        if (objects.length === 0) {\n          throw new Error('Can\\'t merge zero objects');\n        }\n        var ret = {};\n        for (var j = 0; j < objects.length; j++) {\n          var curObject = objects[j];\n          for (var key in curObject) {\n            if (hasOwnProperty.call(curObject, key)) {\n              ret[key] = merger(ret[key], curObject[key]);\n            }\n          }\n        }\n        return ret;\n      };\n    };\n    var merge = baseMerge(shallow);\n\n    var cloneListProperties = function (target, source) {\n      target.listType = source.listType;\n      target.listAttributes = merge({}, source.listAttributes);\n    };\n    var previousSiblingEntry = function (entries, start) {\n      var depth = entries[start].depth;\n      for (var i = start - 1; i >= 0; i--) {\n        if (entries[i].depth === depth) {\n          return Option.some(entries[i]);\n        }\n        if (entries[i].depth < depth) {\n          break;\n        }\n      }\n      return Option.none();\n    };\n    var normalizeEntries = function (entries) {\n      each(entries, function (entry, i) {\n        previousSiblingEntry(entries, i).each(function (matchingEntry) {\n          cloneListProperties(entry, matchingEntry);\n        });\n      });\n    };\n\n    var parseItem = function (depth, itemSelection, selectionState, item) {\n      return firstChild(item).filter(isList$1).fold(function () {\n        itemSelection.each(function (selection) {\n          if (eq(selection.start, item)) {\n            selectionState.set(true);\n          }\n        });\n        var currentItemEntry = createEntry(item, depth, selectionState.get());\n        itemSelection.each(function (selection) {\n          if (eq(selection.end, item)) {\n            selectionState.set(false);\n          }\n        });\n        var childListEntries = lastChild(item).filter(isList$1).map(function (list) {\n          return parseList(depth, itemSelection, selectionState, list);\n        }).getOr([]);\n        return currentItemEntry.toArray().concat(childListEntries);\n      }, function (list) {\n        return parseList(depth, itemSelection, selectionState, list);\n      });\n    };\n    var parseList = function (depth, itemSelection, selectionState, list) {\n      return bind(children(list), function (element) {\n        var parser = isList$1(element) ? parseList : parseItem;\n        var newDepth = depth + 1;\n        return parser(newDepth, itemSelection, selectionState, element);\n      });\n    };\n    var parseLists = function (lists, itemSelection) {\n      var selectionState = Cell(false);\n      var initialDepth = 0;\n      return map(lists, function (list) {\n        return {\n          sourceList: list,\n          entries: parseList(initialDepth, itemSelection, selectionState, list)\n        };\n      });\n    };\n\n    var outdentedComposer = function (editor, entries) {\n      return map(entries, function (entry) {\n        var content = fromElements(entry.content);\n        return Element.fromDom(createTextBlock(editor, content.dom()));\n      });\n    };\n    var indentedComposer = function (editor, entries) {\n      normalizeEntries(entries);\n      return composeList(editor.contentDocument, entries).toArray();\n    };\n    var composeEntries = function (editor, entries) {\n      return bind(groupBy(entries, isIndented), function (entries) {\n        var groupIsIndented = head(entries).map(isIndented).getOr(false);\n        return groupIsIndented ? indentedComposer(editor, entries) : outdentedComposer(editor, entries);\n      });\n    };\n    var indentSelectedEntries = function (entries, indentation) {\n      each(filter(entries, isSelected), function (entry) {\n        return indentEntry(indentation, entry);\n      });\n    };\n    var getItemSelection = function (editor) {\n      var selectedListItems = map(Selection.getSelectedListItems(editor), Element.fromDom);\n      return lift2(find(selectedListItems, not(hasFirstChildList)), find(reverse(selectedListItems), not(hasFirstChildList)), function (start, end) {\n        return {\n          start: start,\n          end: end\n        };\n      });\n    };\n    var listIndentation = function (editor, lists, indentation) {\n      var entrySets = parseLists(lists, getItemSelection(editor));\n      each(entrySets, function (entrySet) {\n        indentSelectedEntries(entrySet.entries, indentation);\n        var composedLists = composeEntries(editor, entrySet.entries);\n        each(composedLists, function (composedList) {\n          fireListEvent(editor, indentation === 'Indent' ? 'IndentList' : 'OutdentList', composedList.dom());\n        });\n        before$1(entrySet.sourceList, composedLists);\n        remove(entrySet.sourceList);\n      });\n    };\n\n    var global$6 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n\n    var DOM = global$6.DOM;\n    var splitList = function (editor, ul, li) {\n      var tmpRng, fragment, bookmarks, node, newBlock;\n      var removeAndKeepBookmarks = function (targetNode) {\n        global$5.each(bookmarks, function (node) {\n          targetNode.parentNode.insertBefore(node, li.parentNode);\n        });\n        DOM.remove(targetNode);\n      };\n      bookmarks = DOM.select('span[data-mce-type=\"bookmark\"]', ul);\n      newBlock = createTextBlock(editor, li);\n      tmpRng = DOM.createRng();\n      tmpRng.setStartAfter(li);\n      tmpRng.setEndAfter(ul);\n      fragment = tmpRng.extractContents();\n      for (node = fragment.firstChild; node; node = node.firstChild) {\n        if (node.nodeName === 'LI' && editor.dom.isEmpty(node)) {\n          DOM.remove(node);\n          break;\n        }\n      }\n      if (!editor.dom.isEmpty(fragment)) {\n        DOM.insertAfter(fragment, ul);\n      }\n      DOM.insertAfter(newBlock, ul);\n      if (NodeType.isEmpty(editor.dom, li.parentNode)) {\n        removeAndKeepBookmarks(li.parentNode);\n      }\n      DOM.remove(li);\n      if (NodeType.isEmpty(editor.dom, ul)) {\n        DOM.remove(ul);\n      }\n    };\n    var SplitList = { splitList: splitList };\n\n    var outdentDlItem = function (editor, item) {\n      if (is$1(item, 'dd')) {\n        mutate(item, 'dt');\n      } else if (is$1(item, 'dt')) {\n        parent(item).each(function (dl) {\n          return SplitList.splitList(editor, dl.dom(), item.dom());\n        });\n      }\n    };\n    var indentDlItem = function (item) {\n      if (is$1(item, 'dt')) {\n        mutate(item, 'dd');\n      }\n    };\n    var dlIndentation = function (editor, indentation, dlItems) {\n      if (indentation === 'Indent') {\n        each(dlItems, indentDlItem);\n      } else {\n        each(dlItems, function (item) {\n          return outdentDlItem(editor, item);\n        });\n      }\n    };\n\n    var getNormalizedPoint = function (container, offset) {\n      if (NodeType.isTextNode(container)) {\n        return {\n          container: container,\n          offset: offset\n        };\n      }\n      var node = global$1.getNode(container, offset);\n      if (NodeType.isTextNode(node)) {\n        return {\n          container: node,\n          offset: offset >= container.childNodes.length ? node.data.length : 0\n        };\n      } else if (node.previousSibling && NodeType.isTextNode(node.previousSibling)) {\n        return {\n          container: node.previousSibling,\n          offset: node.previousSibling.data.length\n        };\n      } else if (node.nextSibling && NodeType.isTextNode(node.nextSibling)) {\n        return {\n          container: node.nextSibling,\n          offset: 0\n        };\n      }\n      return {\n        container: container,\n        offset: offset\n      };\n    };\n    var normalizeRange = function (rng) {\n      var outRng = rng.cloneRange();\n      var rangeStart = getNormalizedPoint(rng.startContainer, rng.startOffset);\n      outRng.setStart(rangeStart.container, rangeStart.offset);\n      var rangeEnd = getNormalizedPoint(rng.endContainer, rng.endOffset);\n      outRng.setEnd(rangeEnd.container, rangeEnd.offset);\n      return outRng;\n    };\n    var Range = {\n      getNormalizedPoint: getNormalizedPoint,\n      normalizeRange: normalizeRange\n    };\n\n    var selectionIndentation = function (editor, indentation) {\n      var lists = map(Selection.getSelectedListRoots(editor), Element.fromDom);\n      var dlItems = map(Selection.getSelectedDlItems(editor), Element.fromDom);\n      var isHandled = false;\n      if (lists.length || dlItems.length) {\n        var bookmark = editor.selection.getBookmark();\n        listIndentation(editor, lists, indentation);\n        dlIndentation(editor, indentation, dlItems);\n        editor.selection.moveToBookmark(bookmark);\n        editor.selection.setRng(Range.normalizeRange(editor.selection.getRng()));\n        editor.nodeChanged();\n        isHandled = true;\n      }\n      return isHandled;\n    };\n    var indentListSelection = function (editor) {\n      return selectionIndentation(editor, 'Indent');\n    };\n    var outdentListSelection = function (editor) {\n      return selectionIndentation(editor, 'Outdent');\n    };\n    var flattenListSelection = function (editor) {\n      return selectionIndentation(editor, 'Flatten');\n    };\n\n    var global$7 = tinymce.util.Tools.resolve('tinymce.dom.BookmarkManager');\n\n    var DOM$1 = global$6.DOM;\n    var createBookmark = function (rng) {\n      var bookmark = {};\n      var setupEndPoint = function (start) {\n        var offsetNode, container, offset;\n        container = rng[start ? 'startContainer' : 'endContainer'];\n        offset = rng[start ? 'startOffset' : 'endOffset'];\n        if (container.nodeType === 1) {\n          offsetNode = DOM$1.create('span', { 'data-mce-type': 'bookmark' });\n          if (container.hasChildNodes()) {\n            offset = Math.min(offset, container.childNodes.length - 1);\n            if (start) {\n              container.insertBefore(offsetNode, container.childNodes[offset]);\n            } else {\n              DOM$1.insertAfter(offsetNode, container.childNodes[offset]);\n            }\n          } else {\n            container.appendChild(offsetNode);\n          }\n          container = offsetNode;\n          offset = 0;\n        }\n        bookmark[start ? 'startContainer' : 'endContainer'] = container;\n        bookmark[start ? 'startOffset' : 'endOffset'] = offset;\n      };\n      setupEndPoint(true);\n      if (!rng.collapsed) {\n        setupEndPoint();\n      }\n      return bookmark;\n    };\n    var resolveBookmark = function (bookmark) {\n      function restoreEndPoint(start) {\n        var container, offset, node;\n        var nodeIndex = function (container) {\n          var node = container.parentNode.firstChild, idx = 0;\n          while (node) {\n            if (node === container) {\n              return idx;\n            }\n            if (node.nodeType !== 1 || node.getAttribute('data-mce-type') !== 'bookmark') {\n              idx++;\n            }\n            node = node.nextSibling;\n          }\n          return -1;\n        };\n        container = node = bookmark[start ? 'startContainer' : 'endContainer'];\n        offset = bookmark[start ? 'startOffset' : 'endOffset'];\n        if (!container) {\n          return;\n        }\n        if (container.nodeType === 1) {\n          offset = nodeIndex(container);\n          container = container.parentNode;\n          DOM$1.remove(node);\n          if (!container.hasChildNodes() && DOM$1.isBlock(container)) {\n            container.appendChild(DOM$1.create('br'));\n          }\n        }\n        bookmark[start ? 'startContainer' : 'endContainer'] = container;\n        bookmark[start ? 'startOffset' : 'endOffset'] = offset;\n      }\n      restoreEndPoint(true);\n      restoreEndPoint();\n      var rng = DOM$1.createRng();\n      rng.setStart(bookmark.startContainer, bookmark.startOffset);\n      if (bookmark.endContainer) {\n        rng.setEnd(bookmark.endContainer, bookmark.endOffset);\n      }\n      return Range.normalizeRange(rng);\n    };\n    var Bookmark = {\n      createBookmark: createBookmark,\n      resolveBookmark: resolveBookmark\n    };\n\n    var isCustomList = function (list) {\n      return /\\btox\\-/.test(list.className);\n    };\n\n    var listToggleActionFromListName = function (listName) {\n      switch (listName) {\n      case 'UL':\n        return 'ToggleUlList';\n      case 'OL':\n        return 'ToggleOlList';\n      case 'DL':\n        return 'ToggleDLList';\n      }\n    };\n\n    var updateListStyle = function (dom, el, detail) {\n      var type = detail['list-style-type'] ? detail['list-style-type'] : null;\n      dom.setStyle(el, 'list-style-type', type);\n    };\n    var setAttribs = function (elm, attrs) {\n      global$5.each(attrs, function (value, key) {\n        elm.setAttribute(key, value);\n      });\n    };\n    var updateListAttrs = function (dom, el, detail) {\n      setAttribs(el, detail['list-attributes']);\n      global$5.each(dom.select('li', el), function (li) {\n        setAttribs(li, detail['list-item-attributes']);\n      });\n    };\n    var updateListWithDetails = function (dom, el, detail) {\n      updateListStyle(dom, el, detail);\n      updateListAttrs(dom, el, detail);\n    };\n    var removeStyles = function (dom, element, styles) {\n      global$5.each(styles, function (style) {\n        var _a;\n        return dom.setStyle(element, (_a = {}, _a[style] = '', _a));\n      });\n    };\n    var getEndPointNode = function (editor, rng, start, root) {\n      var container, offset;\n      container = rng[start ? 'startContainer' : 'endContainer'];\n      offset = rng[start ? 'startOffset' : 'endOffset'];\n      if (container.nodeType === 1) {\n        container = container.childNodes[Math.min(offset, container.childNodes.length - 1)] || container;\n      }\n      if (!start && NodeType.isBr(container.nextSibling)) {\n        container = container.nextSibling;\n      }\n      while (container.parentNode !== root) {\n        if (NodeType.isTextBlock(editor, container)) {\n          return container;\n        }\n        if (/^(TD|TH)$/.test(container.parentNode.nodeName)) {\n          return container;\n        }\n        container = container.parentNode;\n      }\n      return container;\n    };\n    var getSelectedTextBlocks = function (editor, rng, root) {\n      var textBlocks = [], dom = editor.dom;\n      var startNode = getEndPointNode(editor, rng, true, root);\n      var endNode = getEndPointNode(editor, rng, false, root);\n      var block;\n      var siblings = [];\n      for (var node = startNode; node; node = node.nextSibling) {\n        siblings.push(node);\n        if (node === endNode) {\n          break;\n        }\n      }\n      global$5.each(siblings, function (node) {\n        if (NodeType.isTextBlock(editor, node)) {\n          textBlocks.push(node);\n          block = null;\n          return;\n        }\n        if (dom.isBlock(node) || NodeType.isBr(node)) {\n          if (NodeType.isBr(node)) {\n            dom.remove(node);\n          }\n          block = null;\n          return;\n        }\n        var nextSibling = node.nextSibling;\n        if (global$7.isBookmarkNode(node)) {\n          if (NodeType.isTextBlock(editor, nextSibling) || !nextSibling && node.parentNode === root) {\n            block = null;\n            return;\n          }\n        }\n        if (!block) {\n          block = dom.create('p');\n          node.parentNode.insertBefore(block, node);\n          textBlocks.push(block);\n        }\n        block.appendChild(node);\n      });\n      return textBlocks;\n    };\n    var hasCompatibleStyle = function (dom, sib, detail) {\n      var sibStyle = dom.getStyle(sib, 'list-style-type');\n      var detailStyle = detail ? detail['list-style-type'] : '';\n      detailStyle = detailStyle === null ? '' : detailStyle;\n      return sibStyle === detailStyle;\n    };\n    var applyList = function (editor, listName, detail) {\n      if (detail === void 0) {\n        detail = {};\n      }\n      var rng = editor.selection.getRng(true);\n      var bookmark;\n      var listItemName = 'LI';\n      var root = Selection.getClosestListRootElm(editor, editor.selection.getStart(true));\n      var dom = editor.dom;\n      if (dom.getContentEditable(editor.selection.getNode()) === 'false') {\n        return;\n      }\n      listName = listName.toUpperCase();\n      if (listName === 'DL') {\n        listItemName = 'DT';\n      }\n      bookmark = Bookmark.createBookmark(rng);\n      global$5.each(getSelectedTextBlocks(editor, rng, root), function (block) {\n        var listBlock, sibling;\n        sibling = block.previousSibling;\n        if (sibling && NodeType.isListNode(sibling) && sibling.nodeName === listName && hasCompatibleStyle(dom, sibling, detail)) {\n          listBlock = sibling;\n          block = dom.rename(block, listItemName);\n          sibling.appendChild(block);\n        } else {\n          listBlock = dom.create(listName);\n          block.parentNode.insertBefore(listBlock, block);\n          listBlock.appendChild(block);\n          block = dom.rename(block, listItemName);\n        }\n        removeStyles(dom, block, [\n          'margin',\n          'margin-right',\n          'margin-bottom',\n          'margin-left',\n          'margin-top',\n          'padding',\n          'padding-right',\n          'padding-bottom',\n          'padding-left',\n          'padding-top'\n        ]);\n        updateListWithDetails(dom, listBlock, detail);\n        mergeWithAdjacentLists(editor.dom, listBlock);\n      });\n      editor.selection.setRng(Bookmark.resolveBookmark(bookmark));\n    };\n    var isValidLists = function (list1, list2) {\n      return list1 && list2 && NodeType.isListNode(list1) && list1.nodeName === list2.nodeName;\n    };\n    var hasSameListStyle = function (dom, list1, list2) {\n      var targetStyle = dom.getStyle(list1, 'list-style-type', true);\n      var style = dom.getStyle(list2, 'list-style-type', true);\n      return targetStyle === style;\n    };\n    var hasSameClasses = function (elm1, elm2) {\n      return elm1.className === elm2.className;\n    };\n    var shouldMerge = function (dom, list1, list2) {\n      return isValidLists(list1, list2) && hasSameListStyle(dom, list1, list2) && hasSameClasses(list1, list2);\n    };\n    var mergeWithAdjacentLists = function (dom, listBlock) {\n      var sibling, node;\n      sibling = listBlock.nextSibling;\n      if (shouldMerge(dom, listBlock, sibling)) {\n        while (node = sibling.firstChild) {\n          listBlock.appendChild(node);\n        }\n        dom.remove(sibling);\n      }\n      sibling = listBlock.previousSibling;\n      if (shouldMerge(dom, listBlock, sibling)) {\n        while (node = sibling.lastChild) {\n          listBlock.insertBefore(node, listBlock.firstChild);\n        }\n        dom.remove(sibling);\n      }\n    };\n    var updateList = function (editor, list, listName, detail) {\n      if (list.nodeName !== listName) {\n        var newList = editor.dom.rename(list, listName);\n        updateListWithDetails(editor.dom, newList, detail);\n        fireListEvent(editor, listToggleActionFromListName(listName), newList);\n      } else {\n        updateListWithDetails(editor.dom, list, detail);\n        fireListEvent(editor, listToggleActionFromListName(listName), list);\n      }\n    };\n    var toggleMultipleLists = function (editor, parentList, lists, listName, detail) {\n      if (parentList.nodeName === listName && !hasListStyleDetail(detail)) {\n        flattenListSelection(editor);\n      } else {\n        var bookmark = Bookmark.createBookmark(editor.selection.getRng(true));\n        global$5.each([parentList].concat(lists), function (elm) {\n          updateList(editor, elm, listName, detail);\n        });\n        editor.selection.setRng(Bookmark.resolveBookmark(bookmark));\n      }\n    };\n    var hasListStyleDetail = function (detail) {\n      return 'list-style-type' in detail;\n    };\n    var toggleSingleList = function (editor, parentList, listName, detail) {\n      if (parentList === editor.getBody()) {\n        return;\n      }\n      if (parentList) {\n        if (parentList.nodeName === listName && !hasListStyleDetail(detail) && !isCustomList(parentList)) {\n          flattenListSelection(editor);\n        } else {\n          var bookmark = Bookmark.createBookmark(editor.selection.getRng(true));\n          updateListWithDetails(editor.dom, parentList, detail);\n          var newList = editor.dom.rename(parentList, listName);\n          mergeWithAdjacentLists(editor.dom, newList);\n          editor.selection.setRng(Bookmark.resolveBookmark(bookmark));\n          fireListEvent(editor, listToggleActionFromListName(listName), newList);\n        }\n      } else {\n        applyList(editor, listName, detail);\n        fireListEvent(editor, listToggleActionFromListName(listName), parentList);\n      }\n    };\n    var toggleList = function (editor, listName, detail) {\n      var parentList = Selection.getParentList(editor);\n      var selectedSubLists = Selection.getSelectedSubLists(editor);\n      detail = detail ? detail : {};\n      if (parentList && selectedSubLists.length > 0) {\n        toggleMultipleLists(editor, parentList, selectedSubLists, listName, detail);\n      } else {\n        toggleSingleList(editor, parentList, listName, detail);\n      }\n    };\n    var ToggleList = {\n      toggleList: toggleList,\n      mergeWithAdjacentLists: mergeWithAdjacentLists\n    };\n\n    var DOM$2 = global$6.DOM;\n    var normalizeList = function (dom, ul) {\n      var sibling;\n      var parentNode = ul.parentNode;\n      if (parentNode.nodeName === 'LI' && parentNode.firstChild === ul) {\n        sibling = parentNode.previousSibling;\n        if (sibling && sibling.nodeName === 'LI') {\n          sibling.appendChild(ul);\n          if (NodeType.isEmpty(dom, parentNode)) {\n            DOM$2.remove(parentNode);\n          }\n        } else {\n          DOM$2.setStyle(parentNode, 'listStyleType', 'none');\n        }\n      }\n      if (NodeType.isListNode(parentNode)) {\n        sibling = parentNode.previousSibling;\n        if (sibling && sibling.nodeName === 'LI') {\n          sibling.appendChild(ul);\n        }\n      }\n    };\n    var normalizeLists = function (dom, element) {\n      global$5.each(global$5.grep(dom.select('ol,ul', element)), function (ul) {\n        normalizeList(dom, ul);\n      });\n    };\n    var NormalizeLists = {\n      normalizeList: normalizeList,\n      normalizeLists: normalizeLists\n    };\n\n    var findNextCaretContainer = function (editor, rng, isForward, root) {\n      var node = rng.startContainer;\n      var offset = rng.startOffset;\n      if (NodeType.isTextNode(node) && (isForward ? offset < node.data.length : offset > 0)) {\n        return node;\n      }\n      var nonEmptyBlocks = editor.schema.getNonEmptyElements();\n      if (node.nodeType === 1) {\n        node = global$1.getNode(node, offset);\n      }\n      var walker = new global$2(node, root);\n      if (isForward) {\n        if (NodeType.isBogusBr(editor.dom, node)) {\n          walker.next();\n        }\n      }\n      while (node = walker[isForward ? 'next' : 'prev2']()) {\n        if (node.nodeName === 'LI' && !node.hasChildNodes()) {\n          return node;\n        }\n        if (nonEmptyBlocks[node.nodeName]) {\n          return node;\n        }\n        if (NodeType.isTextNode(node) && node.data.length > 0) {\n          return node;\n        }\n      }\n    };\n    var hasOnlyOneBlockChild = function (dom, elm) {\n      var childNodes = elm.childNodes;\n      return childNodes.length === 1 && !NodeType.isListNode(childNodes[0]) && dom.isBlock(childNodes[0]);\n    };\n    var unwrapSingleBlockChild = function (dom, elm) {\n      if (hasOnlyOneBlockChild(dom, elm)) {\n        dom.remove(elm.firstChild, true);\n      }\n    };\n    var moveChildren = function (dom, fromElm, toElm) {\n      var node, targetElm;\n      targetElm = hasOnlyOneBlockChild(dom, toElm) ? toElm.firstChild : toElm;\n      unwrapSingleBlockChild(dom, fromElm);\n      if (!NodeType.isEmpty(dom, fromElm, true)) {\n        while (node = fromElm.firstChild) {\n          targetElm.appendChild(node);\n        }\n      }\n    };\n    var mergeLiElements = function (dom, fromElm, toElm) {\n      var node, listNode;\n      var ul = fromElm.parentNode;\n      if (!NodeType.isChildOfBody(dom, fromElm) || !NodeType.isChildOfBody(dom, toElm)) {\n        return;\n      }\n      if (NodeType.isListNode(toElm.lastChild)) {\n        listNode = toElm.lastChild;\n      }\n      if (ul === toElm.lastChild) {\n        if (NodeType.isBr(ul.previousSibling)) {\n          dom.remove(ul.previousSibling);\n        }\n      }\n      node = toElm.lastChild;\n      if (node && NodeType.isBr(node) && fromElm.hasChildNodes()) {\n        dom.remove(node);\n      }\n      if (NodeType.isEmpty(dom, toElm, true)) {\n        dom.$(toElm).empty();\n      }\n      moveChildren(dom, fromElm, toElm);\n      if (listNode) {\n        toElm.appendChild(listNode);\n      }\n      var contains = contains$1(Element.fromDom(toElm), Element.fromDom(fromElm));\n      var nestedLists = contains ? dom.getParents(fromElm, NodeType.isListNode, toElm) : [];\n      dom.remove(fromElm);\n      each(nestedLists, function (list) {\n        if (NodeType.isEmpty(dom, list) && list !== dom.getRoot()) {\n          dom.remove(list);\n        }\n      });\n    };\n    var mergeIntoEmptyLi = function (editor, fromLi, toLi) {\n      editor.dom.$(toLi).empty();\n      mergeLiElements(editor.dom, fromLi, toLi);\n      editor.selection.setCursorLocation(toLi);\n    };\n    var mergeForward = function (editor, rng, fromLi, toLi) {\n      var dom = editor.dom;\n      if (dom.isEmpty(toLi)) {\n        mergeIntoEmptyLi(editor, fromLi, toLi);\n      } else {\n        var bookmark = Bookmark.createBookmark(rng);\n        mergeLiElements(dom, fromLi, toLi);\n        editor.selection.setRng(Bookmark.resolveBookmark(bookmark));\n      }\n    };\n    var mergeBackward = function (editor, rng, fromLi, toLi) {\n      var bookmark = Bookmark.createBookmark(rng);\n      mergeLiElements(editor.dom, fromLi, toLi);\n      var resolvedBookmark = Bookmark.resolveBookmark(bookmark);\n      editor.selection.setRng(resolvedBookmark);\n    };\n    var backspaceDeleteFromListToListCaret = function (editor, isForward) {\n      var dom = editor.dom, selection = editor.selection;\n      var selectionStartElm = selection.getStart();\n      var root = Selection.getClosestListRootElm(editor, selectionStartElm);\n      var li = dom.getParent(selection.getStart(), 'LI', root);\n      if (li) {\n        var ul = li.parentNode;\n        if (ul === editor.getBody() && NodeType.isEmpty(dom, ul)) {\n          return true;\n        }\n        var rng_1 = Range.normalizeRange(selection.getRng());\n        var otherLi_1 = dom.getParent(findNextCaretContainer(editor, rng_1, isForward, root), 'LI', root);\n        if (otherLi_1 && otherLi_1 !== li) {\n          editor.undoManager.transact(function () {\n            if (isForward) {\n              mergeForward(editor, rng_1, otherLi_1, li);\n            } else {\n              if (NodeType.isFirstChild(li)) {\n                outdentListSelection(editor);\n              } else {\n                mergeBackward(editor, rng_1, li, otherLi_1);\n              }\n            }\n          });\n          return true;\n        } else if (!otherLi_1) {\n          if (!isForward && rng_1.startOffset === 0 && rng_1.endOffset === 0) {\n            editor.undoManager.transact(function () {\n              flattenListSelection(editor);\n            });\n            return true;\n          }\n        }\n      }\n      return false;\n    };\n    var removeBlock = function (dom, block, root) {\n      var parentBlock = dom.getParent(block.parentNode, dom.isBlock, root);\n      dom.remove(block);\n      if (parentBlock && dom.isEmpty(parentBlock)) {\n        dom.remove(parentBlock);\n      }\n    };\n    var backspaceDeleteIntoListCaret = function (editor, isForward) {\n      var dom = editor.dom;\n      var selectionStartElm = editor.selection.getStart();\n      var root = Selection.getClosestListRootElm(editor, selectionStartElm);\n      var block = dom.getParent(selectionStartElm, dom.isBlock, root);\n      if (block && dom.isEmpty(block)) {\n        var rng = Range.normalizeRange(editor.selection.getRng());\n        var otherLi_2 = dom.getParent(findNextCaretContainer(editor, rng, isForward, root), 'LI', root);\n        if (otherLi_2) {\n          editor.undoManager.transact(function () {\n            removeBlock(dom, block, root);\n            ToggleList.mergeWithAdjacentLists(dom, otherLi_2.parentNode);\n            editor.selection.select(otherLi_2, true);\n            editor.selection.collapse(isForward);\n          });\n          return true;\n        }\n      }\n      return false;\n    };\n    var backspaceDeleteCaret = function (editor, isForward) {\n      return backspaceDeleteFromListToListCaret(editor, isForward) || backspaceDeleteIntoListCaret(editor, isForward);\n    };\n    var backspaceDeleteRange = function (editor) {\n      var selectionStartElm = editor.selection.getStart();\n      var root = Selection.getClosestListRootElm(editor, selectionStartElm);\n      var startListParent = editor.dom.getParent(selectionStartElm, 'LI,DT,DD', root);\n      if (startListParent || Selection.getSelectedListItems(editor).length > 0) {\n        editor.undoManager.transact(function () {\n          editor.execCommand('Delete');\n          NormalizeLists.normalizeLists(editor.dom, editor.getBody());\n        });\n        return true;\n      }\n      return false;\n    };\n    var backspaceDelete = function (editor, isForward) {\n      return editor.selection.isCollapsed() ? backspaceDeleteCaret(editor, isForward) : backspaceDeleteRange(editor);\n    };\n    var setup = function (editor) {\n      editor.on('keydown', function (e) {\n        if (e.keyCode === global$3.BACKSPACE) {\n          if (backspaceDelete(editor, false)) {\n            e.preventDefault();\n          }\n        } else if (e.keyCode === global$3.DELETE) {\n          if (backspaceDelete(editor, true)) {\n            e.preventDefault();\n          }\n        }\n      });\n    };\n    var Delete = {\n      setup: setup,\n      backspaceDelete: backspaceDelete\n    };\n\n    var get = function (editor) {\n      return {\n        backspaceDelete: function (isForward) {\n          Delete.backspaceDelete(editor, isForward);\n        }\n      };\n    };\n    var Api = { get: get };\n\n    var queryListCommandState = function (editor, listName) {\n      return function () {\n        var parentList = editor.dom.getParent(editor.selection.getStart(), 'UL,OL,DL');\n        return parentList && parentList.nodeName === listName;\n      };\n    };\n    var register = function (editor) {\n      editor.on('BeforeExecCommand', function (e) {\n        var cmd = e.command.toLowerCase();\n        if (cmd === 'indent') {\n          indentListSelection(editor);\n        } else if (cmd === 'outdent') {\n          outdentListSelection(editor);\n        }\n      });\n      editor.addCommand('InsertUnorderedList', function (ui, detail) {\n        ToggleList.toggleList(editor, 'UL', detail);\n      });\n      editor.addCommand('InsertOrderedList', function (ui, detail) {\n        ToggleList.toggleList(editor, 'OL', detail);\n      });\n      editor.addCommand('InsertDefinitionList', function (ui, detail) {\n        ToggleList.toggleList(editor, 'DL', detail);\n      });\n      editor.addCommand('RemoveList', function () {\n        flattenListSelection(editor);\n      });\n      editor.addQueryStateHandler('InsertUnorderedList', queryListCommandState(editor, 'UL'));\n      editor.addQueryStateHandler('InsertOrderedList', queryListCommandState(editor, 'OL'));\n      editor.addQueryStateHandler('InsertDefinitionList', queryListCommandState(editor, 'DL'));\n    };\n    var Commands = { register: register };\n\n    var shouldIndentOnTab = function (editor) {\n      return editor.getParam('lists_indent_on_tab', true);\n    };\n    var Settings = { shouldIndentOnTab: shouldIndentOnTab };\n\n    var setupTabKey = function (editor) {\n      editor.on('keydown', function (e) {\n        if (e.keyCode !== global$3.TAB || global$3.metaKeyPressed(e)) {\n          return;\n        }\n        editor.undoManager.transact(function () {\n          if (e.shiftKey ? outdentListSelection(editor) : indentListSelection(editor)) {\n            e.preventDefault();\n          }\n        });\n      });\n    };\n    var setup$1 = function (editor) {\n      if (Settings.shouldIndentOnTab(editor)) {\n        setupTabKey(editor);\n      }\n      Delete.setup(editor);\n    };\n    var Keyboard = { setup: setup$1 };\n\n    var findIndex = function (list, predicate) {\n      for (var index = 0; index < list.length; index++) {\n        var element = list[index];\n        if (predicate(element)) {\n          return index;\n        }\n      }\n      return -1;\n    };\n    var listState = function (editor, listName) {\n      return function (buttonApi) {\n        var nodeChangeHandler = function (e) {\n          var tableCellIndex = findIndex(e.parents, NodeType.isTableCellNode);\n          var parents = tableCellIndex !== -1 ? e.parents.slice(0, tableCellIndex) : e.parents;\n          var lists = global$5.grep(parents, NodeType.isListNode);\n          buttonApi.setActive(lists.length > 0 && lists[0].nodeName === listName && !isCustomList(lists[0]));\n        };\n        editor.on('NodeChange', nodeChangeHandler);\n        return function () {\n          return editor.off('NodeChange', nodeChangeHandler);\n        };\n      };\n    };\n    var register$1 = function (editor) {\n      var hasPlugin = function (editor, plugin) {\n        var plugins = editor.settings.plugins ? editor.settings.plugins : '';\n        return global$5.inArray(plugins.split(/[ ,]/), plugin) !== -1;\n      };\n      var exec = function (command) {\n        return function () {\n          return editor.execCommand(command);\n        };\n      };\n      if (!hasPlugin(editor, 'advlist')) {\n        editor.ui.registry.addToggleButton('numlist', {\n          icon: 'ordered-list',\n          active: false,\n          tooltip: 'Numbered list',\n          onAction: exec('InsertOrderedList'),\n          onSetup: listState(editor, 'OL')\n        });\n        editor.ui.registry.addToggleButton('bullist', {\n          icon: 'unordered-list',\n          active: false,\n          tooltip: 'Bullet list',\n          onAction: exec('InsertUnorderedList'),\n          onSetup: listState(editor, 'UL')\n        });\n      }\n    };\n    var Buttons = { register: register$1 };\n\n    function Plugin () {\n      global.add('lists', function (editor) {\n        Keyboard.setup(editor);\n        Buttons.register(editor);\n        Commands.register(editor);\n        return Api.get(editor);\n      });\n    }\n\n    Plugin();\n\n}(window));\n"]}