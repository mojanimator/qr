{"version":3,"sources":["../../../../../public/js/plugins/table/plugin.js"],"names":["domGlobals","Cell","initial","value","get","set","v","clone","noop","compose","fa","fb","args","_i","arguments","length","apply","constant","identity","x","curry","fn","initialArgs","restArgs","all","concat","not","f","die","msg","Error","never","always","none","NONE","eq","o","isNone","call","thunk","id","n","me","fold","s","is","isSome","getOr","getOrThunk","getOrDie","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","Object","freeze","some","a","constant_a","self","elementEq","b","from","Option","global","tinymce","util","Tools","resolve","typeOf","t","Array","prototype","isPrototypeOf","constructor","name","String","isType","type","isString","isArray","isBoolean","isFunction","isNumber","nativeSlice","slice","nativeIndexOf","indexOf","nativePush","push","rawIndexOf","ts","contains","xs","pred","i","len","r","eachr","foldr","acc","foldl","find","findIndex","flatten","output","reverse","last","from$1","keys","hasOwnProperty","each$1","obj","props","k","map$1","tupleMap","tuple","key","has","Immutable","fields","values","struct","sort","arr","reqMessage","required","join","unsuppMessage","unsupported","validateStrArr","label","array","invalidTypeMessage","incorrect","checkDupes","everything","sorted","dupe","d","MixedBag","optional","keys$1","allReqd","req","opt","ATTRIBUTE","Node","ATTRIBUTE_NODE","CDATA_SECTION","CDATA_SECTION_NODE","COMMENT","COMMENT_NODE","DOCUMENT","DOCUMENT_NODE","DOCUMENT_TYPE","DOCUMENT_TYPE_NODE","DOCUMENT_FRAGMENT","DOCUMENT_FRAGMENT_NODE","ELEMENT","ELEMENT_NODE","TEXT","TEXT_NODE","PROCESSING_INSTRUCTION","PROCESSING_INSTRUCTION_NODE","ENTITY_REFERENCE","ENTITY_REFERENCE_NODE","ENTITY","ENTITY_NODE","NOTATION","NOTATION_NODE","Global","window","Function","element","dom","nodeName","toLowerCase","nodeType","isType$1","isComment","isElement","isText","rawSet","setAttribute","console","error","setAll","attrs","get$1","getAttribute","has$1","hasAttribute","remove","removeAttribute","attributes","attr","checkRange","str","substr","start","contains$1","startsWith","prefix","endsWith","suffix","trim","replace","isSupported","style","getPropertyValue","cached","called","fromHtml","html","scope","doc","document","div","createElement","innerHTML","hasChildNodes","childNodes","fromDom","fromTag","tag","node","fromText","text","createTextNode","fromPoint","docElm","y","elementFromPoint","Element","inBody","parentNode","ownerDocument","body","getBody","internalSet","property","setProperty","internalRemove","removeProperty","set$1","setAll$1","css","get$2","styles","getComputedStyle","getUnsafeProperty","getRaw","raw","remove$1","copy","source","target","sourceDom","targetDom","cssText","compareDocumentPosition","match","documentPositionPreceding","DOCUMENT_POSITION_PRECEDING","documentPositionContainedBy","DOCUMENT_POSITION_CONTAINED_BY","__assign","assign","p","firstMatch","regexes","test","find$1","agent","major","minor","group","Number","nu","detect","versionRegexes","cleanedAgent","unknown","Version","edge","chrome","ie","opera","firefox","safari","isBrowser","current","unknown$1","nu$1","version","info","isEdge","isChrome","isIE","isOpera","isFirefox","isSafari","Browser","windows","ios","android","linux","osx","solaris","freebsd","isOS","unknown$2","nu$2","isWindows","isiOS","isAndroid","isOSX","isLinux","isSolaris","isFreeBSD","OperatingSystem","DeviceType","os","browser","userAgent","mediaMatch","isiPad","isiPhone","isMobile","isTouch","isTablet","isPhone","iOSwebview","isDesktop","isWebView","detect$1","candidates","candidate","search","detectBrowser","browsers","detectOs","oses","UaString","normalVersionRegex","checkContains","uastring","PlatformInfo","detect$2","deviceType","PlatformDetection","query","matchMedia","matches","platform","navigator","detect$3","ELEMENT$1","DOCUMENT$1","selector","elem","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","bypassSelector","childElementCount","base","querySelectorAll","one","querySelector","e1","e2","regularContains","d1","d2","ieContains","contains$2","is$1","owner","defaultView","parent","parents","isRoot","stop","ret","rawParent","prevSibling","previousSibling","nextSibling","children","child","index","cs","firstChild","spot","before","marker","parent$1","insertBefore","after","sibling","append","prepend","firstChild$1","appendChild","wrap","wrapper","before$1","elements","after$1","e","append$1","empty","textContent","rogue","remove$2","removeChild","unwrap","children$1","dimension","dimensions","grid","address","coords","detail","detailnew","extended","rowdata","elementnew","rowdatanew","rowcells","rowdetails","bounds","ancestors","predicate","descendants","result","ancestors$1","children$2","descendants$1","ClosestOrAncestor","ancestor","el","closest","child$1","descendant","descend","child_1","res","ancestor$1","child$2","descendant$1","closest$1","firstLayer","filterFirstLayer","LayerSelector","lookup","tags","isRootOrUpperTable","elm","cell","cells","notCell","neighbours","neighbourCells","neighbourRows","firstCell","table","row","rows","parseInt","grid$1","rowProp","colProp","rowsCount","cols","TableLookup","fromTable","parentSection","parentName","rowspan","colspan","fromPastedRows","example","section","DetailsList","column","getAt","warehouse","access","findItem","item","comparator","filtered","filterItems","generate","list","maxRows","maxColumns","details","currentRow","j","cr","cc","newpos","Math","max","justCells","w","Warehouse","statsStruct","findSelectedStats","house","isSelected","totalColumns","columns","totalRows","minRow","minCol","maxRow","maxCol","startRow","endRow","startCol","endCol","makeCell","seenSelected","rowIndex","td","fillInGaps","stats","needCell","clean","emptyRows","extract","selectedSelector","unselectedCells","CopySelected","NodeValue","getOption","nodeValue","api","get$3","set$2","getEnd","NBSP","isTextNodeWithCursorPosition","elementsWithCursorPosition","isCursorPosition","hasCursorPosition","first","last$1","descendantRtl","clone$1","original","isDeep","cloneNode","shallow","deep","shallowAs","copy$1","cloneChildren","createCell","replica","pasteReplace","newRow","cloneFormats","oldCell","newCell","formats","first$1","firstText","formatSelector","clonedFormat","cellOperations","mutate","formatsToClone","prev","docu","lastNode","gap","paste","TableFill","fromHtml$1","inSelection","leftEdge","rightEdge","topEdge","bottomEdge","finishCol","finishRow","isWithin","isRectangular","isRect","detailIsWithin","CellBounds","getBounds","detailA","detailB","min","getAnyBox","startCell","finishCell","startCoords","finishCoords","sc","fc","getBox","CellGroup","moveBy","dest","intercepts","finish","inside","parentCell","innerCell","isContainedBy","c1","c2","CellFinder","moveBy$1","deltaRow","deltaColumn","getWarehouse","intercepts$1","nestedIntercepts","firstTable","lastTable","optStartCell","optLastCell","lastCell","getBox$1","TablePositions","TagBoundaries","DomUniverse","isBoundary","isEmptyTag","comparePosition","other","copyAttributesTo","destination","as","up","down","copyTo","insert","afterAll","appendAll","create","getText","setText","leftRight","brokenPath","bisect","universe","ind","breakToRight","parts","second","breakToLeft","prior","breakPath","isTop","breaker","next","splits","fallback","breakage","extra","left","right","nextChild","all$1","look","head","tail","oneAll","unsafeOne","commonElement","end","eq$1","unsafeSubset","common","ps1","ps2","finder","ps","topDown","startIndex","endIndex","sIndex","eIndex","ancestors$2","prune","path","pruned1","pruned2","shared","firstpath","secondpath","subset","ancs","SubsetFn","sharedOne","subset$1","ancestors$3","breakToLeft$1","breakToRight$1","breakPath$1","Parent","sharedOne$1","_universe","subset$2","ancestors$4","breakToLeft$2","breakToRight$2","breakPath$2","u","c","DomParent","Identified","lookupTable","container","identify","getIsRoot","rootTable","boxes","startTable","finishTable","ancestorCells","lca","lcaTable","finishAncestorCells","startAncestorCells","retrieve","sels","getLast","lastSelectedSelector","box","getEdges","firstSelectedSelector","tbl","expandTo","identified","shiftSelection","CellSelection","retrieve$1","retrieveBox","edges","firstAncestor","lastAncestor","fA","lA","TableSelection","selected","attributeSelector","firstSelected","lastSelected","Ephemera","generate$1","cases","constructors","adt","acase","count","argLength","branches","branchKeys","reqKey","log","params","Adt","type$1","multiple","single","cata","subject","onNone","onMultiple","onSingle","SelectionTypes","selection","selections","unmergable","hasSpan","mergable","_env","CellOperations","noMenu","forMenu","notCell$1","paste$1","pasteRows","clipboard","generators","TableTargets","extractSelected","serializeElements","editor","serializer","serialize","getTextContent","innerText","registerEvents","actions","cellSelection","on","multiCellContext","preventDefault","content","format","cellOpt","getParent","getStart","domCell","getDoc","targets","pasteCells","rng","setRng","focus","clear","Clipboard","Dimension","getOffset","h","parseFloat","getOuter","aggregate","properties","val","isNaN","cumulativeInclusions","absoluteMax","api$1","getBoundingClientRect","height","offsetHeight","get$4","api$2","offsetWidth","get$5","getOuter$1","platform$1","needManualCalc","toNumber","px","num","getProp","getCalculatedHeight","paddingTop","paddingBottom","borderTop","borderBottom","boxSizing","borders","getWidth","getHeight","RuntimeSize","genericSizeRegex","percentageBasedSizeRegex","pixelBasedSizeRegex","setPixelWidth","amount","setPercentageWidth","setHeight","getHeightValue","convert","number","getter","setter","newSize","total","floor","normalizePixelSize","getTotalHeight","get$6","span","getSpan","getRawWidth","cssWidth","width","normalizePercentageWidth","cellWidth","tableSize","pixelWidth","choosePercentageSize","percentMatch","exec","intWidth","getPercentageWidth","normalizePixelWidth","choosePixelSize","pixelMatch","floatWidth","getPixelWidth","getHeight$1","getGenericWidth","unit","setGenericWidth","Sizes","halve","main","newWidth","CellMutations","top","translate","Position","boxPosition","firstDefinedOrZero","absolute","win","documentElement","offsetLeft","offsetTop","scrollTop","pageYOffset","scrollLeft","pageXOffset","clientTop","clientLeft","viewport","rowInfo","colInfo","rtlEdge","pos","ltrEdge","getLeftEdge","getRightEdge","getTop","getTopEdge","getBottomEdge","findPositions","getInnerEdge","getOuterEdge","lines","cellOption","lastLine","negate","step","delta","positions","optElements","ltr","rtl","BarPositions","ResizeDirection","TableDirection","directionAt","auto","isRtl","getGridSize","input","TableGridSize","cat","findMap","setIfNot","ignore","render","newRows","newCells","renderSection","gridSection","sectionName","tb","isNew","tr","removeSection","renderOrRemoveSection","headSection","bodySection","footSection","copy$2","clonedCell","Redraw","read","split","add","old","remove$3","supports","classList","get$7","add$1","clazz","remove$4","add$2","cleanClass","remove$5","has$2","repeat","repititions","range","deduce","rest","aa","extras","abs","rowsArr","col","getBlock","isSingle","getFallback","decide","inBlock","singleInBlock","detailOption","rows$1","Blocks","namespace","dashNamespace","Styles","blocker","position","row$1","Bar","resizeBar","resizeRowBar","resizeColBar","BAR_THICKNESS","destroy","wire","previous","drawBar","origin","cpOption","cp","bar","refreshCol","colPositions","tableHeight","colBar","refreshRow","rowPositions","tableWidth","rowBar","refreshGrid","hdirection","vdirection","refresh","each$2","bars","hide","show","isRowBar","isColBar","Bars","addCell","gridRow","setCells","mutateCell","mapCells","getCell","getCellElement","cellLength","GridRow","getColumn","getRow","findDiff","comp","subgrid","restOfRow","endColIndex","restOfColumn","endRowIndex","TableGrid","toDetails","seen","ri","ci","updateSeen","toGrid","rowCells","Transitions","fromWarehouse","deriveRows","rendered","findRow","rowOfCells","toDetailList","findInWarehouse","run","operation","adjustment","postAction","genWrappers","direction","model","cursor","out","newElements","onCell","onPaste","onPasteRows","lc","onMergable","_warehouse","onUnmergable","onCells","mapError","_","onValue","toOption","isValue","isError","message","onError","fromOption","err","Result","measure","startAddress","gridA","gridB","rowRemainder","colRemainder","colRequired","rowRequired","rowDelta","colDelta","measureWidth","colLengthA","colLengthB","fill","generator","rowFill","_row","colFill","tailor","fillCols","fillRows","modifiedCols","tailoredGrid","Fitment","merge","substitution","unmerge","isToReplace","uniqueCells","currentCell","splitRows","rowPrevCells","replacement","_loop_1","_loop_2","sub","MergingOperations","isSpanning","matching","mergeTables","mergeHeight","mergeWidth","merge$1","fittedGrid","fittedNewGrid","secondDelta","fittedOldGrid","TableMerge","insertRowAt","between","ex","withinSpan","insertColumnAt","splitCellIntoColumns","exampleRow","exampleCol","isTargetCell","splitCellIntoRows","deleteColumnsAt","deleteRowsAt","ModificationOperations","replaceIn","isTarget","notStartRow","colIndex","notStartColumn","replaceColumn","alreadyAdded","replaceRow","targetRow","TransformOperations","only","middle","ColumnContext","neighbours$1","determine","context","zero","onOnly","singleColumnWidth","onChange","newNext","minCellWidth","newThis","diffx","onLeft","onMiddle","_prev","onRight","size","Deltas","getSpan$1","hasColspan","hasRowspan","getInt","CellUtils","minWidth","minHeight","getRaw$1","getRawW","getRawH","getWidthFrom","backups","columnCell","deduced","getDeduced","getRawWidths","getPercentageWidths","getPixelWidths","getHeightFrom","rowCell","getPixelHeights","getRawHeights","ColumnSizes","measures","recalculateWidth","widths","recalculateHeight","heights","matchRowHeight","Recalculations","percentageSize","getCellDelta","_delta","setTableWidth","_newWidths","ratio","change","getWidths","setElementWidth","pixelSize","newWidths","chooseSize","fallbackWidth","getTableSize","TableSize","getWarehouse$1","sumUp","getTableWarehouse","adjustWidth","deltas","dx","newSizes","adjustHeight","newHeights","dy","newCellSizes","newRowSizes","adjustWidthTo","Adjustments","handleUnsupported","baseWith","validate","invalidKeys","handleExact","exactly","verifyGenerators","elementToData","modification","toData","data","nuFrom","recent","getOrInit","transform","makeNew","replaceOrInit","merging","combine","Generators","blockList","isList","tagName","isBlock","isFormatting","isHeading","isContainer","isFrame","isInline","Structure","universe$1","isBlock$1","isList$1","isFormatting$1","isHeading$1","isContainer$1","isEmptyTag$1","isFrame$1","isInline$1","DomStructure","merge$2","isBr","advancedBr","isListItem","siblingIsBlock","rightSibling","markCell","rightSiblingIsBlock","markContent","contents","TableContent","outcome","elementFromGrid","findIn","bundle","uniqueRows","currentDetail","uniqueColumns","insertRowBefore","targetIndex","newGrid","insertRowsBefore","newG","insertRowAfter","insertRowsAfter","insertColumnBefore","insertColumnsBefore","insertColumnAfter","insertColumnsAfter","makeRowHeader","makeColumnHeader","unmakeRowHeader","unmakeColumnHeader","splitCellIntoColumns$1","splitCellIntoRows$1","eraseColumns","_comparator","_genWrappers","eraseRows","mergeCells","unmergeCells","pasteDetails","gridify","wh","mergedGrid","nuGrid","gridifyRows","pasteRowsBefore","pasteRowsAfter","resize","TableOperations","getBody$1","getPixelWidth$1","getPixelHeight","removePxSuffix","addSizeSuffix","removeDataStyle","dataStyleCells","getDirection","ltr$1","rtl$1","dir","Direction","defaultTableToolbar","defaultStyles","defaultAttributes","border","getDefaultAttributes","getParam","getDefaultStyles","hasTableResizeBars","hasTabNavigation","hasAdvancedCellTab","hasAdvancedRowTab","hasAdvancedTableTab","hasAppearanceOptions","hasTableGrid","shouldStyleWithCss","getCellClassList","getRowClassList","getTableClassList","isPercentagesForced","isPixelsForced","getToolbar","getCloneElements","cloneElements","hasObjectResizing","objectResizing","fireNewRow","fire","fireNewCell","fireObjectResizeStart","fireObjectResized","fireTableSelectionChange","otherCells","fireTableSelectionClear","TableActions","lazyWire","isTableBody","lastRowGuard","lastColumnGuard","execute","guard","createRng","setStart","setEnd","deleteRow","deleteColumn","copyRows","selectedCells","slicedGrid","slicedDetails","CopyRows","global$1","getTDTHOverallStyle","select","firstChildStyle","checkChildren","elms","currentStyle","getStyle","applyAlign","formatter","applyVAlign","unApplyAlign","unApplyVAlign","Styles$1","buildListItems","inputList","itemCallback","startItems","appendItems","menuItem","title","menu","extractAdvancedStyles","rgbToHex","toHex","borderWidth","borderStyle","borderColor","bgColor","borderwidth","borderstyle","bordercolor","backgroundcolor","getSharedValues","baseData","comparisonData","items","itemValue","itemKey","comparisonValue","getAdvancedTab","dialogName","advTabItems","getAlignment","alignments","formatName","dataName","alignmentData","matchNode","getHAlignment","getVAlignment","extractDataFromSettings","hasAdvTableTab","extractAdvancedStyleData","defaultData","cellspacing","cellpadding","caption","class","align","getBorder","advStyle","getCellPaddingCellSpacing","spacing","padding","extractDataFromTableElement","optBorderWidth","getAttrib","extractDataFromRowElement","extractDataFromCellElement","celltype","Helpers","getClassList","rowClassList","classes","textStyle","getCssText","block","children$3","getItems","classlist","CellDialogGeneralTab","normal","setAttrib","setStyle","prop","ifTruthy","DomModifier","updateSimpleProps","modifiers","updateAdvancedProps","applyToSingle","cellElm","rename","halign","valign","applyToMultiple","onSubmitCellForm","getData","close","undoManager","transact","applicator","open","cellsData","dialogTabPanel","tabs","dialogPanel","windowManager","buttons","primary","initialData","onSubmit","CellDialog","getClassList$1","formChildren","getItems$1","RowDialogGeneralTab","switchRowType","rowElm","toType","tableElm","oldParentElm","parentElm","insertAfter","updateAdvancedProps$1","modifier","onSubmitRowForm","oldData","createModifier","open$1","rowsData","RowDialog","hasOwnProperty$1","shallow$1","baseMerge","merger","objects","curObject","merge$3","global$2","DefaultRenderOptions","percentages","makeTable","tableBody","tableRow","tableHeaderCell","tableCell","render$1","rowHeaders","columnHeaders","renderOpts","tbody","trs","get$8","getOuter$2","placeCaretInCell","collapse","selectFirstCellInTable","fireEvents","isPercentage","insert$1","options","insertContent","InsertTable","getItems$2","hasClasses","insertNewTable","rowColCountItems","inputMode","alwaysItems","appearanceItems","alignmentItem","classListItem","TableDialogGeneralTab","styleTDTH","applyDataToElement","serializeStyle","setAttribs","onSubmitTableForm","captionElm","addVisual","open$2","generalPanel","nonAdvancedForm","advancedForm","dialogBody","TableDialog","getSelectionStartFromSelector","getSelectionStartCell","getSelectionStartCellOrCaption","each$3","registerCommands","clipboardRows","eraseTable","cellOrCaption","tableOpt","isEmpty","setContent","setCursorLocation","nodeChanged","getTableFromCell","getSize","resizeChange","oldSize","actOnSelection","beforeSize","copyRowSelection","pasteOnSelection","clonedRows","mceTableSplitCells","mceTableMergeCells","mceTableInsertRowBefore","mceTableInsertRowAfter","mceTableInsertColBefore","mceTableInsertColAfter","mceTableDeleteCol","mceTableDeleteRow","mceTableCutRow","mceTableCopyRow","mceTablePasteRowBefore","mceTablePasteRowAfter","mceTableDelete","func","addCommand","mceInsertTable","mceTableProps","mceTableRowProps","mceTableCellProps","Commands","view","detached","editable","body$1","ResizeWire","Event","handlers","handler","unbind","trigger","event","create$1","typeDefs","registry","Events","mkEvent","prevent","kill","fromRawEvent","rawEvent","stopPropagation","clientX","clientY","handle","binder","useCapture","wrapped","addEventListener","bind$1","removeEventListener","filter$1","bind$2","styles$1","Styles$2","Blocker","settings","layerClass","DragMode","DragSink","DragApi","compare","extract$1","mutation","sink","dragApi","mdown","forceDrop","mup","drop","mmove","move","mout","delayDrop","MouseDrag","last$2","rate","timer","cancel","clearTimeout","throttle","setTimeout","InDrag","reset","update","mode","onEvent","dataOption","offset","events","NoDrag","Movement","noDragState","inDragState","dragState","off","isOn","setup","active","movement","throttledDrop","go","mousemove","runIfActive","Dragging","transform$1","Dragger","Mutation","drag","BarMutation","delegate","xDelta","yDelta","isContentEditableTrue","findClosestContentEditable","resizeBarDragging","BarManager","resizing","hoverTable","getResizer","_dataRow","_dataCol","currentCol","getDelta","newX","oldX","startAdjust","mousedown","findClosestEditableTable","mouseover","hideBars","showBars","create$2","manager","beforeResize","afterResize","startDrag","TableResize","createContainer","margin","get$9","inline","remove$6","TableWire","calculatePercentageWidth","enforcePercentage","rawTable","tablePercentage","enforcePixels","getResizeHandler","selectionRng","startW","startRawW","isTable","lazyResize","sz","rawWire","getRng","targetElm","tableHasPercentage","percentW","targetPercentW","newCellSizes_1","newCellSize","readonly","adt$1","none$1","CellLocation","detect$4","detection","CellNavigation","create$3","SimRange","adt$2","cata$1","onBefore","onOn","onAfter","situ","before$2","after$2","Situ","adt$3","domRange","relative","exact","exactFromRange","simRange","soffset","foffset","getStart$1","startContainer","startSitu","finishSitu","getWin","range$1","Selection","selectNodeContents","createRange","selectNodeContentsUsing","setStartBefore","setStartAfter","setFinish","setEndBefore","setEndAfter","relativeToNative","exactToNative","toRect","rect","bottom","getFirstRect","rects","getClientRects","adt$4","fromRange","startOffset","endContainer","endOffset","getRanges","doDiagnose","ranges","collapsed","reversed","rev","diagnose","asLtrRange","diagnosis","searchForPoint","rectForOffset","maxX","curDeltaX","inRect","locateOffset","textnode","rangeForOffset","locate","selectNode","foundRect","searchInChildren","nodes","locateNode","locate$1","boundedX","boundedY","COLLAPSE_TO_LEFT","COLLAPSE_TO_RIGHT","getCollapseDirection","createCollapsedNode","collapseDirection","locateInElement","cursorRange","locateInEmpty","caretPositionFromPoint","offsetNode","caretRangeFromPoint","searchTextNodes","searchFromPoint","availableSearch","fromPoint$1","beforeSpecial","name$1","preprocessRelative","preprocessExact","preprocess","makeRange","after$3","same","doSetNativeRange","getSelection","removeAllRanges","addRange","doSetRange","setLegacyRtlRange","extend","setRangeFromRelative","setBaseAndExtent","setExact","setRelative","toNative","getDomRange","readRange","rangeCount","firstRng","getRangeAt","lastRng","doGetExact","anchor","anchorNode","focusNode","anchorOffset","focusOffset","setToElement","getExact","sel","get$a","getFirstRect$1","getAtPoint","global$3","forward","backward","getCellFirstCursorPosition","getNewRowCursorPosition","rootElements","handle$1","keyCode","TAB","body_1","isRoot_1","navigation","shiftKey","TabContext","create$4","Response","create$5","Situs","convertToRange","makeSitus","Util","sync","selectRange","detect$5","cellSel","annotations","updateSelection","newSels","clearBeforeUpdate","KeySelection","traverse","backtrack","_direction","transition","sidestep","advance","successors","go$1","rules","ruleOpt","succ","rule","Walkers","hone","left$1","right$1","isLeaf","before$3","seekLeft","after$4","seekRight","universe$2","before$4","after$5","seekLeft$1","seekRight$1","ancestor$2","point","range$2","points","adt$5","success","failedUp","failedDown","isOverlapping","bridge","beforeBounds","getRect","afterBounds","isRow","verify","beforeOffset","afterOffset","failure","afterCell","beforeCell","_sharedRow","cata$2","onSuccess","onFailedUp","onFailedDown","BeforeAfter","inAncestor","inParent","indexInParent","gatherer","cand","gather","handleBr","findBr","handleParent","br","adjacent","tryBr","tgt","process","analysis","BrTags","nu$3","moveDown","caret","moveUp","moveBottomTo","moveTopTo","getTop$1","getBottom","Carets","getPartialBox","getRangedRect","toCaret","getElemBox","getBoxAt","getEntireBox","Rectangles","JUMP_SIZE","NUM_RETRIES","adt$6","retry","isOutside","inOutsideBlock","adjustDown","guessBox","lowerCaret","adjustUp","higherCaret","upMovement","adjuster","downMovement","isAtTable","adjustForTable","numRetries","adjustTil","situsFromPoint","guess","newCaret","ieTryDown","ieTryUp","checkScroll","adjusted","getInnerHeight","moved","scrollBy","Retries","tryUp","tryDown","getJumpSize","MAX_RETRIES","platform$2","findSpot","brNeighbour","fromSitus","scan","tryCursor","situs","tryAgain","tryAt","otherRetry","ieRetry","handle$2","TableKeys","inSameTable","simulate","navigate","precheck","firstUpCheck","lastOffset","lastDownCheck","VerticalMovement","findCell","MouseSelection","clearState","selectContents","mouseup","_event","KeyDirection","isKey","keycode","isUp","isDown","isNavigation","SelectionKeys","isBackward","isForward","toRaw","sr","Rect","get$b","_DOC","by","WindowBridge","exactAdt","clearSelection","setSelection","setRelativeSelection","innerHeight","getScrollY","rc","mouse","keyboard","clearToNavigate","keydown","realEvent","which","attempts","keyup","platform$3","external","InputHandlers","remove$7","addClass","removeClasses","byClass","ephemera","addSelectionClass","removeSelectionClasses","byAttr","onSelection","onClear","removeSelectionAttributes","addSelectionAttribute","SelectionAnnotation","getUpOrLeftCells","upGrid","upDetails","slicedCells","getDownOrRightCells","downGrid","downDetails","getOtherCells","upOrLeftCells","downOrRightCells","OtherCells","hasInternalTarget","CellSelection$1","selectionTargets","handlerStruct","syncSelection","mouseHandlers","keyHandlers","hasShiftKey","handleResponse","response","ns","wrappedEvent","wrapEvent","isMouseEvent","isLeftMouse","button","isLeftButtonPressed","mouseDown","mouseOver","mouseUp","getDoubleTap","lastTarget","lastTimeStamp","touchEnd","lT","lTS","timeStamp","doubleTap","Selections","getSelectionTargets","changeHandlers","findTargets","resetTargets","onSetup","isDisabled","setDisabled","onSetupTable","onSetupCellOrRow","onSetupMergeable","onSetupUnmergeable","addButtons","ui","addMenuButton","tooltip","icon","fetch","callback","cmd","command","execCommand","addButton","onAction","addToolbars","toolbar","addContextToolbar","Buttons","addMenuItems","insertTableAction","_a","numRows","numColumns","tableProperties","deleteTable","rowItems","getSubmenuItems","columnItems","cellItems","addMenuItem","addNestedMenuItem","fancytype","addContextMenu","MenuItems","getClipboardRows","setClipboardRows","sugarRows","getApi","resizeHandler","menuItems","insertTable","Plugin","addTempAttr","Plugin$1"],"mappings":"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","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.1.0 (2019-10-17)\n */\n(function (domGlobals) {\n    'use strict';\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      var clone = function () {\n        return Cell(get());\n      };\n      return {\n        get: get,\n        set: set,\n        clone: clone\n      };\n    };\n\n    var noop = function () {\n    };\n    var compose = function (fa, fb) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return fa(fb.apply(null, args));\n      };\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var identity = function (x) {\n      return x;\n    };\n    function curry(fn) {\n      var initialArgs = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        initialArgs[_i - 1] = arguments[_i];\n      }\n      return function () {\n        var restArgs = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          restArgs[_i] = arguments[_i];\n        }\n        var all = initialArgs.concat(restArgs);\n        return fn.apply(null, all);\n      };\n    }\n    var not = function (f) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return !f.apply(null, args);\n      };\n    };\n    var die = function (msg) {\n      return function () {\n        throw new Error(msg);\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      if (Object.freeze) {\n        Object.freeze(me);\n      }\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Option = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var typeOf = function (x) {\n      if (x === null) {\n        return 'null';\n      }\n      var t = typeof x;\n      if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      }\n      if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      }\n      return t;\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isString = isType('string');\n    var isArray = isType('array');\n    var isBoolean = isType('boolean');\n    var isFunction = isType('function');\n    var isNumber = isType('number');\n\n    var nativeSlice = Array.prototype.slice;\n    var nativeIndexOf = Array.prototype.indexOf;\n    var nativePush = Array.prototype.push;\n    var rawIndexOf = function (ts, t) {\n      return nativeIndexOf.call(ts, t);\n    };\n    var contains = function (xs, x) {\n      return rawIndexOf(xs, x) > -1;\n    };\n    var exists = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var eachr = function (xs, f) {\n      for (var i = xs.length - 1; i >= 0; i--) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var filter = function (xs, pred) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          r.push(x);\n        }\n      }\n      return r;\n    };\n    var foldr = function (xs, f, acc) {\n      eachr(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var foldl = function (xs, f, acc) {\n      each(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var find = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Option.some(x);\n        }\n      }\n      return Option.none();\n    };\n    var findIndex = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Option.some(i);\n        }\n      }\n      return Option.none();\n    };\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var bind = function (xs, f) {\n      var output = map(xs, f);\n      return flatten(output);\n    };\n    var forall = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        var x = xs[i];\n        if (pred(x, i) !== true) {\n          return false;\n        }\n      }\n      return true;\n    };\n    var reverse = function (xs) {\n      var r = nativeSlice.call(xs, 0);\n      r.reverse();\n      return r;\n    };\n    var last = function (xs) {\n      return xs.length === 0 ? Option.none() : Option.some(xs[xs.length - 1]);\n    };\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n\n    var keys = Object.keys;\n    var hasOwnProperty = Object.hasOwnProperty;\n    var each$1 = function (obj, f) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        f(x, i);\n      }\n    };\n    var map$1 = function (obj, f) {\n      return tupleMap(obj, function (x, i) {\n        return {\n          k: i,\n          v: f(x, i)\n        };\n      });\n    };\n    var tupleMap = function (obj, f) {\n      var r = {};\n      each$1(obj, function (x, i) {\n        var tuple = f(x, i);\n        r[tuple.k] = tuple.v;\n      });\n      return r;\n    };\n    var get = function (obj, key) {\n      return has(obj, key) ? Option.from(obj[key]) : Option.none();\n    };\n    var has = function (obj, key) {\n      return hasOwnProperty.call(obj, key);\n    };\n\n    var Immutable = function () {\n      var fields = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        fields[_i] = arguments[_i];\n      }\n      return function () {\n        var values = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          values[_i] = arguments[_i];\n        }\n        if (fields.length !== values.length) {\n          throw new Error('Wrong number of arguments to struct. Expected \"[' + fields.length + ']\", got ' + values.length + ' arguments');\n        }\n        var struct = {};\n        each(fields, function (name, i) {\n          struct[name] = constant(values[i]);\n        });\n        return struct;\n      };\n    };\n\n    var sort = function (arr) {\n      return arr.slice(0).sort();\n    };\n    var reqMessage = function (required, keys) {\n      throw new Error('All required keys (' + sort(required).join(', ') + ') were not specified. Specified keys were: ' + sort(keys).join(', ') + '.');\n    };\n    var unsuppMessage = function (unsupported) {\n      throw new Error('Unsupported keys for object: ' + sort(unsupported).join(', '));\n    };\n    var validateStrArr = function (label, array) {\n      if (!isArray(array)) {\n        throw new Error('The ' + label + ' fields must be an array. Was: ' + array + '.');\n      }\n      each(array, function (a) {\n        if (!isString(a)) {\n          throw new Error('The value ' + a + ' in the ' + label + ' fields was not a string.');\n        }\n      });\n    };\n    var invalidTypeMessage = function (incorrect, type) {\n      throw new Error('All values need to be of type: ' + type + '. Keys (' + sort(incorrect).join(', ') + ') were not.');\n    };\n    var checkDupes = function (everything) {\n      var sorted = sort(everything);\n      var dupe = find(sorted, function (s, i) {\n        return i < sorted.length - 1 && s === sorted[i + 1];\n      });\n      dupe.each(function (d) {\n        throw new Error('The field: ' + d + ' occurs more than once in the combined fields: [' + sorted.join(', ') + '].');\n      });\n    };\n\n    var MixedBag = function (required, optional) {\n      var everything = required.concat(optional);\n      if (everything.length === 0) {\n        throw new Error('You must specify at least one required or optional field.');\n      }\n      validateStrArr('required', required);\n      validateStrArr('optional', optional);\n      checkDupes(everything);\n      return function (obj) {\n        var keys$1 = keys(obj);\n        var allReqd = forall(required, function (req) {\n          return contains(keys$1, req);\n        });\n        if (!allReqd) {\n          reqMessage(required, keys$1);\n        }\n        var unsupported = filter(keys$1, function (key) {\n          return !contains(everything, key);\n        });\n        if (unsupported.length > 0) {\n          unsuppMessage(unsupported);\n        }\n        var r = {};\n        each(required, function (req) {\n          r[req] = constant(obj[req]);\n        });\n        each(optional, function (opt) {\n          r[opt] = constant(Object.prototype.hasOwnProperty.call(obj, opt) ? Option.some(obj[opt]) : Option.none());\n        });\n        return r;\n      };\n    };\n\n    var ATTRIBUTE = domGlobals.Node.ATTRIBUTE_NODE;\n    var CDATA_SECTION = domGlobals.Node.CDATA_SECTION_NODE;\n    var COMMENT = domGlobals.Node.COMMENT_NODE;\n    var DOCUMENT = domGlobals.Node.DOCUMENT_NODE;\n    var DOCUMENT_TYPE = domGlobals.Node.DOCUMENT_TYPE_NODE;\n    var DOCUMENT_FRAGMENT = domGlobals.Node.DOCUMENT_FRAGMENT_NODE;\n    var ELEMENT = domGlobals.Node.ELEMENT_NODE;\n    var TEXT = domGlobals.Node.TEXT_NODE;\n    var PROCESSING_INSTRUCTION = domGlobals.Node.PROCESSING_INSTRUCTION_NODE;\n    var ENTITY_REFERENCE = domGlobals.Node.ENTITY_REFERENCE_NODE;\n    var ENTITY = domGlobals.Node.ENTITY_NODE;\n    var NOTATION = domGlobals.Node.NOTATION_NODE;\n\n    var Global = typeof domGlobals.window !== 'undefined' ? domGlobals.window : Function('return this;')();\n\n    var name = function (element) {\n      var r = element.dom().nodeName;\n      return r.toLowerCase();\n    };\n    var type = function (element) {\n      return element.dom().nodeType;\n    };\n    var isType$1 = function (t) {\n      return function (element) {\n        return type(element) === t;\n      };\n    };\n    var isComment = function (element) {\n      return type(element) === COMMENT || name(element) === '#comment';\n    };\n    var isElement = isType$1(ELEMENT);\n    var isText = isType$1(TEXT);\n\n    var rawSet = function (dom, key, value) {\n      if (isString(value) || isBoolean(value) || isNumber(value)) {\n        dom.setAttribute(key, value + '');\n      } else {\n        domGlobals.console.error('Invalid call to Attr.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n        throw new Error('Attribute value was not simple');\n      }\n    };\n    var set = function (element, key, value) {\n      rawSet(element.dom(), key, value);\n    };\n    var setAll = function (element, attrs) {\n      var dom = element.dom();\n      each$1(attrs, function (v, k) {\n        rawSet(dom, k, v);\n      });\n    };\n    var get$1 = function (element, key) {\n      var v = element.dom().getAttribute(key);\n      return v === null ? undefined : v;\n    };\n    var has$1 = function (element, key) {\n      var dom = element.dom();\n      return dom && dom.hasAttribute ? dom.hasAttribute(key) : false;\n    };\n    var remove = function (element, key) {\n      element.dom().removeAttribute(key);\n    };\n    var clone = function (element) {\n      return foldl(element.dom().attributes, function (acc, attr) {\n        acc[attr.name] = attr.value;\n        return acc;\n      }, {});\n    };\n\n    var checkRange = function (str, substr, start) {\n      if (substr === '') {\n        return true;\n      }\n      if (str.length < substr.length) {\n        return false;\n      }\n      var x = str.substr(start, start + substr.length);\n      return x === substr;\n    };\n    var contains$1 = function (str, substr) {\n      return str.indexOf(substr) !== -1;\n    };\n    var startsWith = function (str, prefix) {\n      return checkRange(str, prefix, 0);\n    };\n    var endsWith = function (str, suffix) {\n      return checkRange(str, suffix, str.length - suffix.length);\n    };\n    var trim = function (str) {\n      return str.replace(/^\\s+|\\s+$/g, '');\n    };\n\n    var isSupported = function (dom) {\n      return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n    };\n\n    var cached = function (f) {\n      var called = false;\n      var r;\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (!called) {\n          called = true;\n          r = f.apply(null, args);\n        }\n        return r;\n      };\n    };\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || domGlobals.document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        domGlobals.console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: constant(node) };\n    };\n    var fromPoint = function (docElm, x, y) {\n      var doc = docElm.dom();\n      return Option.from(doc.elementFromPoint(x, y)).map(fromDom);\n    };\n    var Element = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    var inBody = function (element) {\n      var dom = isText(element) ? element.dom().parentNode : element.dom();\n      return dom !== undefined && dom !== null && dom.ownerDocument.body.contains(dom);\n    };\n    var body = cached(function () {\n      return getBody(Element.fromDom(domGlobals.document));\n    });\n    var getBody = function (doc) {\n      var b = doc.dom().body;\n      if (b === null || b === undefined) {\n        throw new Error('Body is not available yet');\n      }\n      return Element.fromDom(b);\n    };\n\n    var internalSet = function (dom, property, value) {\n      if (!isString(value)) {\n        domGlobals.console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n        throw new Error('CSS value must be a string: ' + value);\n      }\n      if (isSupported(dom)) {\n        dom.style.setProperty(property, value);\n      }\n    };\n    var internalRemove = function (dom, property) {\n      if (isSupported(dom)) {\n        dom.style.removeProperty(property);\n      }\n    };\n    var set$1 = function (element, property, value) {\n      var dom = element.dom();\n      internalSet(dom, property, value);\n    };\n    var setAll$1 = function (element, css) {\n      var dom = element.dom();\n      each$1(css, function (v, k) {\n        internalSet(dom, k, v);\n      });\n    };\n    var get$2 = function (element, property) {\n      var dom = element.dom();\n      var styles = domGlobals.window.getComputedStyle(dom);\n      var r = styles.getPropertyValue(property);\n      var v = r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n      return v === null ? undefined : v;\n    };\n    var getUnsafeProperty = function (dom, property) {\n      return isSupported(dom) ? dom.style.getPropertyValue(property) : '';\n    };\n    var getRaw = function (element, property) {\n      var dom = element.dom();\n      var raw = getUnsafeProperty(dom, property);\n      return Option.from(raw).filter(function (r) {\n        return r.length > 0;\n      });\n    };\n    var remove$1 = function (element, property) {\n      var dom = element.dom();\n      internalRemove(dom, property);\n      if (has$1(element, 'style') && trim(get$1(element, 'style')) === '') {\n        remove(element, 'style');\n      }\n    };\n    var copy = function (source, target) {\n      var sourceDom = source.dom();\n      var targetDom = target.dom();\n      if (isSupported(sourceDom) && isSupported(targetDom)) {\n        targetDom.style.cssText = sourceDom.style.cssText;\n      }\n    };\n\n    var compareDocumentPosition = function (a, b, match) {\n      return (a.compareDocumentPosition(b) & match) !== 0;\n    };\n    var documentPositionPreceding = function (a, b) {\n      return compareDocumentPosition(a, b, domGlobals.Node.DOCUMENT_POSITION_PRECEDING);\n    };\n    var documentPositionContainedBy = function (a, b) {\n      return compareDocumentPosition(a, b, domGlobals.Node.DOCUMENT_POSITION_CONTAINED_BY);\n    };\n    var Node = {\n      documentPositionPreceding: documentPositionPreceding,\n      documentPositionContainedBy: documentPositionContainedBy\n    };\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n\n    var firstMatch = function (regexes, s) {\n      for (var i = 0; i < regexes.length; i++) {\n        var x = regexes[i];\n        if (x.test(s)) {\n          return x;\n        }\n      }\n      return undefined;\n    };\n    var find$1 = function (regexes, agent) {\n      var r = firstMatch(regexes, agent);\n      if (!r) {\n        return {\n          major: 0,\n          minor: 0\n        };\n      }\n      var group = function (i) {\n        return Number(agent.replace(r, '$' + i));\n      };\n      return nu(group(1), group(2));\n    };\n    var detect = function (versionRegexes, agent) {\n      var cleanedAgent = String(agent).toLowerCase();\n      if (versionRegexes.length === 0) {\n        return unknown();\n      }\n      return find$1(versionRegexes, cleanedAgent);\n    };\n    var unknown = function () {\n      return nu(0, 0);\n    };\n    var nu = function (major, minor) {\n      return {\n        major: major,\n        minor: minor\n      };\n    };\n    var Version = {\n      nu: nu,\n      detect: detect,\n      unknown: unknown\n    };\n\n    var edge = 'Edge';\n    var chrome = 'Chrome';\n    var ie = 'IE';\n    var opera = 'Opera';\n    var firefox = 'Firefox';\n    var safari = 'Safari';\n    var isBrowser = function (name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n    var unknown$1 = function () {\n      return nu$1({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$1 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isEdge: isBrowser(edge, current),\n        isChrome: isBrowser(chrome, current),\n        isIE: isBrowser(ie, current),\n        isOpera: isBrowser(opera, current),\n        isFirefox: isBrowser(firefox, current),\n        isSafari: isBrowser(safari, current)\n      };\n    };\n    var Browser = {\n      unknown: unknown$1,\n      nu: nu$1,\n      edge: constant(edge),\n      chrome: constant(chrome),\n      ie: constant(ie),\n      opera: constant(opera),\n      firefox: constant(firefox),\n      safari: constant(safari)\n    };\n\n    var windows = 'Windows';\n    var ios = 'iOS';\n    var android = 'Android';\n    var linux = 'Linux';\n    var osx = 'OSX';\n    var solaris = 'Solaris';\n    var freebsd = 'FreeBSD';\n    var isOS = function (name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n    var unknown$2 = function () {\n      return nu$2({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$2 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isWindows: isOS(windows, current),\n        isiOS: isOS(ios, current),\n        isAndroid: isOS(android, current),\n        isOSX: isOS(osx, current),\n        isLinux: isOS(linux, current),\n        isSolaris: isOS(solaris, current),\n        isFreeBSD: isOS(freebsd, current)\n      };\n    };\n    var OperatingSystem = {\n      unknown: unknown$2,\n      nu: nu$2,\n      windows: constant(windows),\n      ios: constant(ios),\n      android: constant(android),\n      linux: constant(linux),\n      osx: constant(osx),\n      solaris: constant(solaris),\n      freebsd: constant(freebsd)\n    };\n\n    var DeviceType = function (os, browser, userAgent, mediaMatch) {\n      var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n      var isiPhone = os.isiOS() && !isiPad;\n      var isMobile = os.isiOS() || os.isAndroid();\n      var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n      var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n      var isPhone = isiPhone || isMobile && !isTablet;\n      var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n      var isDesktop = !isPhone && !isTablet && !iOSwebview;\n      return {\n        isiPad: constant(isiPad),\n        isiPhone: constant(isiPhone),\n        isTablet: constant(isTablet),\n        isPhone: constant(isPhone),\n        isTouch: constant(isTouch),\n        isAndroid: os.isAndroid,\n        isiOS: os.isiOS,\n        isWebView: constant(iOSwebview),\n        isDesktop: constant(isDesktop)\n      };\n    };\n\n    var detect$1 = function (candidates, userAgent) {\n      var agent = String(userAgent).toLowerCase();\n      return find(candidates, function (candidate) {\n        return candidate.search(agent);\n      });\n    };\n    var detectBrowser = function (browsers, userAgent) {\n      return detect$1(browsers, userAgent).map(function (browser) {\n        var version = Version.detect(browser.versionRegexes, userAgent);\n        return {\n          current: browser.name,\n          version: version\n        };\n      });\n    };\n    var detectOs = function (oses, userAgent) {\n      return detect$1(oses, userAgent).map(function (os) {\n        var version = Version.detect(os.versionRegexes, userAgent);\n        return {\n          current: os.name,\n          version: version\n        };\n      });\n    };\n    var UaString = {\n      detectBrowser: detectBrowser,\n      detectOs: detectOs\n    };\n\n    var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n    var checkContains = function (target) {\n      return function (uastring) {\n        return contains$1(uastring, target);\n      };\n    };\n    var browsers = [\n      {\n        name: 'Edge',\n        versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n        search: function (uastring) {\n          return contains$1(uastring, 'edge/') && contains$1(uastring, 'chrome') && contains$1(uastring, 'safari') && contains$1(uastring, 'applewebkit');\n        }\n      },\n      {\n        name: 'Chrome',\n        versionRegexes: [\n          /.*?chrome\\/([0-9]+)\\.([0-9]+).*/,\n          normalVersionRegex\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'chrome') && !contains$1(uastring, 'chromeframe');\n        }\n      },\n      {\n        name: 'IE',\n        versionRegexes: [\n          /.*?msie\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*?rv:([0-9]+)\\.([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'msie') || contains$1(uastring, 'trident');\n        }\n      },\n      {\n        name: 'Opera',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?opera\\/([0-9]+)\\.([0-9]+).*/\n        ],\n        search: checkContains('opera')\n      },\n      {\n        name: 'Firefox',\n        versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n        search: checkContains('firefox')\n      },\n      {\n        name: 'Safari',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?cpu os ([0-9]+)_([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return (contains$1(uastring, 'safari') || contains$1(uastring, 'mobile/')) && contains$1(uastring, 'applewebkit');\n        }\n      }\n    ];\n    var oses = [\n      {\n        name: 'Windows',\n        search: checkContains('win'),\n        versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'iOS',\n        search: function (uastring) {\n          return contains$1(uastring, 'iphone') || contains$1(uastring, 'ipad');\n        },\n        versionRegexes: [\n          /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*cpu os ([0-9]+)_([0-9]+).*/,\n          /.*cpu iphone os ([0-9]+)_([0-9]+).*/\n        ]\n      },\n      {\n        name: 'Android',\n        search: checkContains('android'),\n        versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'OSX',\n        search: checkContains('os x'),\n        versionRegexes: [/.*?os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n      },\n      {\n        name: 'Linux',\n        search: checkContains('linux'),\n        versionRegexes: []\n      },\n      {\n        name: 'Solaris',\n        search: checkContains('sunos'),\n        versionRegexes: []\n      },\n      {\n        name: 'FreeBSD',\n        search: checkContains('freebsd'),\n        versionRegexes: []\n      }\n    ];\n    var PlatformInfo = {\n      browsers: constant(browsers),\n      oses: constant(oses)\n    };\n\n    var detect$2 = function (userAgent, mediaMatch) {\n      var browsers = PlatformInfo.browsers();\n      var oses = PlatformInfo.oses();\n      var browser = UaString.detectBrowser(browsers, userAgent).fold(Browser.unknown, Browser.nu);\n      var os = UaString.detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n      var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n      return {\n        browser: browser,\n        os: os,\n        deviceType: deviceType\n      };\n    };\n    var PlatformDetection = { detect: detect$2 };\n\n    var mediaMatch = function (query) {\n      return domGlobals.window.matchMedia(query).matches;\n    };\n    var platform = Cell(PlatformDetection.detect(domGlobals.navigator.userAgent, mediaMatch));\n    var detect$3 = function () {\n      return platform.get();\n    };\n\n    var ELEMENT$1 = ELEMENT;\n    var DOCUMENT$1 = DOCUMENT;\n    var is = function (element, selector) {\n      var dom = element.dom();\n      if (dom.nodeType !== ELEMENT$1) {\n        return false;\n      } else {\n        var elem = dom;\n        if (elem.matches !== undefined) {\n          return elem.matches(selector);\n        } else if (elem.msMatchesSelector !== undefined) {\n          return elem.msMatchesSelector(selector);\n        } else if (elem.webkitMatchesSelector !== undefined) {\n          return elem.webkitMatchesSelector(selector);\n        } else if (elem.mozMatchesSelector !== undefined) {\n          return elem.mozMatchesSelector(selector);\n        } else {\n          throw new Error('Browser lacks native selectors');\n        }\n      }\n    };\n    var bypassSelector = function (dom) {\n      return dom.nodeType !== ELEMENT$1 && dom.nodeType !== DOCUMENT$1 || dom.childElementCount === 0;\n    };\n    var all = function (selector, scope) {\n      var base = scope === undefined ? domGlobals.document : scope.dom();\n      return bypassSelector(base) ? [] : map(base.querySelectorAll(selector), Element.fromDom);\n    };\n    var one = function (selector, scope) {\n      var base = scope === undefined ? domGlobals.document : scope.dom();\n      return bypassSelector(base) ? Option.none() : Option.from(base.querySelector(selector)).map(Element.fromDom);\n    };\n\n    var eq = function (e1, e2) {\n      return e1.dom() === e2.dom();\n    };\n    var regularContains = function (e1, e2) {\n      var d1 = e1.dom();\n      var d2 = e2.dom();\n      return d1 === d2 ? false : d1.contains(d2);\n    };\n    var ieContains = function (e1, e2) {\n      return Node.documentPositionContainedBy(e1.dom(), e2.dom());\n    };\n    var browser = detect$3().browser;\n    var contains$2 = browser.isIE() ? ieContains : regularContains;\n    var is$1 = is;\n\n    var owner = function (element) {\n      return Element.fromDom(element.dom().ownerDocument);\n    };\n    var defaultView = function (element) {\n      return Element.fromDom(element.dom().ownerDocument.defaultView);\n    };\n    var parent = function (element) {\n      return Option.from(element.dom().parentNode).map(Element.fromDom);\n    };\n    var parents = function (element, isRoot) {\n      var stop = isFunction(isRoot) ? isRoot : never;\n      var dom = element.dom();\n      var ret = [];\n      while (dom.parentNode !== null && dom.parentNode !== undefined) {\n        var rawParent = dom.parentNode;\n        var p = Element.fromDom(rawParent);\n        ret.push(p);\n        if (stop(p) === true) {\n          break;\n        } else {\n          dom = rawParent;\n        }\n      }\n      return ret;\n    };\n    var prevSibling = function (element) {\n      return Option.from(element.dom().previousSibling).map(Element.fromDom);\n    };\n    var nextSibling = function (element) {\n      return Option.from(element.dom().nextSibling).map(Element.fromDom);\n    };\n    var children = function (element) {\n      return map(element.dom().childNodes, Element.fromDom);\n    };\n    var child = function (element, index) {\n      var cs = element.dom().childNodes;\n      return Option.from(cs[index]).map(Element.fromDom);\n    };\n    var firstChild = function (element) {\n      return child(element, 0);\n    };\n    var spot = Immutable('element', 'offset');\n\n    var before = function (marker, element) {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        v.dom().insertBefore(element.dom(), marker.dom());\n      });\n    };\n    var after = function (marker, element) {\n      var sibling = nextSibling(marker);\n      sibling.fold(function () {\n        var parent$1 = parent(marker);\n        parent$1.each(function (v) {\n          append(v, element);\n        });\n      }, function (v) {\n        before(v, element);\n      });\n    };\n    var prepend = function (parent, element) {\n      var firstChild$1 = firstChild(parent);\n      firstChild$1.fold(function () {\n        append(parent, element);\n      }, function (v) {\n        parent.dom().insertBefore(element.dom(), v.dom());\n      });\n    };\n    var append = function (parent, element) {\n      parent.dom().appendChild(element.dom());\n    };\n    var wrap = function (element, wrapper) {\n      before(element, wrapper);\n      append(wrapper, element);\n    };\n\n    var before$1 = function (marker, elements) {\n      each(elements, function (x) {\n        before(marker, x);\n      });\n    };\n    var after$1 = function (marker, elements) {\n      each(elements, function (x, i) {\n        var e = i === 0 ? marker : elements[i - 1];\n        after(e, x);\n      });\n    };\n    var append$1 = function (parent, elements) {\n      each(elements, function (x) {\n        append(parent, x);\n      });\n    };\n\n    var empty = function (element) {\n      element.dom().textContent = '';\n      each(children(element), function (rogue) {\n        remove$2(rogue);\n      });\n    };\n    var remove$2 = function (element) {\n      var dom = element.dom();\n      if (dom.parentNode !== null) {\n        dom.parentNode.removeChild(dom);\n      }\n    };\n    var unwrap = function (wrapper) {\n      var children$1 = children(wrapper);\n      if (children$1.length > 0) {\n        before$1(wrapper, children$1);\n      }\n      remove$2(wrapper);\n    };\n\n    var dimension = Immutable('width', 'height');\n    var dimensions = Immutable('width', 'height');\n    var grid = Immutable('rows', 'columns');\n    var address = Immutable('row', 'column');\n    var coords = Immutable('x', 'y');\n    var detail = Immutable('element', 'rowspan', 'colspan');\n    var detailnew = Immutable('element', 'rowspan', 'colspan', 'isNew');\n    var extended = Immutable('element', 'rowspan', 'colspan', 'row', 'column');\n    var rowdata = Immutable('element', 'cells', 'section');\n    var elementnew = Immutable('element', 'isNew');\n    var rowdatanew = Immutable('element', 'cells', 'section', 'isNew');\n    var rowcells = Immutable('cells', 'section');\n    var rowdetails = Immutable('details', 'section');\n    var bounds = Immutable('startRow', 'startCol', 'finishRow', 'finishCol');\n\n    var ancestors = function (scope, predicate, isRoot) {\n      return filter(parents(scope, isRoot), predicate);\n    };\n    var children$1 = function (scope, predicate) {\n      return filter(children(scope), predicate);\n    };\n    var descendants = function (scope, predicate) {\n      var result = [];\n      each(children(scope), function (x) {\n        if (predicate(x)) {\n          result = result.concat([x]);\n        }\n        result = result.concat(descendants(x, predicate));\n      });\n      return result;\n    };\n\n    var ancestors$1 = function (scope, selector, isRoot) {\n      return ancestors(scope, function (e) {\n        return is(e, selector);\n      }, isRoot);\n    };\n    var children$2 = function (scope, selector) {\n      return children$1(scope, function (e) {\n        return is(e, selector);\n      });\n    };\n    var descendants$1 = function (scope, selector) {\n      return all(selector, scope);\n    };\n\n    function ClosestOrAncestor (is, ancestor, scope, a, isRoot) {\n      return is(scope, a) ? Option.some(scope) : isFunction(isRoot) && isRoot(scope) ? Option.none() : ancestor(scope, a, isRoot);\n    }\n\n    var ancestor = function (scope, predicate, isRoot) {\n      var element = scope.dom();\n      var stop = isFunction(isRoot) ? isRoot : constant(false);\n      while (element.parentNode) {\n        element = element.parentNode;\n        var el = Element.fromDom(element);\n        if (predicate(el)) {\n          return Option.some(el);\n        } else if (stop(el)) {\n          break;\n        }\n      }\n      return Option.none();\n    };\n    var closest = function (scope, predicate, isRoot) {\n      var is = function (s, test) {\n        return test(s);\n      };\n      return ClosestOrAncestor(is, ancestor, scope, predicate, isRoot);\n    };\n    var child$1 = function (scope, predicate) {\n      var pred = function (node) {\n        return predicate(Element.fromDom(node));\n      };\n      var result = find(scope.dom().childNodes, pred);\n      return result.map(Element.fromDom);\n    };\n    var descendant = function (scope, predicate) {\n      var descend = function (node) {\n        for (var i = 0; i < node.childNodes.length; i++) {\n          var child_1 = Element.fromDom(node.childNodes[i]);\n          if (predicate(child_1)) {\n            return Option.some(child_1);\n          }\n          var res = descend(node.childNodes[i]);\n          if (res.isSome()) {\n            return res;\n          }\n        }\n        return Option.none();\n      };\n      return descend(scope.dom());\n    };\n\n    var ancestor$1 = function (scope, selector, isRoot) {\n      return ancestor(scope, function (e) {\n        return is(e, selector);\n      }, isRoot);\n    };\n    var child$2 = function (scope, selector) {\n      return child$1(scope, function (e) {\n        return is(e, selector);\n      });\n    };\n    var descendant$1 = function (scope, selector) {\n      return one(selector, scope);\n    };\n    var closest$1 = function (scope, selector, isRoot) {\n      return ClosestOrAncestor(is, ancestor$1, scope, selector, isRoot);\n    };\n\n    var firstLayer = function (scope, selector) {\n      return filterFirstLayer(scope, selector, constant(true));\n    };\n    var filterFirstLayer = function (scope, selector, predicate) {\n      return bind(children(scope), function (x) {\n        return is(x, selector) ? predicate(x) ? [x] : [] : filterFirstLayer(x, selector, predicate);\n      });\n    };\n    var LayerSelector = {\n      firstLayer: firstLayer,\n      filterFirstLayer: filterFirstLayer\n    };\n\n    var lookup = function (tags, element, isRoot) {\n      if (isRoot === void 0) {\n        isRoot = never;\n      }\n      if (isRoot(element)) {\n        return Option.none();\n      }\n      if (contains(tags, name(element))) {\n        return Option.some(element);\n      }\n      var isRootOrUpperTable = function (elm) {\n        return is(elm, 'table') || isRoot(elm);\n      };\n      return ancestor$1(element, tags.join(','), isRootOrUpperTable);\n    };\n    var cell = function (element, isRoot) {\n      return lookup([\n        'td',\n        'th'\n      ], element, isRoot);\n    };\n    var cells = function (ancestor) {\n      return LayerSelector.firstLayer(ancestor, 'th,td');\n    };\n    var notCell = function (element, isRoot) {\n      return lookup([\n        'caption',\n        'tr',\n        'tbody',\n        'tfoot',\n        'thead'\n      ], element, isRoot);\n    };\n    var neighbours = function (selector, element) {\n      return parent(element).map(function (parent) {\n        return children$2(parent, selector);\n      });\n    };\n    var neighbourCells = curry(neighbours, 'th,td');\n    var neighbourRows = curry(neighbours, 'tr');\n    var firstCell = function (ancestor) {\n      return descendant$1(ancestor, 'th,td');\n    };\n    var table = function (element, isRoot) {\n      return closest$1(element, 'table', isRoot);\n    };\n    var row = function (element, isRoot) {\n      return lookup(['tr'], element, isRoot);\n    };\n    var rows = function (ancestor) {\n      return LayerSelector.firstLayer(ancestor, 'tr');\n    };\n    var attr = function (element, property) {\n      return parseInt(get$1(element, property), 10);\n    };\n    var grid$1 = function (element, rowProp, colProp) {\n      var rowsCount = attr(element, rowProp);\n      var cols = attr(element, colProp);\n      return grid(rowsCount, cols);\n    };\n    var TableLookup = {\n      cell: cell,\n      firstCell: firstCell,\n      cells: cells,\n      neighbourCells: neighbourCells,\n      table: table,\n      row: row,\n      rows: rows,\n      notCell: notCell,\n      neighbourRows: neighbourRows,\n      attr: attr,\n      grid: grid$1\n    };\n\n    var fromTable = function (table) {\n      var rows = TableLookup.rows(table);\n      return map(rows, function (row) {\n        var element = row;\n        var parent$1 = parent(element);\n        var parentSection = parent$1.map(function (p) {\n          var parentName = name(p);\n          return parentName === 'tfoot' || parentName === 'thead' || parentName === 'tbody' ? parentName : 'tbody';\n        }).getOr('tbody');\n        var cells = map(TableLookup.cells(row), function (cell) {\n          var rowspan = has$1(cell, 'rowspan') ? parseInt(get$1(cell, 'rowspan'), 10) : 1;\n          var colspan = has$1(cell, 'colspan') ? parseInt(get$1(cell, 'colspan'), 10) : 1;\n          return detail(cell, rowspan, colspan);\n        });\n        return rowdata(element, cells, parentSection);\n      });\n    };\n    var fromPastedRows = function (rows, example) {\n      return map(rows, function (row) {\n        var cells = map(TableLookup.cells(row), function (cell) {\n          var rowspan = has$1(cell, 'rowspan') ? parseInt(get$1(cell, 'rowspan'), 10) : 1;\n          var colspan = has$1(cell, 'colspan') ? parseInt(get$1(cell, 'colspan'), 10) : 1;\n          return detail(cell, rowspan, colspan);\n        });\n        return rowdata(row, cells, example.section());\n      });\n    };\n    var DetailsList = {\n      fromTable: fromTable,\n      fromPastedRows: fromPastedRows\n    };\n\n    var key = function (row, column) {\n      return row + ',' + column;\n    };\n    var getAt = function (warehouse, row, column) {\n      var raw = warehouse.access()[key(row, column)];\n      return raw !== undefined ? Option.some(raw) : Option.none();\n    };\n    var findItem = function (warehouse, item, comparator) {\n      var filtered = filterItems(warehouse, function (detail) {\n        return comparator(item, detail.element());\n      });\n      return filtered.length > 0 ? Option.some(filtered[0]) : Option.none();\n    };\n    var filterItems = function (warehouse, predicate) {\n      var all = bind(warehouse.all(), function (r) {\n        return r.cells();\n      });\n      return filter(all, predicate);\n    };\n    var generate = function (list) {\n      var access = {};\n      var cells = [];\n      var maxRows = list.length;\n      var maxColumns = 0;\n      each(list, function (details, r) {\n        var currentRow = [];\n        each(details.cells(), function (detail) {\n          var start = 0;\n          while (access[key(r, start)] !== undefined) {\n            start++;\n          }\n          var current = extended(detail.element(), detail.rowspan(), detail.colspan(), r, start);\n          for (var i = 0; i < detail.colspan(); i++) {\n            for (var j = 0; j < detail.rowspan(); j++) {\n              var cr = r + j;\n              var cc = start + i;\n              var newpos = key(cr, cc);\n              access[newpos] = current;\n              maxColumns = Math.max(maxColumns, cc + 1);\n            }\n          }\n          currentRow.push(current);\n        });\n        cells.push(rowdata(details.element(), currentRow, details.section()));\n      });\n      var grid$1 = grid(maxRows, maxColumns);\n      return {\n        grid: constant(grid$1),\n        access: constant(access),\n        all: constant(cells)\n      };\n    };\n    var justCells = function (warehouse) {\n      var rows = map(warehouse.all(), function (w) {\n        return w.cells();\n      });\n      return flatten(rows);\n    };\n    var Warehouse = {\n      generate: generate,\n      getAt: getAt,\n      findItem: findItem,\n      filterItems: filterItems,\n      justCells: justCells\n    };\n\n    var statsStruct = Immutable('minRow', 'minCol', 'maxRow', 'maxCol');\n    var findSelectedStats = function (house, isSelected) {\n      var totalColumns = house.grid().columns();\n      var totalRows = house.grid().rows();\n      var minRow = totalRows;\n      var minCol = totalColumns;\n      var maxRow = 0;\n      var maxCol = 0;\n      each$1(house.access(), function (detail) {\n        if (isSelected(detail)) {\n          var startRow = detail.row();\n          var endRow = startRow + detail.rowspan() - 1;\n          var startCol = detail.column();\n          var endCol = startCol + detail.colspan() - 1;\n          if (startRow < minRow) {\n            minRow = startRow;\n          } else if (endRow > maxRow) {\n            maxRow = endRow;\n          }\n          if (startCol < minCol) {\n            minCol = startCol;\n          } else if (endCol > maxCol) {\n            maxCol = endCol;\n          }\n        }\n      });\n      return statsStruct(minRow, minCol, maxRow, maxCol);\n    };\n    var makeCell = function (list, seenSelected, rowIndex) {\n      var row = list[rowIndex].element();\n      var td = Element.fromTag('td');\n      append(td, Element.fromTag('br'));\n      var f = seenSelected ? append : prepend;\n      f(row, td);\n    };\n    var fillInGaps = function (list, house, stats, isSelected) {\n      var totalColumns = house.grid().columns();\n      var totalRows = house.grid().rows();\n      for (var i = 0; i < totalRows; i++) {\n        var seenSelected = false;\n        for (var j = 0; j < totalColumns; j++) {\n          if (!(i < stats.minRow() || i > stats.maxRow() || j < stats.minCol() || j > stats.maxCol())) {\n            var needCell = Warehouse.getAt(house, i, j).filter(isSelected).isNone();\n            if (needCell) {\n              makeCell(list, seenSelected, i);\n            } else {\n              seenSelected = true;\n            }\n          }\n        }\n      }\n    };\n    var clean = function (table, stats) {\n      var emptyRows = filter(LayerSelector.firstLayer(table, 'tr'), function (row) {\n        return row.dom().childElementCount === 0;\n      });\n      each(emptyRows, remove$2);\n      if (stats.minCol() === stats.maxCol() || stats.minRow() === stats.maxRow()) {\n        each(LayerSelector.firstLayer(table, 'th,td'), function (cell) {\n          remove(cell, 'rowspan');\n          remove(cell, 'colspan');\n        });\n      }\n      remove(table, 'width');\n      remove(table, 'height');\n      remove$1(table, 'width');\n      remove$1(table, 'height');\n    };\n    var extract = function (table, selectedSelector) {\n      var isSelected = function (detail) {\n        return is(detail.element(), selectedSelector);\n      };\n      var list = DetailsList.fromTable(table);\n      var house = Warehouse.generate(list);\n      var stats = findSelectedStats(house, isSelected);\n      var selector = 'th:not(' + selectedSelector + ')' + ',td:not(' + selectedSelector + ')';\n      var unselectedCells = LayerSelector.filterFirstLayer(table, 'th,td', function (cell) {\n        return is(cell, selector);\n      });\n      each(unselectedCells, remove$2);\n      fillInGaps(list, house, stats, isSelected);\n      clean(table, stats);\n      return table;\n    };\n    var CopySelected = { extract: extract };\n\n    function NodeValue (is, name) {\n      var get = function (element) {\n        if (!is(element)) {\n          throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n        }\n        return getOption(element).getOr('');\n      };\n      var getOption = function (element) {\n        return is(element) ? Option.from(element.dom().nodeValue) : Option.none();\n      };\n      var set = function (element, value) {\n        if (!is(element)) {\n          throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n        }\n        element.dom().nodeValue = value;\n      };\n      return {\n        get: get,\n        getOption: getOption,\n        set: set\n      };\n    }\n\n    var api = NodeValue(isText, 'text');\n    var get$3 = function (element) {\n      return api.get(element);\n    };\n    var getOption = function (element) {\n      return api.getOption(element);\n    };\n    var set$2 = function (element, value) {\n      api.set(element, value);\n    };\n\n    var getEnd = function (element) {\n      return name(element) === 'img' ? 1 : getOption(element).fold(function () {\n        return children(element).length;\n      }, function (v) {\n        return v.length;\n      });\n    };\n    var NBSP = '\\xA0';\n    var isTextNodeWithCursorPosition = function (el) {\n      return getOption(el).filter(function (text) {\n        return text.trim().length !== 0 || text.indexOf(NBSP) > -1;\n      }).isSome();\n    };\n    var elementsWithCursorPosition = [\n      'img',\n      'br'\n    ];\n    var isCursorPosition = function (elem) {\n      var hasCursorPosition = isTextNodeWithCursorPosition(elem);\n      return hasCursorPosition || contains(elementsWithCursorPosition, name(elem));\n    };\n\n    var first = function (element) {\n      return descendant(element, isCursorPosition);\n    };\n    var last$1 = function (element) {\n      return descendantRtl(element, isCursorPosition);\n    };\n    var descendantRtl = function (scope, predicate) {\n      var descend = function (element) {\n        var children$1 = children(element);\n        for (var i = children$1.length - 1; i >= 0; i--) {\n          var child = children$1[i];\n          if (predicate(child)) {\n            return Option.some(child);\n          }\n          var res = descend(child);\n          if (res.isSome()) {\n            return res;\n          }\n        }\n        return Option.none();\n      };\n      return descend(scope);\n    };\n\n    var clone$1 = function (original, isDeep) {\n      return Element.fromDom(original.dom().cloneNode(isDeep));\n    };\n    var shallow = function (original) {\n      return clone$1(original, false);\n    };\n    var deep = function (original) {\n      return clone$1(original, true);\n    };\n    var shallowAs = function (original, tag) {\n      var nu = Element.fromTag(tag);\n      var attributes = clone(original);\n      setAll(nu, attributes);\n      return nu;\n    };\n    var copy$1 = function (original, tag) {\n      var nu = shallowAs(original, tag);\n      var cloneChildren = children(deep(original));\n      append$1(nu, cloneChildren);\n      return nu;\n    };\n\n    var createCell = function () {\n      var td = Element.fromTag('td');\n      append(td, Element.fromTag('br'));\n      return td;\n    };\n    var replace = function (cell, tag, attrs) {\n      var replica = copy$1(cell, tag);\n      each$1(attrs, function (v, k) {\n        if (v === null) {\n          remove(replica, k);\n        } else {\n          set(replica, k, v);\n        }\n      });\n      return replica;\n    };\n    var pasteReplace = function (cell) {\n      return cell;\n    };\n    var newRow = function (doc) {\n      return function () {\n        return Element.fromTag('tr', doc.dom());\n      };\n    };\n    var cloneFormats = function (oldCell, newCell, formats) {\n      var first$1 = first(oldCell);\n      return first$1.map(function (firstText) {\n        var formatSelector = formats.join(',');\n        var parents = ancestors$1(firstText, formatSelector, function (element) {\n          return eq(element, oldCell);\n        });\n        return foldr(parents, function (last, parent) {\n          var clonedFormat = shallow(parent);\n          remove(clonedFormat, 'contenteditable');\n          append(last, clonedFormat);\n          return clonedFormat;\n        }, newCell);\n      }).getOr(newCell);\n    };\n    var cellOperations = function (mutate, doc, formatsToClone) {\n      var newCell = function (prev) {\n        var docu = owner(prev.element());\n        var td = Element.fromTag(name(prev.element()), docu.dom());\n        var formats = formatsToClone.getOr([\n          'strong',\n          'em',\n          'b',\n          'i',\n          'span',\n          'font',\n          'h1',\n          'h2',\n          'h3',\n          'h4',\n          'h5',\n          'h6',\n          'p',\n          'div'\n        ]);\n        var lastNode = formats.length > 0 ? cloneFormats(prev.element(), td, formats) : td;\n        append(lastNode, Element.fromTag('br'));\n        copy(prev.element(), td);\n        remove$1(td, 'height');\n        if (prev.colspan() !== 1) {\n          remove$1(prev.element(), 'width');\n        }\n        mutate(prev.element(), td);\n        return td;\n      };\n      return {\n        row: newRow(doc),\n        cell: newCell,\n        replace: replace,\n        gap: createCell\n      };\n    };\n    var paste = function (doc) {\n      return {\n        row: newRow(doc),\n        cell: createCell,\n        replace: pasteReplace,\n        gap: createCell\n      };\n    };\n    var TableFill = {\n      cellOperations: cellOperations,\n      paste: paste\n    };\n\n    var fromHtml$1 = function (html, scope) {\n      var doc = scope || domGlobals.document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      return children(Element.fromDom(div));\n    };\n\n    var inSelection = function (bounds, detail) {\n      var leftEdge = detail.column();\n      var rightEdge = detail.column() + detail.colspan() - 1;\n      var topEdge = detail.row();\n      var bottomEdge = detail.row() + detail.rowspan() - 1;\n      return leftEdge <= bounds.finishCol() && rightEdge >= bounds.startCol() && (topEdge <= bounds.finishRow() && bottomEdge >= bounds.startRow());\n    };\n    var isWithin = function (bounds, detail) {\n      return detail.column() >= bounds.startCol() && detail.column() + detail.colspan() - 1 <= bounds.finishCol() && detail.row() >= bounds.startRow() && detail.row() + detail.rowspan() - 1 <= bounds.finishRow();\n    };\n    var isRectangular = function (warehouse, bounds) {\n      var isRect = true;\n      var detailIsWithin = curry(isWithin, bounds);\n      for (var i = bounds.startRow(); i <= bounds.finishRow(); i++) {\n        for (var j = bounds.startCol(); j <= bounds.finishCol(); j++) {\n          isRect = isRect && Warehouse.getAt(warehouse, i, j).exists(detailIsWithin);\n        }\n      }\n      return isRect ? Option.some(bounds) : Option.none();\n    };\n    var CellBounds = {\n      inSelection: inSelection,\n      isWithin: isWithin,\n      isRectangular: isRectangular\n    };\n\n    var getBounds = function (detailA, detailB) {\n      return bounds(Math.min(detailA.row(), detailB.row()), Math.min(detailA.column(), detailB.column()), Math.max(detailA.row() + detailA.rowspan() - 1, detailB.row() + detailB.rowspan() - 1), Math.max(detailA.column() + detailA.colspan() - 1, detailB.column() + detailB.colspan() - 1));\n    };\n    var getAnyBox = function (warehouse, startCell, finishCell) {\n      var startCoords = Warehouse.findItem(warehouse, startCell, eq);\n      var finishCoords = Warehouse.findItem(warehouse, finishCell, eq);\n      return startCoords.bind(function (sc) {\n        return finishCoords.map(function (fc) {\n          return getBounds(sc, fc);\n        });\n      });\n    };\n    var getBox = function (warehouse, startCell, finishCell) {\n      return getAnyBox(warehouse, startCell, finishCell).bind(function (bounds) {\n        return CellBounds.isRectangular(warehouse, bounds);\n      });\n    };\n    var CellGroup = {\n      getAnyBox: getAnyBox,\n      getBox: getBox\n    };\n\n    var moveBy = function (warehouse, cell, row, column) {\n      return Warehouse.findItem(warehouse, cell, eq).bind(function (detail) {\n        var startRow = row > 0 ? detail.row() + detail.rowspan() - 1 : detail.row();\n        var startCol = column > 0 ? detail.column() + detail.colspan() - 1 : detail.column();\n        var dest = Warehouse.getAt(warehouse, startRow + row, startCol + column);\n        return dest.map(function (d) {\n          return d.element();\n        });\n      });\n    };\n    var intercepts = function (warehouse, start, finish) {\n      return CellGroup.getAnyBox(warehouse, start, finish).map(function (bounds) {\n        var inside = Warehouse.filterItems(warehouse, curry(CellBounds.inSelection, bounds));\n        return map(inside, function (detail) {\n          return detail.element();\n        });\n      });\n    };\n    var parentCell = function (warehouse, innerCell) {\n      var isContainedBy = function (c1, c2) {\n        return contains$2(c2, c1);\n      };\n      return Warehouse.findItem(warehouse, innerCell, isContainedBy).map(function (detail) {\n        return detail.element();\n      });\n    };\n    var CellFinder = {\n      moveBy: moveBy,\n      intercepts: intercepts,\n      parentCell: parentCell\n    };\n\n    var moveBy$1 = function (cell, deltaRow, deltaColumn) {\n      return TableLookup.table(cell).bind(function (table) {\n        var warehouse = getWarehouse(table);\n        return CellFinder.moveBy(warehouse, cell, deltaRow, deltaColumn);\n      });\n    };\n    var intercepts$1 = function (table, first, last) {\n      var warehouse = getWarehouse(table);\n      return CellFinder.intercepts(warehouse, first, last);\n    };\n    var nestedIntercepts = function (table, first, firstTable, last, lastTable) {\n      var warehouse = getWarehouse(table);\n      var optStartCell = eq(table, firstTable) ? Option.some(first) : CellFinder.parentCell(warehouse, first);\n      var optLastCell = eq(table, lastTable) ? Option.some(last) : CellFinder.parentCell(warehouse, last);\n      return optStartCell.bind(function (startCell) {\n        return optLastCell.bind(function (lastCell) {\n          return CellFinder.intercepts(warehouse, startCell, lastCell);\n        });\n      });\n    };\n    var getBox$1 = function (table, first, last) {\n      var warehouse = getWarehouse(table);\n      return CellGroup.getBox(warehouse, first, last);\n    };\n    var getWarehouse = function (table) {\n      var list = DetailsList.fromTable(table);\n      return Warehouse.generate(list);\n    };\n    var TablePositions = {\n      moveBy: moveBy$1,\n      intercepts: intercepts$1,\n      nestedIntercepts: nestedIntercepts,\n      getBox: getBox$1\n    };\n\n    var TagBoundaries = [\n      'body',\n      'p',\n      'div',\n      'article',\n      'aside',\n      'figcaption',\n      'figure',\n      'footer',\n      'header',\n      'nav',\n      'section',\n      'ol',\n      'ul',\n      'li',\n      'table',\n      'thead',\n      'tbody',\n      'tfoot',\n      'caption',\n      'tr',\n      'td',\n      'th',\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6',\n      'blockquote',\n      'pre',\n      'address'\n    ];\n\n    function DomUniverse () {\n      var clone$1 = function (element) {\n        return Element.fromDom(element.dom().cloneNode(false));\n      };\n      var document = function (element) {\n        return element.dom().ownerDocument;\n      };\n      var isBoundary = function (element) {\n        if (!isElement(element)) {\n          return false;\n        }\n        if (name(element) === 'body') {\n          return true;\n        }\n        return contains(TagBoundaries, name(element));\n      };\n      var isEmptyTag = function (element) {\n        if (!isElement(element)) {\n          return false;\n        }\n        return contains([\n          'br',\n          'img',\n          'hr',\n          'input'\n        ], name(element));\n      };\n      var comparePosition = function (element, other) {\n        return element.dom().compareDocumentPosition(other.dom());\n      };\n      var copyAttributesTo = function (source, destination) {\n        var as = clone(source);\n        setAll(destination, as);\n      };\n      return {\n        up: constant({\n          selector: ancestor$1,\n          closest: closest$1,\n          predicate: ancestor,\n          all: parents\n        }),\n        down: constant({\n          selector: descendants$1,\n          predicate: descendants\n        }),\n        styles: constant({\n          get: get$2,\n          getRaw: getRaw,\n          set: set$1,\n          remove: remove$1\n        }),\n        attrs: constant({\n          get: get$1,\n          set: set,\n          remove: remove,\n          copyTo: copyAttributesTo\n        }),\n        insert: constant({\n          before: before,\n          after: after,\n          afterAll: after$1,\n          append: append,\n          appendAll: append$1,\n          prepend: prepend,\n          wrap: wrap\n        }),\n        remove: constant({\n          unwrap: unwrap,\n          remove: remove$2\n        }),\n        create: constant({\n          nu: Element.fromTag,\n          clone: clone$1,\n          text: Element.fromText\n        }),\n        query: constant({\n          comparePosition: comparePosition,\n          prevSibling: prevSibling,\n          nextSibling: nextSibling\n        }),\n        property: constant({\n          children: children,\n          name: name,\n          parent: parent,\n          document: document,\n          isText: isText,\n          isComment: isComment,\n          isElement: isElement,\n          getText: get$3,\n          setText: set$2,\n          isBoundary: isBoundary,\n          isEmptyTag: isEmptyTag\n        }),\n        eq: eq,\n        is: is$1\n      };\n    }\n\n    var leftRight = Immutable('left', 'right');\n    var brokenPath = Immutable('first', 'second', 'splits');\n    var bisect = function (universe, parent, child) {\n      var children = universe.property().children(parent);\n      var index = findIndex(children, curry(universe.eq, child));\n      return index.map(function (ind) {\n        return {\n          before: constant(children.slice(0, ind)),\n          after: constant(children.slice(ind + 1))\n        };\n      });\n    };\n    var breakToRight = function (universe, parent, child) {\n      return bisect(universe, parent, child).map(function (parts) {\n        var second = universe.create().clone(parent);\n        universe.insert().appendAll(second, parts.after());\n        universe.insert().after(parent, second);\n        return leftRight(parent, second);\n      });\n    };\n    var breakToLeft = function (universe, parent, child) {\n      return bisect(universe, parent, child).map(function (parts) {\n        var prior = universe.create().clone(parent);\n        universe.insert().appendAll(prior, parts.before().concat([child]));\n        universe.insert().appendAll(parent, parts.after());\n        universe.insert().before(parent, prior);\n        return leftRight(prior, parent);\n      });\n    };\n    var breakPath = function (universe, item, isTop, breaker) {\n      var next = function (child, group, splits) {\n        var fallback = brokenPath(child, Option.none(), splits);\n        if (isTop(child)) {\n          return brokenPath(child, group, splits);\n        } else {\n          return universe.property().parent(child).bind(function (parent) {\n            return breaker(universe, parent, child).map(function (breakage) {\n              var extra = [{\n                  first: breakage.left,\n                  second: breakage.right\n                }];\n              var nextChild = isTop(parent) ? parent : breakage.left();\n              return next(nextChild, Option.some(breakage.right()), splits.concat(extra));\n            });\n          }).getOr(fallback);\n        }\n      };\n      return next(item, Option.none(), []);\n    };\n\n    var all$1 = function (universe, look, elements, f) {\n      var head = elements[0];\n      var tail = elements.slice(1);\n      return f(universe, look, head, tail);\n    };\n    var oneAll = function (universe, look, elements) {\n      return elements.length > 0 ? all$1(universe, look, elements, unsafeOne) : Option.none();\n    };\n    var unsafeOne = function (universe, look, head, tail) {\n      var start = look(universe, head);\n      return foldr(tail, function (b, a) {\n        var current = look(universe, a);\n        return commonElement(universe, b, current);\n      }, start);\n    };\n    var commonElement = function (universe, start, end) {\n      return start.bind(function (s) {\n        return end.filter(curry(universe.eq, s));\n      });\n    };\n\n    var eq$1 = function (universe, item) {\n      return curry(universe.eq, item);\n    };\n    var unsafeSubset = function (universe, common, ps1, ps2) {\n      var children = universe.property().children(common);\n      if (universe.eq(common, ps1[0])) {\n        return Option.some([ps1[0]]);\n      }\n      if (universe.eq(common, ps2[0])) {\n        return Option.some([ps2[0]]);\n      }\n      var finder = function (ps) {\n        var topDown = reverse(ps);\n        var index = findIndex(topDown, eq$1(universe, common)).getOr(-1);\n        var item = index < topDown.length - 1 ? topDown[index + 1] : topDown[index];\n        return findIndex(children, eq$1(universe, item));\n      };\n      var startIndex = finder(ps1);\n      var endIndex = finder(ps2);\n      return startIndex.bind(function (sIndex) {\n        return endIndex.map(function (eIndex) {\n          var first = Math.min(sIndex, eIndex);\n          var last = Math.max(sIndex, eIndex);\n          return children.slice(first, last + 1);\n        });\n      });\n    };\n    var ancestors$2 = function (universe, start, end, isRoot) {\n      if (isRoot === void 0) {\n        isRoot = never;\n      }\n      var ps1 = [start].concat(universe.up().all(start));\n      var ps2 = [end].concat(universe.up().all(end));\n      var prune = function (path) {\n        var index = findIndex(path, isRoot);\n        return index.fold(function () {\n          return path;\n        }, function (ind) {\n          return path.slice(0, ind + 1);\n        });\n      };\n      var pruned1 = prune(ps1);\n      var pruned2 = prune(ps2);\n      var shared = find(pruned1, function (x) {\n        return exists(pruned2, eq$1(universe, x));\n      });\n      return {\n        firstpath: constant(pruned1),\n        secondpath: constant(pruned2),\n        shared: constant(shared)\n      };\n    };\n    var subset = function (universe, start, end) {\n      var ancs = ancestors$2(universe, start, end);\n      return ancs.shared().bind(function (shared) {\n        return unsafeSubset(universe, shared, ancs.firstpath(), ancs.secondpath());\n      });\n    };\n    var SubsetFn = {\n      subset: subset,\n      ancestors: ancestors$2\n    };\n\n    var sharedOne = oneAll;\n    var subset$1 = SubsetFn.subset;\n    var ancestors$3 = SubsetFn.ancestors;\n    var breakToLeft$1 = breakToLeft;\n    var breakToRight$1 = breakToRight;\n    var breakPath$1 = breakPath;\n    var Parent = {\n      sharedOne: sharedOne,\n      subset: subset$1,\n      ancestors: ancestors$3,\n      breakToLeft: breakToLeft$1,\n      breakToRight: breakToRight$1,\n      breakPath: breakPath$1\n    };\n\n    var universe = DomUniverse();\n    var sharedOne$1 = function (look, elements) {\n      return Parent.sharedOne(universe, function (_universe, element) {\n        return look(element);\n      }, elements);\n    };\n    var subset$2 = function (start, finish) {\n      return Parent.subset(universe, start, finish);\n    };\n    var ancestors$4 = function (start, finish, isRoot) {\n      return Parent.ancestors(universe, start, finish, isRoot);\n    };\n    var breakToLeft$2 = function (parent, child) {\n      return Parent.breakToLeft(universe, parent, child);\n    };\n    var breakToRight$2 = function (parent, child) {\n      return Parent.breakToRight(universe, parent, child);\n    };\n    var breakPath$2 = function (child, isTop, breaker) {\n      return Parent.breakPath(universe, child, isTop, function (u, p, c) {\n        return breaker(p, c);\n      });\n    };\n    var DomParent = {\n      sharedOne: sharedOne$1,\n      subset: subset$2,\n      ancestors: ancestors$4,\n      breakToLeft: breakToLeft$2,\n      breakToRight: breakToRight$2,\n      breakPath: breakPath$2\n    };\n\n    var create = MixedBag([\n      'boxes',\n      'start',\n      'finish'\n    ], []);\n    var Identified = { create: create };\n\n    var lookupTable = function (container) {\n      return ancestor$1(container, 'table');\n    };\n    var identify = function (start, finish, isRoot) {\n      var getIsRoot = function (rootTable) {\n        return function (element) {\n          return isRoot !== undefined && isRoot(element) || eq(element, rootTable);\n        };\n      };\n      if (eq(start, finish)) {\n        return Option.some(Identified.create({\n          boxes: Option.some([start]),\n          start: start,\n          finish: finish\n        }));\n      } else {\n        return lookupTable(start).bind(function (startTable) {\n          return lookupTable(finish).bind(function (finishTable) {\n            if (eq(startTable, finishTable)) {\n              return Option.some(Identified.create({\n                boxes: TablePositions.intercepts(startTable, start, finish),\n                start: start,\n                finish: finish\n              }));\n            } else if (contains$2(startTable, finishTable)) {\n              var ancestorCells = ancestors$1(finish, 'td,th', getIsRoot(startTable));\n              var finishCell = ancestorCells.length > 0 ? ancestorCells[ancestorCells.length - 1] : finish;\n              return Option.some(Identified.create({\n                boxes: TablePositions.nestedIntercepts(startTable, start, startTable, finish, finishTable),\n                start: start,\n                finish: finishCell\n              }));\n            } else if (contains$2(finishTable, startTable)) {\n              var ancestorCells = ancestors$1(start, 'td,th', getIsRoot(finishTable));\n              var startCell = ancestorCells.length > 0 ? ancestorCells[ancestorCells.length - 1] : start;\n              return Option.some(Identified.create({\n                boxes: TablePositions.nestedIntercepts(finishTable, start, startTable, finish, finishTable),\n                start: start,\n                finish: startCell\n              }));\n            } else {\n              return DomParent.ancestors(start, finish).shared().bind(function (lca) {\n                return closest$1(lca, 'table', isRoot).bind(function (lcaTable) {\n                  var finishAncestorCells = ancestors$1(finish, 'td,th', getIsRoot(lcaTable));\n                  var finishCell = finishAncestorCells.length > 0 ? finishAncestorCells[finishAncestorCells.length - 1] : finish;\n                  var startAncestorCells = ancestors$1(start, 'td,th', getIsRoot(lcaTable));\n                  var startCell = startAncestorCells.length > 0 ? startAncestorCells[startAncestorCells.length - 1] : start;\n                  return Option.some(Identified.create({\n                    boxes: TablePositions.nestedIntercepts(lcaTable, start, startTable, finish, finishTable),\n                    start: startCell,\n                    finish: finishCell\n                  }));\n                });\n              });\n            }\n          });\n        });\n      }\n    };\n    var retrieve = function (container, selector) {\n      var sels = descendants$1(container, selector);\n      return sels.length > 0 ? Option.some(sels) : Option.none();\n    };\n    var getLast = function (boxes, lastSelectedSelector) {\n      return find(boxes, function (box) {\n        return is(box, lastSelectedSelector);\n      });\n    };\n    var getEdges = function (container, firstSelectedSelector, lastSelectedSelector) {\n      return descendant$1(container, firstSelectedSelector).bind(function (first) {\n        return descendant$1(container, lastSelectedSelector).bind(function (last) {\n          return DomParent.sharedOne(lookupTable, [\n            first,\n            last\n          ]).map(function (tbl) {\n            return {\n              first: constant(first),\n              last: constant(last),\n              table: constant(tbl)\n            };\n          });\n        });\n      });\n    };\n    var expandTo = function (finish, firstSelectedSelector) {\n      return ancestor$1(finish, 'table').bind(function (table) {\n        return descendant$1(table, firstSelectedSelector).bind(function (start) {\n          return identify(start, finish).bind(function (identified) {\n            return identified.boxes().map(function (boxes) {\n              return {\n                boxes: constant(boxes),\n                start: constant(identified.start()),\n                finish: constant(identified.finish())\n              };\n            });\n          });\n        });\n      });\n    };\n    var shiftSelection = function (boxes, deltaRow, deltaColumn, firstSelectedSelector, lastSelectedSelector) {\n      return getLast(boxes, lastSelectedSelector).bind(function (last) {\n        return TablePositions.moveBy(last, deltaRow, deltaColumn).bind(function (finish) {\n          return expandTo(finish, firstSelectedSelector);\n        });\n      });\n    };\n    var CellSelection = {\n      identify: identify,\n      retrieve: retrieve,\n      shiftSelection: shiftSelection,\n      getEdges: getEdges\n    };\n\n    var retrieve$1 = function (container, selector) {\n      return CellSelection.retrieve(container, selector);\n    };\n    var retrieveBox = function (container, firstSelectedSelector, lastSelectedSelector) {\n      return CellSelection.getEdges(container, firstSelectedSelector, lastSelectedSelector).bind(function (edges) {\n        var isRoot = function (ancestor) {\n          return eq(container, ancestor);\n        };\n        var firstAncestor = ancestor$1(edges.first(), 'thead,tfoot,tbody,table', isRoot);\n        var lastAncestor = ancestor$1(edges.last(), 'thead,tfoot,tbody,table', isRoot);\n        return firstAncestor.bind(function (fA) {\n          return lastAncestor.bind(function (lA) {\n            return eq(fA, lA) ? TablePositions.getBox(edges.table(), edges.first(), edges.last()) : Option.none();\n          });\n        });\n      });\n    };\n    var TableSelection = {\n      retrieve: retrieve$1,\n      retrieveBox: retrieveBox\n    };\n\n    var selected = 'data-mce-selected';\n    var selectedSelector = 'td[' + selected + '],th[' + selected + ']';\n    var attributeSelector = '[' + selected + ']';\n    var firstSelected = 'data-mce-first-selected';\n    var firstSelectedSelector = 'td[' + firstSelected + '],th[' + firstSelected + ']';\n    var lastSelected = 'data-mce-last-selected';\n    var lastSelectedSelector = 'td[' + lastSelected + '],th[' + lastSelected + ']';\n    var Ephemera = {\n      selected: constant(selected),\n      selectedSelector: constant(selectedSelector),\n      attributeSelector: constant(attributeSelector),\n      firstSelected: constant(firstSelected),\n      firstSelectedSelector: constant(firstSelectedSelector),\n      lastSelected: constant(lastSelected),\n      lastSelectedSelector: constant(lastSelectedSelector)\n    };\n\n    var generate$1 = function (cases) {\n      if (!isArray(cases)) {\n        throw new Error('cases must be an array');\n      }\n      if (cases.length === 0) {\n        throw new Error('there must be at least one case');\n      }\n      var constructors = [];\n      var adt = {};\n      each(cases, function (acase, count) {\n        var keys$1 = keys(acase);\n        if (keys$1.length !== 1) {\n          throw new Error('one and only one name per case');\n        }\n        var key = keys$1[0];\n        var value = acase[key];\n        if (adt[key] !== undefined) {\n          throw new Error('duplicate key detected:' + key);\n        } else if (key === 'cata') {\n          throw new Error('cannot have a case named cata (sorry)');\n        } else if (!isArray(value)) {\n          throw new Error('case arguments must be an array');\n        }\n        constructors.push(key);\n        adt[key] = function () {\n          var argLength = arguments.length;\n          if (argLength !== value.length) {\n            throw new Error('Wrong number of arguments to case ' + key + '. Expected ' + value.length + ' (' + value + '), got ' + argLength);\n          }\n          var args = new Array(argLength);\n          for (var i = 0; i < args.length; i++) {\n            args[i] = arguments[i];\n          }\n          var match = function (branches) {\n            var branchKeys = keys(branches);\n            if (constructors.length !== branchKeys.length) {\n              throw new Error('Wrong number of arguments to match. Expected: ' + constructors.join(',') + '\\nActual: ' + branchKeys.join(','));\n            }\n            var allReqd = forall(constructors, function (reqKey) {\n              return contains(branchKeys, reqKey);\n            });\n            if (!allReqd) {\n              throw new Error('Not all branches were specified when using match. Specified: ' + branchKeys.join(', ') + '\\nRequired: ' + constructors.join(', '));\n            }\n            return branches[key].apply(null, args);\n          };\n          return {\n            fold: function () {\n              if (arguments.length !== cases.length) {\n                throw new Error('Wrong number of arguments to fold. Expected ' + cases.length + ', got ' + arguments.length);\n              }\n              var target = arguments[count];\n              return target.apply(null, args);\n            },\n            match: match,\n            log: function (label) {\n              domGlobals.console.log(label, {\n                constructors: constructors,\n                constructor: key,\n                params: args\n              });\n            }\n          };\n        };\n      });\n      return adt;\n    };\n    var Adt = { generate: generate$1 };\n\n    var type$1 = Adt.generate([\n      { none: [] },\n      { multiple: ['elements'] },\n      { single: ['selection'] }\n    ]);\n    var cata = function (subject, onNone, onMultiple, onSingle) {\n      return subject.fold(onNone, onMultiple, onSingle);\n    };\n    var SelectionTypes = {\n      cata: cata,\n      none: type$1.none,\n      multiple: type$1.multiple,\n      single: type$1.single\n    };\n\n    var selection = function (cell, selections) {\n      return SelectionTypes.cata(selections.get(), constant([]), identity, constant([cell]));\n    };\n    var unmergable = function (cell, selections) {\n      var hasSpan = function (elem) {\n        return has$1(elem, 'rowspan') && parseInt(get$1(elem, 'rowspan'), 10) > 1 || has$1(elem, 'colspan') && parseInt(get$1(elem, 'colspan'), 10) > 1;\n      };\n      var candidates = selection(cell, selections);\n      return candidates.length > 0 && forall(candidates, hasSpan) ? Option.some(candidates) : Option.none();\n    };\n    var mergable = function (table, selections) {\n      return SelectionTypes.cata(selections.get(), Option.none, function (cells, _env) {\n        if (cells.length === 0) {\n          return Option.none();\n        }\n        return TableSelection.retrieveBox(table, Ephemera.firstSelectedSelector(), Ephemera.lastSelectedSelector()).bind(function (bounds) {\n          return cells.length > 1 ? Option.some({\n            bounds: constant(bounds),\n            cells: constant(cells)\n          }) : Option.none();\n        });\n      }, Option.none);\n    };\n    var CellOperations = {\n      mergable: mergable,\n      unmergable: unmergable,\n      selection: selection\n    };\n\n    var noMenu = function (cell) {\n      return {\n        element: constant(cell),\n        mergable: Option.none,\n        unmergable: Option.none,\n        selection: constant([cell])\n      };\n    };\n    var forMenu = function (selections, table, cell) {\n      return {\n        element: constant(cell),\n        mergable: constant(CellOperations.mergable(table, selections)),\n        unmergable: constant(CellOperations.unmergable(cell, selections)),\n        selection: constant(CellOperations.selection(cell, selections))\n      };\n    };\n    var notCell$1 = function (element) {\n      return noMenu(element);\n    };\n    var paste$1 = Immutable('element', 'clipboard', 'generators');\n    var pasteRows = function (selections, table, cell, clipboard, generators) {\n      return {\n        element: constant(cell),\n        mergable: Option.none,\n        unmergable: Option.none,\n        selection: constant(CellOperations.selection(cell, selections)),\n        clipboard: constant(clipboard),\n        generators: constant(generators)\n      };\n    };\n    var TableTargets = {\n      noMenu: noMenu,\n      forMenu: forMenu,\n      notCell: notCell$1,\n      paste: paste$1,\n      pasteRows: pasteRows\n    };\n\n    var extractSelected = function (cells) {\n      return TableLookup.table(cells[0]).map(deep).map(function (replica) {\n        return [CopySelected.extract(replica, Ephemera.attributeSelector())];\n      });\n    };\n    var serializeElements = function (editor, elements) {\n      return map(elements, function (elm) {\n        return editor.selection.serializer.serialize(elm.dom(), {});\n      }).join('');\n    };\n    var getTextContent = function (elements) {\n      return map(elements, function (element) {\n        return element.dom().innerText;\n      }).join('');\n    };\n    var registerEvents = function (editor, selections, actions, cellSelection) {\n      editor.on('BeforeGetContent', function (e) {\n        var multiCellContext = function (cells) {\n          e.preventDefault();\n          extractSelected(cells).each(function (elements) {\n            e.content = e.format === 'text' ? getTextContent(elements) : serializeElements(editor, elements);\n          });\n        };\n        if (e.selection === true) {\n          SelectionTypes.cata(selections.get(), noop, multiCellContext, noop);\n        }\n      });\n      editor.on('BeforeSetContent', function (e) {\n        if (e.selection === true && e.paste === true) {\n          var cellOpt = Option.from(editor.dom.getParent(editor.selection.getStart(), 'th,td'));\n          cellOpt.each(function (domCell) {\n            var cell = Element.fromDom(domCell);\n            TableLookup.table(cell).each(function (table) {\n              var elements = filter(fromHtml$1(e.content), function (content) {\n                return name(content) !== 'meta';\n              });\n              if (elements.length === 1 && name(elements[0]) === 'table') {\n                e.preventDefault();\n                var doc = Element.fromDom(editor.getDoc());\n                var generators = TableFill.paste(doc);\n                var targets = TableTargets.paste(cell, elements[0], generators);\n                actions.pasteCells(table, targets).each(function (rng) {\n                  editor.selection.setRng(rng);\n                  editor.focus();\n                  cellSelection.clear(table);\n                });\n              }\n            });\n          });\n        }\n      });\n    };\n    var Clipboard = { registerEvents: registerEvents };\n\n    function Dimension (name, getOffset) {\n      var set = function (element, h) {\n        if (!isNumber(h) && !h.match(/^[0-9]+$/)) {\n          throw new Error(name + '.set accepts only positive integer values. Value was ' + h);\n        }\n        var dom = element.dom();\n        if (isSupported(dom)) {\n          dom.style[name] = h + 'px';\n        }\n      };\n      var get = function (element) {\n        var r = getOffset(element);\n        if (r <= 0 || r === null) {\n          var css = get$2(element, name);\n          return parseFloat(css) || 0;\n        }\n        return r;\n      };\n      var getOuter = get;\n      var aggregate = function (element, properties) {\n        return foldl(properties, function (acc, property) {\n          var val = get$2(element, property);\n          var value = val === undefined ? 0 : parseInt(val, 10);\n          return isNaN(value) ? acc : acc + value;\n        }, 0);\n      };\n      var max = function (element, value, properties) {\n        var cumulativeInclusions = aggregate(element, properties);\n        var absoluteMax = value > cumulativeInclusions ? value - cumulativeInclusions : 0;\n        return absoluteMax;\n      };\n      return {\n        set: set,\n        get: get,\n        getOuter: getOuter,\n        aggregate: aggregate,\n        max: max\n      };\n    }\n\n    var api$1 = Dimension('height', function (element) {\n      var dom = element.dom();\n      return inBody(element) ? dom.getBoundingClientRect().height : dom.offsetHeight;\n    });\n    var get$4 = function (element) {\n      return api$1.get(element);\n    };\n    var getOuter = function (element) {\n      return api$1.getOuter(element);\n    };\n\n    var api$2 = Dimension('width', function (element) {\n      return element.dom().offsetWidth;\n    });\n    var get$5 = function (element) {\n      return api$2.get(element);\n    };\n    var getOuter$1 = function (element) {\n      return api$2.getOuter(element);\n    };\n\n    var platform$1 = detect$3();\n    var needManualCalc = function () {\n      return platform$1.browser.isIE() || platform$1.browser.isEdge();\n    };\n    var toNumber = function (px, fallback) {\n      var num = parseFloat(px);\n      return isNaN(num) ? fallback : num;\n    };\n    var getProp = function (elm, name, fallback) {\n      return toNumber(get$2(elm, name), fallback);\n    };\n    var getCalculatedHeight = function (cell) {\n      var paddingTop = getProp(cell, 'padding-top', 0);\n      var paddingBottom = getProp(cell, 'padding-bottom', 0);\n      var borderTop = getProp(cell, 'border-top-width', 0);\n      var borderBottom = getProp(cell, 'border-bottom-width', 0);\n      var height = cell.dom().getBoundingClientRect().height;\n      var boxSizing = get$2(cell, 'box-sizing');\n      var borders = borderTop + borderBottom;\n      return boxSizing === 'border-box' ? height : height - paddingTop - paddingBottom - borders;\n    };\n    var getWidth = function (cell) {\n      return getProp(cell, 'width', get$5(cell));\n    };\n    var getHeight = function (cell) {\n      return needManualCalc() ? getCalculatedHeight(cell) : getProp(cell, 'height', get$4(cell));\n    };\n    var RuntimeSize = {\n      getWidth: getWidth,\n      getHeight: getHeight\n    };\n\n    var genericSizeRegex = /(\\d+(\\.\\d+)?)(\\w|%)*/;\n    var percentageBasedSizeRegex = /(\\d+(\\.\\d+)?)%/;\n    var pixelBasedSizeRegex = /(\\d+(\\.\\d+)?)px|em/;\n    var setPixelWidth = function (cell, amount) {\n      set$1(cell, 'width', amount + 'px');\n    };\n    var setPercentageWidth = function (cell, amount) {\n      set$1(cell, 'width', amount + '%');\n    };\n    var setHeight = function (cell, amount) {\n      set$1(cell, 'height', amount + 'px');\n    };\n    var getHeightValue = function (cell) {\n      return getRaw(cell, 'height').getOrThunk(function () {\n        return RuntimeSize.getHeight(cell) + 'px';\n      });\n    };\n    var convert = function (cell, number, getter, setter) {\n      var newSize = TableLookup.table(cell).map(function (table) {\n        var total = getter(table);\n        return Math.floor(number / 100 * total);\n      }).getOr(number);\n      setter(cell, newSize);\n      return newSize;\n    };\n    var normalizePixelSize = function (value, cell, getter, setter) {\n      var number = parseInt(value, 10);\n      return endsWith(value, '%') && name(cell) !== 'table' ? convert(cell, number, getter, setter) : number;\n    };\n    var getTotalHeight = function (cell) {\n      var value = getHeightValue(cell);\n      if (!value) {\n        return get$4(cell);\n      }\n      return normalizePixelSize(value, cell, get$4, setHeight);\n    };\n    var get$6 = function (cell, type, f) {\n      var v = f(cell);\n      var span = getSpan(cell, type);\n      return v / span;\n    };\n    var getSpan = function (cell, type) {\n      return has$1(cell, type) ? parseInt(get$1(cell, type), 10) : 1;\n    };\n    var getRawWidth = function (element) {\n      var cssWidth = getRaw(element, 'width');\n      return cssWidth.fold(function () {\n        return Option.from(get$1(element, 'width'));\n      }, function (width) {\n        return Option.some(width);\n      });\n    };\n    var normalizePercentageWidth = function (cellWidth, tableSize) {\n      return cellWidth / tableSize.pixelWidth() * 100;\n    };\n    var choosePercentageSize = function (element, width, tableSize) {\n      var percentMatch = percentageBasedSizeRegex.exec(width);\n      if (percentMatch !== null) {\n        return parseFloat(percentMatch[1]);\n      } else {\n        var intWidth = get$5(element);\n        return normalizePercentageWidth(intWidth, tableSize);\n      }\n    };\n    var getPercentageWidth = function (cell, tableSize) {\n      var width = getRawWidth(cell);\n      return width.fold(function () {\n        var intWidth = get$5(cell);\n        return normalizePercentageWidth(intWidth, tableSize);\n      }, function (w) {\n        return choosePercentageSize(cell, w, tableSize);\n      });\n    };\n    var normalizePixelWidth = function (cellWidth, tableSize) {\n      return cellWidth / 100 * tableSize.pixelWidth();\n    };\n    var choosePixelSize = function (element, width, tableSize) {\n      var pixelMatch = pixelBasedSizeRegex.exec(width);\n      if (pixelMatch !== null) {\n        return parseInt(pixelMatch[1], 10);\n      }\n      var percentMatch = percentageBasedSizeRegex.exec(width);\n      if (percentMatch !== null) {\n        var floatWidth = parseFloat(percentMatch[1]);\n        return normalizePixelWidth(floatWidth, tableSize);\n      }\n      return get$5(element);\n    };\n    var getPixelWidth = function (cell, tableSize) {\n      var width = getRawWidth(cell);\n      return width.fold(function () {\n        return get$5(cell);\n      }, function (w) {\n        return choosePixelSize(cell, w, tableSize);\n      });\n    };\n    var getHeight$1 = function (cell) {\n      return get$6(cell, 'rowspan', getTotalHeight);\n    };\n    var getGenericWidth = function (cell) {\n      var width = getRawWidth(cell);\n      return width.bind(function (w) {\n        var match = genericSizeRegex.exec(w);\n        if (match !== null) {\n          return Option.some({\n            width: constant(parseFloat(match[1])),\n            unit: constant(match[3])\n          });\n        } else {\n          return Option.none();\n        }\n      });\n    };\n    var setGenericWidth = function (cell, amount, unit) {\n      set$1(cell, 'width', amount + unit);\n    };\n    var Sizes = {\n      percentageBasedSizeRegex: constant(percentageBasedSizeRegex),\n      pixelBasedSizeRegex: constant(pixelBasedSizeRegex),\n      setPixelWidth: setPixelWidth,\n      setPercentageWidth: setPercentageWidth,\n      setHeight: setHeight,\n      getPixelWidth: getPixelWidth,\n      getPercentageWidth: getPercentageWidth,\n      getGenericWidth: getGenericWidth,\n      setGenericWidth: setGenericWidth,\n      getHeight: getHeight$1,\n      getRawWidth: getRawWidth\n    };\n\n    var halve = function (main, other) {\n      var width = Sizes.getGenericWidth(main);\n      width.each(function (w) {\n        var newWidth = w.width() / 2;\n        Sizes.setGenericWidth(main, newWidth, w.unit());\n        Sizes.setGenericWidth(other, newWidth, w.unit());\n      });\n    };\n    var CellMutations = { halve: halve };\n\n    var r = function (left, top) {\n      var translate = function (x, y) {\n        return r(left + x, top + y);\n      };\n      return {\n        left: constant(left),\n        top: constant(top),\n        translate: translate\n      };\n    };\n    var Position = r;\n\n    var boxPosition = function (dom) {\n      var box = dom.getBoundingClientRect();\n      return Position(box.left, box.top);\n    };\n    var firstDefinedOrZero = function (a, b) {\n      return a !== undefined ? a : b !== undefined ? b : 0;\n    };\n    var absolute = function (element) {\n      var doc = element.dom().ownerDocument;\n      var body = doc.body;\n      var win = doc.defaultView;\n      var html = doc.documentElement;\n      if (body === element.dom()) {\n        return Position(body.offsetLeft, body.offsetTop);\n      }\n      var scrollTop = firstDefinedOrZero(win.pageYOffset, html.scrollTop);\n      var scrollLeft = firstDefinedOrZero(win.pageXOffset, html.scrollLeft);\n      var clientTop = firstDefinedOrZero(html.clientTop, body.clientTop);\n      var clientLeft = firstDefinedOrZero(html.clientLeft, body.clientLeft);\n      return viewport(element).translate(scrollLeft - clientLeft, scrollTop - clientTop);\n    };\n    var viewport = function (element) {\n      var dom = element.dom();\n      var doc = dom.ownerDocument;\n      var body = doc.body;\n      if (body === dom) {\n        return Position(body.offsetLeft, body.offsetTop);\n      }\n      if (!inBody(element)) {\n        return Position(0, 0);\n      }\n      return boxPosition(dom);\n    };\n\n    var rowInfo = Immutable('row', 'y');\n    var colInfo = Immutable('col', 'x');\n    var rtlEdge = function (cell) {\n      var pos = absolute(cell);\n      return pos.left() + getOuter$1(cell);\n    };\n    var ltrEdge = function (cell) {\n      return absolute(cell).left();\n    };\n    var getLeftEdge = function (index, cell) {\n      return colInfo(index, ltrEdge(cell));\n    };\n    var getRightEdge = function (index, cell) {\n      return colInfo(index, rtlEdge(cell));\n    };\n    var getTop = function (cell) {\n      return absolute(cell).top();\n    };\n    var getTopEdge = function (index, cell) {\n      return rowInfo(index, getTop(cell));\n    };\n    var getBottomEdge = function (index, cell) {\n      return rowInfo(index, getTop(cell) + getOuter(cell));\n    };\n    var findPositions = function (getInnerEdge, getOuterEdge, array) {\n      if (array.length === 0) {\n        return [];\n      }\n      var lines = map(array.slice(1), function (cellOption, index) {\n        return cellOption.map(function (cell) {\n          return getInnerEdge(index, cell);\n        });\n      });\n      var lastLine = array[array.length - 1].map(function (cell) {\n        return getOuterEdge(array.length - 1, cell);\n      });\n      return lines.concat([lastLine]);\n    };\n    var negate = function (step) {\n      return -step;\n    };\n    var height = {\n      delta: identity,\n      positions: function (optElements) {\n        return findPositions(getTopEdge, getBottomEdge, optElements);\n      },\n      edge: getTop\n    };\n    var ltr = {\n      delta: identity,\n      edge: ltrEdge,\n      positions: function (optElements) {\n        return findPositions(getLeftEdge, getRightEdge, optElements);\n      }\n    };\n    var rtl = {\n      delta: negate,\n      edge: rtlEdge,\n      positions: function (optElements) {\n        return findPositions(getRightEdge, getLeftEdge, optElements);\n      }\n    };\n    var BarPositions = {\n      height: height,\n      rtl: rtl,\n      ltr: ltr\n    };\n\n    var ResizeDirection = {\n      ltr: BarPositions.ltr,\n      rtl: BarPositions.rtl\n    };\n\n    function TableDirection (directionAt) {\n      var auto = function (table) {\n        return directionAt(table).isRtl() ? ResizeDirection.rtl : ResizeDirection.ltr;\n      };\n      var delta = function (amount, table) {\n        return auto(table).delta(amount, table);\n      };\n      var positions = function (cols, table) {\n        return auto(table).positions(cols, table);\n      };\n      var edge = function (cell) {\n        return auto(cell).edge(cell);\n      };\n      return {\n        delta: delta,\n        edge: edge,\n        positions: positions\n      };\n    }\n\n    var getGridSize = function (table) {\n      var input = DetailsList.fromTable(table);\n      var warehouse = Warehouse.generate(input);\n      return warehouse.grid();\n    };\n    var TableGridSize = { getGridSize: getGridSize };\n\n    var cat = function (arr) {\n      var r = [];\n      var push = function (x) {\n        r.push(x);\n      };\n      for (var i = 0; i < arr.length; i++) {\n        arr[i].each(push);\n      }\n      return r;\n    };\n    var findMap = function (arr, f) {\n      for (var i = 0; i < arr.length; i++) {\n        var r = f(arr[i], i);\n        if (r.isSome()) {\n          return r;\n        }\n      }\n      return Option.none();\n    };\n\n    var setIfNot = function (element, property, value, ignore) {\n      if (value === ignore) {\n        remove(element, property);\n      } else {\n        set(element, property, value);\n      }\n    };\n    var render = function (table, grid) {\n      var newRows = [];\n      var newCells = [];\n      var renderSection = function (gridSection, sectionName) {\n        var section = child$2(table, sectionName).getOrThunk(function () {\n          var tb = Element.fromTag(sectionName, owner(table).dom());\n          append(table, tb);\n          return tb;\n        });\n        empty(section);\n        var rows = map(gridSection, function (row) {\n          if (row.isNew()) {\n            newRows.push(row.element());\n          }\n          var tr = row.element();\n          empty(tr);\n          each(row.cells(), function (cell) {\n            if (cell.isNew()) {\n              newCells.push(cell.element());\n            }\n            setIfNot(cell.element(), 'colspan', cell.colspan(), 1);\n            setIfNot(cell.element(), 'rowspan', cell.rowspan(), 1);\n            append(tr, cell.element());\n          });\n          return tr;\n        });\n        append$1(section, rows);\n      };\n      var removeSection = function (sectionName) {\n        child$2(table, sectionName).each(remove$2);\n      };\n      var renderOrRemoveSection = function (gridSection, sectionName) {\n        if (gridSection.length > 0) {\n          renderSection(gridSection, sectionName);\n        } else {\n          removeSection(sectionName);\n        }\n      };\n      var headSection = [];\n      var bodySection = [];\n      var footSection = [];\n      each(grid, function (row) {\n        switch (row.section()) {\n        case 'thead':\n          headSection.push(row);\n          break;\n        case 'tbody':\n          bodySection.push(row);\n          break;\n        case 'tfoot':\n          footSection.push(row);\n          break;\n        }\n      });\n      renderOrRemoveSection(headSection, 'thead');\n      renderOrRemoveSection(bodySection, 'tbody');\n      renderOrRemoveSection(footSection, 'tfoot');\n      return {\n        newRows: constant(newRows),\n        newCells: constant(newCells)\n      };\n    };\n    var copy$2 = function (grid) {\n      var rows = map(grid, function (row) {\n        var tr = shallow(row.element());\n        each(row.cells(), function (cell) {\n          var clonedCell = deep(cell.element());\n          setIfNot(clonedCell, 'colspan', cell.colspan(), 1);\n          setIfNot(clonedCell, 'rowspan', cell.rowspan(), 1);\n          append(tr, clonedCell);\n        });\n        return tr;\n      });\n      return rows;\n    };\n    var Redraw = {\n      render: render,\n      copy: copy$2\n    };\n\n    var read = function (element, attr) {\n      var value = get$1(element, attr);\n      return value === undefined || value === '' ? [] : value.split(' ');\n    };\n    var add = function (element, attr, id) {\n      var old = read(element, attr);\n      var nu = old.concat([id]);\n      set(element, attr, nu.join(' '));\n      return true;\n    };\n    var remove$3 = function (element, attr, id) {\n      var nu = filter(read(element, attr), function (v) {\n        return v !== id;\n      });\n      if (nu.length > 0) {\n        set(element, attr, nu.join(' '));\n      } else {\n        remove(element, attr);\n      }\n      return false;\n    };\n\n    var supports = function (element) {\n      return element.dom().classList !== undefined;\n    };\n    var get$7 = function (element) {\n      return read(element, 'class');\n    };\n    var add$1 = function (element, clazz) {\n      return add(element, 'class', clazz);\n    };\n    var remove$4 = function (element, clazz) {\n      return remove$3(element, 'class', clazz);\n    };\n\n    var add$2 = function (element, clazz) {\n      if (supports(element)) {\n        element.dom().classList.add(clazz);\n      } else {\n        add$1(element, clazz);\n      }\n    };\n    var cleanClass = function (element) {\n      var classList = supports(element) ? element.dom().classList : get$7(element);\n      if (classList.length === 0) {\n        remove(element, 'class');\n      }\n    };\n    var remove$5 = function (element, clazz) {\n      if (supports(element)) {\n        var classList = element.dom().classList;\n        classList.remove(clazz);\n      } else {\n        remove$4(element, clazz);\n      }\n      cleanClass(element);\n    };\n    var has$2 = function (element, clazz) {\n      return supports(element) && element.dom().classList.contains(clazz);\n    };\n\n    var repeat = function (repititions, f) {\n      var r = [];\n      for (var i = 0; i < repititions; i++) {\n        r.push(f(i));\n      }\n      return r;\n    };\n    var range = function (start, end) {\n      var r = [];\n      for (var i = start; i < end; i++) {\n        r.push(i);\n      }\n      return r;\n    };\n    var deduce = function (xs, index) {\n      if (index < 0 || index >= xs.length - 1) {\n        return Option.none();\n      }\n      var current = xs[index].fold(function () {\n        var rest = reverse(xs.slice(0, index));\n        return findMap(rest, function (a, i) {\n          return a.map(function (aa) {\n            return {\n              value: aa,\n              delta: i + 1\n            };\n          });\n        });\n      }, function (c) {\n        return Option.some({\n          value: c,\n          delta: 0\n        });\n      });\n      var next = xs[index + 1].fold(function () {\n        var rest = xs.slice(index + 1);\n        return findMap(rest, function (a, i) {\n          return a.map(function (aa) {\n            return {\n              value: aa,\n              delta: i + 1\n            };\n          });\n        });\n      }, function (n) {\n        return Option.some({\n          value: n,\n          delta: 1\n        });\n      });\n      return current.bind(function (c) {\n        return next.map(function (n) {\n          var extras = n.delta + c.delta;\n          return Math.abs(n.value - c.value) / extras;\n        });\n      });\n    };\n\n    var columns = function (warehouse) {\n      var grid = warehouse.grid();\n      var cols = range(0, grid.columns());\n      var rowsArr = range(0, grid.rows());\n      return map(cols, function (col) {\n        var getBlock = function () {\n          return bind(rowsArr, function (r) {\n            return Warehouse.getAt(warehouse, r, col).filter(function (detail) {\n              return detail.column() === col;\n            }).fold(constant([]), function (detail) {\n              return [detail];\n            });\n          });\n        };\n        var isSingle = function (detail) {\n          return detail.colspan() === 1;\n        };\n        var getFallback = function () {\n          return Warehouse.getAt(warehouse, 0, col);\n        };\n        return decide(getBlock, isSingle, getFallback);\n      });\n    };\n    var decide = function (getBlock, isSingle, getFallback) {\n      var inBlock = getBlock();\n      var singleInBlock = find(inBlock, isSingle);\n      var detailOption = singleInBlock.orThunk(function () {\n        return Option.from(inBlock[0]).orThunk(getFallback);\n      });\n      return detailOption.map(function (detail) {\n        return detail.element();\n      });\n    };\n    var rows$1 = function (warehouse) {\n      var grid = warehouse.grid();\n      var rowsArr = range(0, grid.rows());\n      var cols = range(0, grid.columns());\n      return map(rowsArr, function (row) {\n        var getBlock = function () {\n          return bind(cols, function (c) {\n            return Warehouse.getAt(warehouse, row, c).filter(function (detail) {\n              return detail.row() === row;\n            }).fold(constant([]), function (detail) {\n              return [detail];\n            });\n          });\n        };\n        var isSingle = function (detail) {\n          return detail.rowspan() === 1;\n        };\n        var getFallback = function () {\n          return Warehouse.getAt(warehouse, row, 0);\n        };\n        return decide(getBlock, isSingle, getFallback);\n      });\n    };\n    var Blocks = {\n      columns: columns,\n      rows: rows$1\n    };\n\n    var css = function (namespace) {\n      var dashNamespace = namespace.replace(/\\./g, '-');\n      var resolve = function (str) {\n        return dashNamespace + '-' + str;\n      };\n      return { resolve: resolve };\n    };\n\n    var styles = css('ephox-snooker');\n    var Styles = { resolve: styles.resolve };\n\n    var col = function (column, x, y, w, h) {\n      var blocker = Element.fromTag('div');\n      setAll$1(blocker, {\n        position: 'absolute',\n        left: x - w / 2 + 'px',\n        top: y + 'px',\n        height: h + 'px',\n        width: w + 'px'\n      });\n      setAll(blocker, {\n        'data-column': column,\n        'role': 'presentation'\n      });\n      return blocker;\n    };\n    var row$1 = function (r, x, y, w, h) {\n      var blocker = Element.fromTag('div');\n      setAll$1(blocker, {\n        position: 'absolute',\n        left: x + 'px',\n        top: y - h / 2 + 'px',\n        height: h + 'px',\n        width: w + 'px'\n      });\n      setAll(blocker, {\n        'data-row': r,\n        'role': 'presentation'\n      });\n      return blocker;\n    };\n    var Bar = {\n      col: col,\n      row: row$1\n    };\n\n    var resizeBar = Styles.resolve('resizer-bar');\n    var resizeRowBar = Styles.resolve('resizer-rows');\n    var resizeColBar = Styles.resolve('resizer-cols');\n    var BAR_THICKNESS = 7;\n    var destroy = function (wire) {\n      var previous = descendants$1(wire.parent(), '.' + resizeBar);\n      each(previous, remove$2);\n    };\n    var drawBar = function (wire, positions, create) {\n      var origin = wire.origin();\n      each(positions, function (cpOption, i) {\n        cpOption.each(function (cp) {\n          var bar = create(origin, cp);\n          add$2(bar, resizeBar);\n          append(wire.parent(), bar);\n        });\n      });\n    };\n    var refreshCol = function (wire, colPositions, position, tableHeight) {\n      drawBar(wire, colPositions, function (origin, cp) {\n        var colBar = Bar.col(cp.col(), cp.x() - origin.left(), position.top() - origin.top(), BAR_THICKNESS, tableHeight);\n        add$2(colBar, resizeColBar);\n        return colBar;\n      });\n    };\n    var refreshRow = function (wire, rowPositions, position, tableWidth) {\n      drawBar(wire, rowPositions, function (origin, cp) {\n        var rowBar = Bar.row(cp.row(), position.left() - origin.left(), cp.y() - origin.top(), tableWidth, BAR_THICKNESS);\n        add$2(rowBar, resizeRowBar);\n        return rowBar;\n      });\n    };\n    var refreshGrid = function (wire, table, rows, cols, hdirection, vdirection) {\n      var position = absolute(table);\n      var rowPositions = rows.length > 0 ? hdirection.positions(rows, table) : [];\n      refreshRow(wire, rowPositions, position, getOuter$1(table));\n      var colPositions = cols.length > 0 ? vdirection.positions(cols, table) : [];\n      refreshCol(wire, colPositions, position, getOuter(table));\n    };\n    var refresh = function (wire, table, hdirection, vdirection) {\n      destroy(wire);\n      var list = DetailsList.fromTable(table);\n      var warehouse = Warehouse.generate(list);\n      var rows = Blocks.rows(warehouse);\n      var cols = Blocks.columns(warehouse);\n      refreshGrid(wire, table, rows, cols, hdirection, vdirection);\n    };\n    var each$2 = function (wire, f) {\n      var bars = descendants$1(wire.parent(), '.' + resizeBar);\n      each(bars, f);\n    };\n    var hide = function (wire) {\n      each$2(wire, function (bar) {\n        set$1(bar, 'display', 'none');\n      });\n    };\n    var show = function (wire) {\n      each$2(wire, function (bar) {\n        set$1(bar, 'display', 'block');\n      });\n    };\n    var isRowBar = function (element) {\n      return has$2(element, resizeRowBar);\n    };\n    var isColBar = function (element) {\n      return has$2(element, resizeColBar);\n    };\n    var Bars = {\n      refresh: refresh,\n      hide: hide,\n      show: show,\n      destroy: destroy,\n      isRowBar: isRowBar,\n      isColBar: isColBar\n    };\n\n    var addCell = function (gridRow, index, cell) {\n      var cells = gridRow.cells();\n      var before = cells.slice(0, index);\n      var after = cells.slice(index);\n      var newCells = before.concat([cell]).concat(after);\n      return setCells(gridRow, newCells);\n    };\n    var mutateCell = function (gridRow, index, cell) {\n      var cells = gridRow.cells();\n      cells[index] = cell;\n    };\n    var setCells = function (gridRow, cells) {\n      return rowcells(cells, gridRow.section());\n    };\n    var mapCells = function (gridRow, f) {\n      var cells = gridRow.cells();\n      var r = map(cells, f);\n      return rowcells(r, gridRow.section());\n    };\n    var getCell = function (gridRow, index) {\n      return gridRow.cells()[index];\n    };\n    var getCellElement = function (gridRow, index) {\n      return getCell(gridRow, index).element();\n    };\n    var cellLength = function (gridRow) {\n      return gridRow.cells().length;\n    };\n    var GridRow = {\n      addCell: addCell,\n      setCells: setCells,\n      mutateCell: mutateCell,\n      getCell: getCell,\n      getCellElement: getCellElement,\n      mapCells: mapCells,\n      cellLength: cellLength\n    };\n\n    var getColumn = function (grid, index) {\n      return map(grid, function (row) {\n        return GridRow.getCell(row, index);\n      });\n    };\n    var getRow = function (grid, index) {\n      return grid[index];\n    };\n    var findDiff = function (xs, comp) {\n      if (xs.length === 0) {\n        return 0;\n      }\n      var first = xs[0];\n      var index = findIndex(xs, function (x) {\n        return !comp(first.element(), x.element());\n      });\n      return index.fold(function () {\n        return xs.length;\n      }, function (ind) {\n        return ind;\n      });\n    };\n    var subgrid = function (grid, row, column, comparator) {\n      var restOfRow = getRow(grid, row).cells().slice(column);\n      var endColIndex = findDiff(restOfRow, comparator);\n      var restOfColumn = getColumn(grid, column).slice(row);\n      var endRowIndex = findDiff(restOfColumn, comparator);\n      return {\n        colspan: constant(endColIndex),\n        rowspan: constant(endRowIndex)\n      };\n    };\n    var TableGrid = { subgrid: subgrid };\n\n    var toDetails = function (grid, comparator) {\n      var seen = map(grid, function (row, ri) {\n        return map(row.cells(), function (col, ci) {\n          return false;\n        });\n      });\n      var updateSeen = function (ri, ci, rowspan, colspan) {\n        for (var r = ri; r < ri + rowspan; r++) {\n          for (var c = ci; c < ci + colspan; c++) {\n            seen[r][c] = true;\n          }\n        }\n      };\n      return map(grid, function (row, ri) {\n        var details = bind(row.cells(), function (cell, ci) {\n          if (seen[ri][ci] === false) {\n            var result = TableGrid.subgrid(grid, ri, ci, comparator);\n            updateSeen(ri, ci, result.rowspan(), result.colspan());\n            return [detailnew(cell.element(), result.rowspan(), result.colspan(), cell.isNew())];\n          } else {\n            return [];\n          }\n        });\n        return rowdetails(details, row.section());\n      });\n    };\n    var toGrid = function (warehouse, generators, isNew) {\n      var grid = [];\n      for (var i = 0; i < warehouse.grid().rows(); i++) {\n        var rowCells = [];\n        for (var j = 0; j < warehouse.grid().columns(); j++) {\n          var element = Warehouse.getAt(warehouse, i, j).map(function (item) {\n            return elementnew(item.element(), isNew);\n          }).getOrThunk(function () {\n            return elementnew(generators.gap(), true);\n          });\n          rowCells.push(element);\n        }\n        var row = rowcells(rowCells, warehouse.all()[i].section());\n        grid.push(row);\n      }\n      return grid;\n    };\n    var Transitions = {\n      toDetails: toDetails,\n      toGrid: toGrid\n    };\n\n    var fromWarehouse = function (warehouse, generators) {\n      return Transitions.toGrid(warehouse, generators, false);\n    };\n    var deriveRows = function (rendered, generators) {\n      var findRow = function (details) {\n        var rowOfCells = findMap(details, function (detail) {\n          return parent(detail.element()).map(function (row) {\n            var isNew = parent(row).isNone();\n            return elementnew(row, isNew);\n          });\n        });\n        return rowOfCells.getOrThunk(function () {\n          return elementnew(generators.row(), true);\n        });\n      };\n      return map(rendered, function (details) {\n        var row = findRow(details.details());\n        return rowdatanew(row.element(), details.details(), details.section(), row.isNew());\n      });\n    };\n    var toDetailList = function (grid, generators) {\n      var rendered = Transitions.toDetails(grid, eq);\n      return deriveRows(rendered, generators);\n    };\n    var findInWarehouse = function (warehouse, element) {\n      var all = flatten(map(warehouse.all(), function (r) {\n        return r.cells();\n      }));\n      return find(all, function (e) {\n        return eq(element, e.element());\n      });\n    };\n    var run = function (operation, extract, adjustment, postAction, genWrappers) {\n      return function (wire, table, target, generators, direction) {\n        var input = DetailsList.fromTable(table);\n        var warehouse = Warehouse.generate(input);\n        var output = extract(warehouse, target).map(function (info) {\n          var model = fromWarehouse(warehouse, generators);\n          var result = operation(model, info, eq, genWrappers(generators));\n          var grid = toDetailList(result.grid(), generators);\n          return {\n            grid: constant(grid),\n            cursor: result.cursor\n          };\n        });\n        return output.fold(function () {\n          return Option.none();\n        }, function (out) {\n          var newElements = Redraw.render(table, out.grid());\n          adjustment(table, out.grid(), direction);\n          postAction(table);\n          Bars.refresh(wire, table, BarPositions.height, direction);\n          return Option.some({\n            cursor: out.cursor,\n            newRows: newElements.newRows,\n            newCells: newElements.newCells\n          });\n        });\n      };\n    };\n    var onCell = function (warehouse, target) {\n      return TableLookup.cell(target.element()).bind(function (cell) {\n        return findInWarehouse(warehouse, cell);\n      });\n    };\n    var onPaste = function (warehouse, target) {\n      return TableLookup.cell(target.element()).bind(function (cell) {\n        return findInWarehouse(warehouse, cell).map(function (details) {\n          var value = __assign(__assign({}, details), {\n            generators: target.generators,\n            clipboard: target.clipboard\n          });\n          return value;\n        });\n      });\n    };\n    var onPasteRows = function (warehouse, target) {\n      var details = map(target.selection(), function (cell) {\n        return TableLookup.cell(cell).bind(function (lc) {\n          return findInWarehouse(warehouse, lc);\n        });\n      });\n      var cells = cat(details);\n      return cells.length > 0 ? Option.some({\n        cells: cells,\n        generators: target.generators,\n        clipboard: target.clipboard\n      }) : Option.none();\n    };\n    var onMergable = function (_warehouse, target) {\n      return target.mergable();\n    };\n    var onUnmergable = function (_warehouse, target) {\n      return target.unmergable();\n    };\n    var onCells = function (warehouse, target) {\n      var details = map(target.selection(), function (cell) {\n        return TableLookup.cell(cell).bind(function (lc) {\n          return findInWarehouse(warehouse, lc);\n        });\n      });\n      var cells = cat(details);\n      return cells.length > 0 ? Option.some(cells) : Option.none();\n    };\n\n    var value = function (o) {\n      var is = function (v) {\n        return o === v;\n      };\n      var or = function (opt) {\n        return value(o);\n      };\n      var orThunk = function (f) {\n        return value(o);\n      };\n      var map = function (f) {\n        return value(f(o));\n      };\n      var mapError = function (f) {\n        return value(o);\n      };\n      var each = function (f) {\n        f(o);\n      };\n      var bind = function (f) {\n        return f(o);\n      };\n      var fold = function (_, onValue) {\n        return onValue(o);\n      };\n      var exists = function (f) {\n        return f(o);\n      };\n      var forall = function (f) {\n        return f(o);\n      };\n      var toOption = function () {\n        return Option.some(o);\n      };\n      return {\n        is: is,\n        isValue: always,\n        isError: never,\n        getOr: constant(o),\n        getOrThunk: constant(o),\n        getOrDie: constant(o),\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: each,\n        bind: bind,\n        exists: exists,\n        forall: forall,\n        toOption: toOption\n      };\n    };\n    var error = function (message) {\n      var getOrThunk = function (f) {\n        return f();\n      };\n      var getOrDie = function () {\n        return die(String(message))();\n      };\n      var or = function (opt) {\n        return opt;\n      };\n      var orThunk = function (f) {\n        return f();\n      };\n      var map = function (f) {\n        return error(message);\n      };\n      var mapError = function (f) {\n        return error(f(message));\n      };\n      var bind = function (f) {\n        return error(message);\n      };\n      var fold = function (onError, _) {\n        return onError(message);\n      };\n      return {\n        is: never,\n        isValue: never,\n        isError: always,\n        getOr: identity,\n        getOrThunk: getOrThunk,\n        getOrDie: getOrDie,\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: noop,\n        bind: bind,\n        exists: never,\n        forall: always,\n        toOption: Option.none\n      };\n    };\n    var fromOption = function (opt, err) {\n      return opt.fold(function () {\n        return error(err);\n      }, value);\n    };\n    var Result = {\n      value: value,\n      error: error,\n      fromOption: fromOption\n    };\n\n    var measure = function (startAddress, gridA, gridB) {\n      if (startAddress.row() >= gridA.length || startAddress.column() > GridRow.cellLength(gridA[0])) {\n        return Result.error('invalid start address out of table bounds, row: ' + startAddress.row() + ', column: ' + startAddress.column());\n      }\n      var rowRemainder = gridA.slice(startAddress.row());\n      var colRemainder = rowRemainder[0].cells().slice(startAddress.column());\n      var colRequired = GridRow.cellLength(gridB[0]);\n      var rowRequired = gridB.length;\n      return Result.value({\n        rowDelta: constant(rowRemainder.length - rowRequired),\n        colDelta: constant(colRemainder.length - colRequired)\n      });\n    };\n    var measureWidth = function (gridA, gridB) {\n      var colLengthA = GridRow.cellLength(gridA[0]);\n      var colLengthB = GridRow.cellLength(gridB[0]);\n      return {\n        rowDelta: constant(0),\n        colDelta: constant(colLengthA - colLengthB)\n      };\n    };\n    var fill = function (cells, generator) {\n      return map(cells, function () {\n        return elementnew(generator.cell(), true);\n      });\n    };\n    var rowFill = function (grid, amount, generator) {\n      return grid.concat(repeat(amount, function (_row) {\n        return GridRow.setCells(grid[grid.length - 1], fill(grid[grid.length - 1].cells(), generator));\n      }));\n    };\n    var colFill = function (grid, amount, generator) {\n      return map(grid, function (row) {\n        return GridRow.setCells(row, row.cells().concat(fill(range(0, amount), generator)));\n      });\n    };\n    var tailor = function (gridA, delta, generator) {\n      var fillCols = delta.colDelta() < 0 ? colFill : identity;\n      var fillRows = delta.rowDelta() < 0 ? rowFill : identity;\n      var modifiedCols = fillCols(gridA, Math.abs(delta.colDelta()), generator);\n      var tailoredGrid = fillRows(modifiedCols, Math.abs(delta.rowDelta()), generator);\n      return tailoredGrid;\n    };\n    var Fitment = {\n      measure: measure,\n      measureWidth: measureWidth,\n      tailor: tailor\n    };\n\n    var merge = function (grid, bounds, comparator, substitution) {\n      if (grid.length === 0) {\n        return grid;\n      }\n      for (var i = bounds.startRow(); i <= bounds.finishRow(); i++) {\n        for (var j = bounds.startCol(); j <= bounds.finishCol(); j++) {\n          GridRow.mutateCell(grid[i], j, elementnew(substitution(), false));\n        }\n      }\n      return grid;\n    };\n    var unmerge = function (grid, target, comparator, substitution) {\n      var first = true;\n      for (var i = 0; i < grid.length; i++) {\n        for (var j = 0; j < GridRow.cellLength(grid[0]); j++) {\n          var current = GridRow.getCellElement(grid[i], j);\n          var isToReplace = comparator(current, target);\n          if (isToReplace === true && first === false) {\n            GridRow.mutateCell(grid[i], j, elementnew(substitution(), true));\n          } else if (isToReplace === true) {\n            first = false;\n          }\n        }\n      }\n      return grid;\n    };\n    var uniqueCells = function (row, comparator) {\n      return foldl(row, function (rest, cell) {\n        return exists(rest, function (currentCell) {\n          return comparator(currentCell.element(), cell.element());\n        }) ? rest : rest.concat([cell]);\n      }, []);\n    };\n    var splitRows = function (grid, index, comparator, substitution) {\n      if (index > 0 && index < grid.length) {\n        var rowPrevCells = grid[index - 1].cells();\n        var cells = uniqueCells(rowPrevCells, comparator);\n        each(cells, function (cell) {\n          var replacement = Option.none();\n          var _loop_1 = function (i) {\n            var _loop_2 = function (j) {\n              var current = grid[i].cells()[j];\n              var isToReplace = comparator(current.element(), cell.element());\n              if (isToReplace) {\n                if (replacement.isNone()) {\n                  replacement = Option.some(substitution());\n                }\n                replacement.each(function (sub) {\n                  GridRow.mutateCell(grid[i], j, elementnew(sub, true));\n                });\n              }\n            };\n            for (var j = 0; j < GridRow.cellLength(grid[0]); j++) {\n              _loop_2(j);\n            }\n          };\n          for (var i = index; i < grid.length; i++) {\n            _loop_1(i);\n          }\n        });\n      }\n      return grid;\n    };\n    var MergingOperations = {\n      merge: merge,\n      unmerge: unmerge,\n      splitRows: splitRows\n    };\n\n    var isSpanning = function (grid, row, col, comparator) {\n      var candidate = GridRow.getCell(grid[row], col);\n      var matching = curry(comparator, candidate.element());\n      var currentRow = grid[row];\n      return grid.length > 1 && GridRow.cellLength(currentRow) > 1 && (col > 0 && matching(GridRow.getCellElement(currentRow, col - 1)) || col < currentRow.cells().length - 1 && matching(GridRow.getCellElement(currentRow, col + 1)) || row > 0 && matching(GridRow.getCellElement(grid[row - 1], col)) || row < grid.length - 1 && matching(GridRow.getCellElement(grid[row + 1], col)));\n    };\n    var mergeTables = function (startAddress, gridA, gridB, generator, comparator) {\n      var startRow = startAddress.row();\n      var startCol = startAddress.column();\n      var mergeHeight = gridB.length;\n      var mergeWidth = GridRow.cellLength(gridB[0]);\n      var endRow = startRow + mergeHeight;\n      var endCol = startCol + mergeWidth;\n      for (var r = startRow; r < endRow; r++) {\n        for (var c = startCol; c < endCol; c++) {\n          if (isSpanning(gridA, r, c, comparator)) {\n            MergingOperations.unmerge(gridA, GridRow.getCellElement(gridA[r], c), comparator, generator.cell);\n          }\n          var newCell = GridRow.getCellElement(gridB[r - startRow], c - startCol);\n          var replacement = generator.replace(newCell);\n          GridRow.mutateCell(gridA[r], c, elementnew(replacement, true));\n        }\n      }\n      return gridA;\n    };\n    var merge$1 = function (startAddress, gridA, gridB, generator, comparator) {\n      var result = Fitment.measure(startAddress, gridA, gridB);\n      return result.map(function (delta) {\n        var fittedGrid = Fitment.tailor(gridA, delta, generator);\n        return mergeTables(startAddress, fittedGrid, gridB, generator, comparator);\n      });\n    };\n    var insert = function (index, gridA, gridB, generator, comparator) {\n      MergingOperations.splitRows(gridA, index, comparator, generator.cell);\n      var delta = Fitment.measureWidth(gridB, gridA);\n      var fittedNewGrid = Fitment.tailor(gridB, delta, generator);\n      var secondDelta = Fitment.measureWidth(gridA, fittedNewGrid);\n      var fittedOldGrid = Fitment.tailor(gridA, secondDelta, generator);\n      return fittedOldGrid.slice(0, index).concat(fittedNewGrid).concat(fittedOldGrid.slice(index, fittedOldGrid.length));\n    };\n    var TableMerge = {\n      merge: merge$1,\n      insert: insert\n    };\n\n    var insertRowAt = function (grid, index, example, comparator, substitution) {\n      var before = grid.slice(0, index);\n      var after = grid.slice(index);\n      var between = GridRow.mapCells(grid[example], function (ex, c) {\n        var withinSpan = index > 0 && index < grid.length && comparator(GridRow.getCellElement(grid[index - 1], c), GridRow.getCellElement(grid[index], c));\n        var ret = withinSpan ? GridRow.getCell(grid[index], c) : elementnew(substitution(ex.element(), comparator), true);\n        return ret;\n      });\n      return before.concat([between]).concat(after);\n    };\n    var insertColumnAt = function (grid, index, example, comparator, substitution) {\n      return map(grid, function (row) {\n        var withinSpan = index > 0 && index < GridRow.cellLength(row) && comparator(GridRow.getCellElement(row, index - 1), GridRow.getCellElement(row, index));\n        var sub = withinSpan ? GridRow.getCell(row, index) : elementnew(substitution(GridRow.getCellElement(row, example), comparator), true);\n        return GridRow.addCell(row, index, sub);\n      });\n    };\n    var splitCellIntoColumns = function (grid, exampleRow, exampleCol, comparator, substitution) {\n      var index = exampleCol + 1;\n      return map(grid, function (row, i) {\n        var isTargetCell = i === exampleRow;\n        var sub = isTargetCell ? elementnew(substitution(GridRow.getCellElement(row, exampleCol), comparator), true) : GridRow.getCell(row, exampleCol);\n        return GridRow.addCell(row, index, sub);\n      });\n    };\n    var splitCellIntoRows = function (grid, exampleRow, exampleCol, comparator, substitution) {\n      var index = exampleRow + 1;\n      var before = grid.slice(0, index);\n      var after = grid.slice(index);\n      var between = GridRow.mapCells(grid[exampleRow], function (ex, i) {\n        var isTargetCell = i === exampleCol;\n        return isTargetCell ? elementnew(substitution(ex.element(), comparator), true) : ex;\n      });\n      return before.concat([between]).concat(after);\n    };\n    var deleteColumnsAt = function (grid, start, finish) {\n      var rows = map(grid, function (row) {\n        var cells = row.cells().slice(0, start).concat(row.cells().slice(finish + 1));\n        return rowcells(cells, row.section());\n      });\n      return filter(rows, function (row) {\n        return row.cells().length > 0;\n      });\n    };\n    var deleteRowsAt = function (grid, start, finish) {\n      return grid.slice(0, start).concat(grid.slice(finish + 1));\n    };\n    var ModificationOperations = {\n      insertRowAt: insertRowAt,\n      insertColumnAt: insertColumnAt,\n      splitCellIntoColumns: splitCellIntoColumns,\n      splitCellIntoRows: splitCellIntoRows,\n      deleteRowsAt: deleteRowsAt,\n      deleteColumnsAt: deleteColumnsAt\n    };\n\n    var replaceIn = function (grid, targets, comparator, substitution) {\n      var isTarget = function (cell) {\n        return exists(targets, function (target) {\n          return comparator(cell.element(), target.element());\n        });\n      };\n      return map(grid, function (row) {\n        return GridRow.mapCells(row, function (cell) {\n          return isTarget(cell) ? elementnew(substitution(cell.element(), comparator), true) : cell;\n        });\n      });\n    };\n    var notStartRow = function (grid, rowIndex, colIndex, comparator) {\n      return GridRow.getCellElement(grid[rowIndex], colIndex) !== undefined && (rowIndex > 0 && comparator(GridRow.getCellElement(grid[rowIndex - 1], colIndex), GridRow.getCellElement(grid[rowIndex], colIndex)));\n    };\n    var notStartColumn = function (row, index, comparator) {\n      return index > 0 && comparator(GridRow.getCellElement(row, index - 1), GridRow.getCellElement(row, index));\n    };\n    var replaceColumn = function (grid, index, comparator, substitution) {\n      var targets = bind(grid, function (row, i) {\n        var alreadyAdded = notStartRow(grid, i, index, comparator) || notStartColumn(row, index, comparator);\n        return alreadyAdded ? [] : [GridRow.getCell(row, index)];\n      });\n      return replaceIn(grid, targets, comparator, substitution);\n    };\n    var replaceRow = function (grid, index, comparator, substitution) {\n      var targetRow = grid[index];\n      var targets = bind(targetRow.cells(), function (item, i) {\n        var alreadyAdded = notStartRow(grid, index, i, comparator) || notStartColumn(targetRow, i, comparator);\n        return alreadyAdded ? [] : [item];\n      });\n      return replaceIn(grid, targets, comparator, substitution);\n    };\n    var TransformOperations = {\n      replaceColumn: replaceColumn,\n      replaceRow: replaceRow\n    };\n\n    var adt = Adt.generate([\n      { none: [] },\n      { only: ['index'] },\n      {\n        left: [\n          'index',\n          'next'\n        ]\n      },\n      {\n        middle: [\n          'prev',\n          'index',\n          'next'\n        ]\n      },\n      {\n        right: [\n          'prev',\n          'index'\n        ]\n      }\n    ]);\n    var ColumnContext = __assign({}, adt);\n\n    var neighbours$1 = function (input, index) {\n      if (input.length === 0) {\n        return ColumnContext.none();\n      }\n      if (input.length === 1) {\n        return ColumnContext.only(0);\n      }\n      if (index === 0) {\n        return ColumnContext.left(0, 1);\n      }\n      if (index === input.length - 1) {\n        return ColumnContext.right(index - 1, index);\n      }\n      if (index > 0 && index < input.length - 1) {\n        return ColumnContext.middle(index - 1, index, index + 1);\n      }\n      return ColumnContext.none();\n    };\n    var determine = function (input, column, step, tableSize) {\n      var result = input.slice(0);\n      var context = neighbours$1(input, column);\n      var zero = function (array) {\n        return map(array, constant(0));\n      };\n      var onNone = constant(zero(result));\n      var onOnly = function (index) {\n        return tableSize.singleColumnWidth(result[index], step);\n      };\n      var onChange = function (index, next) {\n        if (step >= 0) {\n          var newNext = Math.max(tableSize.minCellWidth(), result[next] - step);\n          return zero(result.slice(0, index)).concat([\n            step,\n            newNext - result[next]\n          ]).concat(zero(result.slice(next + 1)));\n        } else {\n          var newThis = Math.max(tableSize.minCellWidth(), result[index] + step);\n          var diffx = result[index] - newThis;\n          return zero(result.slice(0, index)).concat([\n            newThis - result[index],\n            diffx\n          ]).concat(zero(result.slice(next + 1)));\n        }\n      };\n      var onLeft = onChange;\n      var onMiddle = function (_prev, index, next) {\n        return onChange(index, next);\n      };\n      var onRight = function (_prev, index) {\n        if (step >= 0) {\n          return zero(result.slice(0, index)).concat([step]);\n        } else {\n          var size = Math.max(tableSize.minCellWidth(), result[index] + step);\n          return zero(result.slice(0, index)).concat([size - result[index]]);\n        }\n      };\n      return context.fold(onNone, onOnly, onLeft, onMiddle, onRight);\n    };\n    var Deltas = { determine: determine };\n\n    var getSpan$1 = function (cell, type) {\n      return has$1(cell, type) && parseInt(get$1(cell, type), 10) > 1;\n    };\n    var hasColspan = function (cell) {\n      return getSpan$1(cell, 'colspan');\n    };\n    var hasRowspan = function (cell) {\n      return getSpan$1(cell, 'rowspan');\n    };\n    var getInt = function (element, property) {\n      return parseInt(get$2(element, property), 10);\n    };\n    var CellUtils = {\n      hasColspan: hasColspan,\n      hasRowspan: hasRowspan,\n      minWidth: constant(10),\n      minHeight: constant(10),\n      getInt: getInt\n    };\n\n    var getRaw$1 = function (cell, property, getter) {\n      return getRaw(cell, property).fold(function () {\n        return getter(cell) + 'px';\n      }, function (raw) {\n        return raw;\n      });\n    };\n    var getRawW = function (cell, tableSize) {\n      return getRaw$1(cell, 'width', function (e) {\n        return Sizes.getPixelWidth(e, tableSize);\n      });\n    };\n    var getRawH = function (cell) {\n      return getRaw$1(cell, 'height', Sizes.getHeight);\n    };\n    var getWidthFrom = function (warehouse, direction, getWidth, fallback, tableSize) {\n      var columns = Blocks.columns(warehouse);\n      var backups = map(columns, function (cellOption) {\n        return cellOption.map(direction.edge);\n      });\n      return map(columns, function (cellOption, c) {\n        var columnCell = cellOption.filter(not(CellUtils.hasColspan));\n        return columnCell.fold(function () {\n          var deduced = deduce(backups, c);\n          return fallback(deduced);\n        }, function (cell) {\n          return getWidth(cell, tableSize);\n        });\n      });\n    };\n    var getDeduced = function (deduced) {\n      return deduced.map(function (d) {\n        return d + 'px';\n      }).getOr('');\n    };\n    var getRawWidths = function (warehouse, direction, tableSize) {\n      return getWidthFrom(warehouse, direction, getRawW, getDeduced, tableSize);\n    };\n    var getPercentageWidths = function (warehouse, direction, tableSize) {\n      return getWidthFrom(warehouse, direction, Sizes.getPercentageWidth, function (deduced) {\n        return deduced.fold(function () {\n          return tableSize.minCellWidth();\n        }, function (cellWidth) {\n          return cellWidth / tableSize.pixelWidth() * 100;\n        });\n      }, tableSize);\n    };\n    var getPixelWidths = function (warehouse, direction, tableSize) {\n      return getWidthFrom(warehouse, direction, Sizes.getPixelWidth, function (deduced) {\n        return deduced.getOrThunk(tableSize.minCellWidth);\n      }, tableSize);\n    };\n    var getHeightFrom = function (warehouse, direction, getHeight, fallback) {\n      var rows = Blocks.rows(warehouse);\n      var backups = map(rows, function (cellOption) {\n        return cellOption.map(direction.edge);\n      });\n      return map(rows, function (cellOption, c) {\n        var rowCell = cellOption.filter(not(CellUtils.hasRowspan));\n        return rowCell.fold(function () {\n          var deduced = deduce(backups, c);\n          return fallback(deduced);\n        }, function (cell) {\n          return getHeight(cell);\n        });\n      });\n    };\n    var getPixelHeights = function (warehouse, direction) {\n      return getHeightFrom(warehouse, direction, Sizes.getHeight, function (deduced) {\n        return deduced.getOrThunk(CellUtils.minHeight);\n      });\n    };\n    var getRawHeights = function (warehouse, direction) {\n      return getHeightFrom(warehouse, direction, getRawH, getDeduced);\n    };\n    var ColumnSizes = {\n      getRawWidths: getRawWidths,\n      getPixelWidths: getPixelWidths,\n      getPercentageWidths: getPercentageWidths,\n      getPixelHeights: getPixelHeights,\n      getRawHeights: getRawHeights\n    };\n\n    var total = function (start, end, measures) {\n      var r = 0;\n      for (var i = start; i < end; i++) {\n        r += measures[i] !== undefined ? measures[i] : 0;\n      }\n      return r;\n    };\n    var recalculateWidth = function (warehouse, widths) {\n      var all = Warehouse.justCells(warehouse);\n      return map(all, function (cell) {\n        var width = total(cell.column(), cell.column() + cell.colspan(), widths);\n        return {\n          element: cell.element,\n          width: constant(width),\n          colspan: cell.colspan\n        };\n      });\n    };\n    var recalculateHeight = function (warehouse, heights) {\n      var all = Warehouse.justCells(warehouse);\n      return map(all, function (cell) {\n        var height = total(cell.row(), cell.row() + cell.rowspan(), heights);\n        return {\n          element: cell.element,\n          height: constant(height),\n          rowspan: cell.rowspan\n        };\n      });\n    };\n    var matchRowHeight = function (warehouse, heights) {\n      return map(warehouse.all(), function (row, i) {\n        return {\n          element: row.element,\n          height: constant(heights[i])\n        };\n      });\n    };\n    var Recalculations = {\n      recalculateWidth: recalculateWidth,\n      recalculateHeight: recalculateHeight,\n      matchRowHeight: matchRowHeight\n    };\n\n    var percentageSize = function (width, element) {\n      var floatWidth = parseFloat(width);\n      var pixelWidth = get$5(element);\n      var getCellDelta = function (delta) {\n        return delta / pixelWidth * 100;\n      };\n      var singleColumnWidth = function (w, _delta) {\n        return [100 - w];\n      };\n      var minCellWidth = function () {\n        return CellUtils.minWidth() / pixelWidth * 100;\n      };\n      var setTableWidth = function (table, _newWidths, delta) {\n        var ratio = delta / 100;\n        var change = ratio * floatWidth;\n        Sizes.setPercentageWidth(table, floatWidth + change);\n      };\n      return {\n        width: constant(floatWidth),\n        pixelWidth: constant(pixelWidth),\n        getWidths: ColumnSizes.getPercentageWidths,\n        getCellDelta: getCellDelta,\n        singleColumnWidth: singleColumnWidth,\n        minCellWidth: minCellWidth,\n        setElementWidth: Sizes.setPercentageWidth,\n        setTableWidth: setTableWidth\n      };\n    };\n    var pixelSize = function (width) {\n      var getCellDelta = identity;\n      var singleColumnWidth = function (w, delta) {\n        var newNext = Math.max(CellUtils.minWidth(), w + delta);\n        return [newNext - w];\n      };\n      var setTableWidth = function (table, newWidths, _delta) {\n        var total = foldr(newWidths, function (b, a) {\n          return b + a;\n        }, 0);\n        Sizes.setPixelWidth(table, total);\n      };\n      return {\n        width: constant(width),\n        pixelWidth: constant(width),\n        getWidths: ColumnSizes.getPixelWidths,\n        getCellDelta: getCellDelta,\n        singleColumnWidth: singleColumnWidth,\n        minCellWidth: CellUtils.minWidth,\n        setElementWidth: Sizes.setPixelWidth,\n        setTableWidth: setTableWidth\n      };\n    };\n    var chooseSize = function (element, width) {\n      var percentMatch = Sizes.percentageBasedSizeRegex().exec(width);\n      if (percentMatch !== null) {\n        return percentageSize(percentMatch[1], element);\n      }\n      var pixelMatch = Sizes.pixelBasedSizeRegex().exec(width);\n      if (pixelMatch !== null) {\n        var intWidth = parseInt(pixelMatch[1], 10);\n        return pixelSize(intWidth);\n      }\n      var fallbackWidth = get$5(element);\n      return pixelSize(fallbackWidth);\n    };\n    var getTableSize = function (element) {\n      var width = Sizes.getRawWidth(element);\n      return width.fold(function () {\n        var fallbackWidth = get$5(element);\n        return pixelSize(fallbackWidth);\n      }, function (w) {\n        return chooseSize(element, w);\n      });\n    };\n    var TableSize = { getTableSize: getTableSize };\n\n    var getWarehouse$1 = function (list) {\n      return Warehouse.generate(list);\n    };\n    var sumUp = function (newSize) {\n      return foldr(newSize, function (b, a) {\n        return b + a;\n      }, 0);\n    };\n    var getTableWarehouse = function (table) {\n      var list = DetailsList.fromTable(table);\n      return getWarehouse$1(list);\n    };\n    var adjustWidth = function (table, delta, index, direction) {\n      var tableSize = TableSize.getTableSize(table);\n      var step = tableSize.getCellDelta(delta);\n      var warehouse = getTableWarehouse(table);\n      var widths = tableSize.getWidths(warehouse, direction, tableSize);\n      var deltas = Deltas.determine(widths, index, step, tableSize);\n      var newWidths = map(deltas, function (dx, i) {\n        return dx + widths[i];\n      });\n      var newSizes = Recalculations.recalculateWidth(warehouse, newWidths);\n      each(newSizes, function (cell) {\n        tableSize.setElementWidth(cell.element(), cell.width());\n      });\n      if (index === warehouse.grid().columns() - 1) {\n        tableSize.setTableWidth(table, newWidths, step);\n      }\n    };\n    var adjustHeight = function (table, delta, index, direction) {\n      var warehouse = getTableWarehouse(table);\n      var heights = ColumnSizes.getPixelHeights(warehouse, direction);\n      var newHeights = map(heights, function (dy, i) {\n        return index === i ? Math.max(delta + dy, CellUtils.minHeight()) : dy;\n      });\n      var newCellSizes = Recalculations.recalculateHeight(warehouse, newHeights);\n      var newRowSizes = Recalculations.matchRowHeight(warehouse, newHeights);\n      each(newRowSizes, function (row) {\n        Sizes.setHeight(row.element(), row.height());\n      });\n      each(newCellSizes, function (cell) {\n        Sizes.setHeight(cell.element(), cell.height());\n      });\n      var total = sumUp(newHeights);\n      Sizes.setHeight(table, total);\n    };\n    var adjustWidthTo = function (table, list, direction) {\n      var tableSize = TableSize.getTableSize(table);\n      var warehouse = getWarehouse$1(list);\n      var widths = tableSize.getWidths(warehouse, direction, tableSize);\n      var newSizes = Recalculations.recalculateWidth(warehouse, widths);\n      each(newSizes, function (cell) {\n        tableSize.setElementWidth(cell.element(), cell.width());\n      });\n      if (newSizes.length > 0) {\n        tableSize.setTableWidth(table, widths, tableSize.getCellDelta(0));\n      }\n    };\n    var Adjustments = {\n      adjustWidth: adjustWidth,\n      adjustHeight: adjustHeight,\n      adjustWidthTo: adjustWidthTo\n    };\n\n    var base = function (handleUnsupported, required) {\n      return baseWith(handleUnsupported, required, {\n        validate: isFunction,\n        label: 'function'\n      });\n    };\n    var baseWith = function (handleUnsupported, required, pred) {\n      if (required.length === 0) {\n        throw new Error('You must specify at least one required field.');\n      }\n      validateStrArr('required', required);\n      checkDupes(required);\n      return function (obj) {\n        var keys$1 = keys(obj);\n        var allReqd = forall(required, function (req) {\n          return contains(keys$1, req);\n        });\n        if (!allReqd) {\n          reqMessage(required, keys$1);\n        }\n        handleUnsupported(required, keys$1);\n        var invalidKeys = filter(required, function (key) {\n          return !pred.validate(obj[key], key);\n        });\n        if (invalidKeys.length > 0) {\n          invalidTypeMessage(invalidKeys, pred.label);\n        }\n        return obj;\n      };\n    };\n    var handleExact = function (required, keys) {\n      var unsupported = filter(keys, function (key) {\n        return !contains(required, key);\n      });\n      if (unsupported.length > 0) {\n        unsuppMessage(unsupported);\n      }\n    };\n    var exactly = function (required) {\n      return base(handleExact, required);\n    };\n\n    var verifyGenerators = exactly([\n      'cell',\n      'row',\n      'replace',\n      'gap'\n    ]);\n    var elementToData = function (element) {\n      var colspan = has$1(element, 'colspan') ? parseInt(get$1(element, 'colspan'), 10) : 1;\n      var rowspan = has$1(element, 'rowspan') ? parseInt(get$1(element, 'rowspan'), 10) : 1;\n      return {\n        element: constant(element),\n        colspan: constant(colspan),\n        rowspan: constant(rowspan)\n      };\n    };\n    var modification = function (generators, toData) {\n      if (toData === void 0) {\n        toData = elementToData;\n      }\n      verifyGenerators(generators);\n      var position = Cell(Option.none());\n      var nu = function (data) {\n        return generators.cell(data);\n      };\n      var nuFrom = function (element) {\n        var data = toData(element);\n        return nu(data);\n      };\n      var add = function (element) {\n        var replacement = nuFrom(element);\n        if (position.get().isNone()) {\n          position.set(Option.some(replacement));\n        }\n        recent = Option.some({\n          item: element,\n          replacement: replacement\n        });\n        return replacement;\n      };\n      var recent = Option.none();\n      var getOrInit = function (element, comparator) {\n        return recent.fold(function () {\n          return add(element);\n        }, function (p) {\n          return comparator(element, p.item) ? p.replacement : add(element);\n        });\n      };\n      return {\n        getOrInit: getOrInit,\n        cursor: position.get\n      };\n    };\n    var transform = function (scope, tag) {\n      return function (generators) {\n        var position = Cell(Option.none());\n        verifyGenerators(generators);\n        var list = [];\n        var find$1 = function (element, comparator) {\n          return find(list, function (x) {\n            return comparator(x.item, element);\n          });\n        };\n        var makeNew = function (element) {\n          var attrs = { scope: scope };\n          var cell = generators.replace(element, tag, attrs);\n          list.push({\n            item: element,\n            sub: cell\n          });\n          if (position.get().isNone()) {\n            position.set(Option.some(cell));\n          }\n          return cell;\n        };\n        var replaceOrInit = function (element, comparator) {\n          return find$1(element, comparator).fold(function () {\n            return makeNew(element);\n          }, function (p) {\n            return comparator(element, p.item) ? p.sub : makeNew(element);\n          });\n        };\n        return {\n          replaceOrInit: replaceOrInit,\n          cursor: position.get\n        };\n      };\n    };\n    var merging = function (generators) {\n      verifyGenerators(generators);\n      var position = Cell(Option.none());\n      var combine = function (cell) {\n        if (position.get().isNone()) {\n          position.set(Option.some(cell));\n        }\n        return function () {\n          var raw = generators.cell({\n            element: constant(cell),\n            colspan: constant(1),\n            rowspan: constant(1)\n          });\n          remove$1(raw, 'width');\n          remove$1(cell, 'width');\n          return raw;\n        };\n      };\n      return {\n        combine: combine,\n        cursor: position.get\n      };\n    };\n    var Generators = {\n      modification: modification,\n      transform: transform,\n      merging: merging\n    };\n\n    var blockList = [\n      'body',\n      'p',\n      'div',\n      'article',\n      'aside',\n      'figcaption',\n      'figure',\n      'footer',\n      'header',\n      'nav',\n      'section',\n      'ol',\n      'ul',\n      'table',\n      'thead',\n      'tfoot',\n      'tbody',\n      'caption',\n      'tr',\n      'td',\n      'th',\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6',\n      'blockquote',\n      'pre',\n      'address'\n    ];\n    var isList = function (universe, item) {\n      var tagName = universe.property().name(item);\n      return contains([\n        'ol',\n        'ul'\n      ], tagName);\n    };\n    var isBlock = function (universe, item) {\n      var tagName = universe.property().name(item);\n      return contains(blockList, tagName);\n    };\n    var isFormatting = function (universe, item) {\n      var tagName = universe.property().name(item);\n      return contains([\n        'address',\n        'pre',\n        'p',\n        'h1',\n        'h2',\n        'h3',\n        'h4',\n        'h5',\n        'h6'\n      ], tagName);\n    };\n    var isHeading = function (universe, item) {\n      var tagName = universe.property().name(item);\n      return contains([\n        'h1',\n        'h2',\n        'h3',\n        'h4',\n        'h5',\n        'h6'\n      ], tagName);\n    };\n    var isContainer = function (universe, item) {\n      return contains([\n        'div',\n        'li',\n        'td',\n        'th',\n        'blockquote',\n        'body',\n        'caption'\n      ], universe.property().name(item));\n    };\n    var isEmptyTag = function (universe, item) {\n      return contains([\n        'br',\n        'img',\n        'hr',\n        'input'\n      ], universe.property().name(item));\n    };\n    var isFrame = function (universe, item) {\n      return universe.property().name(item) === 'iframe';\n    };\n    var isInline = function (universe, item) {\n      return !(isBlock(universe, item) || isEmptyTag(universe, item)) && universe.property().name(item) !== 'li';\n    };\n    var Structure = {\n      isBlock: isBlock,\n      isList: isList,\n      isFormatting: isFormatting,\n      isHeading: isHeading,\n      isContainer: isContainer,\n      isEmptyTag: isEmptyTag,\n      isFrame: isFrame,\n      isInline: isInline\n    };\n\n    var universe$1 = DomUniverse();\n    var isBlock$1 = function (element) {\n      return Structure.isBlock(universe$1, element);\n    };\n    var isList$1 = function (element) {\n      return Structure.isList(universe$1, element);\n    };\n    var isFormatting$1 = function (element) {\n      return Structure.isFormatting(universe$1, element);\n    };\n    var isHeading$1 = function (element) {\n      return Structure.isHeading(universe$1, element);\n    };\n    var isContainer$1 = function (element) {\n      return Structure.isContainer(universe$1, element);\n    };\n    var isEmptyTag$1 = function (element) {\n      return Structure.isEmptyTag(universe$1, element);\n    };\n    var isFrame$1 = function (element) {\n      return Structure.isFrame(universe$1, element);\n    };\n    var isInline$1 = function (element) {\n      return Structure.isInline(universe$1, element);\n    };\n    var DomStructure = {\n      isBlock: isBlock$1,\n      isList: isList$1,\n      isFormatting: isFormatting$1,\n      isHeading: isHeading$1,\n      isContainer: isContainer$1,\n      isEmptyTag: isEmptyTag$1,\n      isFrame: isFrame$1,\n      isInline: isInline$1\n    };\n\n    var merge$2 = function (cells) {\n      var isBr = function (el) {\n        return name(el) === 'br';\n      };\n      var advancedBr = function (children) {\n        return forall(children, function (c) {\n          return isBr(c) || isText(c) && get$3(c).trim().length === 0;\n        });\n      };\n      var isListItem = function (el) {\n        return name(el) === 'li' || ancestor(el, DomStructure.isList).isSome();\n      };\n      var siblingIsBlock = function (el) {\n        return nextSibling(el).map(function (rightSibling) {\n          if (DomStructure.isBlock(rightSibling)) {\n            return true;\n          }\n          if (DomStructure.isEmptyTag(rightSibling)) {\n            return name(rightSibling) === 'img' ? false : true;\n          }\n          return false;\n        }).getOr(false);\n      };\n      var markCell = function (cell) {\n        return last$1(cell).bind(function (rightEdge) {\n          var rightSiblingIsBlock = siblingIsBlock(rightEdge);\n          return parent(rightEdge).map(function (parent) {\n            return rightSiblingIsBlock === true || isListItem(parent) || isBr(rightEdge) || DomStructure.isBlock(parent) && !eq(cell, parent) ? [] : [Element.fromTag('br')];\n          });\n        }).getOr([]);\n      };\n      var markContent = function () {\n        var content = bind(cells, function (cell) {\n          var children$1 = children(cell);\n          return advancedBr(children$1) ? [] : children$1.concat(markCell(cell));\n        });\n        return content.length === 0 ? [Element.fromTag('br')] : content;\n      };\n      var contents = markContent();\n      empty(cells[0]);\n      append$1(cells[0], contents);\n    };\n    var TableContent = { merge: merge$2 };\n\n    var prune = function (table) {\n      var cells = TableLookup.cells(table);\n      if (cells.length === 0) {\n        remove$2(table);\n      }\n    };\n    var outcome = Immutable('grid', 'cursor');\n    var elementFromGrid = function (grid, row, column) {\n      return findIn(grid, row, column).orThunk(function () {\n        return findIn(grid, 0, 0);\n      });\n    };\n    var findIn = function (grid, row, column) {\n      return Option.from(grid[row]).bind(function (r) {\n        return Option.from(r.cells()[column]).bind(function (c) {\n          return Option.from(c.element());\n        });\n      });\n    };\n    var bundle = function (grid, row, column) {\n      return outcome(grid, findIn(grid, row, column));\n    };\n    var uniqueRows = function (details) {\n      return foldl(details, function (rest, detail) {\n        return exists(rest, function (currentDetail) {\n          return currentDetail.row() === detail.row();\n        }) ? rest : rest.concat([detail]);\n      }, []).sort(function (detailA, detailB) {\n        return detailA.row() - detailB.row();\n      });\n    };\n    var uniqueColumns = function (details) {\n      return foldl(details, function (rest, detail) {\n        return exists(rest, function (currentDetail) {\n          return currentDetail.column() === detail.column();\n        }) ? rest : rest.concat([detail]);\n      }, []).sort(function (detailA, detailB) {\n        return detailA.column() - detailB.column();\n      });\n    };\n    var insertRowBefore = function (grid, detail, comparator, genWrappers) {\n      var example = detail.row();\n      var targetIndex = detail.row();\n      var newGrid = ModificationOperations.insertRowAt(grid, targetIndex, example, comparator, genWrappers.getOrInit);\n      return bundle(newGrid, targetIndex, detail.column());\n    };\n    var insertRowsBefore = function (grid, details, comparator, genWrappers) {\n      var example = details[0].row();\n      var targetIndex = details[0].row();\n      var rows = uniqueRows(details);\n      var newGrid = foldl(rows, function (newG, _row) {\n        return ModificationOperations.insertRowAt(newG, targetIndex, example, comparator, genWrappers.getOrInit);\n      }, grid);\n      return bundle(newGrid, targetIndex, details[0].column());\n    };\n    var insertRowAfter = function (grid, detail, comparator, genWrappers) {\n      var example = detail.row();\n      var targetIndex = detail.row() + detail.rowspan();\n      var newGrid = ModificationOperations.insertRowAt(grid, targetIndex, example, comparator, genWrappers.getOrInit);\n      return bundle(newGrid, targetIndex, detail.column());\n    };\n    var insertRowsAfter = function (grid, details, comparator, genWrappers) {\n      var rows = uniqueRows(details);\n      var example = rows[rows.length - 1].row();\n      var targetIndex = rows[rows.length - 1].row() + rows[rows.length - 1].rowspan();\n      var newGrid = foldl(rows, function (newG, _row) {\n        return ModificationOperations.insertRowAt(newG, targetIndex, example, comparator, genWrappers.getOrInit);\n      }, grid);\n      return bundle(newGrid, targetIndex, details[0].column());\n    };\n    var insertColumnBefore = function (grid, detail, comparator, genWrappers) {\n      var example = detail.column();\n      var targetIndex = detail.column();\n      var newGrid = ModificationOperations.insertColumnAt(grid, targetIndex, example, comparator, genWrappers.getOrInit);\n      return bundle(newGrid, detail.row(), targetIndex);\n    };\n    var insertColumnsBefore = function (grid, details, comparator, genWrappers) {\n      var columns = uniqueColumns(details);\n      var example = columns[0].column();\n      var targetIndex = columns[0].column();\n      var newGrid = foldl(columns, function (newG, _row) {\n        return ModificationOperations.insertColumnAt(newG, targetIndex, example, comparator, genWrappers.getOrInit);\n      }, grid);\n      return bundle(newGrid, details[0].row(), targetIndex);\n    };\n    var insertColumnAfter = function (grid, detail, comparator, genWrappers) {\n      var example = detail.column();\n      var targetIndex = detail.column() + detail.colspan();\n      var newGrid = ModificationOperations.insertColumnAt(grid, targetIndex, example, comparator, genWrappers.getOrInit);\n      return bundle(newGrid, detail.row(), targetIndex);\n    };\n    var insertColumnsAfter = function (grid, details, comparator, genWrappers) {\n      var example = details[details.length - 1].column();\n      var targetIndex = details[details.length - 1].column() + details[details.length - 1].colspan();\n      var columns = uniqueColumns(details);\n      var newGrid = foldl(columns, function (newG, _row) {\n        return ModificationOperations.insertColumnAt(newG, targetIndex, example, comparator, genWrappers.getOrInit);\n      }, grid);\n      return bundle(newGrid, details[0].row(), targetIndex);\n    };\n    var makeRowHeader = function (grid, detail, comparator, genWrappers) {\n      var newGrid = TransformOperations.replaceRow(grid, detail.row(), comparator, genWrappers.replaceOrInit);\n      return bundle(newGrid, detail.row(), detail.column());\n    };\n    var makeColumnHeader = function (grid, detail, comparator, genWrappers) {\n      var newGrid = TransformOperations.replaceColumn(grid, detail.column(), comparator, genWrappers.replaceOrInit);\n      return bundle(newGrid, detail.row(), detail.column());\n    };\n    var unmakeRowHeader = function (grid, detail, comparator, genWrappers) {\n      var newGrid = TransformOperations.replaceRow(grid, detail.row(), comparator, genWrappers.replaceOrInit);\n      return bundle(newGrid, detail.row(), detail.column());\n    };\n    var unmakeColumnHeader = function (grid, detail, comparator, genWrappers) {\n      var newGrid = TransformOperations.replaceColumn(grid, detail.column(), comparator, genWrappers.replaceOrInit);\n      return bundle(newGrid, detail.row(), detail.column());\n    };\n    var splitCellIntoColumns$1 = function (grid, detail, comparator, genWrappers) {\n      var newGrid = ModificationOperations.splitCellIntoColumns(grid, detail.row(), detail.column(), comparator, genWrappers.getOrInit);\n      return bundle(newGrid, detail.row(), detail.column());\n    };\n    var splitCellIntoRows$1 = function (grid, detail, comparator, genWrappers) {\n      var newGrid = ModificationOperations.splitCellIntoRows(grid, detail.row(), detail.column(), comparator, genWrappers.getOrInit);\n      return bundle(newGrid, detail.row(), detail.column());\n    };\n    var eraseColumns = function (grid, details, _comparator, _genWrappers) {\n      var columns = uniqueColumns(details);\n      var newGrid = ModificationOperations.deleteColumnsAt(grid, columns[0].column(), columns[columns.length - 1].column());\n      var cursor = elementFromGrid(newGrid, details[0].row(), details[0].column());\n      return outcome(newGrid, cursor);\n    };\n    var eraseRows = function (grid, details, _comparator, _genWrappers) {\n      var rows = uniqueRows(details);\n      var newGrid = ModificationOperations.deleteRowsAt(grid, rows[0].row(), rows[rows.length - 1].row());\n      var cursor = elementFromGrid(newGrid, details[0].row(), details[0].column());\n      return outcome(newGrid, cursor);\n    };\n    var mergeCells = function (grid, mergable, comparator, _genWrappers) {\n      var cells = mergable.cells();\n      TableContent.merge(cells);\n      var newGrid = MergingOperations.merge(grid, mergable.bounds(), comparator, constant(cells[0]));\n      return outcome(newGrid, Option.from(cells[0]));\n    };\n    var unmergeCells = function (grid, unmergable, comparator, genWrappers) {\n      var newGrid = foldr(unmergable, function (b, cell) {\n        return MergingOperations.unmerge(b, cell, comparator, genWrappers.combine(cell));\n      }, grid);\n      return outcome(newGrid, Option.from(unmergable[0]));\n    };\n    var pasteCells = function (grid, pasteDetails, comparator, _genWrappers) {\n      var gridify = function (table, generators) {\n        var list = DetailsList.fromTable(table);\n        var wh = Warehouse.generate(list);\n        return Transitions.toGrid(wh, generators, true);\n      };\n      var gridB = gridify(pasteDetails.clipboard(), pasteDetails.generators());\n      var startAddress = address(pasteDetails.row(), pasteDetails.column());\n      var mergedGrid = TableMerge.merge(startAddress, grid, gridB, pasteDetails.generators(), comparator);\n      return mergedGrid.fold(function () {\n        return outcome(grid, Option.some(pasteDetails.element()));\n      }, function (nuGrid) {\n        var cursor = elementFromGrid(nuGrid, pasteDetails.row(), pasteDetails.column());\n        return outcome(nuGrid, cursor);\n      });\n    };\n    var gridifyRows = function (rows, generators, example) {\n      var pasteDetails = DetailsList.fromPastedRows(rows, example);\n      var wh = Warehouse.generate(pasteDetails);\n      return Transitions.toGrid(wh, generators, true);\n    };\n    var pasteRowsBefore = function (grid, pasteDetails, comparator, _genWrappers) {\n      var example = grid[pasteDetails.cells[0].row()];\n      var index = pasteDetails.cells[0].row();\n      var gridB = gridifyRows(pasteDetails.clipboard(), pasteDetails.generators(), example);\n      var mergedGrid = TableMerge.insert(index, grid, gridB, pasteDetails.generators(), comparator);\n      var cursor = elementFromGrid(mergedGrid, pasteDetails.cells[0].row(), pasteDetails.cells[0].column());\n      return outcome(mergedGrid, cursor);\n    };\n    var pasteRowsAfter = function (grid, pasteDetails, comparator, _genWrappers) {\n      var example = grid[pasteDetails.cells[0].row()];\n      var index = pasteDetails.cells[pasteDetails.cells.length - 1].row() + pasteDetails.cells[pasteDetails.cells.length - 1].rowspan();\n      var gridB = gridifyRows(pasteDetails.clipboard(), pasteDetails.generators(), example);\n      var mergedGrid = TableMerge.insert(index, grid, gridB, pasteDetails.generators(), comparator);\n      var cursor = elementFromGrid(mergedGrid, pasteDetails.cells[0].row(), pasteDetails.cells[0].column());\n      return outcome(mergedGrid, cursor);\n    };\n    var resize = Adjustments.adjustWidthTo;\n    var TableOperations = {\n      insertRowBefore: run(insertRowBefore, onCell, noop, noop, Generators.modification),\n      insertRowsBefore: run(insertRowsBefore, onCells, noop, noop, Generators.modification),\n      insertRowAfter: run(insertRowAfter, onCell, noop, noop, Generators.modification),\n      insertRowsAfter: run(insertRowsAfter, onCells, noop, noop, Generators.modification),\n      insertColumnBefore: run(insertColumnBefore, onCell, resize, noop, Generators.modification),\n      insertColumnsBefore: run(insertColumnsBefore, onCells, resize, noop, Generators.modification),\n      insertColumnAfter: run(insertColumnAfter, onCell, resize, noop, Generators.modification),\n      insertColumnsAfter: run(insertColumnsAfter, onCells, resize, noop, Generators.modification),\n      splitCellIntoColumns: run(splitCellIntoColumns$1, onCell, resize, noop, Generators.modification),\n      splitCellIntoRows: run(splitCellIntoRows$1, onCell, noop, noop, Generators.modification),\n      eraseColumns: run(eraseColumns, onCells, resize, prune, Generators.modification),\n      eraseRows: run(eraseRows, onCells, noop, prune, Generators.modification),\n      makeColumnHeader: run(makeColumnHeader, onCell, noop, noop, Generators.transform('row', 'th')),\n      unmakeColumnHeader: run(unmakeColumnHeader, onCell, noop, noop, Generators.transform(null, 'td')),\n      makeRowHeader: run(makeRowHeader, onCell, noop, noop, Generators.transform('col', 'th')),\n      unmakeRowHeader: run(unmakeRowHeader, onCell, noop, noop, Generators.transform(null, 'td')),\n      mergeCells: run(mergeCells, onMergable, noop, noop, Generators.merging),\n      unmergeCells: run(unmergeCells, onUnmergable, resize, noop, Generators.merging),\n      pasteCells: run(pasteCells, onPaste, resize, noop, Generators.modification),\n      pasteRowsBefore: run(pasteRowsBefore, onPasteRows, noop, noop, Generators.modification),\n      pasteRowsAfter: run(pasteRowsAfter, onPasteRows, noop, noop, Generators.modification)\n    };\n\n    var getBody$1 = function (editor) {\n      return Element.fromDom(editor.getBody());\n    };\n    var getPixelWidth$1 = function (elm) {\n      return elm.getBoundingClientRect().width;\n    };\n    var getPixelHeight = function (elm) {\n      return elm.getBoundingClientRect().height;\n    };\n    var getIsRoot = function (editor) {\n      return function (element) {\n        return eq(element, getBody$1(editor));\n      };\n    };\n    var removePxSuffix = function (size) {\n      return size ? size.replace(/px$/, '') : '';\n    };\n    var addSizeSuffix = function (size) {\n      if (/^[0-9]+$/.test(size)) {\n        size += 'px';\n      }\n      return size;\n    };\n    var removeDataStyle = function (table) {\n      var dataStyleCells = descendants$1(table, 'td[data-mce-style],th[data-mce-style]');\n      remove(table, 'data-mce-style');\n      each(dataStyleCells, function (cell) {\n        remove(cell, 'data-mce-style');\n      });\n    };\n\n    var getDirection = function (element) {\n      return get$2(element, 'direction') === 'rtl' ? 'rtl' : 'ltr';\n    };\n\n    var ltr$1 = { isRtl: constant(false) };\n    var rtl$1 = { isRtl: constant(true) };\n    var directionAt = function (element) {\n      var dir = getDirection(element);\n      return dir === 'rtl' ? rtl$1 : ltr$1;\n    };\n    var Direction = { directionAt: directionAt };\n\n    var defaultTableToolbar = 'tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol';\n    var defaultStyles = {\n      'border-collapse': 'collapse',\n      'width': '100%'\n    };\n    var defaultAttributes = { border: '1' };\n    var getDefaultAttributes = function (editor) {\n      return editor.getParam('table_default_attributes', defaultAttributes, 'object');\n    };\n    var getDefaultStyles = function (editor) {\n      return editor.getParam('table_default_styles', defaultStyles, 'object');\n    };\n    var hasTableResizeBars = function (editor) {\n      return editor.getParam('table_resize_bars', true, 'boolean');\n    };\n    var hasTabNavigation = function (editor) {\n      return editor.getParam('table_tab_navigation', true, 'boolean');\n    };\n    var hasAdvancedCellTab = function (editor) {\n      return editor.getParam('table_cell_advtab', true, 'boolean');\n    };\n    var hasAdvancedRowTab = function (editor) {\n      return editor.getParam('table_row_advtab', true, 'boolean');\n    };\n    var hasAdvancedTableTab = function (editor) {\n      return editor.getParam('table_advtab', true, 'boolean');\n    };\n    var hasAppearanceOptions = function (editor) {\n      return editor.getParam('table_appearance_options', true, 'boolean');\n    };\n    var hasTableGrid = function (editor) {\n      return editor.getParam('table_grid', true, 'boolean');\n    };\n    var shouldStyleWithCss = function (editor) {\n      return editor.getParam('table_style_by_css', false, 'boolean');\n    };\n    var getCellClassList = function (editor) {\n      return editor.getParam('table_cell_class_list', [], 'array');\n    };\n    var getRowClassList = function (editor) {\n      return editor.getParam('table_row_class_list', [], 'array');\n    };\n    var getTableClassList = function (editor) {\n      return editor.getParam('table_class_list', [], 'array');\n    };\n    var isPercentagesForced = function (editor) {\n      return editor.getParam('table_responsive_width') === true;\n    };\n    var isPixelsForced = function (editor) {\n      return editor.getParam('table_responsive_width') === false;\n    };\n    var getToolbar = function (editor) {\n      return editor.getParam('table_toolbar', defaultTableToolbar);\n    };\n    var getCloneElements = function (editor) {\n      var cloneElements = editor.getParam('table_clone_elements');\n      if (isString(cloneElements)) {\n        return Option.some(cloneElements.split(/[ ,]/));\n      } else if (Array.isArray(cloneElements)) {\n        return Option.some(cloneElements);\n      } else {\n        return Option.none();\n      }\n    };\n    var hasObjectResizing = function (editor) {\n      var objectResizing = editor.getParam('object_resizing', true);\n      return isString(objectResizing) ? objectResizing === 'table' : objectResizing;\n    };\n\n    var fireNewRow = function (editor, row) {\n      return editor.fire('newrow', { node: row });\n    };\n    var fireNewCell = function (editor, cell) {\n      return editor.fire('newcell', { node: cell });\n    };\n    var fireObjectResizeStart = function (editor, target, width, height) {\n      editor.fire('ObjectResizeStart', {\n        target: target,\n        width: width,\n        height: height\n      });\n    };\n    var fireObjectResized = function (editor, target, width, height) {\n      editor.fire('ObjectResized', {\n        target: target,\n        width: width,\n        height: height\n      });\n    };\n    var fireTableSelectionChange = function (editor, cells, start, finish, otherCells) {\n      editor.fire('tableselectionchange', {\n        cells: cells,\n        start: start,\n        finish: finish,\n        otherCells: otherCells\n      });\n    };\n    var fireTableSelectionClear = function (editor) {\n      editor.fire('tableselectionclear');\n    };\n\n    var TableActions = function (editor, lazyWire) {\n      var isTableBody = function (editor) {\n        return name(getBody$1(editor)) === 'table';\n      };\n      var lastRowGuard = function (table) {\n        var size = TableGridSize.getGridSize(table);\n        return isTableBody(editor) === false || size.rows() > 1;\n      };\n      var lastColumnGuard = function (table) {\n        var size = TableGridSize.getGridSize(table);\n        return isTableBody(editor) === false || size.columns() > 1;\n      };\n      var cloneFormats = getCloneElements(editor);\n      var execute = function (operation, guard, mutate, lazyWire) {\n        return function (table, target) {\n          removeDataStyle(table);\n          var wire = lazyWire();\n          var doc = Element.fromDom(editor.getDoc());\n          var direction = TableDirection(Direction.directionAt);\n          var generators = TableFill.cellOperations(mutate, doc, cloneFormats);\n          return guard(table) ? operation(wire, table, target, generators, direction).bind(function (result) {\n            each(result.newRows(), function (row) {\n              fireNewRow(editor, row.dom());\n            });\n            each(result.newCells(), function (cell) {\n              fireNewCell(editor, cell.dom());\n            });\n            return result.cursor().map(function (cell) {\n              var rng = editor.dom.createRng();\n              rng.setStart(cell.dom(), 0);\n              rng.setEnd(cell.dom(), 0);\n              return rng;\n            });\n          }) : Option.none();\n        };\n      };\n      var deleteRow = execute(TableOperations.eraseRows, lastRowGuard, noop, lazyWire);\n      var deleteColumn = execute(TableOperations.eraseColumns, lastColumnGuard, noop, lazyWire);\n      var insertRowsBefore = execute(TableOperations.insertRowsBefore, always, noop, lazyWire);\n      var insertRowsAfter = execute(TableOperations.insertRowsAfter, always, noop, lazyWire);\n      var insertColumnsBefore = execute(TableOperations.insertColumnsBefore, always, CellMutations.halve, lazyWire);\n      var insertColumnsAfter = execute(TableOperations.insertColumnsAfter, always, CellMutations.halve, lazyWire);\n      var mergeCells = execute(TableOperations.mergeCells, always, noop, lazyWire);\n      var unmergeCells = execute(TableOperations.unmergeCells, always, noop, lazyWire);\n      var pasteRowsBefore = execute(TableOperations.pasteRowsBefore, always, noop, lazyWire);\n      var pasteRowsAfter = execute(TableOperations.pasteRowsAfter, always, noop, lazyWire);\n      var pasteCells = execute(TableOperations.pasteCells, always, noop, lazyWire);\n      return {\n        deleteRow: deleteRow,\n        deleteColumn: deleteColumn,\n        insertRowsBefore: insertRowsBefore,\n        insertRowsAfter: insertRowsAfter,\n        insertColumnsBefore: insertColumnsBefore,\n        insertColumnsAfter: insertColumnsAfter,\n        mergeCells: mergeCells,\n        unmergeCells: unmergeCells,\n        pasteRowsBefore: pasteRowsBefore,\n        pasteRowsAfter: pasteRowsAfter,\n        pasteCells: pasteCells\n      };\n    };\n\n    var copyRows = function (table, target, generators) {\n      var list = DetailsList.fromTable(table);\n      var house = Warehouse.generate(list);\n      var details = onCells(house, target);\n      return details.map(function (selectedCells) {\n        var grid = Transitions.toGrid(house, generators, false);\n        var slicedGrid = grid.slice(selectedCells[0].row(), selectedCells[selectedCells.length - 1].row() + selectedCells[selectedCells.length - 1].rowspan());\n        var slicedDetails = toDetailList(slicedGrid, generators);\n        return Redraw.copy(slicedDetails);\n      });\n    };\n    var CopyRows = { copyRows: copyRows };\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var getTDTHOverallStyle = function (dom, elm, name) {\n      var cells = dom.select('td,th', elm);\n      var firstChildStyle;\n      var checkChildren = function (firstChildStyle, elms) {\n        for (var i = 0; i < elms.length; i++) {\n          var currentStyle = dom.getStyle(elms[i], name);\n          if (typeof firstChildStyle === 'undefined') {\n            firstChildStyle = currentStyle;\n          }\n          if (firstChildStyle !== currentStyle) {\n            return '';\n          }\n        }\n        return firstChildStyle;\n      };\n      firstChildStyle = checkChildren(firstChildStyle, cells);\n      return firstChildStyle;\n    };\n    var applyAlign = function (editor, elm, name) {\n      if (name) {\n        editor.formatter.apply('align' + name, {}, elm);\n      }\n    };\n    var applyVAlign = function (editor, elm, name) {\n      if (name) {\n        editor.formatter.apply('valign' + name, {}, elm);\n      }\n    };\n    var unApplyAlign = function (editor, elm) {\n      global$1.each('left center right'.split(' '), function (name) {\n        editor.formatter.remove('align' + name, {}, elm);\n      });\n    };\n    var unApplyVAlign = function (editor, elm) {\n      global$1.each('top middle bottom'.split(' '), function (name) {\n        editor.formatter.remove('valign' + name, {}, elm);\n      });\n    };\n    var Styles$1 = {\n      applyAlign: applyAlign,\n      applyVAlign: applyVAlign,\n      unApplyAlign: unApplyAlign,\n      unApplyVAlign: unApplyVAlign,\n      getTDTHOverallStyle: getTDTHOverallStyle\n    };\n\n    var buildListItems = function (inputList, itemCallback, startItems) {\n      var appendItems = function (values, output) {\n        output = output || [];\n        global$1.each(values, function (item) {\n          var menuItem = { text: item.text || item.title };\n          if (item.menu) {\n            menuItem.menu = appendItems(item.menu);\n          } else {\n            menuItem.value = item.value;\n            if (itemCallback) {\n              itemCallback(menuItem);\n            }\n          }\n          output.push(menuItem);\n        });\n        return output;\n      };\n      return appendItems(inputList, startItems || []);\n    };\n    var extractAdvancedStyles = function (dom, elm) {\n      var rgbToHex = function (value) {\n        return startsWith(value, 'rgb') ? dom.toHex(value) : value;\n      };\n      var borderWidth = getRaw(Element.fromDom(elm), 'border-width').getOr('');\n      var borderStyle = getRaw(Element.fromDom(elm), 'border-style').getOr('');\n      var borderColor = getRaw(Element.fromDom(elm), 'border-color').map(rgbToHex).getOr('');\n      var bgColor = getRaw(Element.fromDom(elm), 'background-color').map(rgbToHex).getOr('');\n      return {\n        borderwidth: borderWidth,\n        borderstyle: borderStyle,\n        bordercolor: borderColor,\n        backgroundcolor: bgColor\n      };\n    };\n    var getSharedValues = function (data) {\n      var baseData = data[0];\n      var comparisonData = data.slice(1);\n      var keys$1 = keys(baseData);\n      each(comparisonData, function (items) {\n        each(keys$1, function (key) {\n          each$1(items, function (itemValue, itemKey) {\n            var comparisonValue = baseData[key];\n            if (comparisonValue !== '' && key === itemKey) {\n              if (comparisonValue !== itemValue) {\n                baseData[key] = '';\n              }\n            }\n          });\n        });\n      });\n      return baseData;\n    };\n    var getAdvancedTab = function (dialogName) {\n      var advTabItems = [\n        {\n          name: 'borderstyle',\n          type: 'selectbox',\n          label: 'Border style',\n          items: [\n            {\n              text: 'Select...',\n              value: ''\n            },\n            {\n              text: 'Solid',\n              value: 'solid'\n            },\n            {\n              text: 'Dotted',\n              value: 'dotted'\n            },\n            {\n              text: 'Dashed',\n              value: 'dashed'\n            },\n            {\n              text: 'Double',\n              value: 'double'\n            },\n            {\n              text: 'Groove',\n              value: 'groove'\n            },\n            {\n              text: 'Ridge',\n              value: 'ridge'\n            },\n            {\n              text: 'Inset',\n              value: 'inset'\n            },\n            {\n              text: 'Outset',\n              value: 'outset'\n            },\n            {\n              text: 'None',\n              value: 'none'\n            },\n            {\n              text: 'Hidden',\n              value: 'hidden'\n            }\n          ]\n        },\n        {\n          name: 'bordercolor',\n          type: 'colorinput',\n          label: 'Border color'\n        },\n        {\n          name: 'backgroundcolor',\n          type: 'colorinput',\n          label: 'Background color'\n        }\n      ];\n      var borderWidth = {\n        name: 'borderwidth',\n        type: 'input',\n        label: 'Border width'\n      };\n      var items = dialogName === 'cell' ? [borderWidth].concat(advTabItems) : advTabItems;\n      return {\n        title: 'Advanced',\n        name: 'advanced',\n        items: items\n      };\n    };\n    var getAlignment = function (alignments, formatName, dataName, editor, elm) {\n      var alignmentData = {};\n      global$1.each(alignments.split(' '), function (name) {\n        if (editor.formatter.matchNode(elm, formatName + name)) {\n          alignmentData[dataName] = name;\n        }\n      });\n      if (!alignmentData[dataName]) {\n        alignmentData[dataName] = '';\n      }\n      return alignmentData;\n    };\n    var getHAlignment = curry(getAlignment, 'left center right');\n    var getVAlignment = curry(getAlignment, 'top middle bottom');\n    var extractDataFromSettings = function (editor, hasAdvTableTab) {\n      var style = getDefaultStyles(editor);\n      var attrs = getDefaultAttributes(editor);\n      var extractAdvancedStyleData = function (dom) {\n        var rgbToHex = function (value) {\n          return startsWith(value, 'rgb') ? dom.toHex(value) : value;\n        };\n        var borderStyle = get(style, 'border-style').getOr('');\n        var borderColor = get(style, 'border-color').getOr('');\n        var bgColor = get(style, 'background-color').getOr('');\n        return {\n          borderstyle: borderStyle,\n          bordercolor: rgbToHex(borderColor),\n          backgroundcolor: rgbToHex(bgColor)\n        };\n      };\n      var defaultData = {\n        height: '',\n        width: '100%',\n        cellspacing: '',\n        cellpadding: '',\n        caption: false,\n        class: '',\n        align: '',\n        border: ''\n      };\n      var getBorder = function () {\n        var borderWidth = style['border-width'];\n        if (shouldStyleWithCss(editor) && borderWidth) {\n          return { border: borderWidth };\n        }\n        return get(attrs, 'border').fold(function () {\n          return {};\n        }, function (border) {\n          return { border: border };\n        });\n      };\n      var dom = editor.dom;\n      var advStyle = hasAdvTableTab ? extractAdvancedStyleData(dom) : {};\n      var getCellPaddingCellSpacing = function () {\n        var spacing = get(style, 'border-spacing').or(get(attrs, 'cellspacing')).fold(function () {\n          return {};\n        }, function (cellspacing) {\n          return { cellspacing: cellspacing };\n        });\n        var padding = get(style, 'border-padding').or(get(attrs, 'cellpadding')).fold(function () {\n          return {};\n        }, function (cellpadding) {\n          return { cellpadding: cellpadding };\n        });\n        return __assign(__assign({}, spacing), padding);\n      };\n      var data = __assign(__assign(__assign(__assign(__assign(__assign({}, defaultData), style), attrs), advStyle), getBorder()), getCellPaddingCellSpacing());\n      return data;\n    };\n    var extractDataFromTableElement = function (editor, elm, hasAdvTableTab) {\n      var getBorder = function (dom, elm) {\n        var optBorderWidth = getRaw(Element.fromDom(elm), 'border-width');\n        if (shouldStyleWithCss(editor) && optBorderWidth.isSome()) {\n          return optBorderWidth.getOr('');\n        }\n        return dom.getAttrib(elm, 'border') || Styles$1.getTDTHOverallStyle(editor.dom, elm, 'border-width') || Styles$1.getTDTHOverallStyle(editor.dom, elm, 'border');\n      };\n      var dom = editor.dom;\n      var data = __assign(__assign({\n        width: dom.getStyle(elm, 'width') || dom.getAttrib(elm, 'width'),\n        height: dom.getStyle(elm, 'height') || dom.getAttrib(elm, 'height'),\n        cellspacing: dom.getStyle(elm, 'border-spacing') || dom.getAttrib(elm, 'cellspacing'),\n        cellpadding: dom.getAttrib(elm, 'cellpadding') || Styles$1.getTDTHOverallStyle(editor.dom, elm, 'padding'),\n        border: getBorder(dom, elm),\n        caption: !!dom.select('caption', elm)[0],\n        class: dom.getAttrib(elm, 'class', '')\n      }, getHAlignment('align', 'align', editor, elm)), hasAdvTableTab ? extractAdvancedStyles(dom, elm) : {});\n      return data;\n    };\n    var extractDataFromRowElement = function (editor, elm, hasAdvancedRowTab) {\n      var dom = editor.dom;\n      var data = __assign(__assign({\n        height: dom.getStyle(elm, 'height') || dom.getAttrib(elm, 'height'),\n        scope: dom.getAttrib(elm, 'scope'),\n        class: dom.getAttrib(elm, 'class', ''),\n        align: '',\n        type: elm.parentNode.nodeName.toLowerCase()\n      }, getHAlignment('align', 'align', editor, elm)), hasAdvancedRowTab ? extractAdvancedStyles(dom, elm) : {});\n      return data;\n    };\n    var extractDataFromCellElement = function (editor, elm, hasAdvancedCellTab) {\n      var dom = editor.dom;\n      var data = __assign(__assign(__assign({\n        width: dom.getStyle(elm, 'width') || dom.getAttrib(elm, 'width'),\n        height: dom.getStyle(elm, 'height') || dom.getAttrib(elm, 'height'),\n        scope: dom.getAttrib(elm, 'scope'),\n        celltype: elm.nodeName.toLowerCase(),\n        class: dom.getAttrib(elm, 'class', '')\n      }, getHAlignment('align', 'halign', editor, elm)), getVAlignment('valign', 'valign', editor, elm)), hasAdvancedCellTab ? extractAdvancedStyles(dom, elm) : {});\n      return data;\n    };\n    var Helpers = {\n      buildListItems: buildListItems,\n      extractAdvancedStyles: extractAdvancedStyles,\n      getSharedValues: getSharedValues,\n      getAdvancedTab: getAdvancedTab,\n      extractDataFromTableElement: extractDataFromTableElement,\n      extractDataFromRowElement: extractDataFromRowElement,\n      extractDataFromCellElement: extractDataFromCellElement,\n      extractDataFromSettings: extractDataFromSettings\n    };\n\n    var getClassList = function (editor) {\n      var rowClassList = getCellClassList(editor);\n      var classes = Helpers.buildListItems(rowClassList, function (item) {\n        if (item.value) {\n          item.textStyle = function () {\n            return editor.formatter.getCssText({\n              block: 'tr',\n              classes: [item.value]\n            });\n          };\n        }\n      });\n      if (rowClassList.length > 0) {\n        return Option.some({\n          name: 'class',\n          type: 'selectbox',\n          label: 'Class',\n          items: classes\n        });\n      }\n      return Option.none();\n    };\n    var children$3 = [\n      {\n        name: 'width',\n        type: 'input',\n        label: 'Width'\n      },\n      {\n        name: 'height',\n        type: 'input',\n        label: 'Height'\n      },\n      {\n        name: 'celltype',\n        type: 'selectbox',\n        label: 'Cell type',\n        items: [\n          {\n            text: 'Cell',\n            value: 'td'\n          },\n          {\n            text: 'Header cell',\n            value: 'th'\n          }\n        ]\n      },\n      {\n        name: 'scope',\n        type: 'selectbox',\n        label: 'Scope',\n        items: [\n          {\n            text: 'None',\n            value: ''\n          },\n          {\n            text: 'Row',\n            value: 'row'\n          },\n          {\n            text: 'Column',\n            value: 'col'\n          },\n          {\n            text: 'Row group',\n            value: 'rowgroup'\n          },\n          {\n            text: 'Column group',\n            value: 'colgroup'\n          }\n        ]\n      },\n      {\n        name: 'halign',\n        type: 'selectbox',\n        label: 'H Align',\n        items: [\n          {\n            text: 'None',\n            value: ''\n          },\n          {\n            text: 'Left',\n            value: 'left'\n          },\n          {\n            text: 'Center',\n            value: 'center'\n          },\n          {\n            text: 'Right',\n            value: 'right'\n          }\n        ]\n      },\n      {\n        name: 'valign',\n        type: 'selectbox',\n        label: 'V Align',\n        items: [\n          {\n            text: 'None',\n            value: ''\n          },\n          {\n            text: 'Top',\n            value: 'top'\n          },\n          {\n            text: 'Middle',\n            value: 'middle'\n          },\n          {\n            text: 'Bottom',\n            value: 'bottom'\n          }\n        ]\n      }\n    ];\n    var getItems = function (editor) {\n      return getClassList(editor).fold(function () {\n        return children$3;\n      }, function (classlist) {\n        return children$3.concat(classlist);\n      });\n    };\n    var CellDialogGeneralTab = { getItems: getItems };\n\n    var normal = function (dom, node) {\n      var setAttrib = function (attr, value) {\n        dom.setAttrib(node, attr, value);\n      };\n      var setStyle = function (prop, value) {\n        dom.setStyle(node, prop, value);\n      };\n      return {\n        setAttrib: setAttrib,\n        setStyle: setStyle\n      };\n    };\n    var ifTruthy = function (dom, node) {\n      var setAttrib = function (attr, value) {\n        if (value) {\n          dom.setAttrib(node, attr, value);\n        }\n      };\n      var setStyle = function (prop, value) {\n        if (value) {\n          dom.setStyle(node, prop, value);\n        }\n      };\n      return {\n        setAttrib: setAttrib,\n        setStyle: setStyle\n      };\n    };\n    var DomModifier = {\n      normal: normal,\n      ifTruthy: ifTruthy\n    };\n\n    var updateSimpleProps = function (modifiers, data) {\n      modifiers.setAttrib('scope', data.scope);\n      modifiers.setAttrib('class', data.class);\n      modifiers.setStyle('width', addSizeSuffix(data.width));\n      modifiers.setStyle('height', addSizeSuffix(data.height));\n    };\n    var updateAdvancedProps = function (modifiers, data) {\n      modifiers.setStyle('background-color', data.backgroundcolor);\n      modifiers.setStyle('border-color', data.bordercolor);\n      modifiers.setStyle('border-style', data.borderstyle);\n      modifiers.setStyle('border-width', addSizeSuffix(data.borderwidth));\n    };\n    var applyToSingle = function (editor, cells, data) {\n      var dom = editor.dom;\n      var cellElm = data.celltype && cells[0].nodeName.toLowerCase() !== data.celltype ? dom.rename(cells[0], data.celltype) : cells[0];\n      var modifiers = DomModifier.normal(dom, cellElm);\n      updateSimpleProps(modifiers, data);\n      if (hasAdvancedCellTab(editor)) {\n        updateAdvancedProps(modifiers, data);\n      }\n      Styles$1.unApplyAlign(editor, cellElm);\n      Styles$1.unApplyVAlign(editor, cellElm);\n      if (data.halign) {\n        Styles$1.applyAlign(editor, cellElm, data.halign);\n      }\n      if (data.valign) {\n        Styles$1.applyVAlign(editor, cellElm, data.valign);\n      }\n    };\n    var applyToMultiple = function (editor, cells, data) {\n      var dom = editor.dom;\n      global$1.each(cells, function (cellElm) {\n        if (data.celltype && cellElm.nodeName.toLowerCase() !== data.celltype) {\n          cellElm = dom.rename(cellElm, data.celltype);\n        }\n        var modifiers = DomModifier.ifTruthy(dom, cellElm);\n        updateSimpleProps(modifiers, data);\n        if (hasAdvancedCellTab(editor)) {\n          updateAdvancedProps(modifiers, data);\n        }\n        if (data.halign) {\n          Styles$1.applyAlign(editor, cellElm, data.halign);\n        }\n        if (data.valign) {\n          Styles$1.applyVAlign(editor, cellElm, data.valign);\n        }\n      });\n    };\n    var onSubmitCellForm = function (editor, cells, api) {\n      var data = api.getData();\n      api.close();\n      editor.undoManager.transact(function () {\n        var applicator = cells.length === 1 ? applyToSingle : applyToMultiple;\n        applicator(editor, cells, data);\n        editor.focus();\n      });\n    };\n    var open = function (editor) {\n      var cellElm, cells = [];\n      cells = editor.dom.select('td[data-mce-selected],th[data-mce-selected]');\n      cellElm = editor.dom.getParent(editor.selection.getStart(), 'td,th');\n      if (!cells.length && cellElm) {\n        cells.push(cellElm);\n      }\n      cellElm = cellElm || cells[0];\n      if (!cellElm) {\n        return;\n      }\n      var cellsData = global$1.map(cells, function (cellElm) {\n        return Helpers.extractDataFromCellElement(editor, cellElm, hasAdvancedCellTab(editor));\n      });\n      var data = Helpers.getSharedValues(cellsData);\n      var dialogTabPanel = {\n        type: 'tabpanel',\n        tabs: [\n          {\n            title: 'General',\n            name: 'general',\n            items: CellDialogGeneralTab.getItems(editor)\n          },\n          Helpers.getAdvancedTab('cell')\n        ]\n      };\n      var dialogPanel = {\n        type: 'panel',\n        items: [{\n            type: 'grid',\n            columns: 2,\n            items: CellDialogGeneralTab.getItems(editor)\n          }]\n      };\n      editor.windowManager.open({\n        title: 'Cell Properties',\n        size: 'normal',\n        body: hasAdvancedCellTab(editor) ? dialogTabPanel : dialogPanel,\n        buttons: [\n          {\n            type: 'cancel',\n            name: 'cancel',\n            text: 'Cancel'\n          },\n          {\n            type: 'submit',\n            name: 'save',\n            text: 'Save',\n            primary: true\n          }\n        ],\n        initialData: data,\n        onSubmit: curry(onSubmitCellForm, editor, cells)\n      });\n    };\n    var CellDialog = { open: open };\n\n    var getClassList$1 = function (editor) {\n      var rowClassList = getRowClassList(editor);\n      var classes = Helpers.buildListItems(rowClassList, function (item) {\n        if (item.value) {\n          item.textStyle = function () {\n            return editor.formatter.getCssText({\n              block: 'tr',\n              classes: [item.value]\n            });\n          };\n        }\n      });\n      if (rowClassList.length > 0) {\n        return Option.some({\n          name: 'class',\n          type: 'selectbox',\n          label: 'Class',\n          items: classes\n        });\n      }\n      return Option.none();\n    };\n    var formChildren = [\n      {\n        type: 'selectbox',\n        name: 'type',\n        label: 'Row type',\n        items: [\n          {\n            text: 'Header',\n            value: 'thead'\n          },\n          {\n            text: 'Body',\n            value: 'tbody'\n          },\n          {\n            text: 'Footer',\n            value: 'tfoot'\n          }\n        ]\n      },\n      {\n        type: 'selectbox',\n        name: 'align',\n        label: 'Alignment',\n        items: [\n          {\n            text: 'None',\n            value: ''\n          },\n          {\n            text: 'Left',\n            value: 'left'\n          },\n          {\n            text: 'Center',\n            value: 'center'\n          },\n          {\n            text: 'Right',\n            value: 'right'\n          }\n        ]\n      },\n      {\n        label: 'Height',\n        name: 'height',\n        type: 'input'\n      }\n    ];\n    var getItems$1 = function (editor) {\n      return getClassList$1(editor).fold(function () {\n        return formChildren;\n      }, function (classes) {\n        return formChildren.concat(classes);\n      });\n    };\n    var RowDialogGeneralTab = { getItems: getItems$1 };\n\n    var switchRowType = function (dom, rowElm, toType) {\n      var tableElm = dom.getParent(rowElm, 'table');\n      var oldParentElm = rowElm.parentNode;\n      var parentElm = dom.select(toType, tableElm)[0];\n      if (!parentElm) {\n        parentElm = dom.create(toType);\n        if (tableElm.firstChild) {\n          if (tableElm.firstChild.nodeName === 'CAPTION') {\n            dom.insertAfter(parentElm, tableElm.firstChild);\n          } else {\n            tableElm.insertBefore(parentElm, tableElm.firstChild);\n          }\n        } else {\n          tableElm.appendChild(parentElm);\n        }\n      }\n      parentElm.appendChild(rowElm);\n      if (!oldParentElm.hasChildNodes()) {\n        dom.remove(oldParentElm);\n      }\n    };\n    var updateAdvancedProps$1 = function (modifier, data) {\n      modifier.setStyle('background-color', data.backgroundcolor);\n      modifier.setStyle('border-color', data.bordercolor);\n      modifier.setStyle('border-style', data.borderstyle);\n    };\n    var onSubmitRowForm = function (editor, rows, oldData, api) {\n      var dom = editor.dom;\n      var data = api.getData();\n      api.close();\n      var createModifier = rows.length === 1 ? DomModifier.normal : DomModifier.ifTruthy;\n      editor.undoManager.transact(function () {\n        global$1.each(rows, function (rowElm) {\n          if (data.type !== rowElm.parentNode.nodeName.toLowerCase()) {\n            switchRowType(editor.dom, rowElm, data.type);\n          }\n          var modifier = createModifier(dom, rowElm);\n          modifier.setAttrib('scope', data.scope);\n          modifier.setAttrib('class', data.class);\n          modifier.setStyle('height', addSizeSuffix(data.height));\n          if (hasAdvancedRowTab(editor)) {\n            updateAdvancedProps$1(modifier, data);\n          }\n          if (data.align !== oldData.align) {\n            Styles$1.unApplyAlign(editor, rowElm);\n            Styles$1.applyAlign(editor, rowElm, data.align);\n          }\n        });\n        editor.focus();\n      });\n    };\n    var open$1 = function (editor) {\n      var dom = editor.dom;\n      var tableElm, cellElm, rowElm;\n      var rows = [];\n      tableElm = dom.getParent(editor.selection.getStart(), 'table');\n      if (!tableElm) {\n        return;\n      }\n      cellElm = dom.getParent(editor.selection.getStart(), 'td,th');\n      global$1.each(tableElm.rows, function (row) {\n        global$1.each(row.cells, function (cell) {\n          if ((dom.getAttrib(cell, 'data-mce-selected') || cell === cellElm) && rows.indexOf(row) < 0) {\n            rows.push(row);\n            return false;\n          }\n        });\n      });\n      rowElm = rows[0];\n      if (!rowElm) {\n        return;\n      }\n      var rowsData = global$1.map(rows, function (rowElm) {\n        return Helpers.extractDataFromRowElement(editor, rowElm, hasAdvancedRowTab(editor));\n      });\n      var data = Helpers.getSharedValues(rowsData);\n      var dialogTabPanel = {\n        type: 'tabpanel',\n        tabs: [\n          {\n            title: 'General',\n            name: 'general',\n            items: RowDialogGeneralTab.getItems(editor)\n          },\n          Helpers.getAdvancedTab('row')\n        ]\n      };\n      var dialogPanel = {\n        type: 'panel',\n        items: [{\n            type: 'grid',\n            columns: 2,\n            items: RowDialogGeneralTab.getItems(editor)\n          }]\n      };\n      editor.windowManager.open({\n        title: 'Row Properties',\n        size: 'normal',\n        body: hasAdvancedRowTab(editor) ? dialogTabPanel : dialogPanel,\n        buttons: [\n          {\n            type: 'cancel',\n            name: 'cancel',\n            text: 'Cancel'\n          },\n          {\n            type: 'submit',\n            name: 'save',\n            text: 'Save',\n            primary: true\n          }\n        ],\n        initialData: data,\n        onSubmit: curry(onSubmitRowForm, editor, rows, data)\n      });\n    };\n    var RowDialog = { open: open$1 };\n\n    var hasOwnProperty$1 = Object.prototype.hasOwnProperty;\n    var shallow$1 = function (old, nu) {\n      return nu;\n    };\n    var baseMerge = function (merger) {\n      return function () {\n        var objects = new Array(arguments.length);\n        for (var i = 0; i < objects.length; i++) {\n          objects[i] = arguments[i];\n        }\n        if (objects.length === 0) {\n          throw new Error('Can\\'t merge zero objects');\n        }\n        var ret = {};\n        for (var j = 0; j < objects.length; j++) {\n          var curObject = objects[j];\n          for (var key in curObject) {\n            if (hasOwnProperty$1.call(curObject, key)) {\n              ret[key] = merger(ret[key], curObject[key]);\n            }\n          }\n        }\n        return ret;\n      };\n    };\n    var merge$3 = baseMerge(shallow$1);\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.Env');\n\n    var DefaultRenderOptions = {\n      styles: {\n        'border-collapse': 'collapse',\n        'width': '100%'\n      },\n      attributes: { border: '1' },\n      percentages: true\n    };\n    var makeTable = function () {\n      return Element.fromTag('table');\n    };\n    var tableBody = function () {\n      return Element.fromTag('tbody');\n    };\n    var tableRow = function () {\n      return Element.fromTag('tr');\n    };\n    var tableHeaderCell = function () {\n      return Element.fromTag('th');\n    };\n    var tableCell = function () {\n      return Element.fromTag('td');\n    };\n    var render$1 = function (rows, columns, rowHeaders, columnHeaders, renderOpts) {\n      if (renderOpts === void 0) {\n        renderOpts = DefaultRenderOptions;\n      }\n      var table = makeTable();\n      setAll$1(table, renderOpts.styles);\n      setAll(table, renderOpts.attributes);\n      var tbody = tableBody();\n      append(table, tbody);\n      var trs = [];\n      for (var i = 0; i < rows; i++) {\n        var tr = tableRow();\n        for (var j = 0; j < columns; j++) {\n          var td = i < rowHeaders || j < columnHeaders ? tableHeaderCell() : tableCell();\n          if (j < columnHeaders) {\n            set(td, 'scope', 'row');\n          }\n          if (i < rowHeaders) {\n            set(td, 'scope', 'col');\n          }\n          append(td, Element.fromTag('br'));\n          if (renderOpts.percentages) {\n            set$1(td, 'width', 100 / columns + '%');\n          }\n          append(tr, td);\n        }\n        trs.push(tr);\n      }\n      append$1(tbody, trs);\n      return table;\n    };\n\n    var get$8 = function (element) {\n      return element.dom().innerHTML;\n    };\n    var getOuter$2 = function (element) {\n      var container = Element.fromTag('div');\n      var clone = Element.fromDom(element.dom().cloneNode(true));\n      append(container, clone);\n      return get$8(container);\n    };\n\n    var placeCaretInCell = function (editor, cell) {\n      editor.selection.select(cell.dom(), true);\n      editor.selection.collapse(true);\n    };\n    var selectFirstCellInTable = function (editor, tableElm) {\n      descendant$1(tableElm, 'td,th').each(curry(placeCaretInCell, editor));\n    };\n    var fireEvents = function (editor, table) {\n      each(descendants$1(table, 'tr'), function (row) {\n        fireNewRow(editor, row.dom());\n        each(descendants$1(row, 'th,td'), function (cell) {\n          fireNewCell(editor, cell.dom());\n        });\n      });\n    };\n    var isPercentage = function (width) {\n      return isString(width) && width.indexOf('%') !== -1;\n    };\n    var insert$1 = function (editor, columns, rows) {\n      var defaultStyles = getDefaultStyles(editor);\n      var options = {\n        styles: defaultStyles,\n        attributes: getDefaultAttributes(editor),\n        percentages: isPercentage(defaultStyles.width) && !isPixelsForced(editor)\n      };\n      var table = render$1(rows, columns, 0, 0, options);\n      set(table, 'data-mce-id', '__mce');\n      var html = getOuter$2(table);\n      editor.insertContent(html);\n      return descendant$1(getBody$1(editor), 'table[data-mce-id=\"__mce\"]').map(function (table) {\n        if (isPixelsForced(editor)) {\n          set$1(table, 'width', get$2(table, 'width'));\n        }\n        remove(table, 'data-mce-id');\n        fireEvents(editor, table);\n        selectFirstCellInTable(editor, table);\n        return table.dom();\n      }).getOr(null);\n    };\n    var InsertTable = { insert: insert$1 };\n\n    var getItems$2 = function (editor, hasClasses, insertNewTable) {\n      var rowColCountItems = !insertNewTable ? [] : [\n        {\n          type: 'input',\n          name: 'cols',\n          label: 'Cols',\n          inputMode: 'numeric'\n        },\n        {\n          type: 'input',\n          name: 'rows',\n          label: 'Rows',\n          inputMode: 'numeric'\n        }\n      ];\n      var alwaysItems = [\n        {\n          type: 'input',\n          name: 'width',\n          label: 'Width'\n        },\n        {\n          type: 'input',\n          name: 'height',\n          label: 'Height'\n        }\n      ];\n      var appearanceItems = hasAppearanceOptions(editor) ? [\n        {\n          type: 'input',\n          name: 'cellspacing',\n          label: 'Cell spacing',\n          inputMode: 'numeric'\n        },\n        {\n          type: 'input',\n          name: 'cellpadding',\n          label: 'Cell padding',\n          inputMode: 'numeric'\n        },\n        {\n          type: 'input',\n          name: 'border',\n          label: 'Border width'\n        },\n        {\n          type: 'label',\n          label: 'Caption',\n          items: [{\n              type: 'checkbox',\n              name: 'caption',\n              label: 'Show caption'\n            }]\n        }\n      ] : [];\n      var alignmentItem = [{\n          type: 'selectbox',\n          name: 'align',\n          label: 'Alignment',\n          items: [\n            {\n              text: 'None',\n              value: ''\n            },\n            {\n              text: 'Left',\n              value: 'left'\n            },\n            {\n              text: 'Center',\n              value: 'center'\n            },\n            {\n              text: 'Right',\n              value: 'right'\n            }\n          ]\n        }];\n      var classListItem = hasClasses ? [{\n          type: 'selectbox',\n          name: 'class',\n          label: 'Class',\n          items: Helpers.buildListItems(getTableClassList(editor), function (item) {\n            if (item.value) {\n              item.textStyle = function () {\n                return editor.formatter.getCssText({\n                  block: 'table',\n                  classes: [item.value]\n                });\n              };\n            }\n          })\n        }] : [];\n      return rowColCountItems.concat(alwaysItems).concat(appearanceItems).concat(alignmentItem).concat(classListItem);\n    };\n    var TableDialogGeneralTab = { getItems: getItems$2 };\n\n    var styleTDTH = function (dom, elm, name, value) {\n      if (elm.tagName === 'TD' || elm.tagName === 'TH') {\n        if (isString(name)) {\n          dom.setStyle(elm, name, value);\n        } else {\n          dom.setStyle(elm, name);\n        }\n      } else {\n        if (elm.children) {\n          for (var i = 0; i < elm.children.length; i++) {\n            styleTDTH(dom, elm.children[i], name, value);\n          }\n        }\n      }\n    };\n    var applyDataToElement = function (editor, tableElm, data) {\n      var dom = editor.dom;\n      var attrs = {};\n      var styles = {};\n      attrs.class = data.class;\n      styles.height = addSizeSuffix(data.height);\n      if (dom.getAttrib(tableElm, 'width') && !shouldStyleWithCss(editor)) {\n        attrs.width = removePxSuffix(data.width);\n      } else {\n        styles.width = addSizeSuffix(data.width);\n      }\n      if (shouldStyleWithCss(editor)) {\n        styles['border-width'] = addSizeSuffix(data.border);\n        styles['border-spacing'] = addSizeSuffix(data.cellspacing);\n      } else {\n        attrs.border = data.border;\n        attrs.cellpadding = data.cellpadding;\n        attrs.cellspacing = data.cellspacing;\n      }\n      if (shouldStyleWithCss(editor) && tableElm.children) {\n        for (var i = 0; i < tableElm.children.length; i++) {\n          styleTDTH(dom, tableElm.children[i], {\n            'border-width': addSizeSuffix(data.border),\n            'padding': addSizeSuffix(data.cellpadding)\n          });\n          if (hasAdvancedTableTab(editor)) {\n            styleTDTH(dom, tableElm.children[i], { 'border-color': data.bordercolor });\n          }\n        }\n      }\n      if (hasAdvancedTableTab(editor)) {\n        styles['background-color'] = data.backgroundcolor;\n        styles['border-color'] = data.bordercolor;\n        styles['border-style'] = data.borderstyle;\n      }\n      attrs.style = dom.serializeStyle(merge$3(getDefaultStyles(editor), styles));\n      dom.setAttribs(tableElm, merge$3(getDefaultAttributes(editor), attrs));\n    };\n    var onSubmitTableForm = function (editor, tableElm, api) {\n      var dom = editor.dom;\n      var captionElm;\n      var data = api.getData();\n      api.close();\n      if (data.class === '') {\n        delete data.class;\n      }\n      editor.undoManager.transact(function () {\n        if (!tableElm) {\n          var cols = parseInt(data.cols, 10) || 1;\n          var rows = parseInt(data.rows, 10) || 1;\n          tableElm = InsertTable.insert(editor, cols, rows);\n        }\n        applyDataToElement(editor, tableElm, data);\n        captionElm = dom.select('caption', tableElm)[0];\n        if (captionElm && !data.caption) {\n          dom.remove(captionElm);\n        }\n        if (!captionElm && data.caption) {\n          captionElm = dom.create('caption');\n          captionElm.innerHTML = !global$2.ie ? '<br data-mce-bogus=\"1\"/>' : '\\xA0';\n          tableElm.insertBefore(captionElm, tableElm.firstChild);\n        }\n        if (data.align === '') {\n          Styles$1.unApplyAlign(editor, tableElm);\n        } else {\n          Styles$1.applyAlign(editor, tableElm, data.align);\n        }\n        editor.focus();\n        editor.addVisual();\n      });\n    };\n    var open$2 = function (editor, insertNewTable) {\n      var dom = editor.dom;\n      var tableElm;\n      var data = Helpers.extractDataFromSettings(editor, hasAdvancedTableTab(editor));\n      if (insertNewTable === false) {\n        tableElm = dom.getParent(editor.selection.getStart(), 'table');\n        if (tableElm) {\n          data = Helpers.extractDataFromTableElement(editor, tableElm, hasAdvancedTableTab(editor));\n        } else {\n          if (hasAdvancedTableTab(editor)) {\n            data.borderstyle = '';\n            data.bordercolor = '';\n            data.backgroundcolor = '';\n          }\n        }\n      } else {\n        data.cols = '1';\n        data.rows = '1';\n        if (hasAdvancedTableTab(editor)) {\n          data.borderstyle = '';\n          data.bordercolor = '';\n          data.backgroundcolor = '';\n        }\n      }\n      var hasClasses = getTableClassList(editor).length > 0;\n      if (hasClasses) {\n        if (data.class) {\n          data.class = data.class.replace(/\\s*mce\\-item\\-table\\s*/g, '');\n        }\n      }\n      var generalPanel = {\n        type: 'grid',\n        columns: 2,\n        items: TableDialogGeneralTab.getItems(editor, hasClasses, insertNewTable)\n      };\n      var nonAdvancedForm = function () {\n        return {\n          type: 'panel',\n          items: [generalPanel]\n        };\n      };\n      var advancedForm = function () {\n        return {\n          type: 'tabpanel',\n          tabs: [\n            {\n              title: 'General',\n              name: 'general',\n              items: [generalPanel]\n            },\n            Helpers.getAdvancedTab('table')\n          ]\n        };\n      };\n      var dialogBody = hasAdvancedTableTab(editor) ? advancedForm() : nonAdvancedForm();\n      editor.windowManager.open({\n        title: 'Table Properties',\n        size: 'normal',\n        body: dialogBody,\n        onSubmit: curry(onSubmitTableForm, editor, tableElm),\n        buttons: [\n          {\n            type: 'cancel',\n            name: 'cancel',\n            text: 'Cancel'\n          },\n          {\n            type: 'submit',\n            name: 'save',\n            text: 'Save',\n            primary: true\n          }\n        ],\n        initialData: data\n      });\n    };\n    var TableDialog = { open: open$2 };\n\n    var getSelectionStartFromSelector = function (selector) {\n      return function (editor) {\n        return Option.from(editor.dom.getParent(editor.selection.getStart(), selector)).map(Element.fromDom);\n      };\n    };\n    var getSelectionStartCell = getSelectionStartFromSelector('th,td');\n    var getSelectionStartCellOrCaption = getSelectionStartFromSelector('th,td,caption');\n\n    var each$3 = global$1.each;\n    var registerCommands = function (editor, actions, cellSelection, selections, clipboardRows) {\n      var isRoot = getIsRoot(editor);\n      var eraseTable = function () {\n        getSelectionStartCellOrCaption(editor).each(function (cellOrCaption) {\n          var tableOpt = TableLookup.table(cellOrCaption, isRoot);\n          tableOpt.filter(not(isRoot)).each(function (table) {\n            var cursor = Element.fromText('');\n            after(table, cursor);\n            remove$2(table);\n            if (editor.dom.isEmpty(editor.getBody())) {\n              editor.setContent('');\n              editor.selection.setCursorLocation();\n            } else {\n              var rng = editor.dom.createRng();\n              rng.setStart(cursor.dom(), 0);\n              rng.setEnd(cursor.dom(), 0);\n              editor.selection.setRng(rng);\n              editor.nodeChanged();\n            }\n          });\n        });\n      };\n      var getTableFromCell = function (cell) {\n        return TableLookup.table(cell, isRoot);\n      };\n      var getSize = function (table) {\n        return {\n          width: getPixelWidth$1(table.dom()),\n          height: getPixelWidth$1(table.dom())\n        };\n      };\n      var resizeChange = function (editor, oldSize, table) {\n        var newSize = getSize(table);\n        if (oldSize.width !== newSize.width || oldSize.height !== newSize.height) {\n          fireObjectResizeStart(editor, table.dom(), oldSize.width, oldSize.height);\n          fireObjectResized(editor, table.dom(), newSize.width, newSize.height);\n        }\n      };\n      var actOnSelection = function (execute) {\n        getSelectionStartCell(editor).each(function (cell) {\n          getTableFromCell(cell).each(function (table) {\n            var targets = TableTargets.forMenu(selections, table, cell);\n            var beforeSize = getSize(table);\n            execute(table, targets).each(function (rng) {\n              resizeChange(editor, beforeSize, table);\n              editor.selection.setRng(rng);\n              editor.focus();\n              cellSelection.clear(table);\n              removeDataStyle(table);\n            });\n          });\n        });\n      };\n      var copyRowSelection = function (execute) {\n        return getSelectionStartCell(editor).map(function (cell) {\n          return getTableFromCell(cell).bind(function (table) {\n            var doc = Element.fromDom(editor.getDoc());\n            var targets = TableTargets.forMenu(selections, table, cell);\n            var generators = TableFill.cellOperations(noop, doc, Option.none());\n            return CopyRows.copyRows(table, targets, generators);\n          });\n        });\n      };\n      var pasteOnSelection = function (execute) {\n        clipboardRows.get().each(function (rows) {\n          var clonedRows = map(rows, function (row) {\n            return deep(row);\n          });\n          getSelectionStartCell(editor).each(function (cell) {\n            getTableFromCell(cell).each(function (table) {\n              var doc = Element.fromDom(editor.getDoc());\n              var generators = TableFill.paste(doc);\n              var targets = TableTargets.pasteRows(selections, table, cell, clonedRows, generators);\n              execute(table, targets).each(function (rng) {\n                editor.selection.setRng(rng);\n                editor.focus();\n                cellSelection.clear(table);\n              });\n            });\n          });\n        });\n      };\n      each$3({\n        mceTableSplitCells: function () {\n          actOnSelection(actions.unmergeCells);\n        },\n        mceTableMergeCells: function () {\n          actOnSelection(actions.mergeCells);\n        },\n        mceTableInsertRowBefore: function () {\n          actOnSelection(actions.insertRowsBefore);\n        },\n        mceTableInsertRowAfter: function () {\n          actOnSelection(actions.insertRowsAfter);\n        },\n        mceTableInsertColBefore: function () {\n          actOnSelection(actions.insertColumnsBefore);\n        },\n        mceTableInsertColAfter: function () {\n          actOnSelection(actions.insertColumnsAfter);\n        },\n        mceTableDeleteCol: function () {\n          actOnSelection(actions.deleteColumn);\n        },\n        mceTableDeleteRow: function () {\n          actOnSelection(actions.deleteRow);\n        },\n        mceTableCutRow: function (grid) {\n          copyRowSelection().each(function (selection) {\n            clipboardRows.set(selection);\n            actOnSelection(actions.deleteRow);\n          });\n        },\n        mceTableCopyRow: function (grid) {\n          copyRowSelection().each(function (selection) {\n            clipboardRows.set(selection);\n          });\n        },\n        mceTablePasteRowBefore: function (grid) {\n          pasteOnSelection(actions.pasteRowsBefore);\n        },\n        mceTablePasteRowAfter: function (grid) {\n          pasteOnSelection(actions.pasteRowsAfter);\n        },\n        mceTableDelete: eraseTable\n      }, function (func, name) {\n        editor.addCommand(name, func);\n      });\n      each$3({\n        mceInsertTable: curry(TableDialog.open, editor, true),\n        mceTableProps: curry(TableDialog.open, editor, false),\n        mceTableRowProps: curry(RowDialog.open, editor),\n        mceTableCellProps: curry(CellDialog.open, editor)\n      }, function (func, name) {\n        editor.addCommand(name, function () {\n          func();\n        });\n      });\n    };\n    var Commands = { registerCommands: registerCommands };\n\n    var only = function (element) {\n      var parent = Option.from(element.dom().documentElement).map(Element.fromDom).getOr(element);\n      return {\n        parent: constant(parent),\n        view: constant(element),\n        origin: constant(Position(0, 0))\n      };\n    };\n    var detached = function (editable, chrome) {\n      var origin = function () {\n        return absolute(chrome);\n      };\n      return {\n        parent: constant(chrome),\n        view: constant(editable),\n        origin: origin\n      };\n    };\n    var body$1 = function (editable, chrome) {\n      return {\n        parent: constant(chrome),\n        view: constant(editable),\n        origin: constant(Position(0, 0))\n      };\n    };\n    var ResizeWire = {\n      only: only,\n      detached: detached,\n      body: body$1\n    };\n\n    var Event = function (fields) {\n      var struct = Immutable.apply(null, fields);\n      var handlers = [];\n      var bind = function (handler) {\n        if (handler === undefined) {\n          throw new Error('Event bind error: undefined handler');\n        }\n        handlers.push(handler);\n      };\n      var unbind = function (handler) {\n        handlers = filter(handlers, function (h) {\n          return h !== handler;\n        });\n      };\n      var trigger = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        var event = struct.apply(null, args);\n        each(handlers, function (handler) {\n          handler(event);\n        });\n      };\n      return {\n        bind: bind,\n        unbind: unbind,\n        trigger: trigger\n      };\n    };\n\n    var create$1 = function (typeDefs) {\n      var registry = map$1(typeDefs, function (event) {\n        return {\n          bind: event.bind,\n          unbind: event.unbind\n        };\n      });\n      var trigger = map$1(typeDefs, function (event) {\n        return event.trigger;\n      });\n      return {\n        registry: registry,\n        trigger: trigger\n      };\n    };\n    var Events = { create: create$1 };\n\n    var mkEvent = function (target, x, y, stop, prevent, kill, raw) {\n      return {\n        target: constant(target),\n        x: constant(x),\n        y: constant(y),\n        stop: stop,\n        prevent: prevent,\n        kill: kill,\n        raw: constant(raw)\n      };\n    };\n    var fromRawEvent = function (rawEvent) {\n      var target = Element.fromDom(rawEvent.target);\n      var stop = function () {\n        rawEvent.stopPropagation();\n      };\n      var prevent = function () {\n        rawEvent.preventDefault();\n      };\n      var kill = compose(prevent, stop);\n      return mkEvent(target, rawEvent.clientX, rawEvent.clientY, stop, prevent, kill, rawEvent);\n    };\n    var handle = function (filter, handler) {\n      return function (rawEvent) {\n        if (!filter(rawEvent)) {\n          return;\n        }\n        handler(fromRawEvent(rawEvent));\n      };\n    };\n    var binder = function (element, event, filter, handler, useCapture) {\n      var wrapped = handle(filter, handler);\n      element.dom().addEventListener(event, wrapped, useCapture);\n      return { unbind: curry(unbind, element, event, wrapped, useCapture) };\n    };\n    var bind$1 = function (element, event, filter, handler) {\n      return binder(element, event, filter, handler, false);\n    };\n    var unbind = function (element, event, handler, useCapture) {\n      element.dom().removeEventListener(event, handler, useCapture);\n    };\n\n    var filter$1 = constant(true);\n    var bind$2 = function (element, event, handler) {\n      return bind$1(element, event, filter$1, handler);\n    };\n\n    var styles$1 = css('ephox-dragster');\n    var Styles$2 = { resolve: styles$1.resolve };\n\n    var Blocker = function (options) {\n      var settings = merge$3({ layerClass: Styles$2.resolve('blocker') }, options);\n      var div = Element.fromTag('div');\n      set(div, 'role', 'presentation');\n      setAll$1(div, {\n        position: 'fixed',\n        left: '0px',\n        top: '0px',\n        width: '100%',\n        height: '100%'\n      });\n      add$2(div, Styles$2.resolve('blocker'));\n      add$2(div, settings.layerClass);\n      var element = function () {\n        return div;\n      };\n      var destroy = function () {\n        remove$2(div);\n      };\n      return {\n        element: element,\n        destroy: destroy\n      };\n    };\n\n    var DragMode = exactly([\n      'compare',\n      'extract',\n      'mutate',\n      'sink'\n    ]);\n    var DragSink = exactly([\n      'element',\n      'start',\n      'stop',\n      'destroy'\n    ]);\n    var DragApi = exactly([\n      'forceDrop',\n      'drop',\n      'move',\n      'delayDrop'\n    ]);\n\n    var compare = function (old, nu) {\n      return Position(nu.left() - old.left(), nu.top() - old.top());\n    };\n    var extract$1 = function (event) {\n      return Option.some(Position(event.x(), event.y()));\n    };\n    var mutate = function (mutation, info) {\n      mutation.mutate(info.left(), info.top());\n    };\n    var sink = function (dragApi, settings) {\n      var blocker = Blocker(settings);\n      var mdown = bind$2(blocker.element(), 'mousedown', dragApi.forceDrop);\n      var mup = bind$2(blocker.element(), 'mouseup', dragApi.drop);\n      var mmove = bind$2(blocker.element(), 'mousemove', dragApi.move);\n      var mout = bind$2(blocker.element(), 'mouseout', dragApi.delayDrop);\n      var destroy = function () {\n        blocker.destroy();\n        mup.unbind();\n        mmove.unbind();\n        mout.unbind();\n        mdown.unbind();\n      };\n      var start = function (parent) {\n        append(parent, blocker.element());\n      };\n      var stop = function () {\n        remove$2(blocker.element());\n      };\n      return DragSink({\n        element: blocker.element,\n        start: start,\n        stop: stop,\n        destroy: destroy\n      });\n    };\n    var MouseDrag = DragMode({\n      compare: compare,\n      extract: extract$1,\n      sink: sink,\n      mutate: mutate\n    });\n\n    var last$2 = function (fn, rate) {\n      var timer = null;\n      var cancel = function () {\n        if (timer !== null) {\n          domGlobals.clearTimeout(timer);\n          timer = null;\n        }\n      };\n      var throttle = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (timer !== null) {\n          domGlobals.clearTimeout(timer);\n        }\n        timer = domGlobals.setTimeout(function () {\n          fn.apply(null, args);\n          timer = null;\n        }, rate);\n      };\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n\n    function InDrag () {\n      var previous = Option.none();\n      var reset = function () {\n        previous = Option.none();\n      };\n      var update = function (mode, nu) {\n        var result = previous.map(function (old) {\n          return mode.compare(old, nu);\n        });\n        previous = Option.some(nu);\n        return result;\n      };\n      var onEvent = function (event, mode) {\n        var dataOption = mode.extract(event);\n        dataOption.each(function (data) {\n          var offset = update(mode, data);\n          offset.each(function (d) {\n            events.trigger.move(d);\n          });\n        });\n      };\n      var events = Events.create({ move: Event(['info']) });\n      return {\n        onEvent: onEvent,\n        reset: reset,\n        events: events.registry\n      };\n    }\n\n    function NoDrag () {\n      return {\n        onEvent: noop,\n        reset: noop\n      };\n    }\n\n    function Movement () {\n      var noDragState = NoDrag();\n      var inDragState = InDrag();\n      var dragState = noDragState;\n      var on = function () {\n        dragState.reset();\n        dragState = inDragState;\n      };\n      var off = function () {\n        dragState.reset();\n        dragState = noDragState;\n      };\n      var onEvent = function (event, mode) {\n        dragState.onEvent(event, mode);\n      };\n      var isOn = function () {\n        return dragState === inDragState;\n      };\n      return {\n        on: on,\n        off: off,\n        isOn: isOn,\n        onEvent: onEvent,\n        events: inDragState.events\n      };\n    }\n\n    var setup = function (mutation, mode, settings) {\n      var active = false;\n      var events = Events.create({\n        start: Event([]),\n        stop: Event([])\n      });\n      var movement = Movement();\n      var drop = function () {\n        sink.stop();\n        if (movement.isOn()) {\n          movement.off();\n          events.trigger.stop();\n        }\n      };\n      var throttledDrop = last$2(drop, 200);\n      var go = function (parent) {\n        sink.start(parent);\n        movement.on();\n        events.trigger.start();\n      };\n      var mousemove = function (event) {\n        throttledDrop.cancel();\n        movement.onEvent(event, mode);\n      };\n      movement.events.move.bind(function (event) {\n        mode.mutate(mutation, event.info());\n      });\n      var on = function () {\n        active = true;\n      };\n      var off = function () {\n        active = false;\n      };\n      var runIfActive = function (f) {\n        return function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          if (active) {\n            f.apply(null, args);\n          }\n        };\n      };\n      var sink = mode.sink(DragApi({\n        forceDrop: drop,\n        drop: runIfActive(drop),\n        move: runIfActive(mousemove),\n        delayDrop: runIfActive(throttledDrop.throttle)\n      }), settings);\n      var destroy = function () {\n        sink.destroy();\n      };\n      return {\n        element: sink.element,\n        go: go,\n        on: on,\n        off: off,\n        destroy: destroy,\n        events: events.registry\n      };\n    };\n    var Dragging = { setup: setup };\n\n    var transform$1 = function (mutation, settings) {\n      if (settings === void 0) {\n        settings = {};\n      }\n      var mode = settings.mode !== undefined ? settings.mode : MouseDrag;\n      return Dragging.setup(mutation, mode, settings);\n    };\n    var Dragger = { transform: transform$1 };\n\n    var Mutation = function () {\n      var events = Events.create({\n        drag: Event([\n          'xDelta',\n          'yDelta'\n        ])\n      });\n      var mutate = function (x, y) {\n        events.trigger.drag(x, y);\n      };\n      return {\n        mutate: mutate,\n        events: events.registry\n      };\n    };\n\n    var BarMutation = function () {\n      var events = Events.create({\n        drag: Event([\n          'xDelta',\n          'yDelta',\n          'target'\n        ])\n      });\n      var target = Option.none();\n      var delegate = Mutation();\n      delegate.events.drag.bind(function (event) {\n        target.each(function (t) {\n          events.trigger.drag(event.xDelta(), event.yDelta(), t);\n        });\n      });\n      var assign = function (t) {\n        target = Option.some(t);\n      };\n      var get = function () {\n        return target;\n      };\n      return {\n        assign: assign,\n        get: get,\n        mutate: delegate.mutate,\n        events: events.registry\n      };\n    };\n\n    var isContentEditableTrue = function (elm) {\n      return get$1(elm, 'contenteditable') === 'true';\n    };\n    var findClosestContentEditable = function (target, isRoot) {\n      return closest$1(target, '[contenteditable]', isRoot);\n    };\n\n    var resizeBarDragging = Styles.resolve('resizer-bar-dragging');\n    var BarManager = function (wire, direction, hdirection) {\n      var mutation = BarMutation();\n      var resizing = Dragger.transform(mutation, {});\n      var hoverTable = Option.none();\n      var getResizer = function (element, type) {\n        return Option.from(get$1(element, type));\n      };\n      mutation.events.drag.bind(function (event) {\n        getResizer(event.target(), 'data-row').each(function (_dataRow) {\n          var currentRow = CellUtils.getInt(event.target(), 'top');\n          set$1(event.target(), 'top', currentRow + event.yDelta() + 'px');\n        });\n        getResizer(event.target(), 'data-column').each(function (_dataCol) {\n          var currentCol = CellUtils.getInt(event.target(), 'left');\n          set$1(event.target(), 'left', currentCol + event.xDelta() + 'px');\n        });\n      });\n      var getDelta = function (target, dir) {\n        var newX = CellUtils.getInt(target, dir);\n        var oldX = parseInt(get$1(target, 'data-initial-' + dir), 10);\n        return newX - oldX;\n      };\n      resizing.events.stop.bind(function () {\n        mutation.get().each(function (target) {\n          hoverTable.each(function (table) {\n            getResizer(target, 'data-row').each(function (row) {\n              var delta = getDelta(target, 'top');\n              remove(target, 'data-initial-top');\n              events.trigger.adjustHeight(table, delta, parseInt(row, 10));\n            });\n            getResizer(target, 'data-column').each(function (column) {\n              var delta = getDelta(target, 'left');\n              remove(target, 'data-initial-left');\n              events.trigger.adjustWidth(table, delta, parseInt(column, 10));\n            });\n            Bars.refresh(wire, table, hdirection, direction);\n          });\n        });\n      });\n      var handler = function (target, dir) {\n        events.trigger.startAdjust();\n        mutation.assign(target);\n        set(target, 'data-initial-' + dir, parseInt(get$2(target, dir), 10));\n        add$2(target, resizeBarDragging);\n        set$1(target, 'opacity', '0.2');\n        resizing.go(wire.parent());\n      };\n      var mousedown = bind$2(wire.parent(), 'mousedown', function (event) {\n        if (Bars.isRowBar(event.target())) {\n          handler(event.target(), 'top');\n        }\n        if (Bars.isColBar(event.target())) {\n          handler(event.target(), 'left');\n        }\n      });\n      var isRoot = function (e) {\n        return eq(e, wire.view());\n      };\n      var findClosestEditableTable = function (target) {\n        return closest$1(target, 'table', isRoot).filter(function (table) {\n          return findClosestContentEditable(table, isRoot).exists(isContentEditableTrue);\n        });\n      };\n      var mouseover = bind$2(wire.view(), 'mouseover', function (event) {\n        findClosestEditableTable(event.target()).fold(function () {\n          if (inBody(event.target())) {\n            Bars.destroy(wire);\n          }\n        }, function (table) {\n          hoverTable = Option.some(table);\n          Bars.refresh(wire, table, hdirection, direction);\n        });\n      });\n      var destroy = function () {\n        mousedown.unbind();\n        mouseover.unbind();\n        resizing.destroy();\n        Bars.destroy(wire);\n      };\n      var refresh = function (tbl) {\n        Bars.refresh(wire, tbl, hdirection, direction);\n      };\n      var events = Events.create({\n        adjustHeight: Event([\n          'table',\n          'delta',\n          'row'\n        ]),\n        adjustWidth: Event([\n          'table',\n          'delta',\n          'column'\n        ]),\n        startAdjust: Event([])\n      });\n      return {\n        destroy: destroy,\n        refresh: refresh,\n        on: resizing.on,\n        off: resizing.off,\n        hideBars: curry(Bars.hide, wire),\n        showBars: curry(Bars.show, wire),\n        events: events.registry\n      };\n    };\n\n    var create$2 = function (wire, vdirection) {\n      var hdirection = BarPositions.height;\n      var manager = BarManager(wire, vdirection, hdirection);\n      var events = Events.create({\n        beforeResize: Event(['table']),\n        afterResize: Event(['table']),\n        startDrag: Event([])\n      });\n      manager.events.adjustHeight.bind(function (event) {\n        events.trigger.beforeResize(event.table());\n        var delta = hdirection.delta(event.delta(), event.table());\n        Adjustments.adjustHeight(event.table(), delta, event.row(), hdirection);\n        events.trigger.afterResize(event.table());\n      });\n      manager.events.startAdjust.bind(function (event) {\n        events.trigger.startDrag();\n      });\n      manager.events.adjustWidth.bind(function (event) {\n        events.trigger.beforeResize(event.table());\n        var delta = vdirection.delta(event.delta(), event.table());\n        Adjustments.adjustWidth(event.table(), delta, event.column(), vdirection);\n        events.trigger.afterResize(event.table());\n      });\n      return {\n        on: manager.on,\n        off: manager.off,\n        hideBars: manager.hideBars,\n        showBars: manager.showBars,\n        destroy: manager.destroy,\n        events: events.registry\n      };\n    };\n    var TableResize = { create: create$2 };\n\n    var createContainer = function () {\n      var container = Element.fromTag('div');\n      setAll$1(container, {\n        position: 'static',\n        height: '0',\n        width: '0',\n        padding: '0',\n        margin: '0',\n        border: '0'\n      });\n      append(body(), container);\n      return container;\n    };\n    var get$9 = function (editor, container) {\n      return editor.inline ? ResizeWire.body(getBody$1(editor), createContainer()) : ResizeWire.only(Element.fromDom(editor.getDoc()));\n    };\n    var remove$6 = function (editor, wire) {\n      if (editor.inline) {\n        remove$2(wire.parent());\n      }\n    };\n    var TableWire = {\n      get: get$9,\n      remove: remove$6\n    };\n\n    var calculatePercentageWidth = function (element, parent) {\n      return getPixelWidth$1(element.dom()) / getPixelWidth$1(parent.dom()) * 100 + '%';\n    };\n    var enforcePercentage = function (rawTable) {\n      var table = Element.fromDom(rawTable);\n      parent(table).map(function (parent) {\n        return calculatePercentageWidth(table, parent);\n      }).each(function (tablePercentage) {\n        set$1(table, 'width', tablePercentage);\n        each(descendants$1(table, 'tr'), function (tr) {\n          each(children(tr), function (td) {\n            set$1(td, 'width', calculatePercentageWidth(td, tr));\n          });\n        });\n      });\n    };\n    var enforcePixels = function (table) {\n      set$1(Element.fromDom(table), 'width', getPixelWidth$1(table).toString() + 'px');\n    };\n\n    var getResizeHandler = function (editor) {\n      var selectionRng = Option.none();\n      var resize = Option.none();\n      var wire = Option.none();\n      var percentageBasedSizeRegex = /(\\d+(\\.\\d+)?)%/;\n      var startW;\n      var startRawW;\n      var isTable = function (elm) {\n        return elm.nodeName === 'TABLE';\n      };\n      var getRawWidth = function (elm) {\n        var raw = editor.dom.getStyle(elm, 'width') || editor.dom.getAttrib(elm, 'width');\n        return Option.from(raw).filter(function (s) {\n          return s.length > 0;\n        });\n      };\n      var lazyResize = function () {\n        return resize;\n      };\n      var lazyWire = function () {\n        return wire.getOr(ResizeWire.only(Element.fromDom(editor.getBody())));\n      };\n      var destroy = function () {\n        resize.each(function (sz) {\n          sz.destroy();\n        });\n        wire.each(function (w) {\n          TableWire.remove(editor, w);\n        });\n      };\n      editor.on('init', function () {\n        var direction = TableDirection(Direction.directionAt);\n        var rawWire = TableWire.get(editor);\n        wire = Option.some(rawWire);\n        if (hasObjectResizing(editor) && hasTableResizeBars(editor)) {\n          var sz = TableResize.create(rawWire, direction);\n          sz.on();\n          sz.events.startDrag.bind(function (event) {\n            selectionRng = Option.some(editor.selection.getRng());\n          });\n          sz.events.beforeResize.bind(function (event) {\n            var rawTable = event.table().dom();\n            fireObjectResizeStart(editor, rawTable, getPixelWidth$1(rawTable), getPixelHeight(rawTable));\n          });\n          sz.events.afterResize.bind(function (event) {\n            var table = event.table();\n            var rawTable = table.dom();\n            removeDataStyle(table);\n            selectionRng.each(function (rng) {\n              editor.selection.setRng(rng);\n              editor.focus();\n            });\n            fireObjectResized(editor, rawTable, getPixelWidth$1(rawTable), getPixelHeight(rawTable));\n            editor.undoManager.add();\n          });\n          resize = Option.some(sz);\n        }\n      });\n      editor.on('ObjectResizeStart', function (e) {\n        var targetElm = e.target;\n        if (isTable(targetElm)) {\n          var tableHasPercentage = getRawWidth(targetElm).map(function (w) {\n            return percentageBasedSizeRegex.test(w);\n          }).getOr(false);\n          if (tableHasPercentage && isPixelsForced(editor)) {\n            enforcePixels(targetElm);\n          } else if (!tableHasPercentage && isPercentagesForced(editor)) {\n            enforcePercentage(targetElm);\n          }\n          startW = e.width;\n          startRawW = getRawWidth(targetElm).getOr('');\n        }\n      });\n      editor.on('ObjectResized', function (e) {\n        var targetElm = e.target;\n        if (isTable(targetElm)) {\n          var table = targetElm;\n          if (percentageBasedSizeRegex.test(startRawW)) {\n            var percentW = parseFloat(percentageBasedSizeRegex.exec(startRawW)[1]);\n            var targetPercentW = e.width * percentW / startW;\n            editor.dom.setStyle(table, 'width', targetPercentW + '%');\n          } else {\n            var newCellSizes_1 = [];\n            global$1.each(table.rows, function (row) {\n              global$1.each(row.cells, function (cell) {\n                var width = editor.dom.getStyle(cell, 'width', true);\n                newCellSizes_1.push({\n                  cell: cell,\n                  width: width\n                });\n              });\n            });\n            global$1.each(newCellSizes_1, function (newCellSize) {\n              editor.dom.setStyle(newCellSize.cell, 'width', newCellSize.width);\n              editor.dom.setAttrib(newCellSize.cell, 'width', null);\n            });\n          }\n        }\n      });\n      editor.on('SwitchMode', function () {\n        lazyResize().each(function (resize) {\n          if (editor.readonly) {\n            resize.hideBars();\n          } else {\n            resize.showBars();\n          }\n        });\n      });\n      return {\n        lazyResize: lazyResize,\n        lazyWire: lazyWire,\n        destroy: destroy\n      };\n    };\n\n    var adt$1 = Adt.generate([\n      { none: ['current'] },\n      { first: ['current'] },\n      {\n        middle: [\n          'current',\n          'target'\n        ]\n      },\n      { last: ['current'] }\n    ]);\n    var none$1 = function (current) {\n      if (current === void 0) {\n        current = undefined;\n      }\n      return adt$1.none(current);\n    };\n    var CellLocation = __assign(__assign({}, adt$1), { none: none$1 });\n\n    var detect$4 = function (current, isRoot) {\n      return TableLookup.table(current, isRoot).bind(function (table) {\n        var all = TableLookup.cells(table);\n        var index = findIndex(all, function (x) {\n          return eq(current, x);\n        });\n        return index.map(function (ind) {\n          return {\n            index: constant(ind),\n            all: constant(all)\n          };\n        });\n      });\n    };\n    var next = function (current, isRoot) {\n      var detection = detect$4(current, isRoot);\n      return detection.fold(function () {\n        return CellLocation.none(current);\n      }, function (info) {\n        return info.index() + 1 < info.all().length ? CellLocation.middle(current, info.all()[info.index() + 1]) : CellLocation.last(current);\n      });\n    };\n    var prev = function (current, isRoot) {\n      var detection = detect$4(current, isRoot);\n      return detection.fold(function () {\n        return CellLocation.none();\n      }, function (info) {\n        return info.index() - 1 >= 0 ? CellLocation.middle(current, info.all()[info.index() - 1]) : CellLocation.first(current);\n      });\n    };\n    var CellNavigation = {\n      next: next,\n      prev: prev\n    };\n\n    var create$3 = Immutable('start', 'soffset', 'finish', 'foffset');\n    var SimRange = { create: create$3 };\n\n    var adt$2 = Adt.generate([\n      { before: ['element'] },\n      {\n        on: [\n          'element',\n          'offset'\n        ]\n      },\n      { after: ['element'] }\n    ]);\n    var cata$1 = function (subject, onBefore, onOn, onAfter) {\n      return subject.fold(onBefore, onOn, onAfter);\n    };\n    var getStart = function (situ) {\n      return situ.fold(identity, identity, identity);\n    };\n    var before$2 = adt$2.before;\n    var on = adt$2.on;\n    var after$2 = adt$2.after;\n    var Situ = {\n      before: before$2,\n      on: on,\n      after: after$2,\n      cata: cata$1,\n      getStart: getStart\n    };\n\n    var adt$3 = Adt.generate([\n      { domRange: ['rng'] },\n      {\n        relative: [\n          'startSitu',\n          'finishSitu'\n        ]\n      },\n      {\n        exact: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      }\n    ]);\n    var exactFromRange = function (simRange) {\n      return adt$3.exact(simRange.start(), simRange.soffset(), simRange.finish(), simRange.foffset());\n    };\n    var getStart$1 = function (selection) {\n      return selection.match({\n        domRange: function (rng) {\n          return Element.fromDom(rng.startContainer);\n        },\n        relative: function (startSitu, finishSitu) {\n          return Situ.getStart(startSitu);\n        },\n        exact: function (start, soffset, finish, foffset) {\n          return start;\n        }\n      });\n    };\n    var domRange = adt$3.domRange;\n    var relative = adt$3.relative;\n    var exact = adt$3.exact;\n    var getWin = function (selection) {\n      var start = getStart$1(selection);\n      return defaultView(start);\n    };\n    var range$1 = SimRange.create;\n    var Selection = {\n      domRange: domRange,\n      relative: relative,\n      exact: exact,\n      exactFromRange: exactFromRange,\n      getWin: getWin,\n      range: range$1\n    };\n\n    var selectNodeContents = function (win, element) {\n      var rng = win.document.createRange();\n      selectNodeContentsUsing(rng, element);\n      return rng;\n    };\n    var selectNodeContentsUsing = function (rng, element) {\n      rng.selectNodeContents(element.dom());\n    };\n    var setStart = function (rng, situ) {\n      situ.fold(function (e) {\n        rng.setStartBefore(e.dom());\n      }, function (e, o) {\n        rng.setStart(e.dom(), o);\n      }, function (e) {\n        rng.setStartAfter(e.dom());\n      });\n    };\n    var setFinish = function (rng, situ) {\n      situ.fold(function (e) {\n        rng.setEndBefore(e.dom());\n      }, function (e, o) {\n        rng.setEnd(e.dom(), o);\n      }, function (e) {\n        rng.setEndAfter(e.dom());\n      });\n    };\n    var relativeToNative = function (win, startSitu, finishSitu) {\n      var range = win.document.createRange();\n      setStart(range, startSitu);\n      setFinish(range, finishSitu);\n      return range;\n    };\n    var exactToNative = function (win, start, soffset, finish, foffset) {\n      var rng = win.document.createRange();\n      rng.setStart(start.dom(), soffset);\n      rng.setEnd(finish.dom(), foffset);\n      return rng;\n    };\n    var toRect = function (rect) {\n      return {\n        left: constant(rect.left),\n        top: constant(rect.top),\n        right: constant(rect.right),\n        bottom: constant(rect.bottom),\n        width: constant(rect.width),\n        height: constant(rect.height)\n      };\n    };\n    var getFirstRect = function (rng) {\n      var rects = rng.getClientRects();\n      var rect = rects.length > 0 ? rects[0] : rng.getBoundingClientRect();\n      return rect.width > 0 || rect.height > 0 ? Option.some(rect).map(toRect) : Option.none();\n    };\n\n    var adt$4 = Adt.generate([\n      {\n        ltr: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      },\n      {\n        rtl: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      }\n    ]);\n    var fromRange = function (win, type, range) {\n      return type(Element.fromDom(range.startContainer), range.startOffset, Element.fromDom(range.endContainer), range.endOffset);\n    };\n    var getRanges = function (win, selection) {\n      return selection.match({\n        domRange: function (rng) {\n          return {\n            ltr: constant(rng),\n            rtl: Option.none\n          };\n        },\n        relative: function (startSitu, finishSitu) {\n          return {\n            ltr: cached(function () {\n              return relativeToNative(win, startSitu, finishSitu);\n            }),\n            rtl: cached(function () {\n              return Option.some(relativeToNative(win, finishSitu, startSitu));\n            })\n          };\n        },\n        exact: function (start, soffset, finish, foffset) {\n          return {\n            ltr: cached(function () {\n              return exactToNative(win, start, soffset, finish, foffset);\n            }),\n            rtl: cached(function () {\n              return Option.some(exactToNative(win, finish, foffset, start, soffset));\n            })\n          };\n        }\n      });\n    };\n    var doDiagnose = function (win, ranges) {\n      var rng = ranges.ltr();\n      if (rng.collapsed) {\n        var reversed = ranges.rtl().filter(function (rev) {\n          return rev.collapsed === false;\n        });\n        return reversed.map(function (rev) {\n          return adt$4.rtl(Element.fromDom(rev.endContainer), rev.endOffset, Element.fromDom(rev.startContainer), rev.startOffset);\n        }).getOrThunk(function () {\n          return fromRange(win, adt$4.ltr, rng);\n        });\n      } else {\n        return fromRange(win, adt$4.ltr, rng);\n      }\n    };\n    var diagnose = function (win, selection) {\n      var ranges = getRanges(win, selection);\n      return doDiagnose(win, ranges);\n    };\n    var asLtrRange = function (win, selection) {\n      var diagnosis = diagnose(win, selection);\n      return diagnosis.match({\n        ltr: function (start, soffset, finish, foffset) {\n          var rng = win.document.createRange();\n          rng.setStart(start.dom(), soffset);\n          rng.setEnd(finish.dom(), foffset);\n          return rng;\n        },\n        rtl: function (start, soffset, finish, foffset) {\n          var rng = win.document.createRange();\n          rng.setStart(finish.dom(), foffset);\n          rng.setEnd(start.dom(), soffset);\n          return rng;\n        }\n      });\n    };\n\n    var searchForPoint = function (rectForOffset, x, y, maxX, length) {\n      if (length === 0) {\n        return 0;\n      } else if (x === maxX) {\n        return length - 1;\n      }\n      var xDelta = maxX;\n      for (var i = 1; i < length; i++) {\n        var rect = rectForOffset(i);\n        var curDeltaX = Math.abs(x - rect.left);\n        if (y <= rect.bottom) {\n          if (y < rect.top || curDeltaX > xDelta) {\n            return i - 1;\n          } else {\n            xDelta = curDeltaX;\n          }\n        }\n      }\n      return 0;\n    };\n    var inRect = function (rect, x, y) {\n      return x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom;\n    };\n\n    var locateOffset = function (doc, textnode, x, y, rect) {\n      var rangeForOffset = function (o) {\n        var r = doc.dom().createRange();\n        r.setStart(textnode.dom(), o);\n        r.collapse(true);\n        return r;\n      };\n      var rectForOffset = function (o) {\n        var r = rangeForOffset(o);\n        return r.getBoundingClientRect();\n      };\n      var length = get$3(textnode).length;\n      var offset = searchForPoint(rectForOffset, x, y, rect.right, length);\n      return rangeForOffset(offset);\n    };\n    var locate = function (doc, node, x, y) {\n      var r = doc.dom().createRange();\n      r.selectNode(node.dom());\n      var rects = r.getClientRects();\n      var foundRect = findMap(rects, function (rect) {\n        return inRect(rect, x, y) ? Option.some(rect) : Option.none();\n      });\n      return foundRect.map(function (rect) {\n        return locateOffset(doc, node, x, y, rect);\n      });\n    };\n\n    var searchInChildren = function (doc, node, x, y) {\n      var r = doc.dom().createRange();\n      var nodes = children(node);\n      return findMap(nodes, function (n) {\n        r.selectNode(n.dom());\n        return inRect(r.getBoundingClientRect(), x, y) ? locateNode(doc, n, x, y) : Option.none();\n      });\n    };\n    var locateNode = function (doc, node, x, y) {\n      return isText(node) ? locate(doc, node, x, y) : searchInChildren(doc, node, x, y);\n    };\n    var locate$1 = function (doc, node, x, y) {\n      var r = doc.dom().createRange();\n      r.selectNode(node.dom());\n      var rect = r.getBoundingClientRect();\n      var boundedX = Math.max(rect.left, Math.min(rect.right, x));\n      var boundedY = Math.max(rect.top, Math.min(rect.bottom, y));\n      return locateNode(doc, node, boundedX, boundedY);\n    };\n\n    var COLLAPSE_TO_LEFT = true;\n    var COLLAPSE_TO_RIGHT = false;\n    var getCollapseDirection = function (rect, x) {\n      return x - rect.left < rect.right - x ? COLLAPSE_TO_LEFT : COLLAPSE_TO_RIGHT;\n    };\n    var createCollapsedNode = function (doc, target, collapseDirection) {\n      var r = doc.dom().createRange();\n      r.selectNode(target.dom());\n      r.collapse(collapseDirection);\n      return r;\n    };\n    var locateInElement = function (doc, node, x) {\n      var cursorRange = doc.dom().createRange();\n      cursorRange.selectNode(node.dom());\n      var rect = cursorRange.getBoundingClientRect();\n      var collapseDirection = getCollapseDirection(rect, x);\n      var f = collapseDirection === COLLAPSE_TO_LEFT ? first : last$1;\n      return f(node).map(function (target) {\n        return createCollapsedNode(doc, target, collapseDirection);\n      });\n    };\n    var locateInEmpty = function (doc, node, x) {\n      var rect = node.dom().getBoundingClientRect();\n      var collapseDirection = getCollapseDirection(rect, x);\n      return Option.some(createCollapsedNode(doc, node, collapseDirection));\n    };\n    var search = function (doc, node, x) {\n      var f = children(node).length === 0 ? locateInEmpty : locateInElement;\n      return f(doc, node, x);\n    };\n\n    var caretPositionFromPoint = function (doc, x, y) {\n      return Option.from(doc.dom().caretPositionFromPoint(x, y)).bind(function (pos) {\n        if (pos.offsetNode === null) {\n          return Option.none();\n        }\n        var r = doc.dom().createRange();\n        r.setStart(pos.offsetNode, pos.offset);\n        r.collapse();\n        return Option.some(r);\n      });\n    };\n    var caretRangeFromPoint = function (doc, x, y) {\n      return Option.from(doc.dom().caretRangeFromPoint(x, y));\n    };\n    var searchTextNodes = function (doc, node, x, y) {\n      var r = doc.dom().createRange();\n      r.selectNode(node.dom());\n      var rect = r.getBoundingClientRect();\n      var boundedX = Math.max(rect.left, Math.min(rect.right, x));\n      var boundedY = Math.max(rect.top, Math.min(rect.bottom, y));\n      return locate$1(doc, node, boundedX, boundedY);\n    };\n    var searchFromPoint = function (doc, x, y) {\n      return Element.fromPoint(doc, x, y).bind(function (elem) {\n        var fallback = function () {\n          return search(doc, elem, x);\n        };\n        return children(elem).length === 0 ? fallback() : searchTextNodes(doc, elem, x, y).orThunk(fallback);\n      });\n    };\n    var availableSearch = document.caretPositionFromPoint ? caretPositionFromPoint : document.caretRangeFromPoint ? caretRangeFromPoint : searchFromPoint;\n    var fromPoint$1 = function (win, x, y) {\n      var doc = Element.fromDom(win.document);\n      return availableSearch(doc, x, y).map(function (rng) {\n        return SimRange.create(Element.fromDom(rng.startContainer), rng.startOffset, Element.fromDom(rng.endContainer), rng.endOffset);\n      });\n    };\n\n    var beforeSpecial = function (element, offset) {\n      var name$1 = name(element);\n      if ('input' === name$1) {\n        return Situ.after(element);\n      } else if (!contains([\n          'br',\n          'img'\n        ], name$1)) {\n        return Situ.on(element, offset);\n      } else {\n        return offset === 0 ? Situ.before(element) : Situ.after(element);\n      }\n    };\n    var preprocessRelative = function (startSitu, finishSitu) {\n      var start = startSitu.fold(Situ.before, beforeSpecial, Situ.after);\n      var finish = finishSitu.fold(Situ.before, beforeSpecial, Situ.after);\n      return Selection.relative(start, finish);\n    };\n    var preprocessExact = function (start, soffset, finish, foffset) {\n      var startSitu = beforeSpecial(start, soffset);\n      var finishSitu = beforeSpecial(finish, foffset);\n      return Selection.relative(startSitu, finishSitu);\n    };\n    var preprocess = function (selection) {\n      return selection.match({\n        domRange: function (rng) {\n          var start = Element.fromDom(rng.startContainer);\n          var finish = Element.fromDom(rng.endContainer);\n          return preprocessExact(start, rng.startOffset, finish, rng.endOffset);\n        },\n        relative: preprocessRelative,\n        exact: preprocessExact\n      });\n    };\n\n    var makeRange = function (start, soffset, finish, foffset) {\n      var doc = owner(start);\n      var rng = doc.dom().createRange();\n      rng.setStart(start.dom(), soffset);\n      rng.setEnd(finish.dom(), foffset);\n      return rng;\n    };\n    var after$3 = function (start, soffset, finish, foffset) {\n      var r = makeRange(start, soffset, finish, foffset);\n      var same = eq(start, finish) && soffset === foffset;\n      return r.collapsed && !same;\n    };\n\n    var doSetNativeRange = function (win, rng) {\n      Option.from(win.getSelection()).each(function (selection) {\n        selection.removeAllRanges();\n        selection.addRange(rng);\n      });\n    };\n    var doSetRange = function (win, start, soffset, finish, foffset) {\n      var rng = exactToNative(win, start, soffset, finish, foffset);\n      doSetNativeRange(win, rng);\n    };\n    var setLegacyRtlRange = function (win, selection, start, soffset, finish, foffset) {\n      selection.collapse(start.dom(), soffset);\n      selection.extend(finish.dom(), foffset);\n    };\n    var setRangeFromRelative = function (win, relative) {\n      return diagnose(win, relative).match({\n        ltr: function (start, soffset, finish, foffset) {\n          doSetRange(win, start, soffset, finish, foffset);\n        },\n        rtl: function (start, soffset, finish, foffset) {\n          var selection = win.getSelection();\n          if (selection.setBaseAndExtent) {\n            selection.setBaseAndExtent(start.dom(), soffset, finish.dom(), foffset);\n          } else if (selection.extend) {\n            try {\n              setLegacyRtlRange(win, selection, start, soffset, finish, foffset);\n            } catch (e) {\n              doSetRange(win, finish, foffset, start, soffset);\n            }\n          } else {\n            doSetRange(win, finish, foffset, start, soffset);\n          }\n        }\n      });\n    };\n    var setExact = function (win, start, soffset, finish, foffset) {\n      var relative = preprocessExact(start, soffset, finish, foffset);\n      setRangeFromRelative(win, relative);\n    };\n    var setRelative = function (win, startSitu, finishSitu) {\n      var relative = preprocessRelative(startSitu, finishSitu);\n      setRangeFromRelative(win, relative);\n    };\n    var toNative = function (selection) {\n      var win = Selection.getWin(selection).dom();\n      var getDomRange = function (start, soffset, finish, foffset) {\n        return exactToNative(win, start, soffset, finish, foffset);\n      };\n      var filtered = preprocess(selection);\n      return diagnose(win, filtered).match({\n        ltr: getDomRange,\n        rtl: getDomRange\n      });\n    };\n    var readRange = function (selection) {\n      if (selection.rangeCount > 0) {\n        var firstRng = selection.getRangeAt(0);\n        var lastRng = selection.getRangeAt(selection.rangeCount - 1);\n        return Option.some(SimRange.create(Element.fromDom(firstRng.startContainer), firstRng.startOffset, Element.fromDom(lastRng.endContainer), lastRng.endOffset));\n      } else {\n        return Option.none();\n      }\n    };\n    var doGetExact = function (selection) {\n      var anchor = Element.fromDom(selection.anchorNode);\n      var focus = Element.fromDom(selection.focusNode);\n      return after$3(anchor, selection.anchorOffset, focus, selection.focusOffset) ? Option.some(SimRange.create(anchor, selection.anchorOffset, focus, selection.focusOffset)) : readRange(selection);\n    };\n    var setToElement = function (win, element) {\n      var rng = selectNodeContents(win, element);\n      doSetNativeRange(win, rng);\n    };\n    var getExact = function (win) {\n      return Option.from(win.getSelection()).filter(function (sel) {\n        return sel.rangeCount > 0;\n      }).bind(doGetExact);\n    };\n    var get$a = function (win) {\n      return getExact(win).map(function (range) {\n        return Selection.exact(range.start(), range.soffset(), range.finish(), range.foffset());\n      });\n    };\n    var getFirstRect$1 = function (win, selection) {\n      var rng = asLtrRange(win, selection);\n      return getFirstRect(rng);\n    };\n    var getAtPoint = function (win, x, y) {\n      return fromPoint$1(win, x, y);\n    };\n    var clear = function (win) {\n      var selection = win.getSelection();\n      selection.removeAllRanges();\n    };\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n    var forward = function (editor, isRoot, cell, lazyWire) {\n      return go(editor, isRoot, CellNavigation.next(cell), lazyWire);\n    };\n    var backward = function (editor, isRoot, cell, lazyWire) {\n      return go(editor, isRoot, CellNavigation.prev(cell), lazyWire);\n    };\n    var getCellFirstCursorPosition = function (editor, cell) {\n      var selection = Selection.exact(cell, 0, cell, 0);\n      return toNative(selection);\n    };\n    var getNewRowCursorPosition = function (editor, table) {\n      var rows = descendants$1(table, 'tr');\n      return last(rows).bind(function (last) {\n        return descendant$1(last, 'td,th').map(function (first) {\n          return getCellFirstCursorPosition(editor, first);\n        });\n      });\n    };\n    var go = function (editor, isRoot, cell, actions, lazyWire) {\n      return cell.fold(Option.none, Option.none, function (current, next) {\n        return first(next).map(function (cell) {\n          return getCellFirstCursorPosition(editor, cell);\n        });\n      }, function (current) {\n        return TableLookup.table(current, isRoot).bind(function (table) {\n          var targets = TableTargets.noMenu(current);\n          editor.undoManager.transact(function () {\n            actions.insertRowsAfter(table, targets);\n          });\n          return getNewRowCursorPosition(editor, table);\n        });\n      });\n    };\n    var rootElements = [\n      'table',\n      'li',\n      'dl'\n    ];\n    var handle$1 = function (event, editor, actions, lazyWire) {\n      if (event.keyCode === global$3.TAB) {\n        var body_1 = getBody$1(editor);\n        var isRoot_1 = function (element) {\n          var name$1 = name(element);\n          return eq(element, body_1) || contains(rootElements, name$1);\n        };\n        var rng = editor.selection.getRng();\n        if (rng.collapsed) {\n          var start = Element.fromDom(rng.startContainer);\n          TableLookup.cell(start, isRoot_1).each(function (cell) {\n            event.preventDefault();\n            var navigation = event.shiftKey ? backward : forward;\n            var rng = navigation(editor, isRoot_1, cell, actions, lazyWire);\n            rng.each(function (range) {\n              editor.selection.setRng(range);\n            });\n          });\n        }\n      }\n    };\n    var TabContext = { handle: handle$1 };\n\n    var create$4 = Immutable('selection', 'kill');\n    var Response = { create: create$4 };\n\n    var create$5 = function (start, soffset, finish, foffset) {\n      return {\n        start: constant(Situ.on(start, soffset)),\n        finish: constant(Situ.on(finish, foffset))\n      };\n    };\n    var Situs = { create: create$5 };\n\n    var convertToRange = function (win, selection) {\n      var rng = asLtrRange(win, selection);\n      return SimRange.create(Element.fromDom(rng.startContainer), rng.startOffset, Element.fromDom(rng.endContainer), rng.endOffset);\n    };\n    var makeSitus = Situs.create;\n    var Util = {\n      convertToRange: convertToRange,\n      makeSitus: makeSitus\n    };\n\n    var sync = function (container, isRoot, start, soffset, finish, foffset, selectRange) {\n      if (!(eq(start, finish) && soffset === foffset)) {\n        return closest$1(start, 'td,th', isRoot).bind(function (s) {\n          return closest$1(finish, 'td,th', isRoot).bind(function (f) {\n            return detect$5(container, isRoot, s, f, selectRange);\n          });\n        });\n      } else {\n        return Option.none();\n      }\n    };\n    var detect$5 = function (container, isRoot, start, finish, selectRange) {\n      if (!eq(start, finish)) {\n        return CellSelection.identify(start, finish, isRoot).bind(function (cellSel) {\n          var boxes = cellSel.boxes().getOr([]);\n          if (boxes.length > 0) {\n            selectRange(container, boxes, cellSel.start(), cellSel.finish());\n            return Option.some(Response.create(Option.some(Util.makeSitus(start, 0, start, getEnd(start))), true));\n          } else {\n            return Option.none();\n          }\n        });\n      } else {\n        return Option.none();\n      }\n    };\n    var update = function (rows, columns, container, selected, annotations) {\n      var updateSelection = function (newSels) {\n        annotations.clearBeforeUpdate(container);\n        annotations.selectRange(container, newSels.boxes(), newSels.start(), newSels.finish());\n        return newSels.boxes();\n      };\n      return CellSelection.shiftSelection(selected, rows, columns, annotations.firstSelectedSelector(), annotations.lastSelectedSelector()).map(updateSelection);\n    };\n    var KeySelection = {\n      sync: sync,\n      detect: detect$5,\n      update: update\n    };\n\n    var traverse = Immutable('item', 'mode');\n    var backtrack = function (universe, item, _direction, transition) {\n      if (transition === void 0) {\n        transition = sidestep;\n      }\n      return universe.property().parent(item).map(function (p) {\n        return traverse(p, transition);\n      });\n    };\n    var sidestep = function (universe, item, direction, transition) {\n      if (transition === void 0) {\n        transition = advance;\n      }\n      return direction.sibling(universe, item).map(function (p) {\n        return traverse(p, transition);\n      });\n    };\n    var advance = function (universe, item, direction, transition) {\n      if (transition === void 0) {\n        transition = advance;\n      }\n      var children = universe.property().children(item);\n      var result = direction.first(children);\n      return result.map(function (r) {\n        return traverse(r, transition);\n      });\n    };\n    var successors = [\n      {\n        current: backtrack,\n        next: sidestep,\n        fallback: Option.none()\n      },\n      {\n        current: sidestep,\n        next: advance,\n        fallback: Option.some(backtrack)\n      },\n      {\n        current: advance,\n        next: advance,\n        fallback: Option.some(sidestep)\n      }\n    ];\n    var go$1 = function (universe, item, mode, direction, rules) {\n      if (rules === void 0) {\n        rules = successors;\n      }\n      var ruleOpt = find(rules, function (succ) {\n        return succ.current === mode;\n      });\n      return ruleOpt.bind(function (rule) {\n        return rule.current(universe, item, direction, rule.next).orThunk(function () {\n          return rule.fallback.bind(function (fb) {\n            return go$1(universe, item, fb, direction);\n          });\n        });\n      });\n    };\n\n    var left = function () {\n      var sibling = function (universe, item) {\n        return universe.query().prevSibling(item);\n      };\n      var first = function (children) {\n        return children.length > 0 ? Option.some(children[children.length - 1]) : Option.none();\n      };\n      return {\n        sibling: sibling,\n        first: first\n      };\n    };\n    var right = function () {\n      var sibling = function (universe, item) {\n        return universe.query().nextSibling(item);\n      };\n      var first = function (children) {\n        return children.length > 0 ? Option.some(children[0]) : Option.none();\n      };\n      return {\n        sibling: sibling,\n        first: first\n      };\n    };\n    var Walkers = {\n      left: left,\n      right: right\n    };\n\n    var hone = function (universe, item, predicate, mode, direction, isRoot) {\n      var next = go$1(universe, item, mode, direction);\n      return next.bind(function (n) {\n        if (isRoot(n.item())) {\n          return Option.none();\n        } else {\n          return predicate(n.item()) ? Option.some(n.item()) : hone(universe, n.item(), predicate, n.mode(), direction, isRoot);\n        }\n      });\n    };\n    var left$1 = function (universe, item, predicate, isRoot) {\n      return hone(universe, item, predicate, sidestep, Walkers.left(), isRoot);\n    };\n    var right$1 = function (universe, item, predicate, isRoot) {\n      return hone(universe, item, predicate, sidestep, Walkers.right(), isRoot);\n    };\n\n    var isLeaf = function (universe) {\n      return function (element) {\n        return universe.property().children(element).length === 0;\n      };\n    };\n    var before$3 = function (universe, item, isRoot) {\n      return seekLeft(universe, item, isLeaf(universe), isRoot);\n    };\n    var after$4 = function (universe, item, isRoot) {\n      return seekRight(universe, item, isLeaf(universe), isRoot);\n    };\n    var seekLeft = left$1;\n    var seekRight = right$1;\n\n    var universe$2 = DomUniverse();\n    var before$4 = function (element, isRoot) {\n      return before$3(universe$2, element, isRoot);\n    };\n    var after$5 = function (element, isRoot) {\n      return after$4(universe$2, element, isRoot);\n    };\n    var seekLeft$1 = function (element, predicate, isRoot) {\n      return seekLeft(universe$2, element, predicate, isRoot);\n    };\n    var seekRight$1 = function (element, predicate, isRoot) {\n      return seekRight(universe$2, element, predicate, isRoot);\n    };\n\n    var ancestor$2 = function (scope, predicate, isRoot) {\n      return ancestor(scope, predicate, isRoot).isSome();\n    };\n\n    var point = Immutable('element', 'offset');\n    var delta = Immutable('element', 'deltaOffset');\n    var range$2 = Immutable('element', 'start', 'finish');\n    var points = Immutable('begin', 'end');\n    var text = Immutable('element', 'text');\n\n    var adt$5 = Adt.generate([\n      { none: ['message'] },\n      { success: [] },\n      { failedUp: ['cell'] },\n      { failedDown: ['cell'] }\n    ]);\n    var isOverlapping = function (bridge, before, after) {\n      var beforeBounds = bridge.getRect(before);\n      var afterBounds = bridge.getRect(after);\n      return afterBounds.right > beforeBounds.left && afterBounds.left < beforeBounds.right;\n    };\n    var isRow = function (elem) {\n      return closest$1(elem, 'tr');\n    };\n    var verify = function (bridge, before, beforeOffset, after, afterOffset, failure, isRoot) {\n      return closest$1(after, 'td,th', isRoot).bind(function (afterCell) {\n        return closest$1(before, 'td,th', isRoot).map(function (beforeCell) {\n          if (!eq(afterCell, beforeCell)) {\n            return DomParent.sharedOne(isRow, [\n              afterCell,\n              beforeCell\n            ]).fold(function () {\n              return isOverlapping(bridge, beforeCell, afterCell) ? adt$5.success() : failure(beforeCell);\n            }, function (_sharedRow) {\n              return failure(beforeCell);\n            });\n          } else {\n            return eq(after, afterCell) && getEnd(afterCell) === afterOffset ? failure(beforeCell) : adt$5.none('in same cell');\n          }\n        });\n      }).getOr(adt$5.none('default'));\n    };\n    var cata$2 = function (subject, onNone, onSuccess, onFailedUp, onFailedDown) {\n      return subject.fold(onNone, onSuccess, onFailedUp, onFailedDown);\n    };\n    var BeforeAfter = __assign(__assign({}, adt$5), {\n      verify: verify,\n      cata: cata$2\n    });\n\n    var inAncestor = Immutable('ancestor', 'descendants', 'element', 'index');\n    var inParent = Immutable('parent', 'children', 'element', 'index');\n    var indexInParent = function (element) {\n      return parent(element).bind(function (parent) {\n        var children$1 = children(parent);\n        return indexOf(children$1, element).map(function (index) {\n          return inParent(parent, children$1, element, index);\n        });\n      });\n    };\n    var indexOf = function (elements, element) {\n      return findIndex(elements, curry(eq, element));\n    };\n\n    var isBr = function (elem) {\n      return name(elem) === 'br';\n    };\n    var gatherer = function (cand, gather, isRoot) {\n      return gather(cand, isRoot).bind(function (target) {\n        return isText(target) && get$3(target).trim().length === 0 ? gatherer(target, gather, isRoot) : Option.some(target);\n      });\n    };\n    var handleBr = function (isRoot, element, direction) {\n      return direction.traverse(element).orThunk(function () {\n        return gatherer(element, direction.gather, isRoot);\n      }).map(direction.relative);\n    };\n    var findBr = function (element, offset) {\n      return child(element, offset).filter(isBr).orThunk(function () {\n        return child(element, offset - 1).filter(isBr);\n      });\n    };\n    var handleParent = function (isRoot, element, offset, direction) {\n      return findBr(element, offset).bind(function (br) {\n        return direction.traverse(br).fold(function () {\n          return gatherer(br, direction.gather, isRoot).map(direction.relative);\n        }, function (adjacent) {\n          return indexInParent(adjacent).map(function (info) {\n            return Situ.on(info.parent(), info.index());\n          });\n        });\n      });\n    };\n    var tryBr = function (isRoot, element, offset, direction) {\n      var target = isBr(element) ? handleBr(isRoot, element, direction) : handleParent(isRoot, element, offset, direction);\n      return target.map(function (tgt) {\n        return {\n          start: constant(tgt),\n          finish: constant(tgt)\n        };\n      });\n    };\n    var process = function (analysis) {\n      return BeforeAfter.cata(analysis, function (message) {\n        return Option.none();\n      }, function () {\n        return Option.none();\n      }, function (cell) {\n        return Option.some(point(cell, 0));\n      }, function (cell) {\n        return Option.some(point(cell, getEnd(cell)));\n      });\n    };\n    var BrTags = {\n      tryBr: tryBr,\n      process: process\n    };\n\n    var nu$3 = MixedBag([\n      'left',\n      'top',\n      'right',\n      'bottom'\n    ], []);\n    var moveDown = function (caret, amount) {\n      return nu$3({\n        left: caret.left(),\n        top: caret.top() + amount,\n        right: caret.right(),\n        bottom: caret.bottom() + amount\n      });\n    };\n    var moveUp = function (caret, amount) {\n      return nu$3({\n        left: caret.left(),\n        top: caret.top() - amount,\n        right: caret.right(),\n        bottom: caret.bottom() - amount\n      });\n    };\n    var moveBottomTo = function (caret, bottom) {\n      var height = caret.bottom() - caret.top();\n      return nu$3({\n        left: caret.left(),\n        top: bottom - height,\n        right: caret.right(),\n        bottom: bottom\n      });\n    };\n    var moveTopTo = function (caret, top) {\n      var height = caret.bottom() - caret.top();\n      return nu$3({\n        left: caret.left(),\n        top: top,\n        right: caret.right(),\n        bottom: top + height\n      });\n    };\n    var translate = function (caret, xDelta, yDelta) {\n      return nu$3({\n        left: caret.left() + xDelta,\n        top: caret.top() + yDelta,\n        right: caret.right() + xDelta,\n        bottom: caret.bottom() + yDelta\n      });\n    };\n    var getTop$1 = function (caret) {\n      return caret.top();\n    };\n    var getBottom = function (caret) {\n      return caret.bottom();\n    };\n    var toString = function (caret) {\n      return '(' + caret.left() + ', ' + caret.top() + ') -> (' + caret.right() + ', ' + caret.bottom() + ')';\n    };\n    var Carets = {\n      nu: nu$3,\n      moveUp: moveUp,\n      moveDown: moveDown,\n      moveBottomTo: moveBottomTo,\n      moveTopTo: moveTopTo,\n      getTop: getTop$1,\n      getBottom: getBottom,\n      translate: translate,\n      toString: toString\n    };\n\n    var getPartialBox = function (bridge, element, offset) {\n      if (offset >= 0 && offset < getEnd(element)) {\n        return bridge.getRangedRect(element, offset, element, offset + 1);\n      } else if (offset > 0) {\n        return bridge.getRangedRect(element, offset - 1, element, offset);\n      }\n      return Option.none();\n    };\n    var toCaret = function (rect) {\n      return Carets.nu({\n        left: rect.left,\n        top: rect.top,\n        right: rect.right,\n        bottom: rect.bottom\n      });\n    };\n    var getElemBox = function (bridge, element) {\n      return Option.some(bridge.getRect(element));\n    };\n    var getBoxAt = function (bridge, element, offset) {\n      if (isElement(element)) {\n        return getElemBox(bridge, element).map(toCaret);\n      } else if (isText(element)) {\n        return getPartialBox(bridge, element, offset).map(toCaret);\n      } else {\n        return Option.none();\n      }\n    };\n    var getEntireBox = function (bridge, element) {\n      if (isElement(element)) {\n        return getElemBox(bridge, element).map(toCaret);\n      } else if (isText(element)) {\n        return bridge.getRangedRect(element, 0, element, getEnd(element)).map(toCaret);\n      } else {\n        return Option.none();\n      }\n    };\n    var Rectangles = {\n      getBoxAt: getBoxAt,\n      getEntireBox: getEntireBox\n    };\n\n    var JUMP_SIZE = 5;\n    var NUM_RETRIES = 100;\n    var adt$6 = Adt.generate([\n      { none: [] },\n      { retry: ['caret'] }\n    ]);\n    var isOutside = function (caret, box) {\n      return caret.left() < box.left() || Math.abs(box.right() - caret.left()) < 1 || caret.left() > box.right();\n    };\n    var inOutsideBlock = function (bridge, element, caret) {\n      return closest(element, DomStructure.isBlock).fold(constant(false), function (cell) {\n        return Rectangles.getEntireBox(bridge, cell).exists(function (box) {\n          return isOutside(caret, box);\n        });\n      });\n    };\n    var adjustDown = function (bridge, element, guessBox, original, caret) {\n      var lowerCaret = Carets.moveDown(caret, JUMP_SIZE);\n      if (Math.abs(guessBox.bottom() - original.bottom()) < 1) {\n        return adt$6.retry(lowerCaret);\n      } else if (guessBox.top() > caret.bottom()) {\n        return adt$6.retry(lowerCaret);\n      } else if (guessBox.top() === caret.bottom()) {\n        return adt$6.retry(Carets.moveDown(caret, 1));\n      } else {\n        return inOutsideBlock(bridge, element, caret) ? adt$6.retry(Carets.translate(lowerCaret, JUMP_SIZE, 0)) : adt$6.none();\n      }\n    };\n    var adjustUp = function (bridge, element, guessBox, original, caret) {\n      var higherCaret = Carets.moveUp(caret, JUMP_SIZE);\n      if (Math.abs(guessBox.top() - original.top()) < 1) {\n        return adt$6.retry(higherCaret);\n      } else if (guessBox.bottom() < caret.top()) {\n        return adt$6.retry(higherCaret);\n      } else if (guessBox.bottom() === caret.top()) {\n        return adt$6.retry(Carets.moveUp(caret, 1));\n      } else {\n        return inOutsideBlock(bridge, element, caret) ? adt$6.retry(Carets.translate(higherCaret, JUMP_SIZE, 0)) : adt$6.none();\n      }\n    };\n    var upMovement = {\n      point: Carets.getTop,\n      adjuster: adjustUp,\n      move: Carets.moveUp,\n      gather: before$4\n    };\n    var downMovement = {\n      point: Carets.getBottom,\n      adjuster: adjustDown,\n      move: Carets.moveDown,\n      gather: after$5\n    };\n    var isAtTable = function (bridge, x, y) {\n      return bridge.elementFromPoint(x, y).filter(function (elm) {\n        return name(elm) === 'table';\n      }).isSome();\n    };\n    var adjustForTable = function (bridge, movement, original, caret, numRetries) {\n      return adjustTil(bridge, movement, original, movement.move(caret, JUMP_SIZE), numRetries);\n    };\n    var adjustTil = function (bridge, movement, original, caret, numRetries) {\n      if (numRetries === 0) {\n        return Option.some(caret);\n      }\n      if (isAtTable(bridge, caret.left(), movement.point(caret))) {\n        return adjustForTable(bridge, movement, original, caret, numRetries - 1);\n      }\n      return bridge.situsFromPoint(caret.left(), movement.point(caret)).bind(function (guess) {\n        return guess.start().fold(Option.none, function (element) {\n          return Rectangles.getEntireBox(bridge, element).bind(function (guessBox) {\n            return movement.adjuster(bridge, element, guessBox, original, caret).fold(Option.none, function (newCaret) {\n              return adjustTil(bridge, movement, original, newCaret, numRetries - 1);\n            });\n          }).orThunk(function () {\n            return Option.some(caret);\n          });\n        }, Option.none);\n      });\n    };\n    var ieTryDown = function (bridge, caret) {\n      return bridge.situsFromPoint(caret.left(), caret.bottom() + JUMP_SIZE);\n    };\n    var ieTryUp = function (bridge, caret) {\n      return bridge.situsFromPoint(caret.left(), caret.top() - JUMP_SIZE);\n    };\n    var checkScroll = function (movement, adjusted, bridge) {\n      if (movement.point(adjusted) > bridge.getInnerHeight()) {\n        return Option.some(movement.point(adjusted) - bridge.getInnerHeight());\n      } else if (movement.point(adjusted) < 0) {\n        return Option.some(-movement.point(adjusted));\n      } else {\n        return Option.none();\n      }\n    };\n    var retry = function (movement, bridge, caret) {\n      var moved = movement.move(caret, JUMP_SIZE);\n      var adjusted = adjustTil(bridge, movement, caret, moved, NUM_RETRIES).getOr(moved);\n      return checkScroll(movement, adjusted, bridge).fold(function () {\n        return bridge.situsFromPoint(adjusted.left(), movement.point(adjusted));\n      }, function (delta) {\n        bridge.scrollBy(0, delta);\n        return bridge.situsFromPoint(adjusted.left(), movement.point(adjusted) - delta);\n      });\n    };\n    var Retries = {\n      tryUp: curry(retry, upMovement),\n      tryDown: curry(retry, downMovement),\n      ieTryUp: ieTryUp,\n      ieTryDown: ieTryDown,\n      getJumpSize: constant(JUMP_SIZE)\n    };\n\n    var MAX_RETRIES = 20;\n    var platform$2 = detect$3();\n    var findSpot = function (bridge, isRoot, direction) {\n      return bridge.getSelection().bind(function (sel) {\n        return BrTags.tryBr(isRoot, sel.finish(), sel.foffset(), direction).fold(function () {\n          return Option.some(point(sel.finish(), sel.foffset()));\n        }, function (brNeighbour) {\n          var range = bridge.fromSitus(brNeighbour);\n          var analysis = BeforeAfter.verify(bridge, sel.finish(), sel.foffset(), range.finish(), range.foffset(), direction.failure, isRoot);\n          return BrTags.process(analysis);\n        });\n      });\n    };\n    var scan = function (bridge, isRoot, element, offset, direction, numRetries) {\n      if (numRetries === 0) {\n        return Option.none();\n      }\n      return tryCursor(bridge, isRoot, element, offset, direction).bind(function (situs) {\n        var range = bridge.fromSitus(situs);\n        var analysis = BeforeAfter.verify(bridge, element, offset, range.finish(), range.foffset(), direction.failure, isRoot);\n        return BeforeAfter.cata(analysis, function () {\n          return Option.none();\n        }, function () {\n          return Option.some(situs);\n        }, function (cell) {\n          if (eq(element, cell) && offset === 0) {\n            return tryAgain(bridge, element, offset, Carets.moveUp, direction);\n          } else {\n            return scan(bridge, isRoot, cell, 0, direction, numRetries - 1);\n          }\n        }, function (cell) {\n          if (eq(element, cell) && offset === getEnd(cell)) {\n            return tryAgain(bridge, element, offset, Carets.moveDown, direction);\n          } else {\n            return scan(bridge, isRoot, cell, getEnd(cell), direction, numRetries - 1);\n          }\n        });\n      });\n    };\n    var tryAgain = function (bridge, element, offset, move, direction) {\n      return Rectangles.getBoxAt(bridge, element, offset).bind(function (box) {\n        return tryAt(bridge, direction, move(box, Retries.getJumpSize()));\n      });\n    };\n    var tryAt = function (bridge, direction, box) {\n      if (platform$2.browser.isChrome() || platform$2.browser.isSafari() || platform$2.browser.isFirefox() || platform$2.browser.isEdge()) {\n        return direction.otherRetry(bridge, box);\n      } else if (platform$2.browser.isIE()) {\n        return direction.ieRetry(bridge, box);\n      } else {\n        return Option.none();\n      }\n    };\n    var tryCursor = function (bridge, isRoot, element, offset, direction) {\n      return Rectangles.getBoxAt(bridge, element, offset).bind(function (box) {\n        return tryAt(bridge, direction, box);\n      });\n    };\n    var handle$2 = function (bridge, isRoot, direction) {\n      return findSpot(bridge, isRoot, direction).bind(function (spot) {\n        return scan(bridge, isRoot, spot.element(), spot.offset(), direction, MAX_RETRIES).map(bridge.fromSitus);\n      });\n    };\n    var TableKeys = { handle: handle$2 };\n\n    var detection = detect$3();\n    var inSameTable = function (elem, table) {\n      return ancestor$2(elem, function (e) {\n        return parent(e).exists(function (p) {\n          return eq(p, table);\n        });\n      });\n    };\n    var simulate = function (bridge, isRoot, direction, initial, anchor) {\n      return closest$1(initial, 'td,th', isRoot).bind(function (start) {\n        return closest$1(start, 'table', isRoot).bind(function (table) {\n          if (!inSameTable(anchor, table)) {\n            return Option.none();\n          }\n          return TableKeys.handle(bridge, isRoot, direction).bind(function (range) {\n            return closest$1(range.finish(), 'td,th', isRoot).map(function (finish) {\n              return {\n                start: constant(start),\n                finish: constant(finish),\n                range: constant(range)\n              };\n            });\n          });\n        });\n      });\n    };\n    var navigate = function (bridge, isRoot, direction, initial, anchor, precheck) {\n      if (detection.browser.isIE()) {\n        return Option.none();\n      } else {\n        return precheck(initial, isRoot).orThunk(function () {\n          return simulate(bridge, isRoot, direction, initial, anchor).map(function (info) {\n            var range = info.range();\n            return Response.create(Option.some(Util.makeSitus(range.start(), range.soffset(), range.finish(), range.foffset())), true);\n          });\n        });\n      }\n    };\n    var firstUpCheck = function (initial, isRoot) {\n      return closest$1(initial, 'tr', isRoot).bind(function (startRow) {\n        return closest$1(startRow, 'table', isRoot).bind(function (table) {\n          var rows = descendants$1(table, 'tr');\n          if (eq(startRow, rows[0])) {\n            return seekLeft$1(table, function (element) {\n              return last$1(element).isSome();\n            }, isRoot).map(function (last) {\n              var lastOffset = getEnd(last);\n              return Response.create(Option.some(Util.makeSitus(last, lastOffset, last, lastOffset)), true);\n            });\n          } else {\n            return Option.none();\n          }\n        });\n      });\n    };\n    var lastDownCheck = function (initial, isRoot) {\n      return closest$1(initial, 'tr', isRoot).bind(function (startRow) {\n        return closest$1(startRow, 'table', isRoot).bind(function (table) {\n          var rows = descendants$1(table, 'tr');\n          if (eq(startRow, rows[rows.length - 1])) {\n            return seekRight$1(table, function (element) {\n              return first(element).isSome();\n            }, isRoot).map(function (first) {\n              return Response.create(Option.some(Util.makeSitus(first, 0, first, 0)), true);\n            });\n          } else {\n            return Option.none();\n          }\n        });\n      });\n    };\n    var select = function (bridge, container, isRoot, direction, initial, anchor, selectRange) {\n      return simulate(bridge, isRoot, direction, initial, anchor).bind(function (info) {\n        return KeySelection.detect(container, isRoot, info.start(), info.finish(), selectRange);\n      });\n    };\n    var VerticalMovement = {\n      navigate: navigate,\n      select: select,\n      firstUpCheck: firstUpCheck,\n      lastDownCheck: lastDownCheck\n    };\n\n    var findCell = function (target, isRoot) {\n      return closest$1(target, 'td,th', isRoot);\n    };\n    function MouseSelection (bridge, container, isRoot, annotations) {\n      var cursor = Option.none();\n      var clearState = function () {\n        cursor = Option.none();\n      };\n      var mousedown = function (event) {\n        annotations.clear(container);\n        cursor = findCell(event.target(), isRoot);\n      };\n      var mouseover = function (event) {\n        cursor.each(function (start) {\n          annotations.clearBeforeUpdate(container);\n          findCell(event.target(), isRoot).each(function (finish) {\n            CellSelection.identify(start, finish, isRoot).each(function (cellSel) {\n              var boxes = cellSel.boxes().getOr([]);\n              if (boxes.length > 1 || boxes.length === 1 && !eq(start, finish)) {\n                annotations.selectRange(container, boxes, cellSel.start(), cellSel.finish());\n                bridge.selectContents(finish);\n              }\n            });\n          });\n        });\n      };\n      var mouseup = function (_event) {\n        cursor.each(clearState);\n      };\n      return {\n        mousedown: mousedown,\n        mouseover: mouseover,\n        mouseup: mouseup\n      };\n    }\n\n    var down = {\n      traverse: nextSibling,\n      gather: after$5,\n      relative: Situ.before,\n      otherRetry: Retries.tryDown,\n      ieRetry: Retries.ieTryDown,\n      failure: BeforeAfter.failedDown\n    };\n    var up = {\n      traverse: prevSibling,\n      gather: before$4,\n      relative: Situ.before,\n      otherRetry: Retries.tryUp,\n      ieRetry: Retries.ieTryUp,\n      failure: BeforeAfter.failedUp\n    };\n    var KeyDirection = {\n      down: down,\n      up: up\n    };\n\n    var isKey = function (key) {\n      return function (keycode) {\n        return keycode === key;\n      };\n    };\n    var isUp = isKey(38);\n    var isDown = isKey(40);\n    var isNavigation = function (keycode) {\n      return keycode >= 37 && keycode <= 40;\n    };\n    var SelectionKeys = {\n      ltr: {\n        isBackward: isKey(37),\n        isForward: isKey(39)\n      },\n      rtl: {\n        isBackward: isKey(39),\n        isForward: isKey(37)\n      },\n      isUp: isUp,\n      isDown: isDown,\n      isNavigation: isNavigation\n    };\n\n    var toRaw = function (sr) {\n      return {\n        left: sr.left(),\n        top: sr.top(),\n        right: sr.right(),\n        bottom: sr.bottom(),\n        width: sr.width(),\n        height: sr.height()\n      };\n    };\n    var Rect = { toRaw: toRaw };\n\n    var isSafari = detect$3().browser.isSafari();\n    var get$b = function (_DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom() : domGlobals.document;\n      var x = doc.body.scrollLeft || doc.documentElement.scrollLeft;\n      var y = doc.body.scrollTop || doc.documentElement.scrollTop;\n      return Position(x, y);\n    };\n    var by = function (x, y, _DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom() : domGlobals.document;\n      var win = doc.defaultView;\n      win.scrollBy(x, y);\n    };\n\n    var WindowBridge = function (win) {\n      var elementFromPoint = function (x, y) {\n        return Element.fromPoint(Element.fromDom(win.document), x, y);\n      };\n      var getRect = function (element) {\n        return element.dom().getBoundingClientRect();\n      };\n      var getRangedRect = function (start, soffset, finish, foffset) {\n        var sel = Selection.exact(start, soffset, finish, foffset);\n        return getFirstRect$1(win, sel).map(Rect.toRaw);\n      };\n      var getSelection = function () {\n        return get$a(win).map(function (exactAdt) {\n          return Util.convertToRange(win, exactAdt);\n        });\n      };\n      var fromSitus = function (situs) {\n        var relative = Selection.relative(situs.start(), situs.finish());\n        return Util.convertToRange(win, relative);\n      };\n      var situsFromPoint = function (x, y) {\n        return getAtPoint(win, x, y).map(function (exact) {\n          return Situs.create(exact.start(), exact.soffset(), exact.finish(), exact.foffset());\n        });\n      };\n      var clearSelection = function () {\n        clear(win);\n      };\n      var selectContents = function (element) {\n        setToElement(win, element);\n      };\n      var setSelection = function (sel) {\n        setExact(win, sel.start(), sel.soffset(), sel.finish(), sel.foffset());\n      };\n      var setRelativeSelection = function (start, finish) {\n        setRelative(win, start, finish);\n      };\n      var getInnerHeight = function () {\n        return win.innerHeight;\n      };\n      var getScrollY = function () {\n        var pos = get$b(Element.fromDom(win.document));\n        return pos.top();\n      };\n      var scrollBy = function (x, y) {\n        by(x, y, Element.fromDom(win.document));\n      };\n      return {\n        elementFromPoint: elementFromPoint,\n        getRect: getRect,\n        getRangedRect: getRangedRect,\n        getSelection: getSelection,\n        fromSitus: fromSitus,\n        situsFromPoint: situsFromPoint,\n        clearSelection: clearSelection,\n        setSelection: setSelection,\n        setRelativeSelection: setRelativeSelection,\n        selectContents: selectContents,\n        getInnerHeight: getInnerHeight,\n        getScrollY: getScrollY,\n        scrollBy: scrollBy\n      };\n    };\n\n    var rc = Immutable('rows', 'cols');\n    var mouse = function (win, container, isRoot, annotations) {\n      var bridge = WindowBridge(win);\n      var handlers = MouseSelection(bridge, container, isRoot, annotations);\n      return {\n        mousedown: handlers.mousedown,\n        mouseover: handlers.mouseover,\n        mouseup: handlers.mouseup\n      };\n    };\n    var keyboard = function (win, container, isRoot, annotations) {\n      var bridge = WindowBridge(win);\n      var clearToNavigate = function () {\n        annotations.clear(container);\n        return Option.none();\n      };\n      var keydown = function (event, start, soffset, finish, foffset, direction) {\n        var realEvent = event.raw();\n        var keycode = realEvent.which;\n        var shiftKey = realEvent.shiftKey === true;\n        var handler = CellSelection.retrieve(container, annotations.selectedSelector()).fold(function () {\n          if (SelectionKeys.isDown(keycode) && shiftKey) {\n            return curry(VerticalMovement.select, bridge, container, isRoot, KeyDirection.down, finish, start, annotations.selectRange);\n          } else if (SelectionKeys.isUp(keycode) && shiftKey) {\n            return curry(VerticalMovement.select, bridge, container, isRoot, KeyDirection.up, finish, start, annotations.selectRange);\n          } else if (SelectionKeys.isDown(keycode)) {\n            return curry(VerticalMovement.navigate, bridge, isRoot, KeyDirection.down, finish, start, VerticalMovement.lastDownCheck);\n          } else if (SelectionKeys.isUp(keycode)) {\n            return curry(VerticalMovement.navigate, bridge, isRoot, KeyDirection.up, finish, start, VerticalMovement.firstUpCheck);\n          } else {\n            return Option.none;\n          }\n        }, function (selected) {\n          var update = function (attempts) {\n            return function () {\n              var navigation = findMap(attempts, function (delta) {\n                return KeySelection.update(delta.rows(), delta.cols(), container, selected, annotations);\n              });\n              return navigation.fold(function () {\n                return CellSelection.getEdges(container, annotations.firstSelectedSelector(), annotations.lastSelectedSelector()).map(function (edges) {\n                  var relative = SelectionKeys.isDown(keycode) || direction.isForward(keycode) ? Situ.after : Situ.before;\n                  bridge.setRelativeSelection(Situ.on(edges.first(), 0), relative(edges.table()));\n                  annotations.clear(container);\n                  return Response.create(Option.none(), true);\n                });\n              }, function (_) {\n                return Option.some(Response.create(Option.none(), true));\n              });\n            };\n          };\n          if (SelectionKeys.isDown(keycode) && shiftKey) {\n            return update([rc(+1, 0)]);\n          } else if (SelectionKeys.isUp(keycode) && shiftKey) {\n            return update([rc(-1, 0)]);\n          } else if (direction.isBackward(keycode) && shiftKey) {\n            return update([\n              rc(0, -1),\n              rc(-1, 0)\n            ]);\n          } else if (direction.isForward(keycode) && shiftKey) {\n            return update([\n              rc(0, +1),\n              rc(+1, 0)\n            ]);\n          } else if (SelectionKeys.isNavigation(keycode) && shiftKey === false) {\n            return clearToNavigate;\n          } else {\n            return Option.none;\n          }\n        });\n        return handler();\n      };\n      var keyup = function (event, start, soffset, finish, foffset) {\n        return CellSelection.retrieve(container, annotations.selectedSelector()).fold(function () {\n          var realEvent = event.raw();\n          var keycode = realEvent.which;\n          var shiftKey = realEvent.shiftKey === true;\n          if (shiftKey === false) {\n            return Option.none();\n          }\n          if (SelectionKeys.isNavigation(keycode)) {\n            return KeySelection.sync(container, isRoot, start, soffset, finish, foffset, annotations.selectRange);\n          } else {\n            return Option.none();\n          }\n        }, Option.none);\n      };\n      return {\n        keydown: keydown,\n        keyup: keyup\n      };\n    };\n    var platform$3 = detect$3();\n    var external = function (win, container, isRoot, annotations) {\n      var bridge = WindowBridge(win);\n      return function (start, finish) {\n        annotations.clearBeforeUpdate(container);\n        CellSelection.identify(start, finish, isRoot).each(function (cellSel) {\n          var boxes = cellSel.boxes().getOr([]);\n          annotations.selectRange(container, boxes, cellSel.start(), cellSel.finish());\n          if (platform$3.deviceType.isTouch()) {\n            bridge.clearSelection();\n          } else {\n            bridge.selectContents(finish);\n          }\n        });\n      };\n    };\n    var InputHandlers = {\n      mouse: mouse,\n      keyboard: keyboard,\n      external: external\n    };\n\n    var remove$7 = function (element, classes) {\n      each(classes, function (x) {\n        remove$5(element, x);\n      });\n    };\n\n    var addClass = function (clazz) {\n      return function (element) {\n        add$2(element, clazz);\n      };\n    };\n    var removeClasses = function (classes) {\n      return function (element) {\n        remove$7(element, classes);\n      };\n    };\n\n    var byClass = function (ephemera) {\n      var addSelectionClass = addClass(ephemera.selected());\n      var removeSelectionClasses = removeClasses([\n        ephemera.selected(),\n        ephemera.lastSelected(),\n        ephemera.firstSelected()\n      ]);\n      var clear = function (container) {\n        var sels = descendants$1(container, ephemera.selectedSelector());\n        each(sels, removeSelectionClasses);\n      };\n      var selectRange = function (container, cells, start, finish) {\n        clear(container);\n        each(cells, addSelectionClass);\n        add$2(start, ephemera.firstSelected());\n        add$2(finish, ephemera.lastSelected());\n      };\n      return {\n        clearBeforeUpdate: clear,\n        clear: clear,\n        selectRange: selectRange,\n        selectedSelector: ephemera.selectedSelector,\n        firstSelectedSelector: ephemera.firstSelectedSelector,\n        lastSelectedSelector: ephemera.lastSelectedSelector\n      };\n    };\n    var byAttr = function (ephemera, onSelection, onClear) {\n      var removeSelectionAttributes = function (element) {\n        remove(element, ephemera.selected());\n        remove(element, ephemera.firstSelected());\n        remove(element, ephemera.lastSelected());\n      };\n      var addSelectionAttribute = function (element) {\n        set(element, ephemera.selected(), '1');\n      };\n      var clear = function (container) {\n        clearBeforeUpdate(container);\n        onClear();\n      };\n      var clearBeforeUpdate = function (container) {\n        var sels = descendants$1(container, ephemera.selectedSelector());\n        each(sels, removeSelectionAttributes);\n      };\n      var selectRange = function (container, cells, start, finish) {\n        clear(container);\n        each(cells, addSelectionAttribute);\n        set(start, ephemera.firstSelected(), '1');\n        set(finish, ephemera.lastSelected(), '1');\n        onSelection(cells, start, finish);\n      };\n      return {\n        clearBeforeUpdate: clearBeforeUpdate,\n        clear: clear,\n        selectRange: selectRange,\n        selectedSelector: ephemera.selectedSelector,\n        firstSelectedSelector: ephemera.firstSelectedSelector,\n        lastSelectedSelector: ephemera.lastSelectedSelector\n      };\n    };\n    var SelectionAnnotation = {\n      byClass: byClass,\n      byAttr: byAttr\n    };\n\n    var getUpOrLeftCells = function (grid, selectedCells, generators) {\n      var upGrid = grid.slice(0, selectedCells[selectedCells.length - 1].row() + 1);\n      var upDetails = toDetailList(upGrid, generators);\n      return bind(upDetails, function (detail) {\n        var slicedCells = detail.cells().slice(0, selectedCells[selectedCells.length - 1].column() + 1);\n        return map(slicedCells, function (cell) {\n          return cell.element();\n        });\n      });\n    };\n    var getDownOrRightCells = function (grid, selectedCells, generators) {\n      var downGrid = grid.slice(selectedCells[0].row() + selectedCells[0].rowspan() - 1, grid.length);\n      var downDetails = toDetailList(downGrid, generators);\n      return bind(downDetails, function (detail) {\n        var slicedCells = detail.cells().slice(selectedCells[0].column() + selectedCells[0].colspan() - 1, +detail.cells().length);\n        return map(slicedCells, function (cell) {\n          return cell.element();\n        });\n      });\n    };\n    var getOtherCells = function (table, target, generators) {\n      var list = DetailsList.fromTable(table);\n      var house = Warehouse.generate(list);\n      var details = onCells(house, target);\n      return details.map(function (selectedCells) {\n        var grid = Transitions.toGrid(house, generators, false);\n        var upOrLeftCells = getUpOrLeftCells(grid, selectedCells, generators);\n        var downOrRightCells = getDownOrRightCells(grid, selectedCells, generators);\n        return {\n          upOrLeftCells: upOrLeftCells,\n          downOrRightCells: downOrRightCells\n        };\n      });\n    };\n    var OtherCells = { getOtherCells: getOtherCells };\n\n    var hasInternalTarget = function (e) {\n      return has$2(Element.fromDom(e.target), 'ephox-snooker-resizer-bar') === false;\n    };\n    function CellSelection$1 (editor, lazyResize, selectionTargets) {\n      var handlerStruct = MixedBag([\n        'mousedown',\n        'mouseover',\n        'mouseup',\n        'keyup',\n        'keydown'\n      ], []);\n      var handlers = Option.none();\n      var cloneFormats = getCloneElements(editor);\n      var onSelection = function (cells, start, finish) {\n        selectionTargets.targets().each(function (targets) {\n          var tableOpt = TableLookup.table(start);\n          tableOpt.each(function (table) {\n            var doc = Element.fromDom(editor.getDoc());\n            var generators = TableFill.cellOperations(noop, doc, cloneFormats);\n            var otherCells = OtherCells.getOtherCells(table, targets, generators);\n            fireTableSelectionChange(editor, cells, start, finish, otherCells);\n          });\n        });\n      };\n      var onClear = function () {\n        fireTableSelectionClear(editor);\n      };\n      var annotations = SelectionAnnotation.byAttr(Ephemera, onSelection, onClear);\n      editor.on('init', function (e) {\n        var win = editor.getWin();\n        var body = getBody$1(editor);\n        var isRoot = getIsRoot(editor);\n        var syncSelection = function () {\n          var sel = editor.selection;\n          var start = Element.fromDom(sel.getStart());\n          var end = Element.fromDom(sel.getEnd());\n          var shared = DomParent.sharedOne(TableLookup.table, [\n            start,\n            end\n          ]);\n          shared.fold(function () {\n            annotations.clear(body);\n          }, noop);\n        };\n        var mouseHandlers = InputHandlers.mouse(win, body, isRoot, annotations);\n        var keyHandlers = InputHandlers.keyboard(win, body, isRoot, annotations);\n        var external = InputHandlers.external(win, body, isRoot, annotations);\n        var hasShiftKey = function (event) {\n          return event.raw().shiftKey === true;\n        };\n        editor.on('tableselectorchange', function (e) {\n          external(e.start, e.finish);\n        });\n        var handleResponse = function (event, response) {\n          if (!hasShiftKey(event)) {\n            return;\n          }\n          if (response.kill()) {\n            event.kill();\n          }\n          response.selection().each(function (ns) {\n            var relative = Selection.relative(ns.start(), ns.finish());\n            var rng = asLtrRange(win, relative);\n            editor.selection.setRng(rng);\n          });\n        };\n        var keyup = function (event) {\n          var wrappedEvent = wrapEvent(event);\n          if (wrappedEvent.raw().shiftKey && SelectionKeys.isNavigation(wrappedEvent.raw().which)) {\n            var rng = editor.selection.getRng();\n            var start = Element.fromDom(rng.startContainer);\n            var end = Element.fromDom(rng.endContainer);\n            keyHandlers.keyup(wrappedEvent, start, rng.startOffset, end, rng.endOffset).each(function (response) {\n              handleResponse(wrappedEvent, response);\n            });\n          }\n        };\n        var keydown = function (event) {\n          var wrappedEvent = wrapEvent(event);\n          lazyResize().each(function (resize) {\n            resize.hideBars();\n          });\n          var rng = editor.selection.getRng();\n          var startContainer = Element.fromDom(editor.selection.getStart());\n          var start = Element.fromDom(rng.startContainer);\n          var end = Element.fromDom(rng.endContainer);\n          var direction = Direction.directionAt(startContainer).isRtl() ? SelectionKeys.rtl : SelectionKeys.ltr;\n          keyHandlers.keydown(wrappedEvent, start, rng.startOffset, end, rng.endOffset, direction).each(function (response) {\n            handleResponse(wrappedEvent, response);\n          });\n          lazyResize().each(function (resize) {\n            resize.showBars();\n          });\n        };\n        var isMouseEvent = function (event) {\n          return event.hasOwnProperty('x') && event.hasOwnProperty('y');\n        };\n        var wrapEvent = function (event) {\n          var target = Element.fromDom(event.target);\n          var stop = function () {\n            event.stopPropagation();\n          };\n          var prevent = function () {\n            event.preventDefault();\n          };\n          var kill = compose(prevent, stop);\n          return {\n            target: constant(target),\n            x: constant(isMouseEvent(event) ? event.x : null),\n            y: constant(isMouseEvent(event) ? event.y : null),\n            stop: stop,\n            prevent: prevent,\n            kill: kill,\n            raw: constant(event)\n          };\n        };\n        var isLeftMouse = function (raw) {\n          return raw.button === 0;\n        };\n        var isLeftButtonPressed = function (raw) {\n          if (raw.buttons === undefined) {\n            return true;\n          }\n          return (raw.buttons & 1) !== 0;\n        };\n        var mouseDown = function (e) {\n          if (isLeftMouse(e) && hasInternalTarget(e)) {\n            mouseHandlers.mousedown(wrapEvent(e));\n          }\n        };\n        var mouseOver = function (e) {\n          if (isLeftButtonPressed(e) && hasInternalTarget(e)) {\n            mouseHandlers.mouseover(wrapEvent(e));\n          }\n        };\n        var mouseUp = function (e) {\n          if (isLeftMouse(e) && hasInternalTarget(e)) {\n            mouseHandlers.mouseup(wrapEvent(e));\n          }\n        };\n        var getDoubleTap = function () {\n          var lastTarget = Cell(Element.fromDom(body));\n          var lastTimeStamp = Cell(0);\n          var touchEnd = function (t) {\n            var target = Element.fromDom(t.target);\n            if (name(target) === 'td' || name(target) === 'th') {\n              var lT = lastTarget.get();\n              var lTS = lastTimeStamp.get();\n              if (eq(lT, target) && t.timeStamp - lTS < 300) {\n                t.preventDefault();\n                external(target, target);\n              }\n            }\n            lastTarget.set(target);\n            lastTimeStamp.set(t.timeStamp);\n          };\n          return { touchEnd: touchEnd };\n        };\n        var doubleTap = getDoubleTap();\n        editor.on('mousedown', mouseDown);\n        editor.on('mouseover', mouseOver);\n        editor.on('mouseup', mouseUp);\n        editor.on('touchend', doubleTap.touchEnd);\n        editor.on('keyup', keyup);\n        editor.on('keydown', keydown);\n        editor.on('NodeChange', syncSelection);\n        handlers = Option.some(handlerStruct({\n          mousedown: mouseDown,\n          mouseover: mouseOver,\n          mouseup: mouseUp,\n          keyup: keyup,\n          keydown: keydown\n        }));\n      });\n      var destroy = function () {\n        handlers.each(function (handlers) {\n        });\n      };\n      return {\n        clear: annotations.clear,\n        destroy: destroy\n      };\n    }\n\n    var Selections = function (editor) {\n      var get = function () {\n        var body = getBody$1(editor);\n        return TableSelection.retrieve(body, Ephemera.selectedSelector()).fold(function () {\n          if (editor.selection.getStart() === undefined) {\n            return SelectionTypes.none();\n          } else {\n            return SelectionTypes.single(editor.selection);\n          }\n        }, function (cells) {\n          return SelectionTypes.multiple(cells);\n        });\n      };\n      return { get: get };\n    };\n\n    var getSelectionTargets = function (editor, selections) {\n      var targets = Cell(Option.none());\n      var changeHandlers = Cell([]);\n      var findTargets = function () {\n        return getSelectionStartCellOrCaption(editor).bind(function (cellOrCaption) {\n          var table = TableLookup.table(cellOrCaption);\n          return table.map(function (table) {\n            if (name(cellOrCaption) === 'caption') {\n              return TableTargets.notCell(cellOrCaption);\n            } else {\n              return TableTargets.forMenu(selections, table, cellOrCaption);\n            }\n          });\n        });\n      };\n      var resetTargets = function () {\n        targets.set(cached(findTargets)());\n        each(changeHandlers.get(), function (handler) {\n          return handler();\n        });\n      };\n      var onSetup = function (api, isDisabled) {\n        var handler = function () {\n          return targets.get().fold(function () {\n            api.setDisabled(true);\n          }, function (targets) {\n            api.setDisabled(isDisabled(targets));\n          });\n        };\n        handler();\n        changeHandlers.set(changeHandlers.get().concat([handler]));\n        return function () {\n          changeHandlers.set(filter(changeHandlers.get(), function (h) {\n            return h !== handler;\n          }));\n        };\n      };\n      var onSetupTable = function (api) {\n        return onSetup(api, function (_) {\n          return false;\n        });\n      };\n      var onSetupCellOrRow = function (api) {\n        return onSetup(api, function (targets) {\n          return name(targets.element()) === 'caption';\n        });\n      };\n      var onSetupMergeable = function (api) {\n        return onSetup(api, function (targets) {\n          return targets.mergable().isNone();\n        });\n      };\n      var onSetupUnmergeable = function (api) {\n        return onSetup(api, function (targets) {\n          return targets.unmergable().isNone();\n        });\n      };\n      editor.on('NodeChange', resetTargets);\n      return {\n        onSetupTable: onSetupTable,\n        onSetupCellOrRow: onSetupCellOrRow,\n        onSetupMergeable: onSetupMergeable,\n        onSetupUnmergeable: onSetupUnmergeable,\n        resetTargets: resetTargets,\n        targets: function () {\n          return targets.get();\n        }\n      };\n    };\n\n    var addButtons = function (editor, selectionTargets) {\n      editor.ui.registry.addMenuButton('table', {\n        tooltip: 'Table',\n        icon: 'table',\n        fetch: function (callback) {\n          return callback('inserttable tableprops deletetable | cell row column');\n        }\n      });\n      var cmd = function (command) {\n        return function () {\n          return editor.execCommand(command);\n        };\n      };\n      editor.ui.registry.addButton('tableprops', {\n        tooltip: 'Table properties',\n        onAction: cmd('mceTableProps'),\n        icon: 'table',\n        onSetup: selectionTargets.onSetupTable\n      });\n      editor.ui.registry.addButton('tabledelete', {\n        tooltip: 'Delete table',\n        onAction: cmd('mceTableDelete'),\n        icon: 'table-delete-table',\n        onSetup: selectionTargets.onSetupTable\n      });\n      editor.ui.registry.addButton('tablecellprops', {\n        tooltip: 'Cell properties',\n        onAction: cmd('mceTableCellProps'),\n        icon: 'table-cell-properties',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tablemergecells', {\n        tooltip: 'Merge cells',\n        onAction: cmd('mceTableMergeCells'),\n        icon: 'table-merge-cells',\n        onSetup: selectionTargets.onSetupMergeable\n      });\n      editor.ui.registry.addButton('tablesplitcells', {\n        tooltip: 'Split cell',\n        onAction: cmd('mceTableSplitCells'),\n        icon: 'table-split-cells',\n        onSetup: selectionTargets.onSetupUnmergeable\n      });\n      editor.ui.registry.addButton('tableinsertrowbefore', {\n        tooltip: 'Insert row before',\n        onAction: cmd('mceTableInsertRowBefore'),\n        icon: 'table-insert-row-above',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tableinsertrowafter', {\n        tooltip: 'Insert row after',\n        onAction: cmd('mceTableInsertRowAfter'),\n        icon: 'table-insert-row-after',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tabledeleterow', {\n        tooltip: 'Delete row',\n        onAction: cmd('mceTableDeleteRow'),\n        icon: 'table-delete-row',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tablerowprops', {\n        tooltip: 'Row properties',\n        onAction: cmd('mceTableRowProps'),\n        icon: 'table-row-properties',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tableinsertcolbefore', {\n        tooltip: 'Insert column before',\n        onAction: cmd('mceTableInsertColBefore'),\n        icon: 'table-insert-column-before',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tableinsertcolafter', {\n        tooltip: 'Insert column after',\n        onAction: cmd('mceTableInsertColAfter'),\n        icon: 'table-insert-column-after',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tabledeletecol', {\n        tooltip: 'Delete column',\n        onAction: cmd('mceTableDeleteCol'),\n        icon: 'table-delete-column',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tablecutrow', {\n        tooltip: 'Cut row',\n        onAction: cmd('mceTableCutRow'),\n        icon: 'temporary-placeholder',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tablecopyrow', {\n        tooltip: 'Copy row',\n        onAction: cmd('mceTableCopyRow'),\n        icon: 'temporary-placeholder',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tablepasterowbefore', {\n        tooltip: 'Paste row before',\n        onAction: cmd('mceTablePasteRowBefore'),\n        icon: 'temporary-placeholder',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tablepasterowafter', {\n        tooltip: 'Paste row after',\n        onAction: cmd('mceTablePasteRowAfter'),\n        icon: 'temporary-placeholder',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tableinsertdialog', {\n        tooltip: 'Insert table',\n        onAction: cmd('mceInsertTable'),\n        icon: 'table'\n      });\n    };\n    var addToolbars = function (editor) {\n      var isTable = function (table) {\n        return editor.dom.is(table, 'table') && editor.getBody().contains(table);\n      };\n      var toolbar = getToolbar(editor);\n      if (toolbar.length > 0) {\n        editor.ui.registry.addContextToolbar('table', {\n          predicate: isTable,\n          items: toolbar,\n          scope: 'node',\n          position: 'node'\n        });\n      }\n    };\n    var Buttons = {\n      addButtons: addButtons,\n      addToolbars: addToolbars\n    };\n\n    var addMenuItems = function (editor, selectionTargets) {\n      var cmd = function (command) {\n        return function () {\n          return editor.execCommand(command);\n        };\n      };\n      var insertTableAction = function (_a) {\n        var numRows = _a.numRows, numColumns = _a.numColumns;\n        editor.undoManager.transact(function () {\n          InsertTable.insert(editor, numColumns, numRows);\n        });\n        editor.addVisual();\n      };\n      var tableProperties = {\n        text: 'Table properties',\n        onSetup: selectionTargets.onSetupTable,\n        onAction: cmd('mceTableProps')\n      };\n      var deleteTable = {\n        text: 'Delete table',\n        icon: 'table-delete-table',\n        onSetup: selectionTargets.onSetupTable,\n        onAction: cmd('mceTableDelete')\n      };\n      var rowItems = [\n        {\n          type: 'menuitem',\n          text: 'Insert row before',\n          icon: 'table-insert-row-above',\n          onAction: cmd('mceTableInsertRowBefore'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        },\n        {\n          type: 'menuitem',\n          text: 'Insert row after',\n          icon: 'table-insert-row-after',\n          onAction: cmd('mceTableInsertRowAfter'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        },\n        {\n          type: 'menuitem',\n          text: 'Delete row',\n          icon: 'table-delete-row',\n          onAction: cmd('mceTableDeleteRow'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        },\n        {\n          type: 'menuitem',\n          text: 'Row properties',\n          icon: 'table-row-properties',\n          onAction: cmd('mceTableRowProps'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        },\n        { type: 'separator' },\n        {\n          type: 'menuitem',\n          text: 'Cut row',\n          onAction: cmd('mceTableCutRow'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        },\n        {\n          type: 'menuitem',\n          text: 'Copy row',\n          onAction: cmd('mceTableCopyRow'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        },\n        {\n          type: 'menuitem',\n          text: 'Paste row before',\n          onAction: cmd('mceTablePasteRowBefore'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        },\n        {\n          type: 'menuitem',\n          text: 'Paste row after',\n          onAction: cmd('mceTablePasteRowAfter'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        }\n      ];\n      var row = {\n        type: 'nestedmenuitem',\n        text: 'Row',\n        getSubmenuItems: function () {\n          return rowItems;\n        }\n      };\n      var columnItems = [\n        {\n          type: 'menuitem',\n          text: 'Insert column before',\n          icon: 'table-insert-column-before',\n          onAction: cmd('mceTableInsertColBefore'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        },\n        {\n          type: 'menuitem',\n          text: 'Insert column after',\n          icon: 'table-insert-column-after',\n          onAction: cmd('mceTableInsertColAfter'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        },\n        {\n          type: 'menuitem',\n          text: 'Delete column',\n          icon: 'table-delete-column',\n          onAction: cmd('mceTableDeleteCol'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        }\n      ];\n      var column = {\n        type: 'nestedmenuitem',\n        text: 'Column',\n        getSubmenuItems: function () {\n          return columnItems;\n        }\n      };\n      var cellItems = [\n        {\n          type: 'menuitem',\n          text: 'Cell properties',\n          icon: 'table-cell-properties',\n          onAction: cmd('mceTableCellProps'),\n          onSetup: selectionTargets.onSetupCellOrRow\n        },\n        {\n          type: 'menuitem',\n          text: 'Merge cells',\n          icon: 'table-merge-cells',\n          onAction: cmd('mceTableMergeCells'),\n          onSetup: selectionTargets.onSetupMergeable\n        },\n        {\n          type: 'menuitem',\n          text: 'Split cell',\n          icon: 'table-split-cells',\n          onAction: cmd('mceTableSplitCells'),\n          onSetup: selectionTargets.onSetupUnmergeable\n        }\n      ];\n      var cell = {\n        type: 'nestedmenuitem',\n        text: 'Cell',\n        getSubmenuItems: function () {\n          return cellItems;\n        }\n      };\n      if (hasTableGrid(editor) === false) {\n        editor.ui.registry.addMenuItem('inserttable', {\n          text: 'Table',\n          icon: 'table',\n          onAction: cmd('mceInsertTable')\n        });\n      } else {\n        editor.ui.registry.addNestedMenuItem('inserttable', {\n          text: 'Table',\n          icon: 'table',\n          getSubmenuItems: function () {\n            return [{\n                type: 'fancymenuitem',\n                fancytype: 'inserttable',\n                onAction: insertTableAction\n              }];\n          }\n        });\n      }\n      editor.ui.registry.addMenuItem('inserttabledialog', {\n        text: 'Insert table',\n        icon: 'table',\n        onAction: cmd('mceInsertTable')\n      });\n      editor.ui.registry.addMenuItem('tableprops', tableProperties);\n      editor.ui.registry.addMenuItem('deletetable', deleteTable);\n      editor.ui.registry.addNestedMenuItem('row', row);\n      editor.ui.registry.addNestedMenuItem('column', column);\n      editor.ui.registry.addNestedMenuItem('cell', cell);\n      editor.ui.registry.addContextMenu('table', {\n        update: function () {\n          selectionTargets.resetTargets();\n          return selectionTargets.targets().fold(function () {\n            return '';\n          }, function (targets) {\n            if (name(targets.element()) === 'caption') {\n              return 'tableprops deletetable';\n            } else {\n              return 'cell row column | tableprops deletetable';\n            }\n          });\n        }\n      });\n      return {\n        rowItems: rowItems,\n        columnItems: columnItems,\n        cellItems: cellItems\n      };\n    };\n    var MenuItems = { addMenuItems: addMenuItems };\n\n    var getClipboardRows = function (clipboardRows) {\n      return clipboardRows.get().fold(function () {\n        return;\n      }, function (rows) {\n        return map(rows, function (row) {\n          return row.dom();\n        });\n      });\n    };\n    var setClipboardRows = function (rows, clipboardRows) {\n      var sugarRows = map(rows, Element.fromDom);\n      clipboardRows.set(Option.from(sugarRows));\n    };\n    var getApi = function (editor, clipboardRows, resizeHandler, selectionTargets, menuItems) {\n      return {\n        insertTable: function (columns, rows) {\n          return InsertTable.insert(editor, columns, rows);\n        },\n        setClipboardRows: function (rows) {\n          return setClipboardRows(rows, clipboardRows);\n        },\n        getClipboardRows: function () {\n          return getClipboardRows(clipboardRows);\n        },\n        resizeHandler: resizeHandler,\n        menuItems: menuItems,\n        selectionTargets: selectionTargets\n      };\n    };\n\n    function Plugin(editor) {\n      var selections = Selections(editor);\n      var selectionTargets = getSelectionTargets(editor, selections);\n      var resizeHandler = getResizeHandler(editor);\n      var cellSelection = CellSelection$1(editor, resizeHandler.lazyResize, selectionTargets);\n      var actions = TableActions(editor, resizeHandler.lazyWire);\n      var clipboardRows = Cell(Option.none());\n      Commands.registerCommands(editor, actions, cellSelection, selections, clipboardRows);\n      Clipboard.registerEvents(editor, selections, actions, cellSelection);\n      var menuItems = MenuItems.addMenuItems(editor, selectionTargets);\n      Buttons.addButtons(editor, selectionTargets);\n      Buttons.addToolbars(editor);\n      editor.on('PreInit', function () {\n        editor.serializer.addTempAttr(Ephemera.firstSelected());\n        editor.serializer.addTempAttr(Ephemera.lastSelected());\n      });\n      if (hasTabNavigation(editor)) {\n        editor.on('keydown', function (e) {\n          TabContext.handle(e, editor, actions, resizeHandler.lazyWire);\n        });\n      }\n      editor.on('remove', function () {\n        resizeHandler.destroy();\n        cellSelection.destroy();\n      });\n      return getApi(editor, clipboardRows, resizeHandler, selectionTargets, menuItems);\n    }\n    function Plugin$1 () {\n      global.add('table', Plugin);\n    }\n\n    Plugin$1();\n\n}(window));\n"]}