{"version":3,"sources":["../../../../../public/js/plugins/emoticons/plugin.js"],"names":["domGlobals","global","tinymce","util","Tools","resolve","noop","constant","value","never","always","none","NONE","eq","o","isNone","call","thunk","id","n","me","fold","s","is","isSome","getOr","getOrThunk","getOrDie","msg","Error","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","Object","freeze","some","a","constant_a","self","f","v","elementEq","b","from","Option","typeOf","x","t","Array","prototype","isPrototypeOf","constructor","name","String","isType","type","isFunction","nativeSlice","slice","xs","pred","i","len","length","r","from$1","contains","str","substr","indexOf","emojiMatches","emoji","lowerCasePattern","title","toLowerCase","keywords","k","emojisFrom","list","pattern","maxResults","matches","reachedLimit","max","size","push","char","text","icon","init","editor","database","ui","registry","addAutocompleter","ch","columns","minChars","fetch","waitForLoad","then","candidates","listAll","onAction","autocompleteApi","rng","selection","setRng","insertContent","hide","Cell","initial","get","set","clone","last","fn","rate","timer","cancel","clearTimeout","throttle","args","_i","arguments","setTimeout","apply","insertEmoticon","hasOwnProperty","shallow","old","nu","baseMerge","merger","objects","ret","j","curObject","key","merge","keys","hasOwnProperty$1","obj","props","map$1","tupleMap","tuple","has","global$1","global$2","global$3","DEFAULT_ID","getEmoticonDatabaseUrl","pluginUrl","getParam","suffix","getEmoticonDatabaseId","getAppendedEmoticons","Settings","ALL_CATEGORY","categoryNameMap","symbols","people","animals_and_nature","food_and_drink","activity","travel_and_places","flags","user","translateCategory","categories","getUserDefinedEmoticons","userDefinedEmoticons","category","initDatabase","databaseUrl","databaseId","all","processEmojis","emojis","cats","everything","lib","entry","current","concat","on","load","userEmojis","err","console","log","listCategory","listCategories","hasLoaded","reject","numRetries","interval","setInterval","clearInterval","patternName","open","initialState","results","currentTab","scan","dialogApi","dialogData","getData","setData","updateFilter","searchField","label","resultsField","getInitialState","body","tabs","cat","items","initialData","onTabChange","details","newTabName","onChange","actionData","close","buttons","primary","windowManager","focus","block","redial","unblock","catch","level","Dialog","register","addButton","tooltip","addMenuItem","Buttons","Plugin","add","window"],"mappings":"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","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.1.0 (2019-10-17)\n */\n(function (domGlobals) {\n    'use strict';\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var noop = function () {\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      if (Object.freeze) {\n        Object.freeze(me);\n      }\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Option = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var typeOf = function (x) {\n      if (x === null) {\n        return 'null';\n      }\n      var t = typeof x;\n      if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      }\n      if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      }\n      return t;\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isFunction = isType('function');\n\n    var nativeSlice = Array.prototype.slice;\n    var exists = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n\n    var contains = function (str, substr) {\n      return str.indexOf(substr) !== -1;\n    };\n\n    var emojiMatches = function (emoji, lowerCasePattern) {\n      return contains(emoji.title.toLowerCase(), lowerCasePattern) || exists(emoji.keywords, function (k) {\n        return contains(k.toLowerCase(), lowerCasePattern);\n      });\n    };\n    var emojisFrom = function (list, pattern, maxResults) {\n      var matches = [];\n      var lowerCasePattern = pattern.toLowerCase();\n      var reachedLimit = maxResults.fold(function () {\n        return never;\n      }, function (max) {\n        return function (size) {\n          return size >= max;\n        };\n      });\n      for (var i = 0; i < list.length; i++) {\n        if (pattern.length === 0 || emojiMatches(list[i], lowerCasePattern)) {\n          matches.push({\n            value: list[i].char,\n            text: list[i].title,\n            icon: list[i].char\n          });\n          if (reachedLimit(matches.length)) {\n            break;\n          }\n        }\n      }\n      return matches;\n    };\n\n    var init = function (editor, database) {\n      editor.ui.registry.addAutocompleter('emoticons', {\n        ch: ':',\n        columns: 'auto',\n        minChars: 2,\n        fetch: function (pattern, maxResults) {\n          return database.waitForLoad().then(function () {\n            var candidates = database.listAll();\n            return emojisFrom(candidates, pattern, Option.some(maxResults));\n          });\n        },\n        onAction: function (autocompleteApi, rng, value) {\n          editor.selection.setRng(rng);\n          editor.insertContent(value);\n          autocompleteApi.hide();\n        }\n      });\n    };\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      var clone = function () {\n        return Cell(get());\n      };\n      return {\n        get: get,\n        set: set,\n        clone: clone\n      };\n    };\n\n    var last = function (fn, rate) {\n      var timer = null;\n      var cancel = function () {\n        if (timer !== null) {\n          domGlobals.clearTimeout(timer);\n          timer = null;\n        }\n      };\n      var throttle = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (timer !== null) {\n          domGlobals.clearTimeout(timer);\n        }\n        timer = domGlobals.setTimeout(function () {\n          fn.apply(null, args);\n          timer = null;\n        }, rate);\n      };\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n\n    var insertEmoticon = function (editor, ch) {\n      editor.insertContent(ch);\n    };\n\n    var hasOwnProperty = Object.prototype.hasOwnProperty;\n    var shallow = function (old, nu) {\n      return nu;\n    };\n    var baseMerge = function (merger) {\n      return function () {\n        var objects = new Array(arguments.length);\n        for (var i = 0; i < objects.length; i++) {\n          objects[i] = arguments[i];\n        }\n        if (objects.length === 0) {\n          throw new Error('Can\\'t merge zero objects');\n        }\n        var ret = {};\n        for (var j = 0; j < objects.length; j++) {\n          var curObject = objects[j];\n          for (var key in curObject) {\n            if (hasOwnProperty.call(curObject, key)) {\n              ret[key] = merger(ret[key], curObject[key]);\n            }\n          }\n        }\n        return ret;\n      };\n    };\n    var merge = baseMerge(shallow);\n\n    var keys = Object.keys;\n    var hasOwnProperty$1 = Object.hasOwnProperty;\n    var each = function (obj, f) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        f(x, i);\n      }\n    };\n    var map$1 = function (obj, f) {\n      return tupleMap(obj, function (x, i) {\n        return {\n          k: i,\n          v: f(x, i)\n        };\n      });\n    };\n    var tupleMap = function (obj, f) {\n      var r = {};\n      each(obj, function (x, i) {\n        var tuple = f(x, i);\n        r[tuple.k] = tuple.v;\n      });\n      return r;\n    };\n    var has = function (obj, key) {\n      return hasOwnProperty$1.call(obj, key);\n    };\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.Resource');\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.util.Delay');\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.util.Promise');\n\n    var DEFAULT_ID = 'tinymce.plugins.emoticons';\n    var getEmoticonDatabaseUrl = function (editor, pluginUrl) {\n      return editor.getParam('emoticons_database_url', pluginUrl + '/js/emojis' + editor.suffix + '.js');\n    };\n    var getEmoticonDatabaseId = function (editor) {\n      return editor.getParam('emoticons_database_id', DEFAULT_ID, 'string');\n    };\n    var getAppendedEmoticons = function (editor) {\n      return editor.getParam('emoticons_append', {}, 'object');\n    };\n    var Settings = {\n      getEmoticonDatabaseUrl: getEmoticonDatabaseUrl,\n      getEmoticonDatabaseId: getEmoticonDatabaseId,\n      getAppendedEmoticons: getAppendedEmoticons\n    };\n\n    var ALL_CATEGORY = 'All';\n    var categoryNameMap = {\n      symbols: 'Symbols',\n      people: 'People',\n      animals_and_nature: 'Animals and Nature',\n      food_and_drink: 'Food and Drink',\n      activity: 'Activity',\n      travel_and_places: 'Travel and Places',\n      objects: 'Objects',\n      flags: 'Flags',\n      user: 'User Defined'\n    };\n    var translateCategory = function (categories, name) {\n      return has(categories, name) ? categories[name] : name;\n    };\n    var getUserDefinedEmoticons = function (editor) {\n      var userDefinedEmoticons = Settings.getAppendedEmoticons(editor);\n      return map$1(userDefinedEmoticons, function (value) {\n        return merge({\n          keywords: [],\n          category: 'user'\n        }, value);\n      });\n    };\n    var initDatabase = function (editor, databaseUrl, databaseId) {\n      var categories = Cell(Option.none());\n      var all = Cell(Option.none());\n      var processEmojis = function (emojis) {\n        var cats = {};\n        var everything = [];\n        each(emojis, function (lib, title) {\n          var entry = {\n            title: title,\n            keywords: lib.keywords,\n            char: lib.char,\n            category: translateCategory(categoryNameMap, lib.category)\n          };\n          var current = cats[entry.category] !== undefined ? cats[entry.category] : [];\n          cats[entry.category] = current.concat([entry]);\n          everything.push(entry);\n        });\n        categories.set(Option.some(cats));\n        all.set(Option.some(everything));\n      };\n      editor.on('init', function () {\n        global$1.load(databaseId, databaseUrl).then(function (emojis) {\n          var userEmojis = getUserDefinedEmoticons(editor);\n          processEmojis(merge(emojis, userEmojis));\n        }, function (err) {\n          domGlobals.console.log('Failed to load emoticons: ' + err);\n          categories.set(Option.some({}));\n          all.set(Option.some([]));\n        });\n      });\n      var listCategory = function (category) {\n        if (category === ALL_CATEGORY) {\n          return listAll();\n        }\n        return categories.get().bind(function (cats) {\n          return Option.from(cats[category]);\n        }).getOr([]);\n      };\n      var listAll = function () {\n        return all.get().getOr([]);\n      };\n      var listCategories = function () {\n        return [ALL_CATEGORY].concat(keys(categories.get().getOr({})));\n      };\n      var waitForLoad = function () {\n        if (hasLoaded()) {\n          return global$3.resolve(true);\n        } else {\n          return new global$3(function (resolve, reject) {\n            var numRetries = 15;\n            var interval = global$2.setInterval(function () {\n              if (hasLoaded()) {\n                global$2.clearInterval(interval);\n                resolve(true);\n              } else {\n                numRetries--;\n                if (numRetries < 0) {\n                  domGlobals.console.log('Could not load emojis from url: ' + databaseUrl);\n                  global$2.clearInterval(interval);\n                  reject(false);\n                }\n              }\n            }, 100);\n          });\n        }\n      };\n      var hasLoaded = function () {\n        return categories.get().isSome() && all.get().isSome();\n      };\n      return {\n        listCategories: listCategories,\n        hasLoaded: hasLoaded,\n        waitForLoad: waitForLoad,\n        listAll: listAll,\n        listCategory: listCategory\n      };\n    };\n\n    var patternName = 'pattern';\n    var open = function (editor, database) {\n      var initialState = {\n        pattern: '',\n        results: emojisFrom(database.listAll(), '', Option.some(300))\n      };\n      var currentTab = Cell(ALL_CATEGORY);\n      var scan = function (dialogApi) {\n        var dialogData = dialogApi.getData();\n        var category = currentTab.get();\n        var candidates = database.listCategory(category);\n        var results = emojisFrom(candidates, dialogData[patternName], category === ALL_CATEGORY ? Option.some(300) : Option.none());\n        dialogApi.setData({ results: results });\n      };\n      var updateFilter = last(function (dialogApi) {\n        scan(dialogApi);\n      }, 200);\n      var searchField = {\n        label: 'Search',\n        type: 'input',\n        name: patternName\n      };\n      var resultsField = {\n        type: 'collection',\n        name: 'results'\n      };\n      var getInitialState = function () {\n        var body = {\n          type: 'tabpanel',\n          tabs: map(database.listCategories(), function (cat) {\n            return {\n              title: cat,\n              name: cat,\n              items: [\n                searchField,\n                resultsField\n              ]\n            };\n          })\n        };\n        return {\n          title: 'Emoticons',\n          size: 'normal',\n          body: body,\n          initialData: initialState,\n          onTabChange: function (dialogApi, details) {\n            currentTab.set(details.newTabName);\n            updateFilter.throttle(dialogApi);\n          },\n          onChange: updateFilter.throttle,\n          onAction: function (dialogApi, actionData) {\n            if (actionData.name === 'results') {\n              insertEmoticon(editor, actionData.value);\n              dialogApi.close();\n            }\n          },\n          buttons: [{\n              type: 'cancel',\n              text: 'Close',\n              primary: true\n            }]\n        };\n      };\n      var dialogApi = editor.windowManager.open(getInitialState());\n      dialogApi.focus(patternName);\n      if (!database.hasLoaded()) {\n        dialogApi.block('Loading emoticons...');\n        database.waitForLoad().then(function () {\n          dialogApi.redial(getInitialState());\n          updateFilter.throttle(dialogApi);\n          dialogApi.focus(patternName);\n          dialogApi.unblock();\n        }).catch(function (err) {\n          dialogApi.redial({\n            title: 'Emoticons',\n            body: {\n              type: 'panel',\n              items: [{\n                  type: 'alertbanner',\n                  level: 'error',\n                  icon: 'warning',\n                  text: '<p>Could not load emoticons</p>'\n                }]\n            },\n            buttons: [{\n                type: 'cancel',\n                text: 'Close',\n                primary: true\n              }],\n            initialData: {\n              pattern: '',\n              results: []\n            }\n          });\n          dialogApi.focus(patternName);\n          dialogApi.unblock();\n        });\n      }\n    };\n    var Dialog = { open: open };\n\n    var register = function (editor, database) {\n      var onAction = function () {\n        return Dialog.open(editor, database);\n      };\n      editor.ui.registry.addButton('emoticons', {\n        tooltip: 'Emoticons',\n        icon: 'emoji',\n        onAction: onAction\n      });\n      editor.ui.registry.addMenuItem('emoticons', {\n        text: 'Emoticons...',\n        icon: 'emoji',\n        onAction: onAction\n      });\n    };\n    var Buttons = { register: register };\n\n    function Plugin () {\n      global.add('emoticons', function (editor, pluginUrl) {\n        var databaseUrl = Settings.getEmoticonDatabaseUrl(editor, pluginUrl);\n        var databaseId = Settings.getEmoticonDatabaseId(editor);\n        var database = initDatabase(editor, databaseUrl, databaseId);\n        Buttons.register(editor, database);\n        init(editor, database);\n      });\n    }\n\n    Plugin();\n\n}(window));\n"]}