{"version":3,"sources":["../../../../../public/js/themes/mobile/theme.js"],"names":["domGlobals","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","noop","compose","fa","fb","args","_i","constant","value","identity","x","curry","fn","initialArgs","restArgs","all","concat","not","f","die","msg","Error","never","always","none","NONE","eq","o","isNone","thunk","id","me","fold","is","isSome","getOr","getOrThunk","getOrDie","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","freeze","some","a","constant_a","self","v","elementEq","b","from","Option","keys","obj","props","k","len","tupleMap","r","tuple","mapToArray","name","push","find","pred","values","has","key","touchstart","touchmove","touchend","mousedown","mousemove","mouseup","mouseover","keydown","keyup","input","change","click","transitionend","selectstart","Cell","initial","get","set","clone","firstMatch","regexes","test","find$1","agent","major","minor","group","Number","replace","nu","detect","versionRegexes","cleanedAgent","String","toLowerCase","unknown","Version","edge","chrome","ie","opera","firefox","safari","isBrowser","current","unknown$1","nu$1","version","info","isEdge","isChrome","isIE","isOpera","isFirefox","isSafari","Browser","windows","ios","android","linux","osx","solaris","freebsd","isOS","unknown$2","nu$2","isWindows","isiOS","isAndroid","isOSX","isLinux","isSolaris","isFreeBSD","OperatingSystem","DeviceType","os","browser","userAgent","mediaMatch","isiPad","isiPhone","isMobile","isTouch","isTablet","isPhone","iOSwebview","isDesktop","isWebView","typeOf","Array","isPrototypeOf","constructor","isType","type","isString","isObject","isArray","isBoolean","isFunction","isNumber","nativeSlice","slice","nativeIndexOf","nativePush","rawIndexOf","ts","contains","xs","map$1","each$1","eachr","foldr","acc","foldl","find$2","findIndex","flatten","output","reverse","difference","a1","a2","pure","from$1","detect$1","candidates","candidate","search","detectBrowser","browsers","detectOs","oses","UaString","checkRange","str","substr","start","supplant","isStringOrNumber","fullMatch","contains$1","endsWith","suffix","trim","normalVersionRegex","checkContains","target","uastring","PlatformInfo","detect$2","deviceType","PlatformDetection","query","window","matchMedia","matches","platform","navigator","detect$3","alloy","tap","focus","postBlur","postPaste","receive","execute","focusItem","tapOrClick","longpress","systemInit","attachedToDom","detachedFromDom","focusShifted","highlight","dehighlight","emit","component","event","dispatchWith","element","emitWith","properties","emitExecute","dispatch","data","getSystem","triggerEvent","dispatchEvent","simulatedEvent","dispatchFocus","triggerFocus","cached","called","fromHtml","html","scope","doc","document","div","createElement","innerHTML","hasChildNodes","childNodes","console","error","fromDom","fromTag","tag","node","fromText","text","createTextNode","dom","fromPoint","docElm","y","elementFromPoint","Element","ATTRIBUTE","Node","ATTRIBUTE_NODE","CDATA_SECTION","CDATA_SECTION_NODE","COMMENT","COMMENT_NODE","DOCUMENT","DOCUMENT_NODE","DOCUMENT_TYPE","DOCUMENT_TYPE_NODE","DOCUMENT_FRAGMENT","DOCUMENT_FRAGMENT_NODE","ELEMENT","ELEMENT_NODE","TEXT","TEXT_NODE","PROCESSING_INSTRUCTION","PROCESSING_INSTRUCTION_NODE","ENTITY_REFERENCE","ENTITY_REFERENCE_NODE","ENTITY","ENTITY_NODE","NOTATION","NOTATION_NODE","Global","Function","nodeName","nodeType","isType$1","isElement","isText","inBody","parentNode","ownerDocument","body","getBody","Immutable","fields","struct","sort","arr","reqMessage","required","join","unsuppMessage","unsupported","validateStrArr","label","array","checkDupes","everything","sorted","dupe","d","MixedBag","optional","keys$1","allReqd","req","opt","compareDocumentPosition","match","documentPositionPreceding","DOCUMENT_POSITION_PRECEDING","documentPositionContainedBy","DOCUMENT_POSITION_CONTAINED_BY","ELEMENT$1","DOCUMENT$1","selector","elem","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","bypassSelector","childElementCount","base","querySelectorAll","one","querySelector","e1","e2","regularContains","d1","d2","ieContains","contains$2","owner","defaultView","parent","parents","isRoot","stop","ret","rawParent","siblings","filterSelf","elements","children","nextSibling","child","index","cs","firstChild","spot","before","marker","parent$1","insertBefore","after","sibling","append","prepend","firstChild$1","appendChild","appendAt","append$1","empty","textContent","rogue","remove","removeChild","fireDetaching","components","fireAttaching","attach","detachChildren","childComp","syncComponents","replaceChildren","newChildren","subs","deleted","comp","removeFromWorld","isConnected","addToWorld","attach$1","attachWith","insertion","doDetach","detach","getByDom","toOption","attachSystemAfter","guiSystem","attachSystemWith","inserter","children$1","detachSystem","mapError","_","onValue","isValue","isError","message","onError","fromOption","err","Result","generate","cases","constructors","adt","acase","count","argLength","branches","branchKeys","reqKey","log","params","Adt","hasOwnProperty$1","shallow","old","deep","bothObjects","deepMerge","baseMerge","merger","objects","j","curObject","merge","strict","defaultedThunk","asOption","asDefaultedOptionThunk","mergeWithThunk","defaulted","fallback","mergeWith","exclude","readOpt","readOr","readOptFrom","hasKey","wrap","wrapAll","keyvalues","kv","comparison","bothErrors","firstError","secondError","bothValues","partition","results","errors","result","exclude$1","readOpt$1","readOr$1","readOptFrom$1","wrap$1","wrapAll$1","mergeValues","mergeErrors","consolidate","objs","partitions","hasKey$1","SimpleResultType","res","stype","serror","svalue","partition$1","val","map$2","Value","bind$1","bindError","toResult","fromResult","SimpleResult","mergeValues$1","mergeErrors$1","consolidateObj","consolidateArr","ResultCombine","typeAdt","setOf","arrOf","objOf","itemOf","choiceOf","func","fieldAdt","field","state","formatObj","JSON","stringify","formatErrors","es","path","getErrorInfo","nu$3","missingStrict","missingKey","missingBranch","branch","unsupportedFields","custom","adt$1","strictAccess","fallbackAccess","fallbackThunk","optionAccess","optionDefaultedAccess","cExtractOne","strength","okey","presence","prop","bundle","av","extract","bundleAsOption","optValue","outcome","ov","baseThunk","instantiator","cExtract","value$1","validator","toDsl","getSetKeys","objOfOnly","delegate","fieldNames","extra","fieldStrings","validateKeys","validatedKeys","validKeys","schema","vk","anyValue","chooseFrom","ch","vp","choose","choice","chosen","_anyValue","valueOf","setOf$1","errs","asRaw","extraction","errInfo","formatError","asRawOrDie","choose$1","anyValue$1","typedValue","expectedType","actualType","functionProcessor","strict$1","strictOf","strictFunction","forbid","strictObjOf","objSchema","option","optionOf","optionObjOf","optionObjOfOnly","defaulted$1","defaultedOf","defaultedObjOf","state$1","isSource","nu$4","parts","all$1","handlers","handler","any","read","can","abort","run","fuse","ClosestOrAncestor","ancestor","predicate","el","closest","descendant","descend","child_1","closest$1","transform","derive","configs","runActionExtra","action","runOnName","runOnSourceName","redirectToUid","uid","getByUid","redirectee","redirectToPart","detail","partName","partUids","cutter","cut","stopper","runOnSource","runOnAttached","runOnDetached","runOnInit","runOnExecute","markAsBehaviourApi","apiName","apiFunction","endIndex","openBracketIndex","parameters","substring","split","toFunctionAnnotation","cleanParameters","markAsExtraApi","extraName","markAsSketchApi","nu$5","classes","attributes","styles","merge$1","defnA","mod","executeEvent","bConfig","bState","executor","loadEvent","create","active","apis","configSchema","schemaSchema","doCreate","createModes","modes","wrapApi","bName","rest","config","revokeBehaviour","getConfig","wrappedApis","apiF","wrappedExtra","extraF","revoke","spec","prepared","configAsRaw","initialConfig","exhibit","behaviourInfo","exhibitor","getEvents","NoState","init","nu$6","readState","derive$1","capabilities","simpleSchema","create$1","modeSchema","createModes$1","branchKey","rawSet","setAttribute","setAll","attrs","getAttribute","has$1","hasAttribute","remove$1","removeAttribute","read$1","attr","add","remove$2","supports","classList","get$1","add$1","clazz","remove$3","add$2","cleanClass","remove$4","has$2","swap","addCls","removeCls","toAlpha","swapConfig","swapState","alpha","omega","toOmega","clear","isAlpha","isOmega","SwapApis","SwapSchema","Swapping","focus$1","blur","hasFocus","activeElement","_doc","global$1","tinymce","util","Tools","resolve","global$2","openLink","link","href","rel","nuEvt","createEvent","initMouseEvent","TinyCodeDupe","isSkinDisabled","editor","settings","skin","readOnlyOnInit","formatChanged","orientationChanged","dropupDismissed","TinyChannels","fromHtml$1","get$2","set$1","content","owner$1","docDom","fragment","createDocumentFragment","contentElements","getOuter","container","cloneNode","original","isDeep","shallow$1","getHtml","chooseChannels","channels","universal","events","receiveConfig","channelMap","targetChannels","channelInfo","channelSchema","onReceive","ActiveReceiving","cat","sequence","findMap","someIf","unknown$3","EventConfiguration","eventConfig","makeEventLogger","eventName","initialTarget","startTime","Date","getTime","logEventCut","purpose","logEventStopped","logNoParent","logEventNoHandlers","logEventResponse","write","finishTime","time","processEvent","status","patterns","NORMAL","noLogger","LOGGING","logger","STOP","getTrace","stack","lines","line","ignoreEvent","monitorEvent","menuFields","itemFields","itemSchema","_initSize","itemMarkers","tieredMenuMarkers","markers","onPresenceHandler","fieldName","trace","onHandler","onKeyboardHandler","onStrictHandler","onStrictKeyboardHandler","snapshot","initSize","ReceivingSchema","Receiving","updateAriaState","toggleConfig","toggleState","ariaInfo","aria","update","updateClass","toggleClass","toggle","set$2","on","off","isOn","onLoad","selected","ToggleApis","events$1","load","toggleOnExecute","ActiveToggle","SetupBehaviourCellState","initialState","cell","newState","updatePressed","syncWithExpanded","updateExpanded","updateSelected","updateChecked","ToggleSchema","mode","pressed","checked","expanded","Toggling","format","command","button","orientation","receive$1","channel","Receivers","prefix","Styles","events$2","optAction","executeHandler","onClick","onMousedown","pointerEvents","focus$2","focusConfig","ignore","onFocus","blur$1","isFocused","FocusApis","exhibit$1","tabindex","events$3","stopMousedown","prevent","ActiveFocus","FocusSchema","Focusing","isSupported","style","getPropertyValue","internalSet","property","setProperty","internalRemove","removeProperty","set$3","setAll$1","css","get$3","getComputedStyle","getUnsafeProperty","getRaw","raw","remove$5","reflow","offsetWidth","Dimension","getOffset","h","parseFloat","aggregate","parseInt","isNaN","max","cumulativeInclusions","absoluteMax","api","getBoundingClientRect","height","offsetHeight","get$4","ancestors","siblings$1","all$2","ancestors$1","siblings$2","descendants","first","ancestor$1","descendant$1","closest$2","BACKSPACE","TAB","ENTER","ESCAPE","SPACE","LEFT","UP","RIGHT","DOWN","cyclePrev","tryPrev","cycleNext","tryNext","inSet","which","and","preds","isShift","shiftKey","isControl","ctrlKey","isNotShift","rule","classification","choose$2","transitions","transition","cycleBy","delta","min","cap","dehighlightAllExcept","hConfig","hState","skip","highlighted","highlightClass","skipComp","onDehighlight","dehighlightAll","dehighlight$1","isHighlighted","highlight$1","onHighlight","highlightFirst","getFirst","firstComp","highlightLast","getLast","lastComp","highlightAt","getByIndex","highlightBy","getCandidates","targetComp","c","queryTarget","getHighlighted","items","itemClass","last","getDelta","item","dest","getPrevious","getNext","HighlightApis","HighlightSchema","Highlighting","reportFocusShifting","prevFocus","newFocus","noChange","focusee","highlights","FocusInsideModes","typical","infoSchema","stateInit","getKeydownRules","getKeyupRules","optFocusIn","processKey","getRules","keyingConfig","keyingState","rules","toEvents","onFocusHandler","focusInside","OnFocusMode","focusIn","tryGoInsideComponent","isEnterOrSpace","OnEnterOrSpaceMode","create$2","cyclicField","isVisible","tabbingConfig","visibilitySelector","sel","findInitial","tabstops","visibles","firstTabstop","findCurrent","focusManager","isTabstop","useTabstopAt","goFromTabstop","stopIndex","cycle","cyclic","go","tabstop","optStopIndex","goBackwards","tabbingState","navigate","goForwards","onEnter","exit","onEscape","AcyclicType","CyclicType","inside","doDefaultExecute","focused","defaultExecute","stopEventForFirefox","schema$1","execute$1","executeConfig","executeState","spaceExec","useSpace","enterExec","useEnter","downExec","useDown","execKeys","useControlEnter","ExecutionType","flatgrid","dimensions","setGridSize","numRows","numColumns","getNumRows","getNumColumns","KeyingState","onDirection","isLtr","isRtl","getDirection","useH","movement","move","use","west","moveLeft","moveRight","east","useV","north","south","isHidden","indexInfo","locate","locateVisible","visible","findIndex$1","withGrid","numCols","oldRow","Math","floor","oldColumn","address","newIndex","row","column","cycleHorizontal","onLastRow","colsInRow","newColumn","cycleVertical","newRow","newCol","cycleRight","cycleLeft","cycleUp","cycleDown","schema$2","gridConfig","gridState","execute$2","doMove","identified","handleTab","captureTab","doEscape","moveNorth","moveSouth","getKeydownRules$1","getKeyupRules$1","FlatgridType","horizontal","isDisabledButton","tryCycle","schema$3","findCurrent$1","flowConfig","execute$3","focusIn$1","getInitial","moveLeft$1","moveRight$1","doMove$1","executeOnMove","doEscape$1","_flowState","getKeydownRules$2","_component","_se","westMovers","allowVertical","eastMovers","getKeyupRules$2","FlowType","toCell","matrix","rowIndex","columnIndex","cycleHorizontal$1","startCol","deltaCol","newColIndex","cycleVertical$1","colIndex","startRow","deltaRow","nextRowIndex","colsInNextRow","nextColIndex","moveHorizontal","moveVertical","cycleRight$1","cycleLeft$1","cycleUp$1","cycleDown$1","moveLeft$2","moveRight$2","moveUp","moveDown","schema$4","focusIn$2","matrixConfig","previousSelector","selectors","execute$4","toMatrix","rows","doMove$2","ifCycle","ifMove","cycles","inRow","cellsInRow","allRows","next","moveLeft$3","moveRight$3","moveNorth$1","moveSouth$1","getKeydownRules$3","getKeyupRules$3","MatrixType","schema$5","execute$5","menuConfig","focusIn$3","moveUp$1","moveDown$1","fireShiftTab","moveOnTab","fireTab","getKeydownRules$4","getKeyupRules$4","MenuType","schema$6","getKeydownRules$5","specialInfo","onSpace","onShiftEnter","onShiftTab","onTab","onUp","onDown","onLeft","onRight","getKeyupRules$5","stopSpaceKeyup","SpecialType","acyclic","flow","flatgrid$1","execution","menu","special","KeyboardBranches","Keying","keyConfig","keyState","sendFocusIn","field$1","forbidden","get$5","dump","augment","SketchBehaviours","_placeholder","adt$2","single","multiple","subPlaceholder","compSpec","placeholders","newSpec","scan","uiType","substitute","valueThunk","validated","childSpecs","substituted","valuesThunk","preprocessor","preprocess","substituteAll","oneReplace","replacements","used","substitutePlaces","ps","ph","placeholder","unique","generate$1","date","random","adt$3","external","fFactory","sketch","fSchema","fName","fPname","typeSpec","fGroupSchema","fDefaults","fOverrides","requiredSpec","optionalSpec","groupSpec","asNamedPart","part","name$1","convert","adtConstructor","partSchema","combine","partSpec","partValidated","defaults","overrides","internals","externals","pname","factory","_partSpec","_partValidated","units","u","generate$2","np","g","doGenerateOne","generateOne","schemas","names","substitutes","getPart","partKey","getPartOrDie","getAllParts","system","pUid","defaultUids","baseUid","partTypes","partNames","pn","defaultUidsSchema","premadeTag","premade","getPremade","makeApi","getApis","prefix$1","idAttr","prefix$2","idAttr$1","writeOnly","defineProperty","writable","read$2","generate$3","partSchemas","partUidsSchemas","asRawOrDie$1","baseS","single$1","specWithUid","supplyUid","composite","partUidsSchema","components$1","isSketchSpec","singleSchema","compositeSchema","single$2","rawConfig","configFields","extraApis","partFields","composite$1","lookupAttr","getModAttributes","roleAttrs","role","behaviours","buttonBehaviours","domModification","eventOrder","Button","exhibit$2","unselectConfig","unselectable","events$4","ActiveUnselecting","Unselecting","getAttrs","_a","getClasses","fromHtml$2","contents","innerHtml","dom$1","rawHtml","sDom","forToolbarCommand","forToolbar","execCommand","getToggleBehaviours","forToolbarStateCommand","extraBehaviours","forToolbarStateAction","getToolbarIconButton","icons","ui","registry","getAll","optOxideIcon","icon","Buttons","platform$1","labelPart","edgePart","model","manager","edgeActions","touchEvents","mouseEvents","l","det","mouseIsDown","tlEdgePart","tedgePart","trEdgePart","redgePart","brEdgePart","bedgePart","blEdgePart","ledgePart","thumbPart","position","spectrumPart","modelDetail","setValueFrom","getValueFromEvent","spectrum","se","SliderParts","onLoad$1","repConfig","repState","store","onUnload","setValue","getValue","getState","RepresentApis","events$5","resetOnDom","ActiveRepresenting","memory","isNotSet","manual","dataset","dataByValue","dataByText","lookup","itemString","currentDataByValue","currentDataByText","newDataByValue","newDataByText","meta","init$1","RepresentState","setValue$1","onSetValue","getValue$1","getDataKey","getFallbackEntry","onLoad$2","initialValue","onUnload$1","DatasetStore","getValue$2","setValue$2","onLoad$3","ManualStore","setValue$3","getValue$3","onLoad$4","initVal","onUnload$2","MemoryStore","RepresentSchema","Representing","source","api$1","set$4","get$6","left","top","translate","Position","isTouch$1","_sliderChangeEvent","sliderChangeEvent","getEventSource","evt","touchEvent","touches","clientX","clientY","mouseEvent","r$1","minX","minY","min1X","min1Y","maxX","maxY","max1X","max1Y","range","xRange","yRange","halfX","halfY","step","stepSize","snap","snapToGrid","snapStart","rounded","hasEdge","edgeName","hasLEdge","hasREdge","hasTEdge","hasBEdge","currentValue","xValue","yValue","xyValue","fireSliderChange","setToTLEdgeXY","setToTEdge","setToTEdgeXY","setToTREdgeXY","setToREdge","setToREdgeXY","setToBREdgeXY","setToBEdge","setToBEdgeXY","setToBLEdgeXY","setToLEdge","setToLEdgeXY","reduceBy","increaseBy","capValue","snapValueOf","initValue","extraValue","round","remainder","adjustment","rawSteps","maxSteps","numSteps","findOffsetOf","findValueOf","hasMinEdge","hasMaxEdge","minBound","maxBound","screenRange","capMin","capMax","offset","newValue","findOffsetOfValue","maxOffset","centerMinEdge","centerMaxEdge","right","bottom","width","getBounds","getBoundsProperty","bounds","getMinXBounds","getMaxXBounds","getMinYBounds","getMaxYBounds","getXScreenRange","getYScreenRange","getCenterOffsetOf","componentMinEdge","componentMaxEdge","spectrumMinEdge","getXCenterOffSetOf","componentBounds","spectrumBounds","getYCenterOffSetOf","fireSliderChange$1","sliderValue","findValueOfOffset","sliderVal","setToMin","setToMax","moveBy","direction","handleMovement","pos","findOffsetOfValue$1","minEdge","maxEdge","minOffset","findPositionOfValue","slider","setPositionFromValue","thumb","edges","getSpectrum","getLeftEdge","getRightEdge","thumbRadius","HorizontalModel","fireSliderChange$2","sliderValue$1","findValueOfOffset$1","setValueFrom$1","setToMin$1","setToMax$1","moveBy$1","handleMovement$1","getValueFromEvent$1","findOffsetOfValue$2","findPositionOfValue$1","setPositionFromValue$1","getTopEdge","getBottomEdge","onLeft$1","onRight$1","onUp$1","onDown$1","edgeActions$1","VerticalModel","fireSliderChange$3","sliderValue$2","setValueFrom$2","moveBy$2","isVerticalMovement","handleMovement$2","setToMin$2","mX","mY","setToMax$2","getValueFromEvent$2","setPositionFromValue$2","xPos","yPos","thumbXRadius","thumbYRadius","onLeft$2","onRight$2","onUp$2","onDown$2","edgeActions$2","TwoDModel","isTouch$2","SliderSchema","xy","isTouch$3","_spec","_externals","getThumb","refresh","changeValue","onChange","resetToMin","resetToMax","_simulatedEvent","onDragStart","onDragEnd","uiEventsArr","sliderBehaviours","fireOnChoose","onChoose","wasDown","getInitialValue","onInit","Slider","realm","makeItems","setContextToolbar","BLACK","makeSlider","spec$1","getColor","hue","color","sketch$1","undoManager","transact","formatter","nodeChanged","ColorSlider","schema$7","sketch$2","rawSpec","isValidValue","valueIndex","sizes","category","SizeSlider","defaultSize","defaultIndex","indexToSize","sizeToIndex","size","getRawOrComputed","rawStart","optStart","inline","getSize","selection","getStart","root","elemSize","applySize","get$7","apply$1","FontSizes","makeSlider$1","makeItems$1","sketch$3","record","anyInSystem","getOpt","asSpec","promise","Promise","TypeError","_state","_value","_deferreds","doResolve","reject","asap","immediateFn","setImmediate","setTimeout","thisArg","handle","deferred","cb","onFulfilled","onRejected","then","finale","Handler","done","reason","ex","catch","remaining","race","values_1","blobToDataUri","blob","reader","FileReader","onloadend","readAsDataURL","blobToBase64","dataUri","blobToBase64$1","addImage","base64","cache","editorUpload","blobCache","img","createHTML","src","blobUri","insertContent","extractBlob","files","dataTransfer","sketch$4","pickerDom","accept","title","visibility","memPicker","picker","get$8","set$5","isNotEmpty","defaultToEmpty","noLink","getContent","url","fromLink","getInfo","wasSimple","prevHref","prevText","getTextToApply","unlinkIfRequired","activeLink","getAttrs$1","applyInfo","encode","newText","LinkBridge","platform$2","preserve","rng","getRng","setRng","forAndroid","wrapper","RangePreserver","events$6","eventHandlers","getCurrent","composeConfig","composeState","ComposeApis","ComposeSchema","Composing","factory$1","domWithoutAttributes","containerBehaviours","Container","factory$2","dataBehaviours","DataField","get$9","set$6","schema$8","focusBehaviours","selectOnFocus","setSelectionRange","inputBehaviours","dom$2","inputAttributes","inputStyles","inputClasses","factory$3","Input","exhibit$3","tabConfig","tabAttr","ActiveTabstopping","TabstopSchema","Tabstopping","global$3","clearInputBehaviour","field$2","inputSpec","input$1","buttonSpec","iContainer","hidden","display","nativeDisabled","onLoad$5","disableConfig","disableState","disabled","disable","hasNative","useNative","nativeIsDisabled","nativeDisable","nativeEnable","ariaIsDisabled","ariaDisable","ariaEnable","disableClass","onDisabled","enable","onEnabled","isDisabled","set$7","DisableApis","exhibit$4","events$7","ActiveDisable","DisableSchema","Disabling","schema$9","getPartName","sketch$5","fSpec","fieldParts","make","toResult$1","formBehaviours","form","resPs","resPThunk","pName","getField","Form","api$2","subject","destroy","isSet","value$2","SWIPING_LEFT","SWIPING_RIGHT","SWIPING_NONE","init$2","points","move$1","currentDirection","newPoint","priorPoints","prev","complete","firstDirection","lastDirection","SwipingModel","sketch$6","navigateEvent","wrapperAdhocEvents","formAdhocEvents","dialogSwipeState","currentScreen","navigationButton","directionName","enabled","reposition","dialog","screens","currentLeft","w","focusInput","inputs","optInput","inputComp","dotitems","memDots","resetState","memForm","maxFieldIndex","onExecute","propertyName","_f","getGroups","restoreToolbar","sketch$7","groups","focusToolbar","select","DefaultStyleFormats","isRecursive","originator","events$8","warn","DefaultEvents","make$1","NoContextApi","getComp","fail","debugInfo","triggerEscape","build","addToGui","removeFromGui","broadcast","broadcastOn","broadcastEvent","singleton","generateFrom","list","optBlobThunk","optBlob","getBehaviours","bData","getData","byInnerKey","indexKey","chain","combine$1","baseMod","modsByBehaviour","behaviour","nameAndMod","modification","byAspect","combineObjects","combinedClasses","combinedAttributes","combinedStyles","sortKeys","keyName","order","sliced","aKey","bKey","aIndex","bIndex","uncurried","curried","cHandler","curryArgs","descHandler","extraArgs","getCurried","behaviourTuple","nameToHandlers","groupByEvents","behaviourEvents","combine$2","byEventName","combineGroups","assemble","rawHandler","missingOrderError","tuples","fuse$1","sortedTuples","combined","assembled","toInfo","toDefinition","domChildren","toModification","add$3","remove$6","renderToDom","definition","getBehaviours$1","generateFrom$1","generate$4","getDomDefinition","bList","infoModification","baseModification","baseEvents","getMe","systemApi","bBlob","modDefinition","subcomponents","connect","newApi","disconnect","hasConfigured","behaviourName","buildSubcomponents","build$1","buildFromSpec","userSpec","specEvents","completeSpec","extSpec","uids","userSpecWithUid","prebuilt","premade$1","hoverEvent","focusEvent","onHover","hover","focus$3","builder","toggling","hasSubmenu","itemBehaviours","tConfig","ignoreFocus","schema$a","builder$1","schema$b","owner$2","builder$2","focusWidget","widget","onHorizontalArrow","autofocus","setSource","widgetBehaviours","schema$c","itemSchema$1","separator","configureGrid","movementInfo","configureMatrix","rowSelector","configureMenu","parts$1","itemInfo","unit","fakeFocus","schema$d","grid","focus$4","make$2","menuBehaviours","selectedItem","Menu","preserve$1","ownerDoc","refocus","oldFocus","set$8","replaceConfig","replaceState","insert","childSpec","append$2","appendee","prepend$1","prependee","remove$7","removee","foundChild","replaceAt","replaceeIndex","replacer","replacee","replaceBy","replaceePred","ReplaceApis","Replacing","transpose","byItem","byMenu","finish","triggerItem","triggerMenu","generate$5","menus","expansions","menuItems","menuPaths","_triggerItem","submenu","init$3","paths","primary","directory","isClear","setMenuBuilt","menuName","built","setContents","sPrimary","sMenus","sExpansions","dir","sPaths","getTriggeringItem","menuValue","getTriggerData","getItemByValue","getPreparedMenu","triggeringItemValue","triggeredItem","triggeredMenu","triggeringItem","triggeringPath","getTriggeringPath","itemValue","extraPath","lookupItem","revPath","triggers","menuIndex","expand","collapse","lookupMenu","extractPreparedMenu","otherMenus","menuValues","getPrimary","getMenus","prep","LayeredState","make$3","rawUiSpec","submenuParentItems","buildMenus","primaryName","makeSketch","nbMenu","layeredState","setup","componentMap","toDirectory","getItemValue","setActiveMenu","mv","closeOthers","others","backgroundMenu","stayInDom","getSubmenuParents","parentItems","itemComp","updateAriaExpansions","updateMenuPath","latestMenuName","menuPrep","activeMenu","ExpandHighlightDecision","buildIfRequired","expandRight","decision","HighlightSubmenu","activeMenuPrep","onOpenSubmenu","collapseLeft","onCollapseMenu","updateView","keyOnItem","getSource","sandbox","onOpenMenu","highlightImmediately","navigateOnHover","HighlightParent","getActiveItem","collapseMenuApi","currentItem","highlightPrimary","extractMenuFromContainer","repositionMenus","maybeActivePrimary","allMenus","preparedMenus","primaryMenu","onRepositionMenu","collapseMenu","tmenuBehaviours","keyInfo","selectedMenu","collapseItem","tieredData","singleData","collapseItem$1","tieredMenu","tmenu","findRoute","transConfig","transState","route","routes","sConfig","destination","getTransition","getCurrentRoute","getTransitionOf","disableTransition","routeTransition","transitionClass","destinationAttr","getNewRoute","stateAttr","jumpTo","onFinish","fasttrack","progressTo","getState$1","TransitionApis","events$9","rInfo","rTransition","onTransition","ActiveTransitioning","TransitionSchema","createRoutes","waypoints","createBistate","second","createTristate","third","Transitioning","scrollable","register","deregister","Scrollable","getValue$4","convert$1","formats","memMenuThunk","mainMenu","makeMenu","makeItem","isSelected","getPreview","submenus","preview","isMenu","collapsable","sketch$8","memMenu","menuComp","submenuComp","StylesMenu","getFromExpandingItem","newItem","newMenus","newExpansions","getFromItem","newData","StyleConversions","register$1","isSelectedFor","getCssText","enrichSupported","enrichMenu","enrichCustom","formatName","doEnrich","newItems","prune","doPrune","keep","canApply","prunedItems","onDone","pruned","StyleFormats","extract$1","rawToolbar","toolbar","identifyFromArray","identify","commandSketch","stateCommandSketch","actionSketch","undo","redo","bold","italic","underline","removeformat","unlink","image","bullist","numlist","fontsizeselect","forecolor","styleFormats","styleFormatsMenu","fire","styleselect","dropup","appear","feature","prereq","buttons","detect$4","features","itemNames","present","iName","Features","mkEvent","kill","fromRawEvent","rawEvent","stopPropagation","preventDefault","binder","useCapture","wrapped","addEventListener","unbind","bind$2","capture","removeEventListener","filter$1","bind$3","capture$1","global$4","INTERVAL","INSURANCE","get$a","outerWindow","isPortrait","getActualWidth","isIos","screen","listeners","win","poller","clearInterval","onAdjustment","onReady","orientationHandle","flag","innerHeight","insurance","setInterval","Orientation","DelayedFunction","fun","delay","ref","schedule","cancel","clearTimeout","SIGNIFICANT_MOVE","LONGPRESS_DELAY","getTouch","isFarEnough","touch","distX","abs","distY","monitor","startData","longpressFired","longpress$1","handleTouchstart","handleTouchmove","handleTouchend","isSame","fireIfReady","monitor$1","editorApi","tapEvent","onTapContent","onTouchend","onTouchmove","fireTouchstart","TappingEvent","isAndroid6","initEvents","toolstrip","tapping","outerDoc","isRanged","soffset","foffset","hasRangeInUi","selectionStart","selectionEnd","updateMargin","rangeInContent","getSelection","onTouchContent","onTouchToolstrip","onToReading","onToEditing","onScrollToCursor","tinyEvent","getCursorBox","cWin","isOutside","cScrollBy","scrollTo","pageXOffset","pageYOffset","AndroidEvents","safeParse","attribute","parsed","DataAttributes","NodeValue","getOption","nodeValue","api$3","get$b","getEnd","NBSP","isTextNodeWithCursorPosition","elementsWithCursorPosition","isCursorPosition","hasCursorPosition","create$3","SimRange","adt$4","cata","onBefore","onOn","onAfter","situ","before$1","on$1","after$1","Situ","adt$5","domRange","relative","exact","exactFromRange","simRange","getStart$1","startContainer","startSitu","finishSitu","getWin","range$1","Selection","setStart","setStartBefore","setStartAfter","setFinish","setEndBefore","setEnd","setEndAfter","relativeToNative","createRange","exactToNative","toRect","rect","getFirstRect","rects","getClientRects","adt$6","ltr","rtl","fromRange","startOffset","endContainer","endOffset","getRanges","doDiagnose","ranges","collapsed","reversed","rev","diagnose","asLtrRange","diagnosis","searchForPoint","rectForOffset","xDelta","curDeltaX","inRect","locateOffset","textnode","rangeForOffset","locate$1","selectNode","foundRect","searchInChildren","nodes","locateNode","locate$2","boundedX","boundedY","first$1","descendantRtl","COLLAPSE_TO_LEFT","COLLAPSE_TO_RIGHT","getCollapseDirection","createCollapsedNode","collapseDirection","locateInElement","cursorRange","locateInEmpty","search$1","caretPositionFromPoint","offsetNode","caretRangeFromPoint","searchTextNodes","searchFromPoint","availableSearch","beforeSpecial","preprocessExact","makeRange","after$2","same","doSetNativeRange","removeAllRanges","addRange","doSetRange","setLegacyRtlRange","extend","setRangeFromRelative","setBaseAndExtent","setExact","readRange","rangeCount","firstRng","getRangeAt","lastRng","doGetExact","anchor","anchorNode","focusNode","anchorOffset","focusOffset","getExact","get$c","getFirstRect$1","clear$1","COLLAPSED_WIDTH","collapsedRect","toRect$1","rawRect","getRectsFromRange","start_1","optRect","getRectangles","Rectangles","autocompleteHack","resume","iBody","inInput","transaction","ResumeEditing","EXTRA_SPACING","setLastHeight","cBody","getLastHeight","getBoundsFrom","getBounds$1","findDelta","calculate","setup$1","toEditing","onResize","AndroidSetup","getBodyFromFrame","frame","contentWindow","getDocFromFrame","getWinFromFrame","getSelectionFromFrame","optWin","getFrame","getOrDerive","getOrListen","toRect$2","getActiveApi","tryFallbackBox","isCollapsed","toStartRect","documentElement","setSelection","clearSelection","onKeyup","onNodeChanged","onDomChanged","onScrollToElement","onToolbarScrollStart","PlatformEditor","getDoc","siblingStyles","ancestorPosition","ancestorStyles","bgFallback","matchColor","editorBody","clobberStyles","gatherSibilings","clobber","clobberStyle","backup","bgColor","containerStyles","restoreStyles","clobberedEls","restore","Thor","head","maximize","MetaViewport","create$4","mask","androidApi","androidEvents","enter","hide","show","AndroidMode","first$2","rate","timer","throttle","last$1","sketch$9","onView","memIcon","onViewThrottle","TapToEditMask","MobileSchema","socket","produce","mobile","onTap","setReadOnly","maskApi","refreshStructure","AndroidWebapp","schema$e","enhanceGroups","parts$2","factory$4","setGroups","getGroupContainer","shell","toolbarBehaviours","Toolbar","schema$f","parts$3","factory$5","tgroupBehaviours","itemSelector","ToolbarGroup","dataHorizontal","canScrollVertically","scrollTop","canScrollHorizontally","scrollLeft","hasVerticalScroll","hasHorizontalScroll","markAsHorizontal","hasScroll","exclusive","Scrollables","ScrollingToolbar","makeGroup","gSpec","scrollClass","resetGroups","initGroups","gs","createGroups","makeEditSwitch","webapp","makeSocket","showEdit","switchToEdit","hideEdit","updateMode","readOnly","CommonRealm","getAnimationRoot","slideConfig","getDimensionProperty","dimension","getDimension","disableTransitions","shrinkingClass","growingClass","setShrunk","openClass","closedClass","setGrown","doImmediateShrink","slideState","_calculatedSize","setCollapsed","onStartShrink","onShrunk","doStartShrink","calculatedSize","doStartSmartShrink","shrinker","doStartGrow","wasShrinking","beforeSize","fullSize","startPartialGrow","startCompleteGrow","setStartSize","setExpanded","onStartGrow","isExpanded","grow","shrink","immediateShrink","hasGrown","hasShrunk","isGrowing","isShrinking","isTransitioning","toggleGrow","SlidingApis","exhibit$5","events$a","notify","onGrown","ActiveSliding","SlidingSchema","init$4","SlidingState","Sliding","build$2","scrollIntoView","disappear","requestAnimationFrame","onReadyToShrink","closest$3","isDangerous","keyEv","settingsSchema","bindFocus","bindBlur","setup$2","rawSettings","simpleEvents","tapStopped","stopped","pasteTimeout","onPaste","onKeydown","stopBackspace","onFocusIn","focusoutTimeout","onFocusOut","derive$2","rawTarget","getTarget","fromSource","isStopped","isCut","fromExternal","adt$7","doTriggerHandler","eventType","handlerInfo","eventHandler","doTriggerOnUntilStopped","triggerHandler","listener","triggerUntilStopped","triggerOnUntilStopped","broadcastHandler","EventRegistry","registerId","findHandler","filterByType","isAboveRoot","readType","unregisterId","handlersById","Registry","readOrTag","failOnDuplicate","tagId","conflict","unregister","getById","takeover","domEvents","_alloyId","broadcast$1","broadcastData","receivers","receiver","READ_ONLY_MODE_CLASS","EDIT_MODE_CLASS","OuterContainer","AndroidRealm","setToolbarGroups","rawGroups","operation","opacity","CaptureBin","refreshInput","end","selectionDirection","refresh$1","winScope","br","CursorRefresh","resume$1","ResumeEditing$1","stubborn","outerBody","page","toReading","captureInput","onToolbarTouch","timid","dismissKeyboard","IosKeyboard","initEvents$1","iosApi","saveSelectionFirst","highlightSelection","refreshIosSelection","refreshSelection","scrollToY","yTop","scrollToElement","scrollToCursor","box","clearAndRefresh","refreshThrottle","refreshView","syncHeight","toolbarHeight","setViewportOffset","transitionEvent","IosEvents","FakeSelection","onTouch","rectangle","span","rectangles","spans","isActive","exports$1","module","exports","define","require","amd","global","EphoxContactWrapper","code","process","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","runClearTimeout","queue","draining","currentQueue","queueIndex","cleanUpNextTick","drainQueue","timeout","nextTick","Item","env","argv","versions","addListener","once","removeListener","removeAllListeners","prependListener","prependOnceListener","binding","cwd","chdir","umask","setTimeoutFunc","_handled","_immediateFn","_unhandledRejectionFn","prom","_setImmediateFn","_setUnhandledRejectionFn","clearImmediate","immediateIds","nextImmediateId","Timeout","close","clearFn","_id","_clearFn","unref","enroll","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","onTimeout","_onTimeout","onNextTick","promisePolyfill","boltExport","Promise$1","nu$7","baseFn","callbacks","nCallback","isReady","cbs","pure$1","callback","LazyValue","errorReporter","make$4","fab","aFutureB","toPromise","anonBind","futureB","toLazy","toCached","nu$8","pure$2","Future","adjust","amount","create$5","interval","animate","increment","doFinish","finished","SmoothAnimation","findDevice","deviceWidth","deviceHeight","devices","keyboard","portrait","landscape","device","softKeyboardLimits","accountableKeyboardHeight","limits","visualScreenHeight","getGreenzone","viewportHeight","updatePadding","contentBody","greenzoneHeight","deltaHeight","DeviceZones","fixture","fixed","scroller","yFixedData","yFixedProperty","yScrollingData","windowSizeData","getYFixedData","getYFixedProperty","getLastWindowSize","classifyFixed","offsetY","classifyScrolling","classify","classifier","findFixtures","takeoverToolbar","oldToolbarStyle","takeoverViewport","viewport","oldViewportStyle","takeoverDropup","oldDropupStyle","deriveViewportHeight","dropupHeight","winH","takeover$1","toolbarSetup","viewportSetup","dropupSetup","isExpanding","currentWinHeight","lastWinHeight","newToolbarHeight","dropupHeight_1","newHeight","newYOffset","offsetPx","IosViewport","animator","ANIMATION_STEP","NUM_TOP_ANIMATION_FRAMES","ANIMATION_RATE","lastScroll","getTop","getScrollTop","moveScrollAndTop","finalTop","newScroll","moveOnlyScroll","previous","distance","ceil","moveOnlyTop","newTop","updateTop","moveWindowScroll","destY","IosScrolling","BackgroundActivity","doAction","future","idle","greenzone","refreshCursor","Greenzone","par","asyncValues","asyncValue","par$1","futures","updateFixed","winY","updateScrollingFixed","destTop","oldProp","destScroll","updateFixture","updatePositions","fixtures","updates","IosUpdates","VIEW_MARGIN","register$2","structure","scrollBounds","viewTop","outside","scrollThrottle","extraScroll","onScroll","setup$3","bag","ceBody","contentElement","keyboardType","keyboardModel","onOrientation","unfocusedSelection","scrollHeight","updateToolbarPadding","IosSetup","create$6","priorState","scrollEvents","iosEvents","socketHeight","iframeHeight","outerScroll","exclusives","setupBag","cursor","isScrolling","scrollValue","IosMode","produce$1","IosWebapp","IosRealm","global$5","derive$3","baseURL","CssUrls","fontSizes","fireChange","init$5","allFormats","selectorChanged","FormatChangers","fireSkinLoaded","_skinLoaded","initialized","SkinLoaded","READING","EDITING","renderMobileTheme","renderUI","targetNode","getElement","cssUrls","contentCSS","DOM","styleSheetLoader","doScrollIntoView","findFocusIn","dynamicGroup","readOnlyGroups","mainGroups","ro","toolbars","configureToolbar","main","setMode","dynamic","backToMask","bindHandler","contentAreaContainer","hideDropup","editorContainer","backToMaskGroup","backToReadOnlyGroup","readOnlyGroup","actionGroup","extraGroup","backToReadOnly","iframeContainer","getNotificationManagerImpl","open","progressBar","getEl","moveTo","moveRel","getArgs","Theme"],"mappings":"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","file":"theme.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.1.0 (2019-10-17)\n */\n(function (domGlobals) {\n    'use strict';\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n    function __rest(s, e) {\n      var t = {};\n      for (var p in s)\n        if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n          t[p] = s[p];\n      if (s != null && typeof Object.getOwnPropertySymbols === 'function')\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n            t[p[i]] = s[p[i]];\n        }\n      return t;\n    }\n\n    var noop = function () {\n    };\n    var compose = function (fa, fb) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return fa(fb.apply(null, args));\n      };\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var identity = function (x) {\n      return x;\n    };\n    function curry(fn) {\n      var initialArgs = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        initialArgs[_i - 1] = arguments[_i];\n      }\n      return function () {\n        var restArgs = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          restArgs[_i] = arguments[_i];\n        }\n        var all = initialArgs.concat(restArgs);\n        return fn.apply(null, all);\n      };\n    }\n    var not = function (f) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return !f.apply(null, args);\n      };\n    };\n    var die = function (msg) {\n      return function () {\n        throw new Error(msg);\n      };\n    };\n    var apply = function (f) {\n      return f();\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      if (Object.freeze) {\n        Object.freeze(me);\n      }\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Option = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var keys = Object.keys;\n    var hasOwnProperty = Object.hasOwnProperty;\n    var each = function (obj, f) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        f(x, i);\n      }\n    };\n    var map = function (obj, f) {\n      return tupleMap(obj, function (x, i) {\n        return {\n          k: i,\n          v: f(x, i)\n        };\n      });\n    };\n    var tupleMap = function (obj, f) {\n      var r = {};\n      each(obj, function (x, i) {\n        var tuple = f(x, i);\n        r[tuple.k] = tuple.v;\n      });\n      return r;\n    };\n    var mapToArray = function (obj, f) {\n      var r = [];\n      each(obj, function (value, name) {\n        r.push(f(value, name));\n      });\n      return r;\n    };\n    var find = function (obj, pred) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        if (pred(x, i, obj)) {\n          return Option.some(x);\n        }\n      }\n      return Option.none();\n    };\n    var values = function (obj) {\n      return mapToArray(obj, function (v) {\n        return v;\n      });\n    };\n    var has = function (obj, key) {\n      return hasOwnProperty.call(obj, key);\n    };\n\n    var touchstart = constant('touchstart');\n    var touchmove = constant('touchmove');\n    var touchend = constant('touchend');\n    var mousedown = constant('mousedown');\n    var mousemove = constant('mousemove');\n    var mouseup = constant('mouseup');\n    var mouseover = constant('mouseover');\n    var keydown = constant('keydown');\n    var keyup = constant('keyup');\n    var input = constant('input');\n    var change = constant('change');\n    var click = constant('click');\n    var transitionend = constant('transitionend');\n    var selectstart = constant('selectstart');\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      var clone = function () {\n        return Cell(get());\n      };\n      return {\n        get: get,\n        set: set,\n        clone: clone\n      };\n    };\n\n    var firstMatch = function (regexes, s) {\n      for (var i = 0; i < regexes.length; i++) {\n        var x = regexes[i];\n        if (x.test(s)) {\n          return x;\n        }\n      }\n      return undefined;\n    };\n    var find$1 = function (regexes, agent) {\n      var r = firstMatch(regexes, agent);\n      if (!r) {\n        return {\n          major: 0,\n          minor: 0\n        };\n      }\n      var group = function (i) {\n        return Number(agent.replace(r, '$' + i));\n      };\n      return nu(group(1), group(2));\n    };\n    var detect = function (versionRegexes, agent) {\n      var cleanedAgent = String(agent).toLowerCase();\n      if (versionRegexes.length === 0) {\n        return unknown();\n      }\n      return find$1(versionRegexes, cleanedAgent);\n    };\n    var unknown = function () {\n      return nu(0, 0);\n    };\n    var nu = function (major, minor) {\n      return {\n        major: major,\n        minor: minor\n      };\n    };\n    var Version = {\n      nu: nu,\n      detect: detect,\n      unknown: unknown\n    };\n\n    var edge = 'Edge';\n    var chrome = 'Chrome';\n    var ie = 'IE';\n    var opera = 'Opera';\n    var firefox = 'Firefox';\n    var safari = 'Safari';\n    var isBrowser = function (name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n    var unknown$1 = function () {\n      return nu$1({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$1 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isEdge: isBrowser(edge, current),\n        isChrome: isBrowser(chrome, current),\n        isIE: isBrowser(ie, current),\n        isOpera: isBrowser(opera, current),\n        isFirefox: isBrowser(firefox, current),\n        isSafari: isBrowser(safari, current)\n      };\n    };\n    var Browser = {\n      unknown: unknown$1,\n      nu: nu$1,\n      edge: constant(edge),\n      chrome: constant(chrome),\n      ie: constant(ie),\n      opera: constant(opera),\n      firefox: constant(firefox),\n      safari: constant(safari)\n    };\n\n    var windows = 'Windows';\n    var ios = 'iOS';\n    var android = 'Android';\n    var linux = 'Linux';\n    var osx = 'OSX';\n    var solaris = 'Solaris';\n    var freebsd = 'FreeBSD';\n    var isOS = function (name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n    var unknown$2 = function () {\n      return nu$2({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$2 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isWindows: isOS(windows, current),\n        isiOS: isOS(ios, current),\n        isAndroid: isOS(android, current),\n        isOSX: isOS(osx, current),\n        isLinux: isOS(linux, current),\n        isSolaris: isOS(solaris, current),\n        isFreeBSD: isOS(freebsd, current)\n      };\n    };\n    var OperatingSystem = {\n      unknown: unknown$2,\n      nu: nu$2,\n      windows: constant(windows),\n      ios: constant(ios),\n      android: constant(android),\n      linux: constant(linux),\n      osx: constant(osx),\n      solaris: constant(solaris),\n      freebsd: constant(freebsd)\n    };\n\n    var DeviceType = function (os, browser, userAgent, mediaMatch) {\n      var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n      var isiPhone = os.isiOS() && !isiPad;\n      var isMobile = os.isiOS() || os.isAndroid();\n      var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n      var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n      var isPhone = isiPhone || isMobile && !isTablet;\n      var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n      var isDesktop = !isPhone && !isTablet && !iOSwebview;\n      return {\n        isiPad: constant(isiPad),\n        isiPhone: constant(isiPhone),\n        isTablet: constant(isTablet),\n        isPhone: constant(isPhone),\n        isTouch: constant(isTouch),\n        isAndroid: os.isAndroid,\n        isiOS: os.isiOS,\n        isWebView: constant(iOSwebview),\n        isDesktop: constant(isDesktop)\n      };\n    };\n\n    var typeOf = function (x) {\n      if (x === null) {\n        return 'null';\n      }\n      var t = typeof x;\n      if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      }\n      if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      }\n      return t;\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isString = isType('string');\n    var isObject = isType('object');\n    var isArray = isType('array');\n    var isBoolean = isType('boolean');\n    var isFunction = isType('function');\n    var isNumber = isType('number');\n\n    var nativeSlice = Array.prototype.slice;\n    var nativeIndexOf = Array.prototype.indexOf;\n    var nativePush = Array.prototype.push;\n    var rawIndexOf = function (ts, t) {\n      return nativeIndexOf.call(ts, t);\n    };\n    var contains = function (xs, x) {\n      return rawIndexOf(xs, x) > -1;\n    };\n    var exists = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var map$1 = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each$1 = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var eachr = function (xs, f) {\n      for (var i = xs.length - 1; i >= 0; i--) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var filter = function (xs, pred) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          r.push(x);\n        }\n      }\n      return r;\n    };\n    var foldr = function (xs, f, acc) {\n      eachr(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var foldl = function (xs, f, acc) {\n      each$1(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var find$2 = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Option.some(x);\n        }\n      }\n      return Option.none();\n    };\n    var findIndex = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Option.some(i);\n        }\n      }\n      return Option.none();\n    };\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var bind = function (xs, f) {\n      var output = map$1(xs, f);\n      return flatten(output);\n    };\n    var forall = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        var x = xs[i];\n        if (pred(x, i) !== true) {\n          return false;\n        }\n      }\n      return true;\n    };\n    var reverse = function (xs) {\n      var r = nativeSlice.call(xs, 0);\n      r.reverse();\n      return r;\n    };\n    var difference = function (a1, a2) {\n      return filter(a1, function (x) {\n        return !contains(a2, x);\n      });\n    };\n    var pure = function (x) {\n      return [x];\n    };\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n\n    var detect$1 = function (candidates, userAgent) {\n      var agent = String(userAgent).toLowerCase();\n      return find$2(candidates, function (candidate) {\n        return candidate.search(agent);\n      });\n    };\n    var detectBrowser = function (browsers, userAgent) {\n      return detect$1(browsers, userAgent).map(function (browser) {\n        var version = Version.detect(browser.versionRegexes, userAgent);\n        return {\n          current: browser.name,\n          version: version\n        };\n      });\n    };\n    var detectOs = function (oses, userAgent) {\n      return detect$1(oses, userAgent).map(function (os) {\n        var version = Version.detect(os.versionRegexes, userAgent);\n        return {\n          current: os.name,\n          version: version\n        };\n      });\n    };\n    var UaString = {\n      detectBrowser: detectBrowser,\n      detectOs: detectOs\n    };\n\n    var checkRange = function (str, substr, start) {\n      if (substr === '') {\n        return true;\n      }\n      if (str.length < substr.length) {\n        return false;\n      }\n      var x = str.substr(start, start + substr.length);\n      return x === substr;\n    };\n    var supplant = function (str, obj) {\n      var isStringOrNumber = function (a) {\n        var t = typeof a;\n        return t === 'string' || t === 'number';\n      };\n      return str.replace(/\\$\\{([^{}]*)\\}/g, function (fullMatch, key) {\n        var value = obj[key];\n        return isStringOrNumber(value) ? value.toString() : fullMatch;\n      });\n    };\n    var contains$1 = function (str, substr) {\n      return str.indexOf(substr) !== -1;\n    };\n    var endsWith = function (str, suffix) {\n      return checkRange(str, suffix, str.length - suffix.length);\n    };\n    var trim = function (str) {\n      return str.replace(/^\\s+|\\s+$/g, '');\n    };\n\n    var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n    var checkContains = function (target) {\n      return function (uastring) {\n        return contains$1(uastring, target);\n      };\n    };\n    var browsers = [\n      {\n        name: 'Edge',\n        versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n        search: function (uastring) {\n          return contains$1(uastring, 'edge/') && contains$1(uastring, 'chrome') && contains$1(uastring, 'safari') && contains$1(uastring, 'applewebkit');\n        }\n      },\n      {\n        name: 'Chrome',\n        versionRegexes: [\n          /.*?chrome\\/([0-9]+)\\.([0-9]+).*/,\n          normalVersionRegex\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'chrome') && !contains$1(uastring, 'chromeframe');\n        }\n      },\n      {\n        name: 'IE',\n        versionRegexes: [\n          /.*?msie\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*?rv:([0-9]+)\\.([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'msie') || contains$1(uastring, 'trident');\n        }\n      },\n      {\n        name: 'Opera',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?opera\\/([0-9]+)\\.([0-9]+).*/\n        ],\n        search: checkContains('opera')\n      },\n      {\n        name: 'Firefox',\n        versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n        search: checkContains('firefox')\n      },\n      {\n        name: 'Safari',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?cpu os ([0-9]+)_([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return (contains$1(uastring, 'safari') || contains$1(uastring, 'mobile/')) && contains$1(uastring, 'applewebkit');\n        }\n      }\n    ];\n    var oses = [\n      {\n        name: 'Windows',\n        search: checkContains('win'),\n        versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'iOS',\n        search: function (uastring) {\n          return contains$1(uastring, 'iphone') || contains$1(uastring, 'ipad');\n        },\n        versionRegexes: [\n          /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*cpu os ([0-9]+)_([0-9]+).*/,\n          /.*cpu iphone os ([0-9]+)_([0-9]+).*/\n        ]\n      },\n      {\n        name: 'Android',\n        search: checkContains('android'),\n        versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'OSX',\n        search: checkContains('os x'),\n        versionRegexes: [/.*?os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n      },\n      {\n        name: 'Linux',\n        search: checkContains('linux'),\n        versionRegexes: []\n      },\n      {\n        name: 'Solaris',\n        search: checkContains('sunos'),\n        versionRegexes: []\n      },\n      {\n        name: 'FreeBSD',\n        search: checkContains('freebsd'),\n        versionRegexes: []\n      }\n    ];\n    var PlatformInfo = {\n      browsers: constant(browsers),\n      oses: constant(oses)\n    };\n\n    var detect$2 = function (userAgent, mediaMatch) {\n      var browsers = PlatformInfo.browsers();\n      var oses = PlatformInfo.oses();\n      var browser = UaString.detectBrowser(browsers, userAgent).fold(Browser.unknown, Browser.nu);\n      var os = UaString.detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n      var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n      return {\n        browser: browser,\n        os: os,\n        deviceType: deviceType\n      };\n    };\n    var PlatformDetection = { detect: detect$2 };\n\n    var mediaMatch = function (query) {\n      return domGlobals.window.matchMedia(query).matches;\n    };\n    var platform = Cell(PlatformDetection.detect(domGlobals.navigator.userAgent, mediaMatch));\n    var detect$3 = function () {\n      return platform.get();\n    };\n\n    var alloy = { tap: constant('alloy.tap') };\n    var focus = constant('alloy.focus');\n    var postBlur = constant('alloy.blur.post');\n    var postPaste = constant('alloy.paste.post');\n    var receive = constant('alloy.receive');\n    var execute = constant('alloy.execute');\n    var focusItem = constant('alloy.focus.item');\n    var tap = alloy.tap;\n    var tapOrClick = detect$3().deviceType.isTouch() ? alloy.tap : click;\n    var longpress = constant('alloy.longpress');\n    var systemInit = constant('alloy.system.init');\n    var attachedToDom = constant('alloy.system.attached');\n    var detachedFromDom = constant('alloy.system.detached');\n    var focusShifted = constant('alloy.focusmanager.shifted');\n    var highlight = constant('alloy.highlight');\n    var dehighlight = constant('alloy.dehighlight');\n\n    var emit = function (component, event) {\n      dispatchWith(component, component.element(), event, {});\n    };\n    var emitWith = function (component, event, properties) {\n      dispatchWith(component, component.element(), event, properties);\n    };\n    var emitExecute = function (component) {\n      emit(component, execute());\n    };\n    var dispatch = function (component, target, event) {\n      dispatchWith(component, target, event, {});\n    };\n    var dispatchWith = function (component, target, event, properties) {\n      var data = __assign({ target: target }, properties);\n      component.getSystem().triggerEvent(event, target, map(data, constant));\n    };\n    var dispatchEvent = function (component, target, event, simulatedEvent) {\n      component.getSystem().triggerEvent(event, target, simulatedEvent.event());\n    };\n    var dispatchFocus = function (component, target) {\n      component.getSystem().triggerFocus(target, component.element());\n    };\n\n    var cached = function (f) {\n      var called = false;\n      var r;\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (!called) {\n          called = true;\n          r = f.apply(null, args);\n        }\n        return r;\n      };\n    };\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || domGlobals.document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        domGlobals.console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: constant(node) };\n    };\n    var fromPoint = function (docElm, x, y) {\n      var doc = docElm.dom();\n      return Option.from(doc.elementFromPoint(x, y)).map(fromDom);\n    };\n    var Element = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    var ATTRIBUTE = domGlobals.Node.ATTRIBUTE_NODE;\n    var CDATA_SECTION = domGlobals.Node.CDATA_SECTION_NODE;\n    var COMMENT = domGlobals.Node.COMMENT_NODE;\n    var DOCUMENT = domGlobals.Node.DOCUMENT_NODE;\n    var DOCUMENT_TYPE = domGlobals.Node.DOCUMENT_TYPE_NODE;\n    var DOCUMENT_FRAGMENT = domGlobals.Node.DOCUMENT_FRAGMENT_NODE;\n    var ELEMENT = domGlobals.Node.ELEMENT_NODE;\n    var TEXT = domGlobals.Node.TEXT_NODE;\n    var PROCESSING_INSTRUCTION = domGlobals.Node.PROCESSING_INSTRUCTION_NODE;\n    var ENTITY_REFERENCE = domGlobals.Node.ENTITY_REFERENCE_NODE;\n    var ENTITY = domGlobals.Node.ENTITY_NODE;\n    var NOTATION = domGlobals.Node.NOTATION_NODE;\n\n    var Global = typeof domGlobals.window !== 'undefined' ? domGlobals.window : Function('return this;')();\n\n    var name = function (element) {\n      var r = element.dom().nodeName;\n      return r.toLowerCase();\n    };\n    var type = function (element) {\n      return element.dom().nodeType;\n    };\n    var isType$1 = function (t) {\n      return function (element) {\n        return type(element) === t;\n      };\n    };\n    var isElement = isType$1(ELEMENT);\n    var isText = isType$1(TEXT);\n\n    var inBody = function (element) {\n      var dom = isText(element) ? element.dom().parentNode : element.dom();\n      return dom !== undefined && dom !== null && dom.ownerDocument.body.contains(dom);\n    };\n    var body = cached(function () {\n      return getBody(Element.fromDom(domGlobals.document));\n    });\n    var getBody = function (doc) {\n      var b = doc.dom().body;\n      if (b === null || b === undefined) {\n        throw new Error('Body is not available yet');\n      }\n      return Element.fromDom(b);\n    };\n\n    var Immutable = function () {\n      var fields = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        fields[_i] = arguments[_i];\n      }\n      return function () {\n        var values = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          values[_i] = arguments[_i];\n        }\n        if (fields.length !== values.length) {\n          throw new Error('Wrong number of arguments to struct. Expected \"[' + fields.length + ']\", got ' + values.length + ' arguments');\n        }\n        var struct = {};\n        each$1(fields, function (name, i) {\n          struct[name] = constant(values[i]);\n        });\n        return struct;\n      };\n    };\n\n    var sort = function (arr) {\n      return arr.slice(0).sort();\n    };\n    var reqMessage = function (required, keys) {\n      throw new Error('All required keys (' + sort(required).join(', ') + ') were not specified. Specified keys were: ' + sort(keys).join(', ') + '.');\n    };\n    var unsuppMessage = function (unsupported) {\n      throw new Error('Unsupported keys for object: ' + sort(unsupported).join(', '));\n    };\n    var validateStrArr = function (label, array) {\n      if (!isArray(array)) {\n        throw new Error('The ' + label + ' fields must be an array. Was: ' + array + '.');\n      }\n      each$1(array, function (a) {\n        if (!isString(a)) {\n          throw new Error('The value ' + a + ' in the ' + label + ' fields was not a string.');\n        }\n      });\n    };\n    var checkDupes = function (everything) {\n      var sorted = sort(everything);\n      var dupe = find$2(sorted, function (s, i) {\n        return i < sorted.length - 1 && s === sorted[i + 1];\n      });\n      dupe.each(function (d) {\n        throw new Error('The field: ' + d + ' occurs more than once in the combined fields: [' + sorted.join(', ') + '].');\n      });\n    };\n\n    var MixedBag = function (required, optional) {\n      var everything = required.concat(optional);\n      if (everything.length === 0) {\n        throw new Error('You must specify at least one required or optional field.');\n      }\n      validateStrArr('required', required);\n      validateStrArr('optional', optional);\n      checkDupes(everything);\n      return function (obj) {\n        var keys$1 = keys(obj);\n        var allReqd = forall(required, function (req) {\n          return contains(keys$1, req);\n        });\n        if (!allReqd) {\n          reqMessage(required, keys$1);\n        }\n        var unsupported = filter(keys$1, function (key) {\n          return !contains(everything, key);\n        });\n        if (unsupported.length > 0) {\n          unsuppMessage(unsupported);\n        }\n        var r = {};\n        each$1(required, function (req) {\n          r[req] = constant(obj[req]);\n        });\n        each$1(optional, function (opt) {\n          r[opt] = constant(Object.prototype.hasOwnProperty.call(obj, opt) ? Option.some(obj[opt]) : Option.none());\n        });\n        return r;\n      };\n    };\n\n    var compareDocumentPosition = function (a, b, match) {\n      return (a.compareDocumentPosition(b) & match) !== 0;\n    };\n    var documentPositionPreceding = function (a, b) {\n      return compareDocumentPosition(a, b, domGlobals.Node.DOCUMENT_POSITION_PRECEDING);\n    };\n    var documentPositionContainedBy = function (a, b) {\n      return compareDocumentPosition(a, b, domGlobals.Node.DOCUMENT_POSITION_CONTAINED_BY);\n    };\n    var Node = {\n      documentPositionPreceding: documentPositionPreceding,\n      documentPositionContainedBy: documentPositionContainedBy\n    };\n\n    var ELEMENT$1 = ELEMENT;\n    var DOCUMENT$1 = DOCUMENT;\n    var is = function (element, selector) {\n      var dom = element.dom();\n      if (dom.nodeType !== ELEMENT$1) {\n        return false;\n      } else {\n        var elem = dom;\n        if (elem.matches !== undefined) {\n          return elem.matches(selector);\n        } else if (elem.msMatchesSelector !== undefined) {\n          return elem.msMatchesSelector(selector);\n        } else if (elem.webkitMatchesSelector !== undefined) {\n          return elem.webkitMatchesSelector(selector);\n        } else if (elem.mozMatchesSelector !== undefined) {\n          return elem.mozMatchesSelector(selector);\n        } else {\n          throw new Error('Browser lacks native selectors');\n        }\n      }\n    };\n    var bypassSelector = function (dom) {\n      return dom.nodeType !== ELEMENT$1 && dom.nodeType !== DOCUMENT$1 || dom.childElementCount === 0;\n    };\n    var all = function (selector, scope) {\n      var base = scope === undefined ? domGlobals.document : scope.dom();\n      return bypassSelector(base) ? [] : map$1(base.querySelectorAll(selector), Element.fromDom);\n    };\n    var one = function (selector, scope) {\n      var base = scope === undefined ? domGlobals.document : scope.dom();\n      return bypassSelector(base) ? Option.none() : Option.from(base.querySelector(selector)).map(Element.fromDom);\n    };\n\n    var eq = function (e1, e2) {\n      return e1.dom() === e2.dom();\n    };\n    var regularContains = function (e1, e2) {\n      var d1 = e1.dom();\n      var d2 = e2.dom();\n      return d1 === d2 ? false : d1.contains(d2);\n    };\n    var ieContains = function (e1, e2) {\n      return Node.documentPositionContainedBy(e1.dom(), e2.dom());\n    };\n    var browser = detect$3().browser;\n    var contains$2 = browser.isIE() ? ieContains : regularContains;\n\n    var owner = function (element) {\n      return Element.fromDom(element.dom().ownerDocument);\n    };\n    var defaultView = function (element) {\n      return Element.fromDom(element.dom().ownerDocument.defaultView);\n    };\n    var parent = function (element) {\n      return Option.from(element.dom().parentNode).map(Element.fromDom);\n    };\n    var parents = function (element, isRoot) {\n      var stop = isFunction(isRoot) ? isRoot : never;\n      var dom = element.dom();\n      var ret = [];\n      while (dom.parentNode !== null && dom.parentNode !== undefined) {\n        var rawParent = dom.parentNode;\n        var p = Element.fromDom(rawParent);\n        ret.push(p);\n        if (stop(p) === true) {\n          break;\n        } else {\n          dom = rawParent;\n        }\n      }\n      return ret;\n    };\n    var siblings = function (element) {\n      var filterSelf = function (elements) {\n        return filter(elements, function (x) {\n          return !eq(element, x);\n        });\n      };\n      return parent(element).map(children).map(filterSelf).getOr([]);\n    };\n    var nextSibling = function (element) {\n      return Option.from(element.dom().nextSibling).map(Element.fromDom);\n    };\n    var children = function (element) {\n      return map$1(element.dom().childNodes, Element.fromDom);\n    };\n    var child = function (element, index) {\n      var cs = element.dom().childNodes;\n      return Option.from(cs[index]).map(Element.fromDom);\n    };\n    var firstChild = function (element) {\n      return child(element, 0);\n    };\n    var spot = Immutable('element', 'offset');\n\n    var before = function (marker, element) {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        v.dom().insertBefore(element.dom(), marker.dom());\n      });\n    };\n    var after = function (marker, element) {\n      var sibling = nextSibling(marker);\n      sibling.fold(function () {\n        var parent$1 = parent(marker);\n        parent$1.each(function (v) {\n          append(v, element);\n        });\n      }, function (v) {\n        before(v, element);\n      });\n    };\n    var prepend = function (parent, element) {\n      var firstChild$1 = firstChild(parent);\n      firstChild$1.fold(function () {\n        append(parent, element);\n      }, function (v) {\n        parent.dom().insertBefore(element.dom(), v.dom());\n      });\n    };\n    var append = function (parent, element) {\n      parent.dom().appendChild(element.dom());\n    };\n    var appendAt = function (parent, element, index) {\n      child(parent, index).fold(function () {\n        append(parent, element);\n      }, function (v) {\n        before(v, element);\n      });\n    };\n\n    var append$1 = function (parent, elements) {\n      each$1(elements, function (x) {\n        append(parent, x);\n      });\n    };\n\n    var empty = function (element) {\n      element.dom().textContent = '';\n      each$1(children(element), function (rogue) {\n        remove(rogue);\n      });\n    };\n    var remove = function (element) {\n      var dom = element.dom();\n      if (dom.parentNode !== null) {\n        dom.parentNode.removeChild(dom);\n      }\n    };\n\n    var fireDetaching = function (component) {\n      emit(component, detachedFromDom());\n      var children = component.components();\n      each$1(children, fireDetaching);\n    };\n    var fireAttaching = function (component) {\n      var children = component.components();\n      each$1(children, fireAttaching);\n      emit(component, attachedToDom());\n    };\n    var attach = function (parent, child) {\n      append(parent.element(), child.element());\n    };\n    var detachChildren = function (component) {\n      each$1(component.components(), function (childComp) {\n        return remove(childComp.element());\n      });\n      empty(component.element());\n      component.syncComponents();\n    };\n    var replaceChildren = function (component, newChildren) {\n      var subs = component.components();\n      detachChildren(component);\n      var deleted = difference(subs, newChildren);\n      each$1(deleted, function (comp) {\n        fireDetaching(comp);\n        component.getSystem().removeFromWorld(comp);\n      });\n      each$1(newChildren, function (childComp) {\n        if (!childComp.getSystem().isConnected()) {\n          component.getSystem().addToWorld(childComp);\n          attach(component, childComp);\n          if (inBody(component.element())) {\n            fireAttaching(childComp);\n          }\n        } else {\n          attach(component, childComp);\n        }\n        component.syncComponents();\n      });\n    };\n\n    var attach$1 = function (parent, child) {\n      attachWith(parent, child, append);\n    };\n    var attachWith = function (parent, child, insertion) {\n      parent.getSystem().addToWorld(child);\n      insertion(parent.element(), child.element());\n      if (inBody(parent.element())) {\n        fireAttaching(child);\n      }\n      parent.syncComponents();\n    };\n    var doDetach = function (component) {\n      fireDetaching(component);\n      remove(component.element());\n      component.getSystem().removeFromWorld(component);\n    };\n    var detach = function (component) {\n      var parent$1 = parent(component.element()).bind(function (p) {\n        return component.getSystem().getByDom(p).toOption();\n      });\n      doDetach(component);\n      parent$1.each(function (p) {\n        p.syncComponents();\n      });\n    };\n    var attachSystemAfter = function (element, guiSystem) {\n      attachSystemWith(element, guiSystem, after);\n    };\n    var attachSystemWith = function (element, guiSystem, inserter) {\n      inserter(element, guiSystem.element());\n      var children$1 = children(guiSystem.element());\n      each$1(children$1, function (child) {\n        guiSystem.getByDom(child).each(fireAttaching);\n      });\n    };\n    var detachSystem = function (guiSystem) {\n      var children$1 = children(guiSystem.element());\n      each$1(children$1, function (child) {\n        guiSystem.getByDom(child).each(fireDetaching);\n      });\n      remove(guiSystem.element());\n    };\n\n    var value = function (o) {\n      var is = function (v) {\n        return o === v;\n      };\n      var or = function (opt) {\n        return value(o);\n      };\n      var orThunk = function (f) {\n        return value(o);\n      };\n      var map = function (f) {\n        return value(f(o));\n      };\n      var mapError = function (f) {\n        return value(o);\n      };\n      var each = function (f) {\n        f(o);\n      };\n      var bind = function (f) {\n        return f(o);\n      };\n      var fold = function (_, onValue) {\n        return onValue(o);\n      };\n      var exists = function (f) {\n        return f(o);\n      };\n      var forall = function (f) {\n        return f(o);\n      };\n      var toOption = function () {\n        return Option.some(o);\n      };\n      return {\n        is: is,\n        isValue: always,\n        isError: never,\n        getOr: constant(o),\n        getOrThunk: constant(o),\n        getOrDie: constant(o),\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: each,\n        bind: bind,\n        exists: exists,\n        forall: forall,\n        toOption: toOption\n      };\n    };\n    var error = function (message) {\n      var getOrThunk = function (f) {\n        return f();\n      };\n      var getOrDie = function () {\n        return die(String(message))();\n      };\n      var or = function (opt) {\n        return opt;\n      };\n      var orThunk = function (f) {\n        return f();\n      };\n      var map = function (f) {\n        return error(message);\n      };\n      var mapError = function (f) {\n        return error(f(message));\n      };\n      var bind = function (f) {\n        return error(message);\n      };\n      var fold = function (onError, _) {\n        return onError(message);\n      };\n      return {\n        is: never,\n        isValue: never,\n        isError: always,\n        getOr: identity,\n        getOrThunk: getOrThunk,\n        getOrDie: getOrDie,\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: noop,\n        bind: bind,\n        exists: never,\n        forall: always,\n        toOption: Option.none\n      };\n    };\n    var fromOption = function (opt, err) {\n      return opt.fold(function () {\n        return error(err);\n      }, value);\n    };\n    var Result = {\n      value: value,\n      error: error,\n      fromOption: fromOption\n    };\n\n    var generate = function (cases) {\n      if (!isArray(cases)) {\n        throw new Error('cases must be an array');\n      }\n      if (cases.length === 0) {\n        throw new Error('there must be at least one case');\n      }\n      var constructors = [];\n      var adt = {};\n      each$1(cases, function (acase, count) {\n        var keys$1 = keys(acase);\n        if (keys$1.length !== 1) {\n          throw new Error('one and only one name per case');\n        }\n        var key = keys$1[0];\n        var value = acase[key];\n        if (adt[key] !== undefined) {\n          throw new Error('duplicate key detected:' + key);\n        } else if (key === 'cata') {\n          throw new Error('cannot have a case named cata (sorry)');\n        } else if (!isArray(value)) {\n          throw new Error('case arguments must be an array');\n        }\n        constructors.push(key);\n        adt[key] = function () {\n          var argLength = arguments.length;\n          if (argLength !== value.length) {\n            throw new Error('Wrong number of arguments to case ' + key + '. Expected ' + value.length + ' (' + value + '), got ' + argLength);\n          }\n          var args = new Array(argLength);\n          for (var i = 0; i < args.length; i++) {\n            args[i] = arguments[i];\n          }\n          var match = function (branches) {\n            var branchKeys = keys(branches);\n            if (constructors.length !== branchKeys.length) {\n              throw new Error('Wrong number of arguments to match. Expected: ' + constructors.join(',') + '\\nActual: ' + branchKeys.join(','));\n            }\n            var allReqd = forall(constructors, function (reqKey) {\n              return contains(branchKeys, reqKey);\n            });\n            if (!allReqd) {\n              throw new Error('Not all branches were specified when using match. Specified: ' + branchKeys.join(', ') + '\\nRequired: ' + constructors.join(', '));\n            }\n            return branches[key].apply(null, args);\n          };\n          return {\n            fold: function () {\n              if (arguments.length !== cases.length) {\n                throw new Error('Wrong number of arguments to fold. Expected ' + cases.length + ', got ' + arguments.length);\n              }\n              var target = arguments[count];\n              return target.apply(null, args);\n            },\n            match: match,\n            log: function (label) {\n              domGlobals.console.log(label, {\n                constructors: constructors,\n                constructor: key,\n                params: args\n              });\n            }\n          };\n        };\n      });\n      return adt;\n    };\n    var Adt = { generate: generate };\n\n    var hasOwnProperty$1 = Object.prototype.hasOwnProperty;\n    var shallow = function (old, nu) {\n      return nu;\n    };\n    var deep = function (old, nu) {\n      var bothObjects = isObject(old) && isObject(nu);\n      return bothObjects ? deepMerge(old, nu) : nu;\n    };\n    var baseMerge = function (merger) {\n      return function () {\n        var objects = new Array(arguments.length);\n        for (var i = 0; i < objects.length; i++) {\n          objects[i] = arguments[i];\n        }\n        if (objects.length === 0) {\n          throw new Error('Can\\'t merge zero objects');\n        }\n        var ret = {};\n        for (var j = 0; j < objects.length; j++) {\n          var curObject = objects[j];\n          for (var key in curObject) {\n            if (hasOwnProperty$1.call(curObject, key)) {\n              ret[key] = merger(ret[key], curObject[key]);\n            }\n          }\n        }\n        return ret;\n      };\n    };\n    var deepMerge = baseMerge(deep);\n    var merge = baseMerge(shallow);\n\n    var adt = Adt.generate([\n      { strict: [] },\n      { defaultedThunk: ['fallbackThunk'] },\n      { asOption: [] },\n      { asDefaultedOptionThunk: ['fallbackThunk'] },\n      { mergeWithThunk: ['baseThunk'] }\n    ]);\n    var defaulted = function (fallback) {\n      return adt.defaultedThunk(constant(fallback));\n    };\n    var mergeWith = function (base) {\n      return adt.mergeWithThunk(constant(base));\n    };\n    var strict = adt.strict;\n    var asOption = adt.asOption;\n    var defaultedThunk = adt.defaultedThunk;\n    var mergeWithThunk = adt.mergeWithThunk;\n\n    var exclude = function (obj, fields) {\n      var r = {};\n      each(obj, function (v, k) {\n        if (!contains(fields, k)) {\n          r[k] = v;\n        }\n      });\n      return r;\n    };\n\n    var readOpt = function (key) {\n      return function (obj) {\n        return has(obj, key) ? Option.from(obj[key]) : Option.none();\n      };\n    };\n    var readOr = function (key, fallback) {\n      return function (obj) {\n        return has(obj, key) ? obj[key] : fallback;\n      };\n    };\n    var readOptFrom = function (obj, key) {\n      return readOpt(key)(obj);\n    };\n    var hasKey = function (obj, key) {\n      return has(obj, key) && obj[key] !== undefined && obj[key] !== null;\n    };\n\n    var wrap = function (key, value) {\n      var r = {};\n      r[key] = value;\n      return r;\n    };\n    var wrapAll = function (keyvalues) {\n      var r = {};\n      each$1(keyvalues, function (kv) {\n        r[kv.key] = kv.value;\n      });\n      return r;\n    };\n\n    var comparison = Adt.generate([\n      {\n        bothErrors: [\n          'error1',\n          'error2'\n        ]\n      },\n      {\n        firstError: [\n          'error1',\n          'value2'\n        ]\n      },\n      {\n        secondError: [\n          'value1',\n          'error2'\n        ]\n      },\n      {\n        bothValues: [\n          'value1',\n          'value2'\n        ]\n      }\n    ]);\n    var partition = function (results) {\n      var errors = [];\n      var values = [];\n      each$1(results, function (result) {\n        result.fold(function (err) {\n          errors.push(err);\n        }, function (value) {\n          values.push(value);\n        });\n      });\n      return {\n        errors: errors,\n        values: values\n      };\n    };\n\n    var exclude$1 = function (obj, fields) {\n      return exclude(obj, fields);\n    };\n    var readOpt$1 = function (key) {\n      return readOpt(key);\n    };\n    var readOr$1 = function (key, fallback) {\n      return readOr(key, fallback);\n    };\n    var readOptFrom$1 = function (obj, key) {\n      return readOptFrom(obj, key);\n    };\n    var wrap$1 = function (key, value) {\n      return wrap(key, value);\n    };\n    var wrapAll$1 = function (keyvalues) {\n      return wrapAll(keyvalues);\n    };\n    var mergeValues = function (values, base) {\n      return values.length === 0 ? Result.value(base) : Result.value(deepMerge(base, merge.apply(undefined, values)));\n    };\n    var mergeErrors = function (errors) {\n      return Result.error(flatten(errors));\n    };\n    var consolidate = function (objs, base) {\n      var partitions = partition(objs);\n      return partitions.errors.length > 0 ? mergeErrors(partitions.errors) : mergeValues(partitions.values, base);\n    };\n    var hasKey$1 = function (obj, key) {\n      return hasKey(obj, key);\n    };\n\n    var SimpleResultType;\n    (function (SimpleResultType) {\n      SimpleResultType[SimpleResultType['Error'] = 0] = 'Error';\n      SimpleResultType[SimpleResultType['Value'] = 1] = 'Value';\n    }(SimpleResultType || (SimpleResultType = {})));\n    var fold = function (res, onError, onValue) {\n      return res.stype === SimpleResultType.Error ? onError(res.serror) : onValue(res.svalue);\n    };\n    var partition$1 = function (results) {\n      var values = [];\n      var errors = [];\n      each$1(results, function (obj) {\n        fold(obj, function (err) {\n          return errors.push(err);\n        }, function (val) {\n          return values.push(val);\n        });\n      });\n      return {\n        values: values,\n        errors: errors\n      };\n    };\n    var mapError = function (res, f) {\n      if (res.stype === SimpleResultType.Error) {\n        return {\n          stype: SimpleResultType.Error,\n          serror: f(res.serror)\n        };\n      } else {\n        return res;\n      }\n    };\n    var map$2 = function (res, f) {\n      if (res.stype === SimpleResultType.Value) {\n        return {\n          stype: SimpleResultType.Value,\n          svalue: f(res.svalue)\n        };\n      } else {\n        return res;\n      }\n    };\n    var bind$1 = function (res, f) {\n      if (res.stype === SimpleResultType.Value) {\n        return f(res.svalue);\n      } else {\n        return res;\n      }\n    };\n    var bindError = function (res, f) {\n      if (res.stype === SimpleResultType.Error) {\n        return f(res.serror);\n      } else {\n        return res;\n      }\n    };\n    var svalue = function (v) {\n      return {\n        stype: SimpleResultType.Value,\n        svalue: v\n      };\n    };\n    var serror = function (e) {\n      return {\n        stype: SimpleResultType.Error,\n        serror: e\n      };\n    };\n    var toResult = function (res) {\n      return fold(res, Result.error, Result.value);\n    };\n    var fromResult = function (res) {\n      return res.fold(serror, svalue);\n    };\n    var SimpleResult = {\n      fromResult: fromResult,\n      toResult: toResult,\n      svalue: svalue,\n      partition: partition$1,\n      serror: serror,\n      bind: bind$1,\n      bindError: bindError,\n      map: map$2,\n      mapError: mapError,\n      fold: fold\n    };\n\n    var mergeValues$1 = function (values, base) {\n      return values.length > 0 ? SimpleResult.svalue(deepMerge(base, merge.apply(undefined, values))) : SimpleResult.svalue(base);\n    };\n    var mergeErrors$1 = function (errors) {\n      return compose(SimpleResult.serror, flatten)(errors);\n    };\n    var consolidateObj = function (objects, base) {\n      var partition = SimpleResult.partition(objects);\n      return partition.errors.length > 0 ? mergeErrors$1(partition.errors) : mergeValues$1(partition.values, base);\n    };\n    var consolidateArr = function (objects) {\n      var partitions = SimpleResult.partition(objects);\n      return partitions.errors.length > 0 ? mergeErrors$1(partitions.errors) : SimpleResult.svalue(partitions.values);\n    };\n    var ResultCombine = {\n      consolidateObj: consolidateObj,\n      consolidateArr: consolidateArr\n    };\n\n    var typeAdt = Adt.generate([\n      {\n        setOf: [\n          'validator',\n          'valueType'\n        ]\n      },\n      { arrOf: ['valueType'] },\n      { objOf: ['fields'] },\n      { itemOf: ['validator'] },\n      {\n        choiceOf: [\n          'key',\n          'branches'\n        ]\n      },\n      { thunk: ['description'] },\n      {\n        func: [\n          'args',\n          'outputSchema'\n        ]\n      }\n    ]);\n    var fieldAdt = Adt.generate([\n      {\n        field: [\n          'name',\n          'presence',\n          'type'\n        ]\n      },\n      { state: ['name'] }\n    ]);\n\n    var formatObj = function (input) {\n      return isObject(input) && keys(input).length > 100 ? ' removed due to size' : JSON.stringify(input, null, 2);\n    };\n    var formatErrors = function (errors) {\n      var es = errors.length > 10 ? errors.slice(0, 10).concat([{\n          path: [],\n          getErrorInfo: function () {\n            return '... (only showing first ten failures)';\n          }\n        }]) : errors;\n      return map$1(es, function (e) {\n        return 'Failed path: (' + e.path.join(' > ') + ')\\n' + e.getErrorInfo();\n      });\n    };\n\n    var nu$3 = function (path, getErrorInfo) {\n      return SimpleResult.serror([{\n          path: path,\n          getErrorInfo: getErrorInfo\n        }]);\n    };\n    var missingStrict = function (path, key, obj) {\n      return nu$3(path, function () {\n        return 'Could not find valid *strict* value for \"' + key + '\" in ' + formatObj(obj);\n      });\n    };\n    var missingKey = function (path, key) {\n      return nu$3(path, function () {\n        return 'Choice schema did not contain choice key: \"' + key + '\"';\n      });\n    };\n    var missingBranch = function (path, branches, branch) {\n      return nu$3(path, function () {\n        return 'The chosen schema: \"' + branch + '\" did not exist in branches: ' + formatObj(branches);\n      });\n    };\n    var unsupportedFields = function (path, unsupported) {\n      return nu$3(path, function () {\n        return 'There are unsupported fields: [' + unsupported.join(', ') + '] specified';\n      });\n    };\n    var custom = function (path, err) {\n      return nu$3(path, function () {\n        return err;\n      });\n    };\n\n    var adt$1 = Adt.generate([\n      {\n        field: [\n          'key',\n          'okey',\n          'presence',\n          'prop'\n        ]\n      },\n      {\n        state: [\n          'okey',\n          'instantiator'\n        ]\n      }\n    ]);\n    var strictAccess = function (path, obj, key) {\n      return readOptFrom(obj, key).fold(function () {\n        return missingStrict(path, key, obj);\n      }, SimpleResult.svalue);\n    };\n    var fallbackAccess = function (obj, key, fallbackThunk) {\n      var v = readOptFrom(obj, key).fold(function () {\n        return fallbackThunk(obj);\n      }, identity);\n      return SimpleResult.svalue(v);\n    };\n    var optionAccess = function (obj, key) {\n      return SimpleResult.svalue(readOptFrom(obj, key));\n    };\n    var optionDefaultedAccess = function (obj, key, fallback) {\n      var opt = readOptFrom(obj, key).map(function (val) {\n        return val === true ? fallback(obj) : val;\n      });\n      return SimpleResult.svalue(opt);\n    };\n    var cExtractOne = function (path, obj, field, strength) {\n      return field.fold(function (key, okey, presence, prop) {\n        var bundle = function (av) {\n          var result = prop.extract(path.concat([key]), strength, av);\n          return SimpleResult.map(result, function (res) {\n            return wrap(okey, strength(res));\n          });\n        };\n        var bundleAsOption = function (optValue) {\n          return optValue.fold(function () {\n            var outcome = wrap(okey, strength(Option.none()));\n            return SimpleResult.svalue(outcome);\n          }, function (ov) {\n            var result = prop.extract(path.concat([key]), strength, ov);\n            return SimpleResult.map(result, function (res) {\n              return wrap(okey, strength(Option.some(res)));\n            });\n          });\n        };\n        return function () {\n          return presence.fold(function () {\n            return SimpleResult.bind(strictAccess(path, obj, key), bundle);\n          }, function (fallbackThunk) {\n            return SimpleResult.bind(fallbackAccess(obj, key, fallbackThunk), bundle);\n          }, function () {\n            return SimpleResult.bind(optionAccess(obj, key), bundleAsOption);\n          }, function (fallbackThunk) {\n            return SimpleResult.bind(optionDefaultedAccess(obj, key, fallbackThunk), bundleAsOption);\n          }, function (baseThunk) {\n            var base = baseThunk(obj);\n            var result = SimpleResult.map(fallbackAccess(obj, key, constant({})), function (v) {\n              return deepMerge(base, v);\n            });\n            return SimpleResult.bind(result, bundle);\n          });\n        }();\n      }, function (okey, instantiator) {\n        var state = instantiator(obj);\n        return SimpleResult.svalue(wrap(okey, strength(state)));\n      });\n    };\n    var cExtract = function (path, obj, fields, strength) {\n      var results = map$1(fields, function (field) {\n        return cExtractOne(path, obj, field, strength);\n      });\n      return ResultCombine.consolidateObj(results, {});\n    };\n    var value$1 = function (validator) {\n      var extract = function (path, strength, val) {\n        return SimpleResult.bindError(validator(val, strength), function (err) {\n          return custom(path, err);\n        });\n      };\n      var toString = function () {\n        return 'val';\n      };\n      var toDsl = function () {\n        return typeAdt.itemOf(validator);\n      };\n      return {\n        extract: extract,\n        toString: toString,\n        toDsl: toDsl\n      };\n    };\n    var getSetKeys = function (obj) {\n      var keys$1 = keys(obj);\n      return filter(keys$1, function (k) {\n        return hasKey$1(obj, k);\n      });\n    };\n    var objOfOnly = function (fields) {\n      var delegate = objOf(fields);\n      var fieldNames = foldr(fields, function (acc, f) {\n        return f.fold(function (key) {\n          return deepMerge(acc, wrap$1(key, true));\n        }, constant(acc));\n      }, {});\n      var extract = function (path, strength, o) {\n        var keys = isBoolean(o) ? [] : getSetKeys(o);\n        var extra = filter(keys, function (k) {\n          return !hasKey$1(fieldNames, k);\n        });\n        return extra.length === 0 ? delegate.extract(path, strength, o) : unsupportedFields(path, extra);\n      };\n      return {\n        extract: extract,\n        toString: delegate.toString,\n        toDsl: delegate.toDsl\n      };\n    };\n    var objOf = function (fields) {\n      var extract = function (path, strength, o) {\n        return cExtract(path, o, fields, strength);\n      };\n      var toString = function () {\n        var fieldStrings = map$1(fields, function (field) {\n          return field.fold(function (key, okey, presence, prop) {\n            return key + ' -> ' + prop.toString();\n          }, function (okey, instantiator) {\n            return 'state(' + okey + ')';\n          });\n        });\n        return 'obj{\\n' + fieldStrings.join('\\n') + '}';\n      };\n      var toDsl = function () {\n        return typeAdt.objOf(map$1(fields, function (f) {\n          return f.fold(function (key, okey, presence, prop) {\n            return fieldAdt.field(key, presence, prop);\n          }, function (okey, instantiator) {\n            return fieldAdt.state(okey);\n          });\n        }));\n      };\n      return {\n        extract: extract,\n        toString: toString,\n        toDsl: toDsl\n      };\n    };\n    var arrOf = function (prop) {\n      var extract = function (path, strength, array) {\n        var results = map$1(array, function (a, i) {\n          return prop.extract(path.concat(['[' + i + ']']), strength, a);\n        });\n        return ResultCombine.consolidateArr(results);\n      };\n      var toString = function () {\n        return 'array(' + prop.toString() + ')';\n      };\n      var toDsl = function () {\n        return typeAdt.arrOf(prop);\n      };\n      return {\n        extract: extract,\n        toString: toString,\n        toDsl: toDsl\n      };\n    };\n    var setOf = function (validator, prop) {\n      var validateKeys = function (path, keys) {\n        return arrOf(value$1(validator)).extract(path, identity, keys);\n      };\n      var extract = function (path, strength, o) {\n        var keys$1 = keys(o);\n        var validatedKeys = validateKeys(path, keys$1);\n        return SimpleResult.bind(validatedKeys, function (validKeys) {\n          var schema = map$1(validKeys, function (vk) {\n            return adt$1.field(vk, vk, strict(), prop);\n          });\n          return objOf(schema).extract(path, strength, o);\n        });\n      };\n      var toString = function () {\n        return 'setOf(' + prop.toString() + ')';\n      };\n      var toDsl = function () {\n        return typeAdt.setOf(validator, prop);\n      };\n      return {\n        extract: extract,\n        toString: toString,\n        toDsl: toDsl\n      };\n    };\n    var anyValue = constant(value$1(SimpleResult.svalue));\n    var state = adt$1.state;\n    var field = adt$1.field;\n\n    var chooseFrom = function (path, strength, input, branches, ch) {\n      var fields = readOptFrom$1(branches, ch);\n      return fields.fold(function () {\n        return missingBranch(path, branches, ch);\n      }, function (vp) {\n        return vp.extract(path.concat(['branch: ' + ch]), strength, input);\n      });\n    };\n    var choose = function (key, branches) {\n      var extract = function (path, strength, input) {\n        var choice = readOptFrom$1(input, key);\n        return choice.fold(function () {\n          return missingKey(path, key);\n        }, function (chosen) {\n          return chooseFrom(path, strength, input, branches, chosen);\n        });\n      };\n      var toString = function () {\n        return 'chooseOn(' + key + '). Possible values: ' + keys(branches);\n      };\n      var toDsl = function () {\n        return typeAdt.choiceOf(key, branches);\n      };\n      return {\n        extract: extract,\n        toString: toString,\n        toDsl: toDsl\n      };\n    };\n\n    var _anyValue = value$1(SimpleResult.svalue);\n    var valueOf = function (validator) {\n      return value$1(function (v) {\n        return validator(v).fold(SimpleResult.serror, SimpleResult.svalue);\n      });\n    };\n    var setOf$1 = function (validator, prop) {\n      return setOf(function (v) {\n        return SimpleResult.fromResult(validator(v));\n      }, prop);\n    };\n    var extract = function (label, prop, strength, obj) {\n      var res = prop.extract([label], strength, obj);\n      return SimpleResult.mapError(res, function (errs) {\n        return {\n          input: obj,\n          errors: errs\n        };\n      });\n    };\n    var asRaw = function (label, prop, obj) {\n      return SimpleResult.toResult(extract(label, prop, identity, obj));\n    };\n    var getOrDie = function (extraction) {\n      return extraction.fold(function (errInfo) {\n        throw new Error(formatError(errInfo));\n      }, identity);\n    };\n    var asRawOrDie = function (label, prop, obj) {\n      return getOrDie(asRaw(label, prop, obj));\n    };\n    var formatError = function (errInfo) {\n      return 'Errors: \\n' + formatErrors(errInfo.errors) + '\\n\\nInput object: ' + formatObj(errInfo.input);\n    };\n    var choose$1 = function (key, branches) {\n      return choose(key, map(branches, objOf));\n    };\n    var anyValue$1 = constant(_anyValue);\n    var typedValue = function (validator, expectedType) {\n      return value$1(function (a) {\n        var actualType = typeof a;\n        return validator(a) ? SimpleResult.svalue(a) : SimpleResult.serror('Expected type: ' + expectedType + ' but got: ' + actualType);\n      });\n    };\n    var functionProcessor = typedValue(isFunction, 'function');\n\n    var strict$1 = function (key) {\n      return field(key, key, strict(), anyValue());\n    };\n    var strictOf = function (key, schema) {\n      return field(key, key, strict(), schema);\n    };\n    var strictFunction = function (key) {\n      return strictOf(key, functionProcessor);\n    };\n    var forbid = function (key, message) {\n      return field(key, key, asOption(), value$1(function (v) {\n        return SimpleResult.serror('The field: ' + key + ' is forbidden. ' + message);\n      }));\n    };\n    var strictObjOf = function (key, objSchema) {\n      return field(key, key, strict(), objOf(objSchema));\n    };\n    var option = function (key) {\n      return field(key, key, asOption(), anyValue());\n    };\n    var optionOf = function (key, schema) {\n      return field(key, key, asOption(), schema);\n    };\n    var optionObjOf = function (key, objSchema) {\n      return optionOf(key, objOf(objSchema));\n    };\n    var optionObjOfOnly = function (key, objSchema) {\n      return optionOf(key, objOfOnly(objSchema));\n    };\n    var defaulted$1 = function (key, fallback) {\n      return field(key, key, defaulted(fallback), anyValue());\n    };\n    var defaultedOf = function (key, fallback, schema) {\n      return field(key, key, defaulted(fallback), schema);\n    };\n    var defaultedObjOf = function (key, fallback, objSchema) {\n      return defaultedOf(key, fallback, objOf(objSchema));\n    };\n    var state$1 = function (okey, instantiator) {\n      return state(okey, instantiator);\n    };\n\n    var isSource = function (component, simulatedEvent) {\n      return eq(component.element(), simulatedEvent.event().target());\n    };\n\n    var nu$4 = function (parts) {\n      if (!hasKey$1(parts, 'can') && !hasKey$1(parts, 'abort') && !hasKey$1(parts, 'run')) {\n        throw new Error('EventHandler defined by: ' + JSON.stringify(parts, null, 2) + ' does not have can, abort, or run!');\n      }\n      return asRawOrDie('Extracting event.handler', objOfOnly([\n        defaulted$1('can', constant(true)),\n        defaulted$1('abort', constant(false)),\n        defaulted$1('run', noop)\n      ]), parts);\n    };\n    var all$1 = function (handlers, f) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return foldl(handlers, function (acc, handler) {\n          return acc && f(handler).apply(undefined, args);\n        }, true);\n      };\n    };\n    var any = function (handlers, f) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return foldl(handlers, function (acc, handler) {\n          return acc || f(handler).apply(undefined, args);\n        }, false);\n      };\n    };\n    var read = function (handler) {\n      return isFunction(handler) ? {\n        can: constant(true),\n        abort: constant(false),\n        run: handler\n      } : handler;\n    };\n    var fuse = function (handlers) {\n      var can = all$1(handlers, function (handler) {\n        return handler.can;\n      });\n      var abort = any(handlers, function (handler) {\n        return handler.abort;\n      });\n      var run = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        each$1(handlers, function (handler) {\n          handler.run.apply(undefined, args);\n        });\n      };\n      return nu$4({\n        can: can,\n        abort: abort,\n        run: run\n      });\n    };\n\n    function ClosestOrAncestor (is, ancestor, scope, a, isRoot) {\n      return is(scope, a) ? Option.some(scope) : isFunction(isRoot) && isRoot(scope) ? Option.none() : ancestor(scope, a, isRoot);\n    }\n\n    var ancestor = function (scope, predicate, isRoot) {\n      var element = scope.dom();\n      var stop = isFunction(isRoot) ? isRoot : constant(false);\n      while (element.parentNode) {\n        element = element.parentNode;\n        var el = Element.fromDom(element);\n        if (predicate(el)) {\n          return Option.some(el);\n        } else if (stop(el)) {\n          break;\n        }\n      }\n      return Option.none();\n    };\n    var closest = function (scope, predicate, isRoot) {\n      var is = function (s, test) {\n        return test(s);\n      };\n      return ClosestOrAncestor(is, ancestor, scope, predicate, isRoot);\n    };\n    var descendant = function (scope, predicate) {\n      var descend = function (node) {\n        for (var i = 0; i < node.childNodes.length; i++) {\n          var child_1 = Element.fromDom(node.childNodes[i]);\n          if (predicate(child_1)) {\n            return Option.some(child_1);\n          }\n          var res = descend(node.childNodes[i]);\n          if (res.isSome()) {\n            return res;\n          }\n        }\n        return Option.none();\n      };\n      return descend(scope.dom());\n    };\n\n    var closest$1 = function (target, transform, isRoot) {\n      var delegate = closest(target, function (elem) {\n        return transform(elem).isSome();\n      }, isRoot);\n      return delegate.bind(transform);\n    };\n\n    var derive = function (configs) {\n      return wrapAll$1(configs);\n    };\n    var abort = function (name, predicate) {\n      return {\n        key: name,\n        value: nu$4({ abort: predicate })\n      };\n    };\n    var can = function (name, predicate) {\n      return {\n        key: name,\n        value: nu$4({ can: predicate })\n      };\n    };\n    var run = function (name, handler) {\n      return {\n        key: name,\n        value: nu$4({ run: handler })\n      };\n    };\n    var runActionExtra = function (name, action, extra) {\n      return {\n        key: name,\n        value: nu$4({\n          run: function (component) {\n            action.apply(undefined, [component].concat(extra));\n          }\n        })\n      };\n    };\n    var runOnName = function (name) {\n      return function (handler) {\n        return run(name, handler);\n      };\n    };\n    var runOnSourceName = function (name) {\n      return function (handler) {\n        return {\n          key: name,\n          value: nu$4({\n            run: function (component, simulatedEvent) {\n              if (isSource(component, simulatedEvent)) {\n                handler(component, simulatedEvent);\n              }\n            }\n          })\n        };\n      };\n    };\n    var redirectToUid = function (name, uid) {\n      return run(name, function (component, simulatedEvent) {\n        component.getSystem().getByUid(uid).each(function (redirectee) {\n          dispatchEvent(redirectee, redirectee.element(), name, simulatedEvent);\n        });\n      });\n    };\n    var redirectToPart = function (name, detail, partName) {\n      var uid = detail.partUids[partName];\n      return redirectToUid(name, uid);\n    };\n    var cutter = function (name) {\n      return run(name, function (component, simulatedEvent) {\n        simulatedEvent.cut();\n      });\n    };\n    var stopper = function (name) {\n      return run(name, function (component, simulatedEvent) {\n        simulatedEvent.stop();\n      });\n    };\n    var runOnSource = function (name, f) {\n      return runOnSourceName(name)(f);\n    };\n    var runOnAttached = runOnSourceName(attachedToDom());\n    var runOnDetached = runOnSourceName(detachedFromDom());\n    var runOnInit = runOnSourceName(systemInit());\n    var runOnExecute = runOnName(execute());\n\n    var markAsBehaviourApi = function (f, apiName, apiFunction) {\n      var delegate = apiFunction.toString();\n      var endIndex = delegate.indexOf(')') + 1;\n      var openBracketIndex = delegate.indexOf('(');\n      var parameters = delegate.substring(openBracketIndex + 1, endIndex - 1).split(/,\\s*/);\n      f.toFunctionAnnotation = function () {\n        return {\n          name: apiName,\n          parameters: cleanParameters(parameters.slice(0, 1).concat(parameters.slice(3)))\n        };\n      };\n      return f;\n    };\n    var cleanParameters = function (parameters) {\n      return map$1(parameters, function (p) {\n        return endsWith(p, '/*') ? p.substring(0, p.length - '/*'.length) : p;\n      });\n    };\n    var markAsExtraApi = function (f, extraName) {\n      var delegate = f.toString();\n      var endIndex = delegate.indexOf(')') + 1;\n      var openBracketIndex = delegate.indexOf('(');\n      var parameters = delegate.substring(openBracketIndex + 1, endIndex - 1).split(/,\\s*/);\n      f.toFunctionAnnotation = function () {\n        return {\n          name: extraName,\n          parameters: cleanParameters(parameters)\n        };\n      };\n      return f;\n    };\n    var markAsSketchApi = function (f, apiFunction) {\n      var delegate = apiFunction.toString();\n      var endIndex = delegate.indexOf(')') + 1;\n      var openBracketIndex = delegate.indexOf('(');\n      var parameters = delegate.substring(openBracketIndex + 1, endIndex - 1).split(/,\\s*/);\n      f.toFunctionAnnotation = function () {\n        return {\n          name: 'OVERRIDE',\n          parameters: cleanParameters(parameters.slice(1))\n        };\n      };\n      return f;\n    };\n\n    var nu$5 = function (s) {\n      return {\n        classes: s.classes !== undefined ? s.classes : [],\n        attributes: s.attributes !== undefined ? s.attributes : {},\n        styles: s.styles !== undefined ? s.styles : {}\n      };\n    };\n    var merge$1 = function (defnA, mod) {\n      return __assign(__assign({}, defnA), {\n        attributes: __assign(__assign({}, defnA.attributes), mod.attributes),\n        styles: __assign(__assign({}, defnA.styles), mod.styles),\n        classes: defnA.classes.concat(mod.classes)\n      });\n    };\n\n    var executeEvent = function (bConfig, bState, executor) {\n      return runOnExecute(function (component) {\n        executor(component, bConfig, bState);\n      });\n    };\n    var loadEvent = function (bConfig, bState, f) {\n      return runOnInit(function (component, simulatedEvent) {\n        f(component, bConfig, bState);\n      });\n    };\n    var create = function (schema, name, active, apis, extra, state) {\n      var configSchema = objOfOnly(schema);\n      var schemaSchema = optionObjOf(name, [optionObjOfOnly('config', schema)]);\n      return doCreate(configSchema, schemaSchema, name, active, apis, extra, state);\n    };\n    var createModes = function (modes, name, active, apis, extra, state) {\n      var configSchema = modes;\n      var schemaSchema = optionObjOf(name, [optionOf('config', modes)]);\n      return doCreate(configSchema, schemaSchema, name, active, apis, extra, state);\n    };\n    var wrapApi = function (bName, apiFunction, apiName) {\n      var f = function (component) {\n        var rest = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n          rest[_i - 1] = arguments[_i];\n        }\n        var args = [component].concat(rest);\n        return component.config({ name: constant(bName) }).fold(function () {\n          throw new Error('We could not find any behaviour configuration for: ' + bName + '. Using API: ' + apiName);\n        }, function (info) {\n          var rest = Array.prototype.slice.call(args, 1);\n          return apiFunction.apply(undefined, [\n            component,\n            info.config,\n            info.state\n          ].concat(rest));\n        });\n      };\n      return markAsBehaviourApi(f, apiName, apiFunction);\n    };\n    var revokeBehaviour = function (name) {\n      return {\n        key: name,\n        value: undefined\n      };\n    };\n    var doCreate = function (configSchema, schemaSchema, name, active, apis, extra, state) {\n      var getConfig = function (info) {\n        return hasKey$1(info, name) ? info[name]() : Option.none();\n      };\n      var wrappedApis = map(apis, function (apiF, apiName) {\n        return wrapApi(name, apiF, apiName);\n      });\n      var wrappedExtra = map(extra, function (extraF, extraName) {\n        return markAsExtraApi(extraF, extraName);\n      });\n      var me = __assign(__assign(__assign({}, wrappedExtra), wrappedApis), {\n        revoke: curry(revokeBehaviour, name),\n        config: function (spec) {\n          var prepared = asRawOrDie(name + '-config', configSchema, spec);\n          return {\n            key: name,\n            value: {\n              config: prepared,\n              me: me,\n              configAsRaw: cached(function () {\n                return asRawOrDie(name + '-config', configSchema, spec);\n              }),\n              initialConfig: spec,\n              state: state\n            }\n          };\n        },\n        schema: function () {\n          return schemaSchema;\n        },\n        exhibit: function (info, base) {\n          return getConfig(info).bind(function (behaviourInfo) {\n            return readOptFrom$1(active, 'exhibit').map(function (exhibitor) {\n              return exhibitor(base, behaviourInfo.config, behaviourInfo.state);\n            });\n          }).getOr(nu$5({}));\n        },\n        name: function () {\n          return name;\n        },\n        handlers: function (info) {\n          return getConfig(info).map(function (behaviourInfo) {\n            var getEvents = readOr$1('events', function (a, b) {\n              return {};\n            })(active);\n            return getEvents(behaviourInfo.config, behaviourInfo.state);\n          }).getOr({});\n        }\n      });\n      return me;\n    };\n\n    var NoState = {\n      init: function () {\n        return nu$6({\n          readState: function () {\n            return 'No State required';\n          }\n        });\n      }\n    };\n    var nu$6 = function (spec) {\n      return spec;\n    };\n\n    var derive$1 = function (capabilities) {\n      return wrapAll$1(capabilities);\n    };\n    var simpleSchema = objOfOnly([\n      strict$1('fields'),\n      strict$1('name'),\n      defaulted$1('active', {}),\n      defaulted$1('apis', {}),\n      defaulted$1('state', NoState),\n      defaulted$1('extra', {})\n    ]);\n    var create$1 = function (data) {\n      var value = asRawOrDie('Creating behaviour: ' + data.name, simpleSchema, data);\n      return create(value.fields, value.name, value.active, value.apis, value.extra, value.state);\n    };\n    var modeSchema = objOfOnly([\n      strict$1('branchKey'),\n      strict$1('branches'),\n      strict$1('name'),\n      defaulted$1('active', {}),\n      defaulted$1('apis', {}),\n      defaulted$1('state', NoState),\n      defaulted$1('extra', {})\n    ]);\n    var createModes$1 = function (data) {\n      var value = asRawOrDie('Creating behaviour: ' + data.name, modeSchema, data);\n      return createModes(choose$1(value.branchKey, value.branches), value.name, value.active, value.apis, value.extra, value.state);\n    };\n    var revoke = constant(undefined);\n\n    var rawSet = function (dom, key, value) {\n      if (isString(value) || isBoolean(value) || isNumber(value)) {\n        dom.setAttribute(key, value + '');\n      } else {\n        domGlobals.console.error('Invalid call to Attr.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n        throw new Error('Attribute value was not simple');\n      }\n    };\n    var set = function (element, key, value) {\n      rawSet(element.dom(), key, value);\n    };\n    var setAll = function (element, attrs) {\n      var dom = element.dom();\n      each(attrs, function (v, k) {\n        rawSet(dom, k, v);\n      });\n    };\n    var get = function (element, key) {\n      var v = element.dom().getAttribute(key);\n      return v === null ? undefined : v;\n    };\n    var has$1 = function (element, key) {\n      var dom = element.dom();\n      return dom && dom.hasAttribute ? dom.hasAttribute(key) : false;\n    };\n    var remove$1 = function (element, key) {\n      element.dom().removeAttribute(key);\n    };\n\n    var read$1 = function (element, attr) {\n      var value = get(element, attr);\n      return value === undefined || value === '' ? [] : value.split(' ');\n    };\n    var add = function (element, attr, id) {\n      var old = read$1(element, attr);\n      var nu = old.concat([id]);\n      set(element, attr, nu.join(' '));\n      return true;\n    };\n    var remove$2 = function (element, attr, id) {\n      var nu = filter(read$1(element, attr), function (v) {\n        return v !== id;\n      });\n      if (nu.length > 0) {\n        set(element, attr, nu.join(' '));\n      } else {\n        remove$1(element, attr);\n      }\n      return false;\n    };\n\n    var supports = function (element) {\n      return element.dom().classList !== undefined;\n    };\n    var get$1 = function (element) {\n      return read$1(element, 'class');\n    };\n    var add$1 = function (element, clazz) {\n      return add(element, 'class', clazz);\n    };\n    var remove$3 = function (element, clazz) {\n      return remove$2(element, 'class', clazz);\n    };\n\n    var add$2 = function (element, clazz) {\n      if (supports(element)) {\n        element.dom().classList.add(clazz);\n      } else {\n        add$1(element, clazz);\n      }\n    };\n    var cleanClass = function (element) {\n      var classList = supports(element) ? element.dom().classList : get$1(element);\n      if (classList.length === 0) {\n        remove$1(element, 'class');\n      }\n    };\n    var remove$4 = function (element, clazz) {\n      if (supports(element)) {\n        var classList = element.dom().classList;\n        classList.remove(clazz);\n      } else {\n        remove$3(element, clazz);\n      }\n      cleanClass(element);\n    };\n    var has$2 = function (element, clazz) {\n      return supports(element) && element.dom().classList.contains(clazz);\n    };\n\n    var swap = function (element, addCls, removeCls) {\n      remove$4(element, removeCls);\n      add$2(element, addCls);\n    };\n    var toAlpha = function (component, swapConfig, swapState) {\n      swap(component.element(), swapConfig.alpha, swapConfig.omega);\n    };\n    var toOmega = function (component, swapConfig, swapState) {\n      swap(component.element(), swapConfig.omega, swapConfig.alpha);\n    };\n    var clear = function (component, swapConfig, swapState) {\n      remove$4(component.element(), swapConfig.alpha);\n      remove$4(component.element(), swapConfig.omega);\n    };\n    var isAlpha = function (component, swapConfig, swapState) {\n      return has$2(component.element(), swapConfig.alpha);\n    };\n    var isOmega = function (component, swapConfig, swapState) {\n      return has$2(component.element(), swapConfig.omega);\n    };\n\n    var SwapApis = /*#__PURE__*/Object.freeze({\n        toAlpha: toAlpha,\n        toOmega: toOmega,\n        isAlpha: isAlpha,\n        isOmega: isOmega,\n        clear: clear\n    });\n\n    var SwapSchema = [\n      strict$1('alpha'),\n      strict$1('omega')\n    ];\n\n    var Swapping = create$1({\n      fields: SwapSchema,\n      name: 'swapping',\n      apis: SwapApis\n    });\n\n    var focus$1 = function (element) {\n      element.dom().focus();\n    };\n    var blur = function (element) {\n      element.dom().blur();\n    };\n    var hasFocus = function (element) {\n      var doc = owner(element).dom();\n      return element.dom() === doc.activeElement;\n    };\n    var active = function (_doc) {\n      var doc = _doc !== undefined ? _doc.dom() : domGlobals.document;\n      return Option.from(doc.activeElement).map(Element.fromDom);\n    };\n    var search = function (element) {\n      return active(owner(element)).filter(function (e) {\n        return element.dom().contains(e.dom());\n      });\n    };\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.ThemeManager');\n\n    var openLink = function (target) {\n      var link = domGlobals.document.createElement('a');\n      link.target = '_blank';\n      link.href = target.href;\n      link.rel = 'noreferrer noopener';\n      var nuEvt = domGlobals.document.createEvent('MouseEvents');\n      nuEvt.initMouseEvent('click', true, true, domGlobals.window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\n      domGlobals.document.body.appendChild(link);\n      link.dispatchEvent(nuEvt);\n      domGlobals.document.body.removeChild(link);\n    };\n    var TinyCodeDupe = { openLink: openLink };\n\n    var isSkinDisabled = function (editor) {\n      return editor.settings.skin === false;\n    };\n    var readOnlyOnInit = function (editor) {\n      return false;\n    };\n\n    var formatChanged = 'formatChanged';\n    var orientationChanged = 'orientationChanged';\n    var dropupDismissed = 'dropupDismissed';\n    var TinyChannels = {\n      formatChanged: constant(formatChanged),\n      orientationChanged: constant(orientationChanged),\n      dropupDismissed: constant(dropupDismissed)\n    };\n\n    var fromHtml$1 = function (html, scope) {\n      var doc = scope || domGlobals.document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      return children(Element.fromDom(div));\n    };\n\n    var get$2 = function (element) {\n      return element.dom().innerHTML;\n    };\n    var set$1 = function (element, content) {\n      var owner$1 = owner(element);\n      var docDom = owner$1.dom();\n      var fragment = Element.fromDom(docDom.createDocumentFragment());\n      var contentElements = fromHtml$1(content, docDom);\n      append$1(fragment, contentElements);\n      empty(element);\n      append(element, fragment);\n    };\n    var getOuter = function (element) {\n      var container = Element.fromTag('div');\n      var clone = Element.fromDom(element.dom().cloneNode(true));\n      append(container, clone);\n      return get$2(container);\n    };\n\n    var clone = function (original, isDeep) {\n      return Element.fromDom(original.dom().cloneNode(isDeep));\n    };\n    var shallow$1 = function (original) {\n      return clone(original, false);\n    };\n\n    var getHtml = function (element) {\n      var clone = shallow$1(element);\n      return getOuter(clone);\n    };\n\n    var element = function (elem) {\n      return getHtml(elem);\n    };\n\n    var chooseChannels = function (channels, message) {\n      return message.universal() ? channels : filter(channels, function (ch) {\n        return contains(message.channels(), ch);\n      });\n    };\n    var events = function (receiveConfig) {\n      return derive([run(receive(), function (component, message) {\n          var channelMap = receiveConfig.channels;\n          var channels = keys(channelMap);\n          var targetChannels = chooseChannels(channels, message);\n          each$1(targetChannels, function (ch) {\n            var channelInfo = channelMap[ch];\n            var channelSchema = channelInfo.schema;\n            var data = asRawOrDie('channel[' + ch + '] data\\nReceiver: ' + element(component.element()), channelSchema, message.data());\n            channelInfo.onReceive(component, data);\n          });\n        })]);\n    };\n\n    var ActiveReceiving = /*#__PURE__*/Object.freeze({\n        events: events\n    });\n\n    var cat = function (arr) {\n      var r = [];\n      var push = function (x) {\n        r.push(x);\n      };\n      for (var i = 0; i < arr.length; i++) {\n        arr[i].each(push);\n      }\n      return r;\n    };\n    var sequence = function (arr) {\n      var r = [];\n      for (var i = 0; i < arr.length; i++) {\n        var x = arr[i];\n        if (x.isSome()) {\n          r.push(x.getOrDie());\n        } else {\n          return Option.none();\n        }\n      }\n      return Option.some(r);\n    };\n    var findMap = function (arr, f) {\n      for (var i = 0; i < arr.length; i++) {\n        var r = f(arr[i], i);\n        if (r.isSome()) {\n          return r;\n        }\n      }\n      return Option.none();\n    };\n    var someIf = function (b, a) {\n      return b ? Option.some(a) : Option.none();\n    };\n\n    var unknown$3 = 'unknown';\n    var EventConfiguration;\n    (function (EventConfiguration) {\n      EventConfiguration[EventConfiguration['STOP'] = 0] = 'STOP';\n      EventConfiguration[EventConfiguration['NORMAL'] = 1] = 'NORMAL';\n      EventConfiguration[EventConfiguration['LOGGING'] = 2] = 'LOGGING';\n    }(EventConfiguration || (EventConfiguration = {})));\n    var eventConfig = Cell({});\n    var makeEventLogger = function (eventName, initialTarget) {\n      var sequence = [];\n      var startTime = new Date().getTime();\n      return {\n        logEventCut: function (name, target, purpose) {\n          sequence.push({\n            outcome: 'cut',\n            target: target,\n            purpose: purpose\n          });\n        },\n        logEventStopped: function (name, target, purpose) {\n          sequence.push({\n            outcome: 'stopped',\n            target: target,\n            purpose: purpose\n          });\n        },\n        logNoParent: function (name, target, purpose) {\n          sequence.push({\n            outcome: 'no-parent',\n            target: target,\n            purpose: purpose\n          });\n        },\n        logEventNoHandlers: function (name, target) {\n          sequence.push({\n            outcome: 'no-handlers-left',\n            target: target\n          });\n        },\n        logEventResponse: function (name, target, purpose) {\n          sequence.push({\n            outcome: 'response',\n            purpose: purpose,\n            target: target\n          });\n        },\n        write: function () {\n          var finishTime = new Date().getTime();\n          if (contains([\n              'mousemove',\n              'mouseover',\n              'mouseout',\n              systemInit()\n            ], eventName)) {\n            return;\n          }\n          domGlobals.console.log(eventName, {\n            event: eventName,\n            time: finishTime - startTime,\n            target: initialTarget.dom(),\n            sequence: map$1(sequence, function (s) {\n              if (!contains([\n                  'cut',\n                  'stopped',\n                  'response'\n                ], s.outcome)) {\n                return s.outcome;\n              } else {\n                return '{' + s.purpose + '} ' + s.outcome + ' at (' + element(s.target) + ')';\n              }\n            })\n          });\n        }\n      };\n    };\n    var processEvent = function (eventName, initialTarget, f) {\n      var status = readOptFrom$1(eventConfig.get(), eventName).orThunk(function () {\n        var patterns = keys(eventConfig.get());\n        return findMap(patterns, function (p) {\n          return eventName.indexOf(p) > -1 ? Option.some(eventConfig.get()[p]) : Option.none();\n        });\n      }).getOr(EventConfiguration.NORMAL);\n      switch (status) {\n      case EventConfiguration.NORMAL:\n        return f(noLogger());\n      case EventConfiguration.LOGGING: {\n          var logger = makeEventLogger(eventName, initialTarget);\n          var output = f(logger);\n          logger.write();\n          return output;\n        }\n      case EventConfiguration.STOP:\n        return true;\n      }\n    };\n    var path = [\n      'alloy/data/Fields',\n      'alloy/debugging/Debugging'\n    ];\n    var getTrace = function () {\n      var err = new Error();\n      if (err.stack !== undefined) {\n        var lines = err.stack.split('\\n');\n        return find$2(lines, function (line) {\n          return line.indexOf('alloy') > 0 && !exists(path, function (p) {\n            return line.indexOf(p) > -1;\n          });\n        }).getOr(unknown$3);\n      } else {\n        return unknown$3;\n      }\n    };\n    var ignoreEvent = {\n      logEventCut: noop,\n      logEventStopped: noop,\n      logNoParent: noop,\n      logEventNoHandlers: noop,\n      logEventResponse: noop,\n      write: noop\n    };\n    var monitorEvent = function (eventName, initialTarget, f) {\n      return processEvent(eventName, initialTarget, f);\n    };\n    var noLogger = constant(ignoreEvent);\n\n    var menuFields = constant([\n      strict$1('menu'),\n      strict$1('selectedMenu')\n    ]);\n    var itemFields = constant([\n      strict$1('item'),\n      strict$1('selectedItem')\n    ]);\n    var schema = constant(objOf(itemFields().concat(menuFields())));\n    var itemSchema = constant(objOf(itemFields()));\n\n    var _initSize = strictObjOf('initSize', [\n      strict$1('numColumns'),\n      strict$1('numRows')\n    ]);\n    var itemMarkers = function () {\n      return strictOf('markers', itemSchema());\n    };\n    var tieredMenuMarkers = function () {\n      return strictObjOf('markers', [strict$1('backgroundMenu')].concat(menuFields()).concat(itemFields()));\n    };\n    var markers = function (required) {\n      return strictObjOf('markers', map$1(required, strict$1));\n    };\n    var onPresenceHandler = function (label, fieldName, presence) {\n      var trace = getTrace();\n      return field(fieldName, fieldName, presence, valueOf(function (f) {\n        return Result.value(function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          return f.apply(undefined, args);\n        });\n      }));\n    };\n    var onHandler = function (fieldName) {\n      return onPresenceHandler('onHandler', fieldName, defaulted(noop));\n    };\n    var onKeyboardHandler = function (fieldName) {\n      return onPresenceHandler('onKeyboardHandler', fieldName, defaulted(Option.none));\n    };\n    var onStrictHandler = function (fieldName) {\n      return onPresenceHandler('onHandler', fieldName, strict());\n    };\n    var onStrictKeyboardHandler = function (fieldName) {\n      return onPresenceHandler('onKeyboardHandler', fieldName, strict());\n    };\n    var output = function (name, value) {\n      return state$1(name, constant(value));\n    };\n    var snapshot = function (name) {\n      return state$1(name, identity);\n    };\n    var initSize = constant(_initSize);\n\n    var ReceivingSchema = [strictOf('channels', setOf$1(Result.value, objOfOnly([\n        onStrictHandler('onReceive'),\n        defaulted$1('schema', anyValue$1())\n      ])))];\n\n    var Receiving = create$1({\n      fields: ReceivingSchema,\n      name: 'receiving',\n      active: ActiveReceiving\n    });\n\n    var updateAriaState = function (component, toggleConfig, toggleState) {\n      var ariaInfo = toggleConfig.aria;\n      ariaInfo.update(component, ariaInfo, toggleState.get());\n    };\n    var updateClass = function (component, toggleConfig, toggleState) {\n      toggleConfig.toggleClass.each(function (toggleClass) {\n        if (toggleState.get()) {\n          add$2(component.element(), toggleClass);\n        } else {\n          remove$4(component.element(), toggleClass);\n        }\n      });\n    };\n    var toggle = function (component, toggleConfig, toggleState) {\n      set$2(component, toggleConfig, toggleState, !toggleState.get());\n    };\n    var on = function (component, toggleConfig, toggleState) {\n      toggleState.set(true);\n      updateClass(component, toggleConfig, toggleState);\n      updateAriaState(component, toggleConfig, toggleState);\n    };\n    var off = function (component, toggleConfig, toggleState) {\n      toggleState.set(false);\n      updateClass(component, toggleConfig, toggleState);\n      updateAriaState(component, toggleConfig, toggleState);\n    };\n    var set$2 = function (component, toggleConfig, toggleState, state) {\n      var action = state ? on : off;\n      action(component, toggleConfig, toggleState);\n    };\n    var isOn = function (component, toggleConfig, toggleState) {\n      return toggleState.get();\n    };\n    var onLoad = function (component, toggleConfig, toggleState) {\n      set$2(component, toggleConfig, toggleState, toggleConfig.selected);\n    };\n\n    var ToggleApis = /*#__PURE__*/Object.freeze({\n        onLoad: onLoad,\n        toggle: toggle,\n        isOn: isOn,\n        on: on,\n        off: off,\n        set: set$2\n    });\n\n    var exhibit = function (base, toggleConfig, toggleState) {\n      return nu$5({});\n    };\n    var events$1 = function (toggleConfig, toggleState) {\n      var execute = executeEvent(toggleConfig, toggleState, toggle);\n      var load = loadEvent(toggleConfig, toggleState, onLoad);\n      return derive(flatten([\n        toggleConfig.toggleOnExecute ? [execute] : [],\n        [load]\n      ]));\n    };\n\n    var ActiveToggle = /*#__PURE__*/Object.freeze({\n        exhibit: exhibit,\n        events: events$1\n    });\n\n    var SetupBehaviourCellState = function (initialState) {\n      var init = function () {\n        var cell = Cell(initialState);\n        var get = function () {\n          return cell.get();\n        };\n        var set = function (newState) {\n          return cell.set(newState);\n        };\n        var clear = function () {\n          return cell.set(initialState);\n        };\n        var readState = function () {\n          return cell.get();\n        };\n        return {\n          get: get,\n          set: set,\n          clear: clear,\n          readState: readState\n        };\n      };\n      return { init: init };\n    };\n\n    var updatePressed = function (component, ariaInfo, status) {\n      set(component.element(), 'aria-pressed', status);\n      if (ariaInfo.syncWithExpanded) {\n        updateExpanded(component, ariaInfo, status);\n      }\n    };\n    var updateSelected = function (component, ariaInfo, status) {\n      set(component.element(), 'aria-selected', status);\n    };\n    var updateChecked = function (component, ariaInfo, status) {\n      set(component.element(), 'aria-checked', status);\n    };\n    var updateExpanded = function (component, ariaInfo, status) {\n      set(component.element(), 'aria-expanded', status);\n    };\n\n    var ToggleSchema = [\n      defaulted$1('selected', false),\n      option('toggleClass'),\n      defaulted$1('toggleOnExecute', true),\n      defaultedOf('aria', { mode: 'none' }, choose$1('mode', {\n        pressed: [\n          defaulted$1('syncWithExpanded', false),\n          output('update', updatePressed)\n        ],\n        checked: [output('update', updateChecked)],\n        expanded: [output('update', updateExpanded)],\n        selected: [output('update', updateSelected)],\n        none: [output('update', noop)]\n      }))\n    ];\n\n    var Toggling = create$1({\n      fields: ToggleSchema,\n      name: 'toggling',\n      active: ActiveToggle,\n      apis: ToggleApis,\n      state: SetupBehaviourCellState(false)\n    });\n\n    var format = function (command, update) {\n      return Receiving.config({\n        channels: wrap$1(TinyChannels.formatChanged(), {\n          onReceive: function (button, data) {\n            if (data.command === command) {\n              update(button, data.state);\n            }\n          }\n        })\n      });\n    };\n    var orientation = function (onReceive) {\n      return Receiving.config({ channels: wrap$1(TinyChannels.orientationChanged(), { onReceive: onReceive }) });\n    };\n    var receive$1 = function (channel, onReceive) {\n      return {\n        key: channel,\n        value: { onReceive: onReceive }\n      };\n    };\n    var Receivers = {\n      format: format,\n      orientation: orientation,\n      receive: receive$1\n    };\n\n    var prefix = 'tinymce-mobile';\n    var resolve = function (p) {\n      return prefix + '-' + p;\n    };\n    var Styles = {\n      resolve: resolve,\n      prefix: constant(prefix)\n    };\n\n    var events$2 = function (optAction) {\n      var executeHandler = function (action) {\n        return run(execute(), function (component, simulatedEvent) {\n          action(component);\n          simulatedEvent.stop();\n        });\n      };\n      var onClick = function (component, simulatedEvent) {\n        simulatedEvent.stop();\n        emitExecute(component);\n      };\n      var onMousedown = function (component, simulatedEvent) {\n        simulatedEvent.cut();\n      };\n      var pointerEvents = detect$3().deviceType.isTouch() ? [run(tap(), onClick)] : [\n        run(click(), onClick),\n        run(mousedown(), onMousedown)\n      ];\n      return derive(flatten([\n        optAction.map(executeHandler).toArray(),\n        pointerEvents\n      ]));\n    };\n\n    var focus$2 = function (component, focusConfig) {\n      if (!focusConfig.ignore) {\n        focus$1(component.element());\n        focusConfig.onFocus(component);\n      }\n    };\n    var blur$1 = function (component, focusConfig) {\n      if (!focusConfig.ignore) {\n        blur(component.element());\n      }\n    };\n    var isFocused = function (component) {\n      return hasFocus(component.element());\n    };\n\n    var FocusApis = /*#__PURE__*/Object.freeze({\n        focus: focus$2,\n        blur: blur$1,\n        isFocused: isFocused\n    });\n\n    var exhibit$1 = function (base, focusConfig) {\n      var mod = focusConfig.ignore ? {} : { attributes: { tabindex: '-1' } };\n      return nu$5(mod);\n    };\n    var events$3 = function (focusConfig) {\n      return derive([run(focus(), function (component, simulatedEvent) {\n          focus$2(component, focusConfig);\n          simulatedEvent.stop();\n        })].concat(focusConfig.stopMousedown ? [run(mousedown(), function (_, simulatedEvent) {\n          simulatedEvent.event().prevent();\n        })] : []));\n    };\n\n    var ActiveFocus = /*#__PURE__*/Object.freeze({\n        exhibit: exhibit$1,\n        events: events$3\n    });\n\n    var FocusSchema = [\n      onHandler('onFocus'),\n      defaulted$1('stopMousedown', false),\n      defaulted$1('ignore', false)\n    ];\n\n    var Focusing = create$1({\n      fields: FocusSchema,\n      name: 'focusing',\n      active: ActiveFocus,\n      apis: FocusApis\n    });\n\n    var isSupported = function (dom) {\n      return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n    };\n\n    var internalSet = function (dom, property, value) {\n      if (!isString(value)) {\n        domGlobals.console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n        throw new Error('CSS value must be a string: ' + value);\n      }\n      if (isSupported(dom)) {\n        dom.style.setProperty(property, value);\n      }\n    };\n    var internalRemove = function (dom, property) {\n      if (isSupported(dom)) {\n        dom.style.removeProperty(property);\n      }\n    };\n    var set$3 = function (element, property, value) {\n      var dom = element.dom();\n      internalSet(dom, property, value);\n    };\n    var setAll$1 = function (element, css) {\n      var dom = element.dom();\n      each(css, function (v, k) {\n        internalSet(dom, k, v);\n      });\n    };\n    var get$3 = function (element, property) {\n      var dom = element.dom();\n      var styles = domGlobals.window.getComputedStyle(dom);\n      var r = styles.getPropertyValue(property);\n      var v = r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n      return v === null ? undefined : v;\n    };\n    var getUnsafeProperty = function (dom, property) {\n      return isSupported(dom) ? dom.style.getPropertyValue(property) : '';\n    };\n    var getRaw = function (element, property) {\n      var dom = element.dom();\n      var raw = getUnsafeProperty(dom, property);\n      return Option.from(raw).filter(function (r) {\n        return r.length > 0;\n      });\n    };\n    var remove$5 = function (element, property) {\n      var dom = element.dom();\n      internalRemove(dom, property);\n      if (has$1(element, 'style') && trim(get(element, 'style')) === '') {\n        remove$1(element, 'style');\n      }\n    };\n    var reflow = function (e) {\n      return e.dom().offsetWidth;\n    };\n\n    function Dimension (name, getOffset) {\n      var set = function (element, h) {\n        if (!isNumber(h) && !h.match(/^[0-9]+$/)) {\n          throw new Error(name + '.set accepts only positive integer values. Value was ' + h);\n        }\n        var dom = element.dom();\n        if (isSupported(dom)) {\n          dom.style[name] = h + 'px';\n        }\n      };\n      var get = function (element) {\n        var r = getOffset(element);\n        if (r <= 0 || r === null) {\n          var css = get$3(element, name);\n          return parseFloat(css) || 0;\n        }\n        return r;\n      };\n      var getOuter = get;\n      var aggregate = function (element, properties) {\n        return foldl(properties, function (acc, property) {\n          var val = get$3(element, property);\n          var value = val === undefined ? 0 : parseInt(val, 10);\n          return isNaN(value) ? acc : acc + value;\n        }, 0);\n      };\n      var max = function (element, value, properties) {\n        var cumulativeInclusions = aggregate(element, properties);\n        var absoluteMax = value > cumulativeInclusions ? value - cumulativeInclusions : 0;\n        return absoluteMax;\n      };\n      return {\n        set: set,\n        get: get,\n        getOuter: getOuter,\n        aggregate: aggregate,\n        max: max\n      };\n    }\n\n    var api = Dimension('height', function (element) {\n      var dom = element.dom();\n      return inBody(element) ? dom.getBoundingClientRect().height : dom.offsetHeight;\n    });\n    var get$4 = function (element) {\n      return api.get(element);\n    };\n\n    var ancestors = function (scope, predicate, isRoot) {\n      return filter(parents(scope, isRoot), predicate);\n    };\n    var siblings$1 = function (scope, predicate) {\n      return filter(siblings(scope), predicate);\n    };\n\n    var all$2 = function (selector) {\n      return all(selector);\n    };\n    var ancestors$1 = function (scope, selector, isRoot) {\n      return ancestors(scope, function (e) {\n        return is(e, selector);\n      }, isRoot);\n    };\n    var siblings$2 = function (scope, selector) {\n      return siblings$1(scope, function (e) {\n        return is(e, selector);\n      });\n    };\n    var descendants = function (scope, selector) {\n      return all(selector, scope);\n    };\n\n    var first = function (selector) {\n      return one(selector);\n    };\n    var ancestor$1 = function (scope, selector, isRoot) {\n      return ancestor(scope, function (e) {\n        return is(e, selector);\n      }, isRoot);\n    };\n    var descendant$1 = function (scope, selector) {\n      return one(selector, scope);\n    };\n    var closest$2 = function (scope, selector, isRoot) {\n      return ClosestOrAncestor(is, ancestor$1, scope, selector, isRoot);\n    };\n\n    var BACKSPACE = function () {\n      return [8];\n    };\n    var TAB = function () {\n      return [9];\n    };\n    var ENTER = function () {\n      return [13];\n    };\n    var ESCAPE = function () {\n      return [27];\n    };\n    var SPACE = function () {\n      return [32];\n    };\n    var LEFT = function () {\n      return [37];\n    };\n    var UP = function () {\n      return [38];\n    };\n    var RIGHT = function () {\n      return [39];\n    };\n    var DOWN = function () {\n      return [40];\n    };\n\n    var cyclePrev = function (values, index, predicate) {\n      var before = reverse(values.slice(0, index));\n      var after = reverse(values.slice(index + 1));\n      return find$2(before.concat(after), predicate);\n    };\n    var tryPrev = function (values, index, predicate) {\n      var before = reverse(values.slice(0, index));\n      return find$2(before, predicate);\n    };\n    var cycleNext = function (values, index, predicate) {\n      var before = values.slice(0, index);\n      var after = values.slice(index + 1);\n      return find$2(after.concat(before), predicate);\n    };\n    var tryNext = function (values, index, predicate) {\n      var after = values.slice(index + 1);\n      return find$2(after, predicate);\n    };\n\n    var inSet = function (keys) {\n      return function (event) {\n        var raw = event.raw();\n        return contains(keys, raw.which);\n      };\n    };\n    var and = function (preds) {\n      return function (event) {\n        return forall(preds, function (pred) {\n          return pred(event);\n        });\n      };\n    };\n    var isShift = function (event) {\n      var raw = event.raw();\n      return raw.shiftKey === true;\n    };\n    var isControl = function (event) {\n      var raw = event.raw();\n      return raw.ctrlKey === true;\n    };\n    var isNotShift = not(isShift);\n\n    var rule = function (matches, action) {\n      return {\n        matches: matches,\n        classification: action\n      };\n    };\n    var choose$2 = function (transitions, event) {\n      var transition = find$2(transitions, function (t) {\n        return t.matches(event);\n      });\n      return transition.map(function (t) {\n        return t.classification;\n      });\n    };\n\n    var cycleBy = function (value, delta, min, max) {\n      var r = value + delta;\n      if (r > max) {\n        return min;\n      } else {\n        return r < min ? max : r;\n      }\n    };\n    var cap = function (value, min, max) {\n      if (value <= min) {\n        return min;\n      } else {\n        return value >= max ? max : value;\n      }\n    };\n\n    var dehighlightAllExcept = function (component, hConfig, hState, skip) {\n      var highlighted = descendants(component.element(), '.' + hConfig.highlightClass);\n      each$1(highlighted, function (h) {\n        if (!exists(skip, function (skipComp) {\n            return skipComp.element() === h;\n          })) {\n          remove$4(h, hConfig.highlightClass);\n          component.getSystem().getByDom(h).each(function (target) {\n            hConfig.onDehighlight(component, target);\n            emit(target, dehighlight());\n          });\n        }\n      });\n    };\n    var dehighlightAll = function (component, hConfig, hState) {\n      return dehighlightAllExcept(component, hConfig, hState, []);\n    };\n    var dehighlight$1 = function (component, hConfig, hState, target) {\n      if (isHighlighted(component, hConfig, hState, target)) {\n        remove$4(target.element(), hConfig.highlightClass);\n        hConfig.onDehighlight(component, target);\n        emit(target, dehighlight());\n      }\n    };\n    var highlight$1 = function (component, hConfig, hState, target) {\n      dehighlightAllExcept(component, hConfig, hState, [target]);\n      if (!isHighlighted(component, hConfig, hState, target)) {\n        add$2(target.element(), hConfig.highlightClass);\n        hConfig.onHighlight(component, target);\n        emit(target, highlight());\n      }\n    };\n    var highlightFirst = function (component, hConfig, hState) {\n      getFirst(component, hConfig).each(function (firstComp) {\n        highlight$1(component, hConfig, hState, firstComp);\n      });\n    };\n    var highlightLast = function (component, hConfig, hState) {\n      getLast(component, hConfig).each(function (lastComp) {\n        highlight$1(component, hConfig, hState, lastComp);\n      });\n    };\n    var highlightAt = function (component, hConfig, hState, index) {\n      getByIndex(component, hConfig, hState, index).fold(function (err) {\n        throw new Error(err);\n      }, function (firstComp) {\n        highlight$1(component, hConfig, hState, firstComp);\n      });\n    };\n    var highlightBy = function (component, hConfig, hState, predicate) {\n      var candidates = getCandidates(component, hConfig);\n      var targetComp = find$2(candidates, predicate);\n      targetComp.each(function (c) {\n        highlight$1(component, hConfig, hState, c);\n      });\n    };\n    var isHighlighted = function (component, hConfig, hState, queryTarget) {\n      return has$2(queryTarget.element(), hConfig.highlightClass);\n    };\n    var getHighlighted = function (component, hConfig, hState) {\n      return descendant$1(component.element(), '.' + hConfig.highlightClass).bind(function (e) {\n        return component.getSystem().getByDom(e).toOption();\n      });\n    };\n    var getByIndex = function (component, hConfig, hState, index) {\n      var items = descendants(component.element(), '.' + hConfig.itemClass);\n      return Option.from(items[index]).fold(function () {\n        return Result.error('No element found with index ' + index);\n      }, component.getSystem().getByDom);\n    };\n    var getFirst = function (component, hConfig, hState) {\n      return descendant$1(component.element(), '.' + hConfig.itemClass).bind(function (e) {\n        return component.getSystem().getByDom(e).toOption();\n      });\n    };\n    var getLast = function (component, hConfig, hState) {\n      var items = descendants(component.element(), '.' + hConfig.itemClass);\n      var last = items.length > 0 ? Option.some(items[items.length - 1]) : Option.none();\n      return last.bind(function (c) {\n        return component.getSystem().getByDom(c).toOption();\n      });\n    };\n    var getDelta = function (component, hConfig, hState, delta) {\n      var items = descendants(component.element(), '.' + hConfig.itemClass);\n      var current = findIndex(items, function (item) {\n        return has$2(item, hConfig.highlightClass);\n      });\n      return current.bind(function (selected) {\n        var dest = cycleBy(selected, delta, 0, items.length - 1);\n        return component.getSystem().getByDom(items[dest]).toOption();\n      });\n    };\n    var getPrevious = function (component, hConfig, hState) {\n      return getDelta(component, hConfig, hState, -1);\n    };\n    var getNext = function (component, hConfig, hState) {\n      return getDelta(component, hConfig, hState, +1);\n    };\n    var getCandidates = function (component, hConfig, hState) {\n      var items = descendants(component.element(), '.' + hConfig.itemClass);\n      return cat(map$1(items, function (i) {\n        return component.getSystem().getByDom(i).toOption();\n      }));\n    };\n\n    var HighlightApis = /*#__PURE__*/Object.freeze({\n        dehighlightAll: dehighlightAll,\n        dehighlight: dehighlight$1,\n        highlight: highlight$1,\n        highlightFirst: highlightFirst,\n        highlightLast: highlightLast,\n        highlightAt: highlightAt,\n        highlightBy: highlightBy,\n        isHighlighted: isHighlighted,\n        getHighlighted: getHighlighted,\n        getFirst: getFirst,\n        getLast: getLast,\n        getPrevious: getPrevious,\n        getNext: getNext,\n        getCandidates: getCandidates\n    });\n\n    var HighlightSchema = [\n      strict$1('highlightClass'),\n      strict$1('itemClass'),\n      onHandler('onHighlight'),\n      onHandler('onDehighlight')\n    ];\n\n    var Highlighting = create$1({\n      fields: HighlightSchema,\n      name: 'highlighting',\n      apis: HighlightApis\n    });\n\n    var reportFocusShifting = function (component, prevFocus, newFocus) {\n      var noChange = prevFocus.exists(function (p) {\n        return newFocus.exists(function (n) {\n          return eq(n, p);\n        });\n      });\n      if (!noChange) {\n        emitWith(component, focusShifted(), {\n          prevFocus: prevFocus,\n          newFocus: newFocus\n        });\n      }\n    };\n    var dom = function () {\n      var get = function (component) {\n        return search(component.element());\n      };\n      var set = function (component, focusee) {\n        var prevFocus = get(component);\n        component.getSystem().triggerFocus(focusee, component.element());\n        var newFocus = get(component);\n        reportFocusShifting(component, prevFocus, newFocus);\n      };\n      return {\n        get: get,\n        set: set\n      };\n    };\n    var highlights = function () {\n      var get = function (component) {\n        return Highlighting.getHighlighted(component).map(function (item) {\n          return item.element();\n        });\n      };\n      var set = function (component, element) {\n        var prevFocus = get(component);\n        component.getSystem().getByDom(element).fold(noop, function (item) {\n          Highlighting.highlight(component, item);\n        });\n        var newFocus = get(component);\n        reportFocusShifting(component, prevFocus, newFocus);\n      };\n      return {\n        get: get,\n        set: set\n      };\n    };\n\n    var FocusInsideModes;\n    (function (FocusInsideModes) {\n      FocusInsideModes['OnFocusMode'] = 'onFocus';\n      FocusInsideModes['OnEnterOrSpaceMode'] = 'onEnterOrSpace';\n      FocusInsideModes['OnApiMode'] = 'onApi';\n    }(FocusInsideModes || (FocusInsideModes = {})));\n\n    var typical = function (infoSchema, stateInit, getKeydownRules, getKeyupRules, optFocusIn) {\n      var schema = function () {\n        return infoSchema.concat([\n          defaulted$1('focusManager', dom()),\n          defaultedOf('focusInside', 'onFocus', valueOf(function (val) {\n            return contains([\n              'onFocus',\n              'onEnterOrSpace',\n              'onApi'\n            ], val) ? Result.value(val) : Result.error('Invalid value for focusInside');\n          })),\n          output('handler', me),\n          output('state', stateInit),\n          output('sendFocusIn', optFocusIn)\n        ]);\n      };\n      var processKey = function (component, simulatedEvent, getRules, keyingConfig, keyingState) {\n        var rules = getRules(component, simulatedEvent, keyingConfig, keyingState);\n        return choose$2(rules, simulatedEvent.event()).bind(function (rule) {\n          return rule(component, simulatedEvent, keyingConfig, keyingState);\n        });\n      };\n      var toEvents = function (keyingConfig, keyingState) {\n        var onFocusHandler = keyingConfig.focusInside !== FocusInsideModes.OnFocusMode ? Option.none() : optFocusIn(keyingConfig).map(function (focusIn) {\n          return run(focus(), function (component, simulatedEvent) {\n            focusIn(component, keyingConfig, keyingState);\n            simulatedEvent.stop();\n          });\n        });\n        var tryGoInsideComponent = function (component, simulatedEvent) {\n          var isEnterOrSpace = inSet(SPACE().concat(ENTER()))(simulatedEvent.event());\n          if (keyingConfig.focusInside === FocusInsideModes.OnEnterOrSpaceMode && isEnterOrSpace && isSource(component, simulatedEvent)) {\n            optFocusIn(keyingConfig).each(function (focusIn) {\n              focusIn(component, keyingConfig, keyingState);\n              simulatedEvent.stop();\n            });\n          }\n        };\n        return derive(onFocusHandler.toArray().concat([\n          run(keydown(), function (component, simulatedEvent) {\n            processKey(component, simulatedEvent, getKeydownRules, keyingConfig, keyingState).fold(function () {\n              tryGoInsideComponent(component, simulatedEvent);\n            }, function (_) {\n              simulatedEvent.stop();\n            });\n          }),\n          run(keyup(), function (component, simulatedEvent) {\n            processKey(component, simulatedEvent, getKeyupRules, keyingConfig, keyingState).each(function (_) {\n              simulatedEvent.stop();\n            });\n          })\n        ]));\n      };\n      var me = {\n        schema: schema,\n        processKey: processKey,\n        toEvents: toEvents\n      };\n      return me;\n    };\n\n    var create$2 = function (cyclicField) {\n      var schema = [\n        option('onEscape'),\n        option('onEnter'),\n        defaulted$1('selector', '[data-alloy-tabstop=\"true\"]:not(:disabled)'),\n        defaulted$1('firstTabstop', 0),\n        defaulted$1('useTabstopAt', constant(true)),\n        option('visibilitySelector')\n      ].concat([cyclicField]);\n      var isVisible = function (tabbingConfig, element) {\n        var target = tabbingConfig.visibilitySelector.bind(function (sel) {\n          return closest$2(element, sel);\n        }).getOr(element);\n        return get$4(target) > 0;\n      };\n      var findInitial = function (component, tabbingConfig) {\n        var tabstops = descendants(component.element(), tabbingConfig.selector);\n        var visibles = filter(tabstops, function (elem) {\n          return isVisible(tabbingConfig, elem);\n        });\n        return Option.from(visibles[tabbingConfig.firstTabstop]);\n      };\n      var findCurrent = function (component, tabbingConfig) {\n        return tabbingConfig.focusManager.get(component).bind(function (elem) {\n          return closest$2(elem, tabbingConfig.selector);\n        });\n      };\n      var isTabstop = function (tabbingConfig, element) {\n        return isVisible(tabbingConfig, element) && tabbingConfig.useTabstopAt(element);\n      };\n      var focusIn = function (component, tabbingConfig) {\n        findInitial(component, tabbingConfig).each(function (target) {\n          tabbingConfig.focusManager.set(component, target);\n        });\n      };\n      var goFromTabstop = function (component, tabstops, stopIndex, tabbingConfig, cycle) {\n        return cycle(tabstops, stopIndex, function (elem) {\n          return isTabstop(tabbingConfig, elem);\n        }).fold(function () {\n          return tabbingConfig.cyclic ? Option.some(true) : Option.none();\n        }, function (target) {\n          tabbingConfig.focusManager.set(component, target);\n          return Option.some(true);\n        });\n      };\n      var go = function (component, simulatedEvent, tabbingConfig, cycle) {\n        var tabstops = descendants(component.element(), tabbingConfig.selector);\n        return findCurrent(component, tabbingConfig).bind(function (tabstop) {\n          var optStopIndex = findIndex(tabstops, curry(eq, tabstop));\n          return optStopIndex.bind(function (stopIndex) {\n            return goFromTabstop(component, tabstops, stopIndex, tabbingConfig, cycle);\n          });\n        });\n      };\n      var goBackwards = function (component, simulatedEvent, tabbingConfig, tabbingState) {\n        var navigate = tabbingConfig.cyclic ? cyclePrev : tryPrev;\n        return go(component, simulatedEvent, tabbingConfig, navigate);\n      };\n      var goForwards = function (component, simulatedEvent, tabbingConfig, tabbingState) {\n        var navigate = tabbingConfig.cyclic ? cycleNext : tryNext;\n        return go(component, simulatedEvent, tabbingConfig, navigate);\n      };\n      var execute = function (component, simulatedEvent, tabbingConfig, tabbingState) {\n        return tabbingConfig.onEnter.bind(function (f) {\n          return f(component, simulatedEvent);\n        });\n      };\n      var exit = function (component, simulatedEvent, tabbingConfig, tabbingState) {\n        return tabbingConfig.onEscape.bind(function (f) {\n          return f(component, simulatedEvent);\n        });\n      };\n      var getKeydownRules = constant([\n        rule(and([\n          isShift,\n          inSet(TAB())\n        ]), goBackwards),\n        rule(inSet(TAB()), goForwards),\n        rule(inSet(ESCAPE()), exit),\n        rule(and([\n          isNotShift,\n          inSet(ENTER())\n        ]), execute)\n      ]);\n      var getKeyupRules = constant([]);\n      return typical(schema, NoState.init, getKeydownRules, getKeyupRules, function () {\n        return Option.some(focusIn);\n      });\n    };\n\n    var AcyclicType = create$2(state$1('cyclic', constant(false)));\n\n    var CyclicType = create$2(state$1('cyclic', constant(true)));\n\n    var inside = function (target) {\n      return name(target) === 'input' && get(target, 'type') !== 'radio' || name(target) === 'textarea';\n    };\n\n    var doDefaultExecute = function (component, simulatedEvent, focused) {\n      dispatch(component, focused, execute());\n      return Option.some(true);\n    };\n    var defaultExecute = function (component, simulatedEvent, focused) {\n      return inside(focused) && inSet(SPACE())(simulatedEvent.event()) ? Option.none() : doDefaultExecute(component, simulatedEvent, focused);\n    };\n    var stopEventForFirefox = function (component, simulatedEvent) {\n      return Option.some(true);\n    };\n\n    var schema$1 = [\n      defaulted$1('execute', defaultExecute),\n      defaulted$1('useSpace', false),\n      defaulted$1('useEnter', true),\n      defaulted$1('useControlEnter', false),\n      defaulted$1('useDown', false)\n    ];\n    var execute$1 = function (component, simulatedEvent, executeConfig) {\n      return executeConfig.execute(component, simulatedEvent, component.element());\n    };\n    var getKeydownRules = function (component, simulatedEvent, executeConfig, executeState) {\n      var spaceExec = executeConfig.useSpace && !inside(component.element()) ? SPACE() : [];\n      var enterExec = executeConfig.useEnter ? ENTER() : [];\n      var downExec = executeConfig.useDown ? DOWN() : [];\n      var execKeys = spaceExec.concat(enterExec).concat(downExec);\n      return [rule(inSet(execKeys), execute$1)].concat(executeConfig.useControlEnter ? [rule(and([\n          isControl,\n          inSet(ENTER())\n        ]), execute$1)] : []);\n    };\n    var getKeyupRules = function (component, simulatedEvent, executeConfig, executeState) {\n      return executeConfig.useSpace && !inside(component.element()) ? [rule(inSet(SPACE()), stopEventForFirefox)] : [];\n    };\n    var ExecutionType = typical(schema$1, NoState.init, getKeydownRules, getKeyupRules, function () {\n      return Option.none();\n    });\n\n    var flatgrid = function (spec) {\n      var dimensions = Cell(Option.none());\n      var setGridSize = function (numRows, numColumns) {\n        dimensions.set(Option.some({\n          numRows: constant(numRows),\n          numColumns: constant(numColumns)\n        }));\n      };\n      var getNumRows = function () {\n        return dimensions.get().map(function (d) {\n          return d.numRows();\n        });\n      };\n      var getNumColumns = function () {\n        return dimensions.get().map(function (d) {\n          return d.numColumns();\n        });\n      };\n      return nu$6({\n        readState: function () {\n          return dimensions.get().map(function (d) {\n            return {\n              numRows: d.numRows(),\n              numColumns: d.numColumns()\n            };\n          }).getOr({\n            numRows: '?',\n            numColumns: '?'\n          });\n        },\n        setGridSize: setGridSize,\n        getNumRows: getNumRows,\n        getNumColumns: getNumColumns\n      });\n    };\n    var init = function (spec) {\n      return spec.state(spec);\n    };\n\n    var KeyingState = /*#__PURE__*/Object.freeze({\n        flatgrid: flatgrid,\n        init: init\n    });\n\n    var onDirection = function (isLtr, isRtl) {\n      return function (element) {\n        return getDirection(element) === 'rtl' ? isRtl : isLtr;\n      };\n    };\n    var getDirection = function (element) {\n      return get$3(element, 'direction') === 'rtl' ? 'rtl' : 'ltr';\n    };\n\n    var useH = function (movement) {\n      return function (component, simulatedEvent, config, state) {\n        var move = movement(component.element());\n        return use(move, component, simulatedEvent, config, state);\n      };\n    };\n    var west = function (moveLeft, moveRight) {\n      var movement = onDirection(moveLeft, moveRight);\n      return useH(movement);\n    };\n    var east = function (moveLeft, moveRight) {\n      var movement = onDirection(moveRight, moveLeft);\n      return useH(movement);\n    };\n    var useV = function (move) {\n      return function (component, simulatedEvent, config, state) {\n        return use(move, component, simulatedEvent, config, state);\n      };\n    };\n    var use = function (move, component, simulatedEvent, config, state) {\n      var outcome = config.focusManager.get(component).bind(function (focused) {\n        return move(component.element(), focused, config, state);\n      });\n      return outcome.map(function (newFocus) {\n        config.focusManager.set(component, newFocus);\n        return true;\n      });\n    };\n    var north = useV;\n    var south = useV;\n    var move = useV;\n\n    var isHidden = function (dom) {\n      return dom.offsetWidth <= 0 && dom.offsetHeight <= 0;\n    };\n    var isVisible = function (element) {\n      var dom = element.dom();\n      return !isHidden(dom);\n    };\n\n    var indexInfo = MixedBag([\n      'index',\n      'candidates'\n    ], []);\n    var locate = function (candidates, predicate) {\n      return findIndex(candidates, predicate).map(function (index) {\n        return indexInfo({\n          index: index,\n          candidates: candidates\n        });\n      });\n    };\n\n    var locateVisible = function (container, current, selector) {\n      var predicate = curry(eq, current);\n      var candidates = descendants(container, selector);\n      var visible = filter(candidates, isVisible);\n      return locate(visible, predicate);\n    };\n    var findIndex$1 = function (elements, target) {\n      return findIndex(elements, function (elem) {\n        return eq(target, elem);\n      });\n    };\n\n    var withGrid = function (values, index, numCols, f) {\n      var oldRow = Math.floor(index / numCols);\n      var oldColumn = index % numCols;\n      return f(oldRow, oldColumn).bind(function (address) {\n        var newIndex = address.row() * numCols + address.column();\n        return newIndex >= 0 && newIndex < values.length ? Option.some(values[newIndex]) : Option.none();\n      });\n    };\n    var cycleHorizontal = function (values, index, numRows, numCols, delta) {\n      return withGrid(values, index, numCols, function (oldRow, oldColumn) {\n        var onLastRow = oldRow === numRows - 1;\n        var colsInRow = onLastRow ? values.length - oldRow * numCols : numCols;\n        var newColumn = cycleBy(oldColumn, delta, 0, colsInRow - 1);\n        return Option.some({\n          row: constant(oldRow),\n          column: constant(newColumn)\n        });\n      });\n    };\n    var cycleVertical = function (values, index, numRows, numCols, delta) {\n      return withGrid(values, index, numCols, function (oldRow, oldColumn) {\n        var newRow = cycleBy(oldRow, delta, 0, numRows - 1);\n        var onLastRow = newRow === numRows - 1;\n        var colsInRow = onLastRow ? values.length - newRow * numCols : numCols;\n        var newCol = cap(oldColumn, 0, colsInRow - 1);\n        return Option.some({\n          row: constant(newRow),\n          column: constant(newCol)\n        });\n      });\n    };\n    var cycleRight = function (values, index, numRows, numCols) {\n      return cycleHorizontal(values, index, numRows, numCols, +1);\n    };\n    var cycleLeft = function (values, index, numRows, numCols) {\n      return cycleHorizontal(values, index, numRows, numCols, -1);\n    };\n    var cycleUp = function (values, index, numRows, numCols) {\n      return cycleVertical(values, index, numRows, numCols, -1);\n    };\n    var cycleDown = function (values, index, numRows, numCols) {\n      return cycleVertical(values, index, numRows, numCols, +1);\n    };\n\n    var schema$2 = [\n      strict$1('selector'),\n      defaulted$1('execute', defaultExecute),\n      onKeyboardHandler('onEscape'),\n      defaulted$1('captureTab', false),\n      initSize()\n    ];\n    var focusIn = function (component, gridConfig, gridState) {\n      descendant$1(component.element(), gridConfig.selector).each(function (first) {\n        gridConfig.focusManager.set(component, first);\n      });\n    };\n    var findCurrent = function (component, gridConfig) {\n      return gridConfig.focusManager.get(component).bind(function (elem) {\n        return closest$2(elem, gridConfig.selector);\n      });\n    };\n    var execute$2 = function (component, simulatedEvent, gridConfig, gridState) {\n      return findCurrent(component, gridConfig).bind(function (focused) {\n        return gridConfig.execute(component, simulatedEvent, focused);\n      });\n    };\n    var doMove = function (cycle) {\n      return function (element, focused, gridConfig, gridState) {\n        return locateVisible(element, focused, gridConfig.selector).bind(function (identified) {\n          return cycle(identified.candidates(), identified.index(), gridState.getNumRows().getOr(gridConfig.initSize.numRows), gridState.getNumColumns().getOr(gridConfig.initSize.numColumns));\n        });\n      };\n    };\n    var handleTab = function (component, simulatedEvent, gridConfig, gridState) {\n      return gridConfig.captureTab ? Option.some(true) : Option.none();\n    };\n    var doEscape = function (component, simulatedEvent, gridConfig, gridState) {\n      return gridConfig.onEscape(component, simulatedEvent);\n    };\n    var moveLeft = doMove(cycleLeft);\n    var moveRight = doMove(cycleRight);\n    var moveNorth = doMove(cycleUp);\n    var moveSouth = doMove(cycleDown);\n    var getKeydownRules$1 = constant([\n      rule(inSet(LEFT()), west(moveLeft, moveRight)),\n      rule(inSet(RIGHT()), east(moveLeft, moveRight)),\n      rule(inSet(UP()), north(moveNorth)),\n      rule(inSet(DOWN()), south(moveSouth)),\n      rule(and([\n        isShift,\n        inSet(TAB())\n      ]), handleTab),\n      rule(and([\n        isNotShift,\n        inSet(TAB())\n      ]), handleTab),\n      rule(inSet(ESCAPE()), doEscape),\n      rule(inSet(SPACE().concat(ENTER())), execute$2)\n    ]);\n    var getKeyupRules$1 = constant([rule(inSet(SPACE()), stopEventForFirefox)]);\n    var FlatgridType = typical(schema$2, flatgrid, getKeydownRules$1, getKeyupRules$1, function () {\n      return Option.some(focusIn);\n    });\n\n    var horizontal = function (container, selector, current, delta) {\n      var isDisabledButton = function (candidate) {\n        return name(candidate) === 'button' && get(candidate, 'disabled') === 'disabled';\n      };\n      var tryCycle = function (initial, index, candidates) {\n        var newIndex = cycleBy(index, delta, 0, candidates.length - 1);\n        if (newIndex === initial) {\n          return Option.none();\n        } else {\n          return isDisabledButton(candidates[newIndex]) ? tryCycle(initial, newIndex, candidates) : Option.from(candidates[newIndex]);\n        }\n      };\n      return locateVisible(container, current, selector).bind(function (identified) {\n        var index = identified.index();\n        var candidates = identified.candidates();\n        return tryCycle(index, index, candidates);\n      });\n    };\n\n    var schema$3 = [\n      strict$1('selector'),\n      defaulted$1('getInitial', Option.none),\n      defaulted$1('execute', defaultExecute),\n      onKeyboardHandler('onEscape'),\n      defaulted$1('executeOnMove', false),\n      defaulted$1('allowVertical', true)\n    ];\n    var findCurrent$1 = function (component, flowConfig) {\n      return flowConfig.focusManager.get(component).bind(function (elem) {\n        return closest$2(elem, flowConfig.selector);\n      });\n    };\n    var execute$3 = function (component, simulatedEvent, flowConfig) {\n      return findCurrent$1(component, flowConfig).bind(function (focused) {\n        return flowConfig.execute(component, simulatedEvent, focused);\n      });\n    };\n    var focusIn$1 = function (component, flowConfig) {\n      flowConfig.getInitial(component).orThunk(function () {\n        return descendant$1(component.element(), flowConfig.selector);\n      }).each(function (first) {\n        flowConfig.focusManager.set(component, first);\n      });\n    };\n    var moveLeft$1 = function (element, focused, info) {\n      return horizontal(element, info.selector, focused, -1);\n    };\n    var moveRight$1 = function (element, focused, info) {\n      return horizontal(element, info.selector, focused, +1);\n    };\n    var doMove$1 = function (movement) {\n      return function (component, simulatedEvent, flowConfig) {\n        return movement(component, simulatedEvent, flowConfig).bind(function () {\n          return flowConfig.executeOnMove ? execute$3(component, simulatedEvent, flowConfig) : Option.some(true);\n        });\n      };\n    };\n    var doEscape$1 = function (component, simulatedEvent, flowConfig, _flowState) {\n      return flowConfig.onEscape(component, simulatedEvent);\n    };\n    var getKeydownRules$2 = function (_component, _se, flowConfig, _flowState) {\n      var westMovers = LEFT().concat(flowConfig.allowVertical ? UP() : []);\n      var eastMovers = RIGHT().concat(flowConfig.allowVertical ? DOWN() : []);\n      return [\n        rule(inSet(westMovers), doMove$1(west(moveLeft$1, moveRight$1))),\n        rule(inSet(eastMovers), doMove$1(east(moveLeft$1, moveRight$1))),\n        rule(inSet(ENTER()), execute$3),\n        rule(inSet(SPACE()), execute$3),\n        rule(inSet(ESCAPE()), doEscape$1)\n      ];\n    };\n    var getKeyupRules$2 = constant([rule(inSet(SPACE()), stopEventForFirefox)]);\n    var FlowType = typical(schema$3, NoState.init, getKeydownRules$2, getKeyupRules$2, function () {\n      return Option.some(focusIn$1);\n    });\n\n    var outcome = MixedBag([\n      'rowIndex',\n      'columnIndex',\n      'cell'\n    ], []);\n    var toCell = function (matrix, rowIndex, columnIndex) {\n      return Option.from(matrix[rowIndex]).bind(function (row) {\n        return Option.from(row[columnIndex]).map(function (cell) {\n          return outcome({\n            rowIndex: rowIndex,\n            columnIndex: columnIndex,\n            cell: cell\n          });\n        });\n      });\n    };\n    var cycleHorizontal$1 = function (matrix, rowIndex, startCol, deltaCol) {\n      var row = matrix[rowIndex];\n      var colsInRow = row.length;\n      var newColIndex = cycleBy(startCol, deltaCol, 0, colsInRow - 1);\n      return toCell(matrix, rowIndex, newColIndex);\n    };\n    var cycleVertical$1 = function (matrix, colIndex, startRow, deltaRow) {\n      var nextRowIndex = cycleBy(startRow, deltaRow, 0, matrix.length - 1);\n      var colsInNextRow = matrix[nextRowIndex].length;\n      var nextColIndex = cap(colIndex, 0, colsInNextRow - 1);\n      return toCell(matrix, nextRowIndex, nextColIndex);\n    };\n    var moveHorizontal = function (matrix, rowIndex, startCol, deltaCol) {\n      var row = matrix[rowIndex];\n      var colsInRow = row.length;\n      var newColIndex = cap(startCol + deltaCol, 0, colsInRow - 1);\n      return toCell(matrix, rowIndex, newColIndex);\n    };\n    var moveVertical = function (matrix, colIndex, startRow, deltaRow) {\n      var nextRowIndex = cap(startRow + deltaRow, 0, matrix.length - 1);\n      var colsInNextRow = matrix[nextRowIndex].length;\n      var nextColIndex = cap(colIndex, 0, colsInNextRow - 1);\n      return toCell(matrix, nextRowIndex, nextColIndex);\n    };\n    var cycleRight$1 = function (matrix, startRow, startCol) {\n      return cycleHorizontal$1(matrix, startRow, startCol, +1);\n    };\n    var cycleLeft$1 = function (matrix, startRow, startCol) {\n      return cycleHorizontal$1(matrix, startRow, startCol, -1);\n    };\n    var cycleUp$1 = function (matrix, startRow, startCol) {\n      return cycleVertical$1(matrix, startCol, startRow, -1);\n    };\n    var cycleDown$1 = function (matrix, startRow, startCol) {\n      return cycleVertical$1(matrix, startCol, startRow, +1);\n    };\n    var moveLeft$2 = function (matrix, startRow, startCol) {\n      return moveHorizontal(matrix, startRow, startCol, -1);\n    };\n    var moveRight$2 = function (matrix, startRow, startCol) {\n      return moveHorizontal(matrix, startRow, startCol, +1);\n    };\n    var moveUp = function (matrix, startRow, startCol) {\n      return moveVertical(matrix, startCol, startRow, -1);\n    };\n    var moveDown = function (matrix, startRow, startCol) {\n      return moveVertical(matrix, startCol, startRow, +1);\n    };\n\n    var schema$4 = [\n      strictObjOf('selectors', [\n        strict$1('row'),\n        strict$1('cell')\n      ]),\n      defaulted$1('cycles', true),\n      defaulted$1('previousSelector', Option.none),\n      defaulted$1('execute', defaultExecute)\n    ];\n    var focusIn$2 = function (component, matrixConfig) {\n      var focused = matrixConfig.previousSelector(component).orThunk(function () {\n        var selectors = matrixConfig.selectors;\n        return descendant$1(component.element(), selectors.cell);\n      });\n      focused.each(function (cell) {\n        matrixConfig.focusManager.set(component, cell);\n      });\n    };\n    var execute$4 = function (component, simulatedEvent, matrixConfig) {\n      return search(component.element()).bind(function (focused) {\n        return matrixConfig.execute(component, simulatedEvent, focused);\n      });\n    };\n    var toMatrix = function (rows, matrixConfig) {\n      return map$1(rows, function (row) {\n        return descendants(row, matrixConfig.selectors.cell);\n      });\n    };\n    var doMove$2 = function (ifCycle, ifMove) {\n      return function (element, focused, matrixConfig) {\n        var move = matrixConfig.cycles ? ifCycle : ifMove;\n        return closest$2(focused, matrixConfig.selectors.row).bind(function (inRow) {\n          var cellsInRow = descendants(inRow, matrixConfig.selectors.cell);\n          return findIndex$1(cellsInRow, focused).bind(function (colIndex) {\n            var allRows = descendants(element, matrixConfig.selectors.row);\n            return findIndex$1(allRows, inRow).bind(function (rowIndex) {\n              var matrix = toMatrix(allRows, matrixConfig);\n              return move(matrix, rowIndex, colIndex).map(function (next) {\n                return next.cell();\n              });\n            });\n          });\n        });\n      };\n    };\n    var moveLeft$3 = doMove$2(cycleLeft$1, moveLeft$2);\n    var moveRight$3 = doMove$2(cycleRight$1, moveRight$2);\n    var moveNorth$1 = doMove$2(cycleUp$1, moveUp);\n    var moveSouth$1 = doMove$2(cycleDown$1, moveDown);\n    var getKeydownRules$3 = constant([\n      rule(inSet(LEFT()), west(moveLeft$3, moveRight$3)),\n      rule(inSet(RIGHT()), east(moveLeft$3, moveRight$3)),\n      rule(inSet(UP()), north(moveNorth$1)),\n      rule(inSet(DOWN()), south(moveSouth$1)),\n      rule(inSet(SPACE().concat(ENTER())), execute$4)\n    ]);\n    var getKeyupRules$3 = constant([rule(inSet(SPACE()), stopEventForFirefox)]);\n    var MatrixType = typical(schema$4, NoState.init, getKeydownRules$3, getKeyupRules$3, function () {\n      return Option.some(focusIn$2);\n    });\n\n    var schema$5 = [\n      strict$1('selector'),\n      defaulted$1('execute', defaultExecute),\n      defaulted$1('moveOnTab', false)\n    ];\n    var execute$5 = function (component, simulatedEvent, menuConfig) {\n      return menuConfig.focusManager.get(component).bind(function (focused) {\n        return menuConfig.execute(component, simulatedEvent, focused);\n      });\n    };\n    var focusIn$3 = function (component, menuConfig) {\n      descendant$1(component.element(), menuConfig.selector).each(function (first) {\n        menuConfig.focusManager.set(component, first);\n      });\n    };\n    var moveUp$1 = function (element, focused, info) {\n      return horizontal(element, info.selector, focused, -1);\n    };\n    var moveDown$1 = function (element, focused, info) {\n      return horizontal(element, info.selector, focused, +1);\n    };\n    var fireShiftTab = function (component, simulatedEvent, menuConfig) {\n      return menuConfig.moveOnTab ? move(moveUp$1)(component, simulatedEvent, menuConfig) : Option.none();\n    };\n    var fireTab = function (component, simulatedEvent, menuConfig) {\n      return menuConfig.moveOnTab ? move(moveDown$1)(component, simulatedEvent, menuConfig) : Option.none();\n    };\n    var getKeydownRules$4 = constant([\n      rule(inSet(UP()), move(moveUp$1)),\n      rule(inSet(DOWN()), move(moveDown$1)),\n      rule(and([\n        isShift,\n        inSet(TAB())\n      ]), fireShiftTab),\n      rule(and([\n        isNotShift,\n        inSet(TAB())\n      ]), fireTab),\n      rule(inSet(ENTER()), execute$5),\n      rule(inSet(SPACE()), execute$5)\n    ]);\n    var getKeyupRules$4 = constant([rule(inSet(SPACE()), stopEventForFirefox)]);\n    var MenuType = typical(schema$5, NoState.init, getKeydownRules$4, getKeyupRules$4, function () {\n      return Option.some(focusIn$3);\n    });\n\n    var schema$6 = [\n      onKeyboardHandler('onSpace'),\n      onKeyboardHandler('onEnter'),\n      onKeyboardHandler('onShiftEnter'),\n      onKeyboardHandler('onLeft'),\n      onKeyboardHandler('onRight'),\n      onKeyboardHandler('onTab'),\n      onKeyboardHandler('onShiftTab'),\n      onKeyboardHandler('onUp'),\n      onKeyboardHandler('onDown'),\n      onKeyboardHandler('onEscape'),\n      defaulted$1('stopSpaceKeyup', false),\n      option('focusIn')\n    ];\n    var getKeydownRules$5 = function (component, simulatedEvent, specialInfo) {\n      return [\n        rule(inSet(SPACE()), specialInfo.onSpace),\n        rule(and([\n          isNotShift,\n          inSet(ENTER())\n        ]), specialInfo.onEnter),\n        rule(and([\n          isShift,\n          inSet(ENTER())\n        ]), specialInfo.onShiftEnter),\n        rule(and([\n          isShift,\n          inSet(TAB())\n        ]), specialInfo.onShiftTab),\n        rule(and([\n          isNotShift,\n          inSet(TAB())\n        ]), specialInfo.onTab),\n        rule(inSet(UP()), specialInfo.onUp),\n        rule(inSet(DOWN()), specialInfo.onDown),\n        rule(inSet(LEFT()), specialInfo.onLeft),\n        rule(inSet(RIGHT()), specialInfo.onRight),\n        rule(inSet(SPACE()), specialInfo.onSpace),\n        rule(inSet(ESCAPE()), specialInfo.onEscape)\n      ];\n    };\n    var getKeyupRules$5 = function (component, simulatedEvent, specialInfo) {\n      return specialInfo.stopSpaceKeyup ? [rule(inSet(SPACE()), stopEventForFirefox)] : [];\n    };\n    var SpecialType = typical(schema$6, NoState.init, getKeydownRules$5, getKeyupRules$5, function (specialInfo) {\n      return specialInfo.focusIn;\n    });\n\n    var acyclic = AcyclicType.schema();\n    var cyclic = CyclicType.schema();\n    var flow = FlowType.schema();\n    var flatgrid$1 = FlatgridType.schema();\n    var matrix = MatrixType.schema();\n    var execution = ExecutionType.schema();\n    var menu = MenuType.schema();\n    var special = SpecialType.schema();\n\n    var KeyboardBranches = /*#__PURE__*/Object.freeze({\n        acyclic: acyclic,\n        cyclic: cyclic,\n        flow: flow,\n        flatgrid: flatgrid$1,\n        matrix: matrix,\n        execution: execution,\n        menu: menu,\n        special: special\n    });\n\n    var Keying = createModes$1({\n      branchKey: 'mode',\n      branches: KeyboardBranches,\n      name: 'keying',\n      active: {\n        events: function (keyingConfig, keyingState) {\n          var handler = keyingConfig.handler;\n          return handler.toEvents(keyingConfig, keyingState);\n        }\n      },\n      apis: {\n        focusIn: function (component, keyConfig, keyState) {\n          keyConfig.sendFocusIn(keyConfig).fold(function () {\n            component.getSystem().triggerFocus(component.element(), component.element());\n          }, function (sendFocusIn) {\n            sendFocusIn(component, keyConfig, keyState);\n          });\n        },\n        setGridSize: function (component, keyConfig, keyState, numRows, numColumns) {\n          if (!hasKey$1(keyState, 'setGridSize')) {\n            domGlobals.console.error('Layout does not support setGridSize');\n          } else {\n            keyState.setGridSize(numRows, numColumns);\n          }\n        }\n      },\n      state: KeyingState\n    });\n\n    var field$1 = function (name, forbidden) {\n      return defaultedObjOf(name, {}, map$1(forbidden, function (f) {\n        return forbid(f.name(), 'Cannot configure ' + f.name() + ' for ' + name);\n      }).concat([state$1('dump', identity)]));\n    };\n    var get$5 = function (data) {\n      return data.dump;\n    };\n    var augment = function (data, original) {\n      return __assign(__assign({}, data.dump), derive$1(original));\n    };\n    var SketchBehaviours = {\n      field: field$1,\n      augment: augment,\n      get: get$5\n    };\n\n    var _placeholder = 'placeholder';\n    var adt$2 = Adt.generate([\n      {\n        single: [\n          'required',\n          'valueThunk'\n        ]\n      },\n      {\n        multiple: [\n          'required',\n          'valueThunks'\n        ]\n      }\n    ]);\n    var subPlaceholder = function (owner, detail, compSpec, placeholders) {\n      if (owner.exists(function (o) {\n          return o !== compSpec.owner;\n        })) {\n        return adt$2.single(true, constant(compSpec));\n      }\n      return readOptFrom$1(placeholders, compSpec.name).fold(function () {\n        throw new Error('Unknown placeholder component: ' + compSpec.name + '\\nKnown: [' + keys(placeholders) + ']\\nNamespace: ' + owner.getOr('none') + '\\nSpec: ' + JSON.stringify(compSpec, null, 2));\n      }, function (newSpec) {\n        return newSpec.replace();\n      });\n    };\n    var scan = function (owner, detail, compSpec, placeholders) {\n      if (compSpec.uiType === _placeholder) {\n        return subPlaceholder(owner, detail, compSpec, placeholders);\n      } else {\n        return adt$2.single(false, constant(compSpec));\n      }\n    };\n    var substitute = function (owner, detail, compSpec, placeholders) {\n      var base = scan(owner, detail, compSpec, placeholders);\n      return base.fold(function (req, valueThunk) {\n        var value = valueThunk(detail, compSpec.config, compSpec.validated);\n        var childSpecs = readOptFrom$1(value, 'components').getOr([]);\n        var substituted = bind(childSpecs, function (c) {\n          return substitute(owner, detail, c, placeholders);\n        });\n        return [__assign(__assign({}, value), { components: substituted })];\n      }, function (req, valuesThunk) {\n        var values = valuesThunk(detail, compSpec.config, compSpec.validated);\n        var preprocessor = compSpec.validated.preprocess.getOr(identity);\n        return preprocessor(values);\n      });\n    };\n    var substituteAll = function (owner, detail, components, placeholders) {\n      return bind(components, function (c) {\n        return substitute(owner, detail, c, placeholders);\n      });\n    };\n    var oneReplace = function (label, replacements) {\n      var called = false;\n      var used = function () {\n        return called;\n      };\n      var replace = function () {\n        if (called === true) {\n          throw new Error('Trying to use the same placeholder more than once: ' + label);\n        }\n        called = true;\n        return replacements;\n      };\n      var required = function () {\n        return replacements.fold(function (req, _) {\n          return req;\n        }, function (req, _) {\n          return req;\n        });\n      };\n      return {\n        name: constant(label),\n        required: required,\n        used: used,\n        replace: replace\n      };\n    };\n    var substitutePlaces = function (owner, detail, components, placeholders) {\n      var ps = map(placeholders, function (ph, name) {\n        return oneReplace(name, ph);\n      });\n      var outcome = substituteAll(owner, detail, components, ps);\n      each(ps, function (p) {\n        if (p.used() === false && p.required()) {\n          throw new Error('Placeholder: ' + p.name() + ' was not found in components list\\nNamespace: ' + owner.getOr('none') + '\\nComponents: ' + JSON.stringify(detail.components, null, 2));\n        }\n      });\n      return outcome;\n    };\n    var single = adt$2.single;\n    var multiple = adt$2.multiple;\n    var placeholder = constant(_placeholder);\n\n    var unique = 0;\n    var generate$1 = function (prefix) {\n      var date = new Date();\n      var time = date.getTime();\n      var random = Math.floor(Math.random() * 1000000000);\n      unique++;\n      return prefix + '_' + random + unique + String(time);\n    };\n\n    var adt$3 = Adt.generate([\n      { required: ['data'] },\n      { external: ['data'] },\n      { optional: ['data'] },\n      { group: ['data'] }\n    ]);\n    var fFactory = defaulted$1('factory', { sketch: identity });\n    var fSchema = defaulted$1('schema', []);\n    var fName = strict$1('name');\n    var fPname = field('pname', 'pname', defaultedThunk(function (typeSpec) {\n      return '<alloy.' + generate$1(typeSpec.name) + '>';\n    }), anyValue$1());\n    var fGroupSchema = state$1('schema', function () {\n      return [option('preprocess')];\n    });\n    var fDefaults = defaulted$1('defaults', constant({}));\n    var fOverrides = defaulted$1('overrides', constant({}));\n    var requiredSpec = objOf([\n      fFactory,\n      fSchema,\n      fName,\n      fPname,\n      fDefaults,\n      fOverrides\n    ]);\n    var optionalSpec = objOf([\n      fFactory,\n      fSchema,\n      fName,\n      fPname,\n      fDefaults,\n      fOverrides\n    ]);\n    var groupSpec = objOf([\n      fFactory,\n      fGroupSchema,\n      fName,\n      strict$1('unit'),\n      fPname,\n      fDefaults,\n      fOverrides\n    ]);\n    var asNamedPart = function (part) {\n      return part.fold(Option.some, Option.none, Option.some, Option.some);\n    };\n    var name$1 = function (part) {\n      var get = function (data) {\n        return data.name;\n      };\n      return part.fold(get, get, get, get);\n    };\n    var convert = function (adtConstructor, partSchema) {\n      return function (spec) {\n        var data = asRawOrDie('Converting part type', partSchema, spec);\n        return adtConstructor(data);\n      };\n    };\n    var required = convert(adt$3.required, requiredSpec);\n    var optional = convert(adt$3.optional, optionalSpec);\n    var group = convert(adt$3.group, groupSpec);\n    var original = constant('entirety');\n\n    var combine = function (detail, data, partSpec, partValidated) {\n      return deepMerge(data.defaults(detail, partSpec, partValidated), partSpec, { uid: detail.partUids[data.name] }, data.overrides(detail, partSpec, partValidated));\n    };\n    var subs = function (owner, detail, parts) {\n      var internals = {};\n      var externals = {};\n      each$1(parts, function (part) {\n        part.fold(function (data) {\n          internals[data.pname] = single(true, function (detail, partSpec, partValidated) {\n            return data.factory.sketch(combine(detail, data, partSpec, partValidated));\n          });\n        }, function (data) {\n          var partSpec = detail.parts[data.name];\n          externals[data.name] = constant(data.factory.sketch(combine(detail, data, partSpec[original()]), partSpec));\n        }, function (data) {\n          internals[data.pname] = single(false, function (detail, partSpec, partValidated) {\n            return data.factory.sketch(combine(detail, data, partSpec, partValidated));\n          });\n        }, function (data) {\n          internals[data.pname] = multiple(true, function (detail, _partSpec, _partValidated) {\n            var units = detail[data.name];\n            return map$1(units, function (u) {\n              return data.factory.sketch(deepMerge(data.defaults(detail, u, _partValidated), u, data.overrides(detail, u)));\n            });\n          });\n        });\n      });\n      return {\n        internals: constant(internals),\n        externals: constant(externals)\n      };\n    };\n\n    var generate$2 = function (owner, parts) {\n      var r = {};\n      each$1(parts, function (part) {\n        asNamedPart(part).each(function (np) {\n          var g = doGenerateOne(owner, np.pname);\n          r[np.name] = function (config) {\n            var validated = asRawOrDie('Part: ' + np.name + ' in ' + owner, objOf(np.schema), config);\n            return __assign(__assign({}, g), {\n              config: config,\n              validated: validated\n            });\n          };\n        });\n      });\n      return r;\n    };\n    var doGenerateOne = function (owner, pname) {\n      return {\n        uiType: placeholder(),\n        owner: owner,\n        name: pname\n      };\n    };\n    var generateOne = function (owner, pname, config) {\n      return {\n        uiType: placeholder(),\n        owner: owner,\n        name: pname,\n        config: config,\n        validated: {}\n      };\n    };\n    var schemas = function (parts) {\n      return bind(parts, function (part) {\n        return part.fold(Option.none, Option.some, Option.none, Option.none).map(function (data) {\n          return strictObjOf(data.name, data.schema.concat([snapshot(original())]));\n        }).toArray();\n      });\n    };\n    var names = function (parts) {\n      return map$1(parts, name$1);\n    };\n    var substitutes = function (owner, detail, parts) {\n      return subs(owner, detail, parts);\n    };\n    var components = function (owner, detail, internals) {\n      return substitutePlaces(Option.some(owner), detail, detail.components, internals);\n    };\n    var getPart = function (component, detail, partKey) {\n      var uid = detail.partUids[partKey];\n      return component.getSystem().getByUid(uid).toOption();\n    };\n    var getPartOrDie = function (component, detail, partKey) {\n      return getPart(component, detail, partKey).getOrDie('Could not find part: ' + partKey);\n    };\n    var getAllParts = function (component, detail) {\n      var system = component.getSystem();\n      return map(detail.partUids, function (pUid, k) {\n        return constant(system.getByUid(pUid));\n      });\n    };\n    var defaultUids = function (baseUid, partTypes) {\n      var partNames = names(partTypes);\n      return wrapAll$1(map$1(partNames, function (pn) {\n        return {\n          key: pn,\n          value: baseUid + '-' + pn\n        };\n      }));\n    };\n    var defaultUidsSchema = function (partTypes) {\n      return field('partUids', 'partUids', mergeWithThunk(function (spec) {\n        return defaultUids(spec.uid, partTypes);\n      }), anyValue$1());\n    };\n\n    var premadeTag = generate$1('alloy-premade');\n    var premade = function (comp) {\n      return wrap$1(premadeTag, comp);\n    };\n    var getPremade = function (spec) {\n      return readOptFrom$1(spec, premadeTag);\n    };\n    var makeApi = function (f) {\n      return markAsSketchApi(function (component) {\n        var rest = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n          rest[_i - 1] = arguments[_i];\n        }\n        return f.apply(undefined, [component.getApis()].concat([component].concat(rest)));\n      }, f);\n    };\n\n    var prefix$1 = constant('alloy-id-');\n    var idAttr = constant('data-alloy-id');\n\n    var prefix$2 = prefix$1();\n    var idAttr$1 = idAttr();\n    var write = function (label, elem) {\n      var id = generate$1(prefix$2 + label);\n      writeOnly(elem, id);\n      return id;\n    };\n    var writeOnly = function (elem, uid) {\n      Object.defineProperty(elem.dom(), idAttr$1, {\n        value: uid,\n        writable: true\n      });\n    };\n    var read$2 = function (elem) {\n      var id = isElement(elem) ? elem.dom()[idAttr$1] : null;\n      return Option.from(id);\n    };\n    var generate$3 = function (prefix) {\n      return generate$1(prefix);\n    };\n\n    var base = function (partSchemas, partUidsSchemas) {\n      var ps = partSchemas.length > 0 ? [strictObjOf('parts', partSchemas)] : [];\n      return ps.concat([\n        strict$1('uid'),\n        defaulted$1('dom', {}),\n        defaulted$1('components', []),\n        snapshot('originalSpec'),\n        defaulted$1('debug.sketcher', {})\n      ]).concat(partUidsSchemas);\n    };\n    var asRawOrDie$1 = function (label, schema, spec, partSchemas, partUidsSchemas) {\n      var baseS = base(partSchemas, partUidsSchemas);\n      return asRawOrDie(label + ' [SpecSchema]', objOfOnly(baseS.concat(schema)), spec);\n    };\n\n    var single$1 = function (owner, schema, factory, spec) {\n      var specWithUid = supplyUid(spec);\n      var detail = asRawOrDie$1(owner, schema, specWithUid, [], []);\n      return factory(detail, specWithUid);\n    };\n    var composite = function (owner, schema, partTypes, factory, spec) {\n      var specWithUid = supplyUid(spec);\n      var partSchemas = schemas(partTypes);\n      var partUidsSchema = defaultUidsSchema(partTypes);\n      var detail = asRawOrDie$1(owner, schema, specWithUid, partSchemas, [partUidsSchema]);\n      var subs = substitutes(owner, detail, partTypes);\n      var components$1 = components(owner, detail, subs.internals());\n      return factory(detail, components$1, specWithUid, subs.externals());\n    };\n    var supplyUid = function (spec) {\n      return spec.hasOwnProperty('uid') ? spec : __assign(__assign({}, spec), { uid: generate$3('uid') });\n    };\n\n    function isSketchSpec(spec) {\n      return spec.uid !== undefined;\n    }\n    var singleSchema = objOfOnly([\n      strict$1('name'),\n      strict$1('factory'),\n      strict$1('configFields'),\n      defaulted$1('apis', {}),\n      defaulted$1('extraApis', {})\n    ]);\n    var compositeSchema = objOfOnly([\n      strict$1('name'),\n      strict$1('factory'),\n      strict$1('configFields'),\n      strict$1('partFields'),\n      defaulted$1('apis', {}),\n      defaulted$1('extraApis', {})\n    ]);\n    var single$2 = function (rawConfig) {\n      var config = asRawOrDie('Sketcher for ' + rawConfig.name, singleSchema, rawConfig);\n      var sketch = function (spec) {\n        return single$1(config.name, config.configFields, config.factory, spec);\n      };\n      var apis = map(config.apis, makeApi);\n      var extraApis = map(config.extraApis, function (f, k) {\n        return markAsExtraApi(f, k);\n      });\n      return __assign(__assign({\n        name: constant(config.name),\n        partFields: constant([]),\n        configFields: constant(config.configFields),\n        sketch: sketch\n      }, apis), extraApis);\n    };\n    var composite$1 = function (rawConfig) {\n      var config = asRawOrDie('Sketcher for ' + rawConfig.name, compositeSchema, rawConfig);\n      var sketch = function (spec) {\n        return composite(config.name, config.configFields, config.partFields, config.factory, spec);\n      };\n      var parts = generate$2(config.name, config.partFields);\n      var apis = map(config.apis, makeApi);\n      var extraApis = map(config.extraApis, function (f, k) {\n        return markAsExtraApi(f, k);\n      });\n      return __assign(__assign({\n        name: constant(config.name),\n        partFields: constant(config.partFields),\n        configFields: constant(config.configFields),\n        sketch: sketch,\n        parts: constant(parts)\n      }, apis), extraApis);\n    };\n\n    var factory = function (detail) {\n      var events = events$2(detail.action);\n      var tag = detail.dom.tag;\n      var lookupAttr = function (attr) {\n        return readOptFrom$1(detail.dom, 'attributes').bind(function (attrs) {\n          return readOptFrom$1(attrs, attr);\n        });\n      };\n      var getModAttributes = function () {\n        if (tag === 'button') {\n          var type = lookupAttr('type').getOr('button');\n          var roleAttrs = lookupAttr('role').map(function (role) {\n            return { role: role };\n          }).getOr({});\n          return __assign({ type: type }, roleAttrs);\n        } else {\n          var role = lookupAttr('role').getOr('button');\n          return { role: role };\n        }\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: detail.components,\n        events: events,\n        behaviours: SketchBehaviours.augment(detail.buttonBehaviours, [\n          Focusing.config({}),\n          Keying.config({\n            mode: 'execution',\n            useSpace: true,\n            useEnter: true\n          })\n        ]),\n        domModification: { attributes: getModAttributes() },\n        eventOrder: detail.eventOrder\n      };\n    };\n    var Button = single$2({\n      name: 'Button',\n      factory: factory,\n      configFields: [\n        defaulted$1('uid', undefined),\n        strict$1('dom'),\n        defaulted$1('components', []),\n        SketchBehaviours.field('buttonBehaviours', [\n          Focusing,\n          Keying\n        ]),\n        option('action'),\n        option('role'),\n        defaulted$1('eventOrder', {})\n      ]\n    });\n\n    var exhibit$2 = function (base, unselectConfig) {\n      return nu$5({\n        styles: {\n          '-webkit-user-select': 'none',\n          'user-select': 'none',\n          '-ms-user-select': 'none',\n          '-moz-user-select': '-moz-none'\n        },\n        attributes: { unselectable: 'on' }\n      });\n    };\n    var events$4 = function (unselectConfig) {\n      return derive([abort(selectstart(), constant(true))]);\n    };\n\n    var ActiveUnselecting = /*#__PURE__*/Object.freeze({\n        events: events$4,\n        exhibit: exhibit$2\n    });\n\n    var Unselecting = create$1({\n      fields: [],\n      name: 'unselecting',\n      active: ActiveUnselecting\n    });\n\n    var getAttrs = function (elem) {\n      var attributes = elem.dom().attributes !== undefined ? elem.dom().attributes : [];\n      return foldl(attributes, function (b, attr) {\n        var _a;\n        if (attr.name === 'class') {\n          return b;\n        } else {\n          return __assign(__assign({}, b), (_a = {}, _a[attr.name] = attr.value, _a));\n        }\n      }, {});\n    };\n    var getClasses = function (elem) {\n      return Array.prototype.slice.call(elem.dom().classList, 0);\n    };\n    var fromHtml$2 = function (html) {\n      var elem = Element.fromHtml(html);\n      var children$1 = children(elem);\n      var attrs = getAttrs(elem);\n      var classes = getClasses(elem);\n      var contents = children$1.length === 0 ? {} : { innerHtml: get$2(elem) };\n      return __assign({\n        tag: name(elem),\n        classes: classes,\n        attributes: attrs\n      }, contents);\n    };\n\n    var dom$1 = function (rawHtml) {\n      var html = supplant(rawHtml, { prefix: Styles.prefix() });\n      return fromHtml$2(html);\n    };\n    var spec = function (rawHtml) {\n      var sDom = dom$1(rawHtml);\n      return { dom: sDom };\n    };\n\n    var forToolbarCommand = function (editor, command) {\n      return forToolbar(command, function () {\n        editor.execCommand(command);\n      }, {}, editor);\n    };\n    var getToggleBehaviours = function (command) {\n      return derive$1([\n        Toggling.config({\n          toggleClass: Styles.resolve('toolbar-button-selected'),\n          toggleOnExecute: false,\n          aria: { mode: 'pressed' }\n        }),\n        Receivers.format(command, function (button, status) {\n          var toggle = status ? Toggling.on : Toggling.off;\n          toggle(button);\n        })\n      ]);\n    };\n    var forToolbarStateCommand = function (editor, command) {\n      var extraBehaviours = getToggleBehaviours(command);\n      return forToolbar(command, function () {\n        editor.execCommand(command);\n      }, extraBehaviours, editor);\n    };\n    var forToolbarStateAction = function (editor, clazz, command, action) {\n      var extraBehaviours = getToggleBehaviours(command);\n      return forToolbar(clazz, action, extraBehaviours, editor);\n    };\n    var getToolbarIconButton = function (clazz, editor) {\n      var icons = editor.ui.registry.getAll().icons;\n      var optOxideIcon = Option.from(icons[clazz]);\n      return optOxideIcon.fold(function () {\n        return dom$1('<span class=\"${prefix}-toolbar-button ${prefix}-toolbar-group-item ${prefix}-icon-' + clazz + ' ${prefix}-icon\"></span>');\n      }, function (icon) {\n        return dom$1('<span class=\"${prefix}-toolbar-button ${prefix}-toolbar-group-item\">' + icon + '</span>');\n      });\n    };\n    var forToolbar = function (clazz, action, extraBehaviours, editor) {\n      return Button.sketch({\n        dom: getToolbarIconButton(clazz, editor),\n        action: action,\n        buttonBehaviours: deepMerge(derive$1([Unselecting.config({})]), extraBehaviours)\n      });\n    };\n    var Buttons = {\n      forToolbar: forToolbar,\n      forToolbarCommand: forToolbarCommand,\n      forToolbarStateAction: forToolbarStateAction,\n      forToolbarStateCommand: forToolbarStateCommand,\n      getToolbarIconButton: getToolbarIconButton\n    };\n\n    var platform$1 = detect$3();\n    var isTouch = platform$1.deviceType.isTouch();\n    var labelPart = optional({\n      schema: [strict$1('dom')],\n      name: 'label'\n    });\n    var edgePart = function (name) {\n      return optional({\n        name: '' + name + '-edge',\n        overrides: function (detail) {\n          var action = detail.model.manager.edgeActions[name];\n          return action.fold(function () {\n            return {};\n          }, function (a) {\n            var touchEvents = derive([runActionExtra(touchstart(), a, [detail])]);\n            var mouseEvents = derive([\n              runActionExtra(mousedown(), a, [detail]),\n              runActionExtra(mousemove(), function (l, det) {\n                if (det.mouseIsDown.get()) {\n                  a(l, det);\n                }\n              }, [detail])\n            ]);\n            return { events: isTouch ? touchEvents : mouseEvents };\n          });\n        }\n      });\n    };\n    var tlEdgePart = edgePart('top-left');\n    var tedgePart = edgePart('top');\n    var trEdgePart = edgePart('top-right');\n    var redgePart = edgePart('right');\n    var brEdgePart = edgePart('bottom-right');\n    var bedgePart = edgePart('bottom');\n    var blEdgePart = edgePart('bottom-left');\n    var ledgePart = edgePart('left');\n    var thumbPart = required({\n      name: 'thumb',\n      defaults: constant({ dom: { styles: { position: 'absolute' } } }),\n      overrides: function (detail) {\n        return {\n          events: derive([\n            redirectToPart(touchstart(), detail, 'spectrum'),\n            redirectToPart(touchmove(), detail, 'spectrum'),\n            redirectToPart(touchend(), detail, 'spectrum'),\n            redirectToPart(mousedown(), detail, 'spectrum'),\n            redirectToPart(mousemove(), detail, 'spectrum'),\n            redirectToPart(mouseup(), detail, 'spectrum')\n          ])\n        };\n      }\n    });\n    var spectrumPart = required({\n      schema: [state$1('mouseIsDown', function () {\n          return Cell(false);\n        })],\n      name: 'spectrum',\n      overrides: function (detail) {\n        var modelDetail = detail.model;\n        var model = modelDetail.manager;\n        var setValueFrom = function (component, simulatedEvent) {\n          return model.getValueFromEvent(simulatedEvent).map(function (value) {\n            return model.setValueFrom(component, detail, value);\n          });\n        };\n        var touchEvents = derive([\n          run(touchstart(), setValueFrom),\n          run(touchmove(), setValueFrom)\n        ]);\n        var mouseEvents = derive([\n          run(mousedown(), setValueFrom),\n          run(mousemove(), function (spectrum, se) {\n            if (detail.mouseIsDown.get()) {\n              setValueFrom(spectrum, se);\n            }\n          })\n        ]);\n        return {\n          behaviours: derive$1(isTouch ? [] : [\n            Keying.config({\n              mode: 'special',\n              onLeft: function (spectrum) {\n                return model.onLeft(spectrum, detail);\n              },\n              onRight: function (spectrum) {\n                return model.onRight(spectrum, detail);\n              },\n              onUp: function (spectrum) {\n                return model.onUp(spectrum, detail);\n              },\n              onDown: function (spectrum) {\n                return model.onDown(spectrum, detail);\n              }\n            }),\n            Focusing.config({})\n          ]),\n          events: isTouch ? touchEvents : mouseEvents\n        };\n      }\n    });\n    var SliderParts = [\n      labelPart,\n      ledgePart,\n      redgePart,\n      tedgePart,\n      bedgePart,\n      tlEdgePart,\n      trEdgePart,\n      blEdgePart,\n      brEdgePart,\n      thumbPart,\n      spectrumPart\n    ];\n\n    var onLoad$1 = function (component, repConfig, repState) {\n      repConfig.store.manager.onLoad(component, repConfig, repState);\n    };\n    var onUnload = function (component, repConfig, repState) {\n      repConfig.store.manager.onUnload(component, repConfig, repState);\n    };\n    var setValue = function (component, repConfig, repState, data) {\n      repConfig.store.manager.setValue(component, repConfig, repState, data);\n    };\n    var getValue = function (component, repConfig, repState) {\n      return repConfig.store.manager.getValue(component, repConfig, repState);\n    };\n    var getState = function (component, repConfig, repState) {\n      return repState;\n    };\n\n    var RepresentApis = /*#__PURE__*/Object.freeze({\n        onLoad: onLoad$1,\n        onUnload: onUnload,\n        setValue: setValue,\n        getValue: getValue,\n        getState: getState\n    });\n\n    var events$5 = function (repConfig, repState) {\n      var es = repConfig.resetOnDom ? [\n        runOnAttached(function (comp, se) {\n          onLoad$1(comp, repConfig, repState);\n        }),\n        runOnDetached(function (comp, se) {\n          onUnload(comp, repConfig, repState);\n        })\n      ] : [loadEvent(repConfig, repState, onLoad$1)];\n      return derive(es);\n    };\n\n    var ActiveRepresenting = /*#__PURE__*/Object.freeze({\n        events: events$5\n    });\n\n    var memory = function () {\n      var data = Cell(null);\n      var readState = function () {\n        return {\n          mode: 'memory',\n          value: data.get()\n        };\n      };\n      var isNotSet = function () {\n        return data.get() === null;\n      };\n      var clear = function () {\n        data.set(null);\n      };\n      return nu$6({\n        set: data.set,\n        get: data.get,\n        isNotSet: isNotSet,\n        clear: clear,\n        readState: readState\n      });\n    };\n    var manual = function () {\n      var readState = function () {\n      };\n      return nu$6({ readState: readState });\n    };\n    var dataset = function () {\n      var dataByValue = Cell({});\n      var dataByText = Cell({});\n      var readState = function () {\n        return {\n          mode: 'dataset',\n          dataByValue: dataByValue.get(),\n          dataByText: dataByText.get()\n        };\n      };\n      var clear = function () {\n        dataByValue.set({});\n        dataByText.set({});\n      };\n      var lookup = function (itemString) {\n        return readOptFrom$1(dataByValue.get(), itemString).orThunk(function () {\n          return readOptFrom$1(dataByText.get(), itemString);\n        });\n      };\n      var update = function (items) {\n        var currentDataByValue = dataByValue.get();\n        var currentDataByText = dataByText.get();\n        var newDataByValue = {};\n        var newDataByText = {};\n        each$1(items, function (item) {\n          newDataByValue[item.value] = item;\n          readOptFrom$1(item, 'meta').each(function (meta) {\n            readOptFrom$1(meta, 'text').each(function (text) {\n              newDataByText[text] = item;\n            });\n          });\n        });\n        dataByValue.set(__assign(__assign({}, currentDataByValue), newDataByValue));\n        dataByText.set(__assign(__assign({}, currentDataByText), newDataByText));\n      };\n      return nu$6({\n        readState: readState,\n        lookup: lookup,\n        update: update,\n        clear: clear\n      });\n    };\n    var init$1 = function (spec) {\n      return spec.store.manager.state(spec);\n    };\n\n    var RepresentState = /*#__PURE__*/Object.freeze({\n        memory: memory,\n        dataset: dataset,\n        manual: manual,\n        init: init$1\n    });\n\n    var setValue$1 = function (component, repConfig, repState, data) {\n      var store = repConfig.store;\n      repState.update([data]);\n      store.setValue(component, data);\n      repConfig.onSetValue(component, data);\n    };\n    var getValue$1 = function (component, repConfig, repState) {\n      var store = repConfig.store;\n      var key = store.getDataKey(component);\n      return repState.lookup(key).fold(function () {\n        return store.getFallbackEntry(key);\n      }, function (data) {\n        return data;\n      });\n    };\n    var onLoad$2 = function (component, repConfig, repState) {\n      var store = repConfig.store;\n      store.initialValue.each(function (data) {\n        setValue$1(component, repConfig, repState, data);\n      });\n    };\n    var onUnload$1 = function (component, repConfig, repState) {\n      repState.clear();\n    };\n    var DatasetStore = [\n      option('initialValue'),\n      strict$1('getFallbackEntry'),\n      strict$1('getDataKey'),\n      strict$1('setValue'),\n      output('manager', {\n        setValue: setValue$1,\n        getValue: getValue$1,\n        onLoad: onLoad$2,\n        onUnload: onUnload$1,\n        state: dataset\n      })\n    ];\n\n    var getValue$2 = function (component, repConfig, repState) {\n      return repConfig.store.getValue(component);\n    };\n    var setValue$2 = function (component, repConfig, repState, data) {\n      repConfig.store.setValue(component, data);\n      repConfig.onSetValue(component, data);\n    };\n    var onLoad$3 = function (component, repConfig, repState) {\n      repConfig.store.initialValue.each(function (data) {\n        repConfig.store.setValue(component, data);\n      });\n    };\n    var ManualStore = [\n      strict$1('getValue'),\n      defaulted$1('setValue', noop),\n      option('initialValue'),\n      output('manager', {\n        setValue: setValue$2,\n        getValue: getValue$2,\n        onLoad: onLoad$3,\n        onUnload: noop,\n        state: NoState.init\n      })\n    ];\n\n    var setValue$3 = function (component, repConfig, repState, data) {\n      repState.set(data);\n      repConfig.onSetValue(component, data);\n    };\n    var getValue$3 = function (component, repConfig, repState) {\n      return repState.get();\n    };\n    var onLoad$4 = function (component, repConfig, repState) {\n      repConfig.store.initialValue.each(function (initVal) {\n        if (repState.isNotSet()) {\n          repState.set(initVal);\n        }\n      });\n    };\n    var onUnload$2 = function (component, repConfig, repState) {\n      repState.clear();\n    };\n    var MemoryStore = [\n      option('initialValue'),\n      output('manager', {\n        setValue: setValue$3,\n        getValue: getValue$3,\n        onLoad: onLoad$4,\n        onUnload: onUnload$2,\n        state: memory\n      })\n    ];\n\n    var RepresentSchema = [\n      defaultedOf('store', { mode: 'memory' }, choose$1('mode', {\n        memory: MemoryStore,\n        manual: ManualStore,\n        dataset: DatasetStore\n      })),\n      onHandler('onSetValue'),\n      defaulted$1('resetOnDom', false)\n    ];\n\n    var Representing = create$1({\n      fields: RepresentSchema,\n      name: 'representing',\n      active: ActiveRepresenting,\n      apis: RepresentApis,\n      extra: {\n        setValueFrom: function (component, source) {\n          var value = Representing.getValue(source);\n          Representing.setValue(component, value);\n        }\n      },\n      state: RepresentState\n    });\n\n    var api$1 = Dimension('width', function (element) {\n      return element.dom().offsetWidth;\n    });\n    var set$4 = function (element, h) {\n      api$1.set(element, h);\n    };\n    var get$6 = function (element) {\n      return api$1.get(element);\n    };\n\n    var r = function (left, top) {\n      var translate = function (x, y) {\n        return r(left + x, top + y);\n      };\n      return {\n        left: constant(left),\n        top: constant(top),\n        translate: translate\n      };\n    };\n    var Position = r;\n\n    var isTouch$1 = detect$3().deviceType.isTouch();\n    var _sliderChangeEvent = 'slider.change.value';\n    var sliderChangeEvent = constant(_sliderChangeEvent);\n    var getEventSource = function (simulatedEvent) {\n      var evt = simulatedEvent.event().raw();\n      if (isTouch$1) {\n        var touchEvent = evt;\n        return touchEvent.touches !== undefined && touchEvent.touches.length === 1 ? Option.some(touchEvent.touches[0]).map(function (t) {\n          return Position(t.clientX, t.clientY);\n        }) : Option.none();\n      } else {\n        var mouseEvent = evt;\n        return mouseEvent.clientX !== undefined ? Option.some(mouseEvent).map(function (me) {\n          return Position(me.clientX, me.clientY);\n        }) : Option.none();\n      }\n    };\n\n    var t = 'top', r$1 = 'right', b = 'bottom', l = 'left';\n    var minX = function (detail) {\n      return detail.model.minX;\n    };\n    var minY = function (detail) {\n      return detail.model.minY;\n    };\n    var min1X = function (detail) {\n      return detail.model.minX - 1;\n    };\n    var min1Y = function (detail) {\n      return detail.model.minY - 1;\n    };\n    var maxX = function (detail) {\n      return detail.model.maxX;\n    };\n    var maxY = function (detail) {\n      return detail.model.maxY;\n    };\n    var max1X = function (detail) {\n      return detail.model.maxX + 1;\n    };\n    var max1Y = function (detail) {\n      return detail.model.maxY + 1;\n    };\n    var range = function (detail, max, min) {\n      return max(detail) - min(detail);\n    };\n    var xRange = function (detail) {\n      return range(detail, maxX, minX);\n    };\n    var yRange = function (detail) {\n      return range(detail, maxY, minY);\n    };\n    var halfX = function (detail) {\n      return xRange(detail) / 2;\n    };\n    var halfY = function (detail) {\n      return yRange(detail) / 2;\n    };\n    var step = function (detail) {\n      return detail.stepSize;\n    };\n    var snap = function (detail) {\n      return detail.snapToGrid;\n    };\n    var snapStart = function (detail) {\n      return detail.snapStart;\n    };\n    var rounded = function (detail) {\n      return detail.rounded;\n    };\n    var hasEdge = function (detail, edgeName) {\n      return detail[edgeName + '-edge'] !== undefined;\n    };\n    var hasLEdge = function (detail) {\n      return hasEdge(detail, l);\n    };\n    var hasREdge = function (detail) {\n      return hasEdge(detail, r$1);\n    };\n    var hasTEdge = function (detail) {\n      return hasEdge(detail, t);\n    };\n    var hasBEdge = function (detail) {\n      return hasEdge(detail, b);\n    };\n    var currentValue = function (detail) {\n      return detail.model.value.get();\n    };\n\n    var xValue = function (x) {\n      return { x: constant(x) };\n    };\n    var yValue = function (y) {\n      return { y: constant(y) };\n    };\n    var xyValue = function (x, y) {\n      return {\n        x: constant(x),\n        y: constant(y)\n      };\n    };\n    var fireSliderChange = function (component, value) {\n      emitWith(component, sliderChangeEvent(), { value: value });\n    };\n    var setToTLEdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(min1X(detail), min1Y(detail)));\n    };\n    var setToTEdge = function (edge, detail) {\n      fireSliderChange(edge, yValue(min1Y(detail)));\n    };\n    var setToTEdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(halfX(detail), min1Y(detail)));\n    };\n    var setToTREdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(max1X(detail), min1Y(detail)));\n    };\n    var setToREdge = function (edge, detail) {\n      fireSliderChange(edge, xValue(max1X(detail)));\n    };\n    var setToREdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(max1X(detail), halfY(detail)));\n    };\n    var setToBREdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(max1X(detail), max1Y(detail)));\n    };\n    var setToBEdge = function (edge, detail) {\n      fireSliderChange(edge, yValue(max1Y(detail)));\n    };\n    var setToBEdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(halfX(detail), max1Y(detail)));\n    };\n    var setToBLEdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(min1X(detail), max1Y(detail)));\n    };\n    var setToLEdge = function (edge, detail) {\n      fireSliderChange(edge, xValue(min1X(detail)));\n    };\n    var setToLEdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(min1X(detail), halfY(detail)));\n    };\n\n    var reduceBy = function (value, min, max, step) {\n      if (value < min) {\n        return value;\n      } else if (value > max) {\n        return max;\n      } else if (value === min) {\n        return min - 1;\n      } else {\n        return Math.max(min, value - step);\n      }\n    };\n    var increaseBy = function (value, min, max, step) {\n      if (value > max) {\n        return value;\n      } else if (value < min) {\n        return min;\n      } else if (value === max) {\n        return max + 1;\n      } else {\n        return Math.min(max, value + step);\n      }\n    };\n    var capValue = function (value, min, max) {\n      return Math.max(min, Math.min(max, value));\n    };\n    var snapValueOf = function (value, min, max, step, snapStart) {\n      return snapStart.fold(function () {\n        var initValue = value - min;\n        var extraValue = Math.round(initValue / step) * step;\n        return capValue(min + extraValue, min - 1, max + 1);\n      }, function (start) {\n        var remainder = (value - start) % step;\n        var adjustment = Math.round(remainder / step);\n        var rawSteps = Math.floor((value - start) / step);\n        var maxSteps = Math.floor((max - start) / step);\n        var numSteps = Math.min(maxSteps, rawSteps + adjustment);\n        var r = start + numSteps * step;\n        return Math.max(start, r);\n      });\n    };\n    var findOffsetOf = function (value, min, max) {\n      return Math.min(max, Math.max(value, min)) - min;\n    };\n    var findValueOf = function (args) {\n      var min = args.min, max = args.max, range = args.range, value = args.value, step = args.step, snap = args.snap, snapStart = args.snapStart, rounded = args.rounded, hasMinEdge = args.hasMinEdge, hasMaxEdge = args.hasMaxEdge, minBound = args.minBound, maxBound = args.maxBound, screenRange = args.screenRange;\n      var capMin = hasMinEdge ? min - 1 : min;\n      var capMax = hasMaxEdge ? max + 1 : max;\n      if (value < minBound) {\n        return capMin;\n      } else if (value > maxBound) {\n        return capMax;\n      } else {\n        var offset = findOffsetOf(value, minBound, maxBound);\n        var newValue = capValue(offset / screenRange * range + min, capMin, capMax);\n        if (snap && newValue >= min && newValue <= max) {\n          return snapValueOf(newValue, min, max, step, snapStart);\n        } else if (rounded) {\n          return Math.round(newValue);\n        } else {\n          return newValue;\n        }\n      }\n    };\n    var findOffsetOfValue = function (args) {\n      var min = args.min, max = args.max, range = args.range, value = args.value, hasMinEdge = args.hasMinEdge, hasMaxEdge = args.hasMaxEdge, maxBound = args.maxBound, maxOffset = args.maxOffset, centerMinEdge = args.centerMinEdge, centerMaxEdge = args.centerMaxEdge;\n      if (value < min) {\n        return hasMinEdge ? 0 : centerMinEdge;\n      } else if (value > max) {\n        return hasMaxEdge ? maxBound : centerMaxEdge;\n      } else {\n        return (value - min) / range * maxOffset;\n      }\n    };\n\n    var top = 'top', right = 'right', bottom = 'bottom', left = 'left', width = 'width', height = 'height';\n    var getBounds = function (component) {\n      return component.element().dom().getBoundingClientRect();\n    };\n    var getBoundsProperty = function (bounds, property) {\n      return bounds[property];\n    };\n    var getMinXBounds = function (component) {\n      var bounds = getBounds(component);\n      return getBoundsProperty(bounds, left);\n    };\n    var getMaxXBounds = function (component) {\n      var bounds = getBounds(component);\n      return getBoundsProperty(bounds, right);\n    };\n    var getMinYBounds = function (component) {\n      var bounds = getBounds(component);\n      return getBoundsProperty(bounds, top);\n    };\n    var getMaxYBounds = function (component) {\n      var bounds = getBounds(component);\n      return getBoundsProperty(bounds, bottom);\n    };\n    var getXScreenRange = function (component) {\n      var bounds = getBounds(component);\n      return getBoundsProperty(bounds, width);\n    };\n    var getYScreenRange = function (component) {\n      var bounds = getBounds(component);\n      return getBoundsProperty(bounds, height);\n    };\n    var getCenterOffsetOf = function (componentMinEdge, componentMaxEdge, spectrumMinEdge) {\n      return (componentMinEdge + componentMaxEdge) / 2 - spectrumMinEdge;\n    };\n    var getXCenterOffSetOf = function (component, spectrum) {\n      var componentBounds = getBounds(component);\n      var spectrumBounds = getBounds(spectrum);\n      var componentMinEdge = getBoundsProperty(componentBounds, left);\n      var componentMaxEdge = getBoundsProperty(componentBounds, right);\n      var spectrumMinEdge = getBoundsProperty(spectrumBounds, left);\n      return getCenterOffsetOf(componentMinEdge, componentMaxEdge, spectrumMinEdge);\n    };\n    var getYCenterOffSetOf = function (component, spectrum) {\n      var componentBounds = getBounds(component);\n      var spectrumBounds = getBounds(spectrum);\n      var componentMinEdge = getBoundsProperty(componentBounds, top);\n      var componentMaxEdge = getBoundsProperty(componentBounds, bottom);\n      var spectrumMinEdge = getBoundsProperty(spectrumBounds, top);\n      return getCenterOffsetOf(componentMinEdge, componentMaxEdge, spectrumMinEdge);\n    };\n\n    var fireSliderChange$1 = function (spectrum, value) {\n      emitWith(spectrum, sliderChangeEvent(), { value: value });\n    };\n    var sliderValue = function (x) {\n      return { x: constant(x) };\n    };\n    var findValueOfOffset = function (spectrum, detail, left) {\n      var args = {\n        min: minX(detail),\n        max: maxX(detail),\n        range: xRange(detail),\n        value: left,\n        step: step(detail),\n        snap: snap(detail),\n        snapStart: snapStart(detail),\n        rounded: rounded(detail),\n        hasMinEdge: hasLEdge(detail),\n        hasMaxEdge: hasREdge(detail),\n        minBound: getMinXBounds(spectrum),\n        maxBound: getMaxXBounds(spectrum),\n        screenRange: getXScreenRange(spectrum)\n      };\n      return findValueOf(args);\n    };\n    var setValueFrom = function (spectrum, detail, value) {\n      var xValue = findValueOfOffset(spectrum, detail, value);\n      var sliderVal = sliderValue(xValue);\n      fireSliderChange$1(spectrum, sliderVal);\n      return xValue;\n    };\n    var setToMin = function (spectrum, detail) {\n      var min = minX(detail);\n      fireSliderChange$1(spectrum, sliderValue(min));\n    };\n    var setToMax = function (spectrum, detail) {\n      var max = maxX(detail);\n      fireSliderChange$1(spectrum, sliderValue(max));\n    };\n    var moveBy = function (direction, spectrum, detail) {\n      var f = direction > 0 ? increaseBy : reduceBy;\n      var xValue = f(currentValue(detail).x(), minX(detail), maxX(detail), step(detail));\n      fireSliderChange$1(spectrum, sliderValue(xValue));\n      return Option.some(xValue);\n    };\n    var handleMovement = function (direction) {\n      return function (spectrum, detail) {\n        return moveBy(direction, spectrum, detail).map(function () {\n          return true;\n        });\n      };\n    };\n    var getValueFromEvent = function (simulatedEvent) {\n      var pos = getEventSource(simulatedEvent);\n      return pos.map(function (p) {\n        return p.left();\n      });\n    };\n    var findOffsetOfValue$1 = function (spectrum, detail, value, minEdge, maxEdge) {\n      var minOffset = 0;\n      var maxOffset = getXScreenRange(spectrum);\n      var centerMinEdge = minEdge.bind(function (edge) {\n        return Option.some(getXCenterOffSetOf(edge, spectrum));\n      }).getOr(minOffset);\n      var centerMaxEdge = maxEdge.bind(function (edge) {\n        return Option.some(getXCenterOffSetOf(edge, spectrum));\n      }).getOr(maxOffset);\n      var args = {\n        min: minX(detail),\n        max: maxX(detail),\n        range: xRange(detail),\n        value: value,\n        hasMinEdge: hasLEdge(detail),\n        hasMaxEdge: hasREdge(detail),\n        minBound: getMinXBounds(spectrum),\n        minOffset: minOffset,\n        maxBound: getMaxXBounds(spectrum),\n        maxOffset: maxOffset,\n        centerMinEdge: centerMinEdge,\n        centerMaxEdge: centerMaxEdge\n      };\n      return findOffsetOfValue(args);\n    };\n    var findPositionOfValue = function (slider, spectrum, value, minEdge, maxEdge, detail) {\n      var offset = findOffsetOfValue$1(spectrum, detail, value, minEdge, maxEdge);\n      return getMinXBounds(spectrum) - getMinXBounds(slider) + offset;\n    };\n    var setPositionFromValue = function (slider, thumb, detail, edges) {\n      var value = currentValue(detail);\n      var pos = findPositionOfValue(slider, edges.getSpectrum(slider), value.x(), edges.getLeftEdge(slider), edges.getRightEdge(slider), detail);\n      var thumbRadius = get$6(thumb.element()) / 2;\n      set$3(thumb.element(), 'left', pos - thumbRadius + 'px');\n    };\n    var onLeft = handleMovement(-1);\n    var onRight = handleMovement(1);\n    var onUp = Option.none;\n    var onDown = Option.none;\n    var edgeActions = {\n      'top-left': Option.none(),\n      'top': Option.none(),\n      'top-right': Option.none(),\n      'right': Option.some(setToREdge),\n      'bottom-right': Option.none(),\n      'bottom': Option.none(),\n      'bottom-left': Option.none(),\n      'left': Option.some(setToLEdge)\n    };\n\n    var HorizontalModel = /*#__PURE__*/Object.freeze({\n        setValueFrom: setValueFrom,\n        setToMin: setToMin,\n        setToMax: setToMax,\n        findValueOfOffset: findValueOfOffset,\n        getValueFromEvent: getValueFromEvent,\n        findPositionOfValue: findPositionOfValue,\n        setPositionFromValue: setPositionFromValue,\n        onLeft: onLeft,\n        onRight: onRight,\n        onUp: onUp,\n        onDown: onDown,\n        edgeActions: edgeActions\n    });\n\n    var fireSliderChange$2 = function (spectrum, value) {\n      emitWith(spectrum, sliderChangeEvent(), { value: value });\n    };\n    var sliderValue$1 = function (y) {\n      return { y: constant(y) };\n    };\n    var findValueOfOffset$1 = function (spectrum, detail, top) {\n      var args = {\n        min: minY(detail),\n        max: maxY(detail),\n        range: yRange(detail),\n        value: top,\n        step: step(detail),\n        snap: snap(detail),\n        snapStart: snapStart(detail),\n        rounded: rounded(detail),\n        hasMinEdge: hasTEdge(detail),\n        hasMaxEdge: hasBEdge(detail),\n        minBound: getMinYBounds(spectrum),\n        maxBound: getMaxYBounds(spectrum),\n        screenRange: getYScreenRange(spectrum)\n      };\n      return findValueOf(args);\n    };\n    var setValueFrom$1 = function (spectrum, detail, value) {\n      var yValue = findValueOfOffset$1(spectrum, detail, value);\n      var sliderVal = sliderValue$1(yValue);\n      fireSliderChange$2(spectrum, sliderVal);\n      return yValue;\n    };\n    var setToMin$1 = function (spectrum, detail) {\n      var min = minY(detail);\n      fireSliderChange$2(spectrum, sliderValue$1(min));\n    };\n    var setToMax$1 = function (spectrum, detail) {\n      var max = maxY(detail);\n      fireSliderChange$2(spectrum, sliderValue$1(max));\n    };\n    var moveBy$1 = function (direction, spectrum, detail) {\n      var f = direction > 0 ? increaseBy : reduceBy;\n      var yValue = f(currentValue(detail).y(), minY(detail), maxY(detail), step(detail));\n      fireSliderChange$2(spectrum, sliderValue$1(yValue));\n      return Option.some(yValue);\n    };\n    var handleMovement$1 = function (direction) {\n      return function (spectrum, detail) {\n        return moveBy$1(direction, spectrum, detail).map(function () {\n          return true;\n        });\n      };\n    };\n    var getValueFromEvent$1 = function (simulatedEvent) {\n      var pos = getEventSource(simulatedEvent);\n      return pos.map(function (p) {\n        return p.top();\n      });\n    };\n    var findOffsetOfValue$2 = function (spectrum, detail, value, minEdge, maxEdge) {\n      var minOffset = 0;\n      var maxOffset = getYScreenRange(spectrum);\n      var centerMinEdge = minEdge.bind(function (edge) {\n        return Option.some(getYCenterOffSetOf(edge, spectrum));\n      }).getOr(minOffset);\n      var centerMaxEdge = maxEdge.bind(function (edge) {\n        return Option.some(getYCenterOffSetOf(edge, spectrum));\n      }).getOr(maxOffset);\n      var args = {\n        min: minY(detail),\n        max: maxY(detail),\n        range: yRange(detail),\n        value: value,\n        hasMinEdge: hasTEdge(detail),\n        hasMaxEdge: hasBEdge(detail),\n        minBound: getMinYBounds(spectrum),\n        minOffset: minOffset,\n        maxBound: getMaxYBounds(spectrum),\n        maxOffset: maxOffset,\n        centerMinEdge: centerMinEdge,\n        centerMaxEdge: centerMaxEdge\n      };\n      return findOffsetOfValue(args);\n    };\n    var findPositionOfValue$1 = function (slider, spectrum, value, minEdge, maxEdge, detail) {\n      var offset = findOffsetOfValue$2(spectrum, detail, value, minEdge, maxEdge);\n      return getMinYBounds(spectrum) - getMinYBounds(slider) + offset;\n    };\n    var setPositionFromValue$1 = function (slider, thumb, detail, edges) {\n      var value = currentValue(detail);\n      var pos = findPositionOfValue$1(slider, edges.getSpectrum(slider), value.y(), edges.getTopEdge(slider), edges.getBottomEdge(slider), detail);\n      var thumbRadius = get$4(thumb.element()) / 2;\n      set$3(thumb.element(), 'top', pos - thumbRadius + 'px');\n    };\n    var onLeft$1 = Option.none;\n    var onRight$1 = Option.none;\n    var onUp$1 = handleMovement$1(-1);\n    var onDown$1 = handleMovement$1(1);\n    var edgeActions$1 = {\n      'top-left': Option.none(),\n      'top': Option.some(setToTEdge),\n      'top-right': Option.none(),\n      'right': Option.none(),\n      'bottom-right': Option.none(),\n      'bottom': Option.some(setToBEdge),\n      'bottom-left': Option.none(),\n      'left': Option.none()\n    };\n\n    var VerticalModel = /*#__PURE__*/Object.freeze({\n        setValueFrom: setValueFrom$1,\n        setToMin: setToMin$1,\n        setToMax: setToMax$1,\n        findValueOfOffset: findValueOfOffset$1,\n        getValueFromEvent: getValueFromEvent$1,\n        findPositionOfValue: findPositionOfValue$1,\n        setPositionFromValue: setPositionFromValue$1,\n        onLeft: onLeft$1,\n        onRight: onRight$1,\n        onUp: onUp$1,\n        onDown: onDown$1,\n        edgeActions: edgeActions$1\n    });\n\n    var fireSliderChange$3 = function (spectrum, value) {\n      emitWith(spectrum, sliderChangeEvent(), { value: value });\n    };\n    var sliderValue$2 = function (x, y) {\n      return {\n        x: constant(x),\n        y: constant(y)\n      };\n    };\n    var setValueFrom$2 = function (spectrum, detail, value) {\n      var xValue = findValueOfOffset(spectrum, detail, value.left());\n      var yValue = findValueOfOffset$1(spectrum, detail, value.top());\n      var val = sliderValue$2(xValue, yValue);\n      fireSliderChange$3(spectrum, val);\n      return val;\n    };\n    var moveBy$2 = function (direction, isVerticalMovement, spectrum, detail) {\n      var f = direction > 0 ? increaseBy : reduceBy;\n      var xValue = isVerticalMovement ? currentValue(detail).x() : f(currentValue(detail).x(), minX(detail), maxX(detail), step(detail));\n      var yValue = !isVerticalMovement ? currentValue(detail).y() : f(currentValue(detail).y(), minY(detail), maxY(detail), step(detail));\n      fireSliderChange$3(spectrum, sliderValue$2(xValue, yValue));\n      return Option.some(xValue);\n    };\n    var handleMovement$2 = function (direction, isVerticalMovement) {\n      return function (spectrum, detail) {\n        return moveBy$2(direction, isVerticalMovement, spectrum, detail).map(function () {\n          return true;\n        });\n      };\n    };\n    var setToMin$2 = function (spectrum, detail) {\n      var mX = minX(detail);\n      var mY = minY(detail);\n      fireSliderChange$3(spectrum, sliderValue$2(mX, mY));\n    };\n    var setToMax$2 = function (spectrum, detail) {\n      var mX = maxX(detail);\n      var mY = maxY(detail);\n      fireSliderChange$3(spectrum, sliderValue$2(mX, mY));\n    };\n    var getValueFromEvent$2 = function (simulatedEvent) {\n      return getEventSource(simulatedEvent);\n    };\n    var setPositionFromValue$2 = function (slider, thumb, detail, edges) {\n      var value = currentValue(detail);\n      var xPos = findPositionOfValue(slider, edges.getSpectrum(slider), value.x(), edges.getLeftEdge(slider), edges.getRightEdge(slider), detail);\n      var yPos = findPositionOfValue$1(slider, edges.getSpectrum(slider), value.y(), edges.getTopEdge(slider), edges.getBottomEdge(slider), detail);\n      var thumbXRadius = get$6(thumb.element()) / 2;\n      var thumbYRadius = get$4(thumb.element()) / 2;\n      set$3(thumb.element(), 'left', xPos - thumbXRadius + 'px');\n      set$3(thumb.element(), 'top', yPos - thumbYRadius + 'px');\n    };\n    var onLeft$2 = handleMovement$2(-1, false);\n    var onRight$2 = handleMovement$2(1, false);\n    var onUp$2 = handleMovement$2(-1, true);\n    var onDown$2 = handleMovement$2(1, true);\n    var edgeActions$2 = {\n      'top-left': Option.some(setToTLEdgeXY),\n      'top': Option.some(setToTEdgeXY),\n      'top-right': Option.some(setToTREdgeXY),\n      'right': Option.some(setToREdgeXY),\n      'bottom-right': Option.some(setToBREdgeXY),\n      'bottom': Option.some(setToBEdgeXY),\n      'bottom-left': Option.some(setToBLEdgeXY),\n      'left': Option.some(setToLEdgeXY)\n    };\n\n    var TwoDModel = /*#__PURE__*/Object.freeze({\n        setValueFrom: setValueFrom$2,\n        setToMin: setToMin$2,\n        setToMax: setToMax$2,\n        getValueFromEvent: getValueFromEvent$2,\n        setPositionFromValue: setPositionFromValue$2,\n        onLeft: onLeft$2,\n        onRight: onRight$2,\n        onUp: onUp$2,\n        onDown: onDown$2,\n        edgeActions: edgeActions$2\n    });\n\n    var isTouch$2 = detect$3().deviceType.isTouch();\n    var SliderSchema = [\n      defaulted$1('stepSize', 1),\n      defaulted$1('onChange', noop),\n      defaulted$1('onChoose', noop),\n      defaulted$1('onInit', noop),\n      defaulted$1('onDragStart', noop),\n      defaulted$1('onDragEnd', noop),\n      defaulted$1('snapToGrid', false),\n      defaulted$1('rounded', true),\n      option('snapStart'),\n      strictOf('model', choose$1('mode', {\n        x: [\n          defaulted$1('minX', 0),\n          defaulted$1('maxX', 100),\n          state$1('value', function (spec) {\n            return Cell(spec.mode.minX);\n          }),\n          strict$1('getInitialValue'),\n          output('manager', HorizontalModel)\n        ],\n        y: [\n          defaulted$1('minY', 0),\n          defaulted$1('maxY', 100),\n          state$1('value', function (spec) {\n            return Cell(spec.mode.minY);\n          }),\n          strict$1('getInitialValue'),\n          output('manager', VerticalModel)\n        ],\n        xy: [\n          defaulted$1('minX', 0),\n          defaulted$1('maxX', 100),\n          defaulted$1('minY', 0),\n          defaulted$1('maxY', 100),\n          state$1('value', function (spec) {\n            return Cell({\n              x: constant(spec.mode.minX),\n              y: constant(spec.mode.minY)\n            });\n          }),\n          strict$1('getInitialValue'),\n          output('manager', TwoDModel)\n        ]\n      })),\n      field$1('sliderBehaviours', [\n        Keying,\n        Representing\n      ])\n    ].concat(!isTouch$2 ? [state$1('mouseIsDown', function () {\n        return Cell(false);\n      })] : []);\n\n    var isTouch$3 = detect$3().deviceType.isTouch();\n    var sketch = function (detail, components, _spec, _externals) {\n      var getThumb = function (component) {\n        return getPartOrDie(component, detail, 'thumb');\n      };\n      var getSpectrum = function (component) {\n        return getPartOrDie(component, detail, 'spectrum');\n      };\n      var getLeftEdge = function (component) {\n        return getPart(component, detail, 'left-edge');\n      };\n      var getRightEdge = function (component) {\n        return getPart(component, detail, 'right-edge');\n      };\n      var getTopEdge = function (component) {\n        return getPart(component, detail, 'top-edge');\n      };\n      var getBottomEdge = function (component) {\n        return getPart(component, detail, 'bottom-edge');\n      };\n      var modelDetail = detail.model;\n      var model = modelDetail.manager;\n      var refresh = function (slider, thumb) {\n        model.setPositionFromValue(slider, thumb, detail, {\n          getLeftEdge: getLeftEdge,\n          getRightEdge: getRightEdge,\n          getTopEdge: getTopEdge,\n          getBottomEdge: getBottomEdge,\n          getSpectrum: getSpectrum\n        });\n      };\n      var changeValue = function (slider, newValue) {\n        modelDetail.value.set(newValue);\n        var thumb = getThumb(slider);\n        refresh(slider, thumb);\n        detail.onChange(slider, thumb, newValue);\n        return Option.some(true);\n      };\n      var resetToMin = function (slider) {\n        model.setToMin(slider, detail);\n      };\n      var resetToMax = function (slider) {\n        model.setToMax(slider, detail);\n      };\n      var touchEvents = [\n        run(touchstart(), function (slider, _simulatedEvent) {\n          detail.onDragStart(slider, getThumb(slider));\n        }),\n        run(touchend(), function (slider, _simulatedEvent) {\n          detail.onDragEnd(slider, getThumb(slider));\n        })\n      ];\n      var mouseEvents = [\n        run(mousedown(), function (slider, simulatedEvent) {\n          simulatedEvent.stop();\n          detail.onDragStart(slider, getThumb(slider));\n          detail.mouseIsDown.set(true);\n        }),\n        run(mouseup(), function (slider, _simulatedEvent) {\n          detail.onDragEnd(slider, getThumb(slider));\n        })\n      ];\n      var uiEventsArr = isTouch$3 ? touchEvents : mouseEvents;\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: augment(detail.sliderBehaviours, flatten([\n          !isTouch$3 ? [Keying.config({\n              mode: 'special',\n              focusIn: function (slider) {\n                return getPart(slider, detail, 'spectrum').map(Keying.focusIn).map(constant(true));\n              }\n            })] : [],\n          [\n            Representing.config({\n              store: {\n                mode: 'manual',\n                getValue: function (_) {\n                  return modelDetail.value.get();\n                }\n              }\n            }),\n            Receiving.config({\n              channels: {\n                'mouse.released': {\n                  onReceive: function (slider, se) {\n                    var fireOnChoose = function () {\n                      getPart(slider, detail, 'thumb').each(function (thumb) {\n                        var value = modelDetail.value.get();\n                        detail.onChoose(slider, thumb, value);\n                      });\n                    };\n                    if (isTouch$3) {\n                      fireOnChoose();\n                    } else {\n                      var wasDown = detail.mouseIsDown.get();\n                      detail.mouseIsDown.set(false);\n                      if (wasDown) {\n                        fireOnChoose();\n                      }\n                    }\n                  }\n                }\n              }\n            })\n          ]\n        ])),\n        events: derive([\n          run(sliderChangeEvent(), function (slider, simulatedEvent) {\n            changeValue(slider, simulatedEvent.event().value());\n          }),\n          runOnAttached(function (slider, simulatedEvent) {\n            var getInitial = modelDetail.getInitialValue();\n            modelDetail.value.set(getInitial);\n            var thumb = getThumb(slider);\n            refresh(slider, thumb);\n            var spectrum = getSpectrum(slider);\n            detail.onInit(slider, thumb, spectrum, modelDetail.value.get());\n          })\n        ].concat(uiEventsArr)),\n        apis: {\n          resetToMin: resetToMin,\n          resetToMax: resetToMax,\n          changeValue: changeValue,\n          refresh: refresh\n        },\n        domModification: { styles: { position: 'relative' } }\n      };\n    };\n\n    var Slider = composite$1({\n      name: 'Slider',\n      configFields: SliderSchema,\n      partFields: SliderParts,\n      factory: sketch,\n      apis: {\n        resetToMin: function (apis, slider) {\n          apis.resetToMin(slider);\n        },\n        resetToMax: function (apis, slider) {\n          apis.resetToMax(slider);\n        },\n        refresh: function (apis, slider) {\n          apis.refresh(slider);\n        }\n      }\n    });\n\n    var button = function (realm, clazz, makeItems, editor) {\n      return Buttons.forToolbar(clazz, function () {\n        var items = makeItems();\n        realm.setContextToolbar([{\n            label: clazz + ' group',\n            items: items\n          }]);\n      }, {}, editor);\n    };\n\n    var BLACK = -1;\n    var makeSlider = function (spec$1) {\n      var getColor = function (hue) {\n        if (hue < 0) {\n          return 'black';\n        } else if (hue > 360) {\n          return 'white';\n        } else {\n          return 'hsl(' + hue + ', 100%, 50%)';\n        }\n      };\n      var onInit = function (slider, thumb, spectrum, value) {\n        var color = getColor(value.x());\n        set$3(thumb.element(), 'background-color', color);\n      };\n      var onChange = function (slider, thumb, value) {\n        var color = getColor(value.x());\n        set$3(thumb.element(), 'background-color', color);\n        spec$1.onChange(slider, thumb, color);\n      };\n      return Slider.sketch({\n        dom: dom$1('<div class=\"${prefix}-slider ${prefix}-hue-slider-container\"></div>'),\n        components: [\n          Slider.parts()['left-edge'](spec('<div class=\"${prefix}-hue-slider-black\"></div>')),\n          Slider.parts().spectrum({\n            dom: dom$1('<div class=\"${prefix}-slider-gradient-container\"></div>'),\n            components: [spec('<div class=\"${prefix}-slider-gradient\"></div>')],\n            behaviours: derive$1([Toggling.config({ toggleClass: Styles.resolve('thumb-active') })])\n          }),\n          Slider.parts()['right-edge'](spec('<div class=\"${prefix}-hue-slider-white\"></div>')),\n          Slider.parts().thumb({\n            dom: dom$1('<div class=\"${prefix}-slider-thumb\"></div>'),\n            behaviours: derive$1([Toggling.config({ toggleClass: Styles.resolve('thumb-active') })])\n          })\n        ],\n        onChange: onChange,\n        onDragStart: function (slider, thumb) {\n          Toggling.on(thumb);\n        },\n        onDragEnd: function (slider, thumb) {\n          Toggling.off(thumb);\n        },\n        onInit: onInit,\n        stepSize: 10,\n        model: {\n          mode: 'x',\n          minX: 0,\n          maxX: 360,\n          getInitialValue: function () {\n            return {\n              x: function () {\n                return spec$1.getInitialValue();\n              }\n            };\n          }\n        },\n        sliderBehaviours: derive$1([Receivers.orientation(Slider.refresh)])\n      });\n    };\n    var makeItems = function (spec) {\n      return [makeSlider(spec)];\n    };\n    var sketch$1 = function (realm, editor) {\n      var spec = {\n        onChange: function (slider, thumb, color) {\n          editor.undoManager.transact(function () {\n            editor.formatter.apply('forecolor', { value: color });\n            editor.nodeChanged();\n          });\n        },\n        getInitialValue: function () {\n          return BLACK;\n        }\n      };\n      return button(realm, 'color-levels', function () {\n        return makeItems(spec);\n      }, editor);\n    };\n    var ColorSlider = {\n      makeItems: makeItems,\n      sketch: sketch$1\n    };\n\n    var schema$7 = objOfOnly([\n      strict$1('getInitialValue'),\n      strict$1('onChange'),\n      strict$1('category'),\n      strict$1('sizes')\n    ]);\n    var sketch$2 = function (rawSpec) {\n      var spec$1 = asRawOrDie('SizeSlider', schema$7, rawSpec);\n      var isValidValue = function (valueIndex) {\n        return valueIndex >= 0 && valueIndex < spec$1.sizes.length;\n      };\n      var onChange = function (slider, thumb, valueIndex) {\n        var index = valueIndex.x();\n        if (isValidValue(index)) {\n          spec$1.onChange(index);\n        }\n      };\n      return Slider.sketch({\n        dom: {\n          tag: 'div',\n          classes: [\n            Styles.resolve('slider-' + spec$1.category + '-size-container'),\n            Styles.resolve('slider'),\n            Styles.resolve('slider-size-container')\n          ]\n        },\n        onChange: onChange,\n        onDragStart: function (slider, thumb) {\n          Toggling.on(thumb);\n        },\n        onDragEnd: function (slider, thumb) {\n          Toggling.off(thumb);\n        },\n        model: {\n          mode: 'x',\n          minX: 0,\n          maxX: spec$1.sizes.length - 1,\n          getInitialValue: function () {\n            return {\n              x: function () {\n                return spec$1.getInitialValue();\n              }\n            };\n          }\n        },\n        stepSize: 1,\n        snapToGrid: true,\n        sliderBehaviours: derive$1([Receivers.orientation(Slider.refresh)]),\n        components: [\n          Slider.parts().spectrum({\n            dom: dom$1('<div class=\"${prefix}-slider-size-container\"></div>'),\n            components: [spec('<div class=\"${prefix}-slider-size-line\"></div>')]\n          }),\n          Slider.parts().thumb({\n            dom: dom$1('<div class=\"${prefix}-slider-thumb\"></div>'),\n            behaviours: derive$1([Toggling.config({ toggleClass: Styles.resolve('thumb-active') })])\n          })\n        ]\n      });\n    };\n    var SizeSlider = { sketch: sketch$2 };\n\n    var candidates = [\n      '9px',\n      '10px',\n      '11px',\n      '12px',\n      '14px',\n      '16px',\n      '18px',\n      '20px',\n      '24px',\n      '32px',\n      '36px'\n    ];\n    var defaultSize = 'medium';\n    var defaultIndex = 2;\n    var indexToSize = function (index) {\n      return Option.from(candidates[index]);\n    };\n    var sizeToIndex = function (size) {\n      return findIndex(candidates, function (v) {\n        return v === size;\n      });\n    };\n    var getRawOrComputed = function (isRoot, rawStart) {\n      var optStart = isElement(rawStart) ? Option.some(rawStart) : parent(rawStart).filter(isElement);\n      return optStart.map(function (start) {\n        var inline = closest(start, function (elem) {\n          return getRaw(elem, 'font-size').isSome();\n        }, isRoot).bind(function (elem) {\n          return getRaw(elem, 'font-size');\n        });\n        return inline.getOrThunk(function () {\n          return get$3(start, 'font-size');\n        });\n      }).getOr('');\n    };\n    var getSize = function (editor) {\n      var node = editor.selection.getStart();\n      var elem = Element.fromDom(node);\n      var root = Element.fromDom(editor.getBody());\n      var isRoot = function (e) {\n        return eq(root, e);\n      };\n      var elemSize = getRawOrComputed(isRoot, elem);\n      return find$2(candidates, function (size) {\n        return elemSize === size;\n      }).getOr(defaultSize);\n    };\n    var applySize = function (editor, value) {\n      var currentValue = getSize(editor);\n      if (currentValue !== value) {\n        editor.execCommand('fontSize', false, value);\n      }\n    };\n    var get$7 = function (editor) {\n      var size = getSize(editor);\n      return sizeToIndex(size).getOr(defaultIndex);\n    };\n    var apply$1 = function (editor, index) {\n      indexToSize(index).each(function (size) {\n        applySize(editor, size);\n      });\n    };\n    var FontSizes = {\n      candidates: constant(candidates),\n      get: get$7,\n      apply: apply$1\n    };\n\n    var sizes = FontSizes.candidates();\n    var makeSlider$1 = function (spec) {\n      return SizeSlider.sketch({\n        onChange: spec.onChange,\n        sizes: sizes,\n        category: 'font',\n        getInitialValue: spec.getInitialValue\n      });\n    };\n    var makeItems$1 = function (spec$1) {\n      return [\n        spec('<span class=\"${prefix}-toolbar-button ${prefix}-icon-small-font ${prefix}-icon\"></span>'),\n        makeSlider$1(spec$1),\n        spec('<span class=\"${prefix}-toolbar-button ${prefix}-icon-large-font ${prefix}-icon\"></span>')\n      ];\n    };\n    var sketch$3 = function (realm, editor) {\n      var spec = {\n        onChange: function (value) {\n          FontSizes.apply(editor, value);\n        },\n        getInitialValue: function () {\n          return FontSizes.get(editor);\n        }\n      };\n      return button(realm, 'font-size', function () {\n        return makeItems$1(spec);\n      }, editor);\n    };\n\n    var record = function (spec) {\n      var uid = isSketchSpec(spec) && hasKey$1(spec, 'uid') ? spec.uid : generate$3('memento');\n      var get = function (anyInSystem) {\n        return anyInSystem.getSystem().getByUid(uid).getOrDie();\n      };\n      var getOpt = function (anyInSystem) {\n        return anyInSystem.getSystem().getByUid(uid).toOption();\n      };\n      var asSpec = function () {\n        return __assign(__assign({}, spec), { uid: uid });\n      };\n      return {\n        get: get,\n        getOpt: getOpt,\n        asSpec: asSpec\n      };\n    };\n\n    var promise = function () {\n      var Promise = function (fn) {\n        if (typeof this !== 'object') {\n          throw new TypeError('Promises must be constructed via new');\n        }\n        if (typeof fn !== 'function') {\n          throw new TypeError('not a function');\n        }\n        this._state = null;\n        this._value = null;\n        this._deferreds = [];\n        doResolve(fn, bind(resolve, this), bind(reject, this));\n      };\n      var asap = Promise.immediateFn || typeof window.setImmediate === 'function' && window.setImmediate || function (fn) {\n        domGlobals.setTimeout(fn, 1);\n      };\n      function bind(fn, thisArg) {\n        return function () {\n          return fn.apply(thisArg, arguments);\n        };\n      }\n      var isArray = Array.isArray || function (value) {\n        return Object.prototype.toString.call(value) === '[object Array]';\n      };\n      function handle(deferred) {\n        var me = this;\n        if (this._state === null) {\n          this._deferreds.push(deferred);\n          return;\n        }\n        asap(function () {\n          var cb = me._state ? deferred.onFulfilled : deferred.onRejected;\n          if (cb === null) {\n            (me._state ? deferred.resolve : deferred.reject)(me._value);\n            return;\n          }\n          var ret;\n          try {\n            ret = cb(me._value);\n          } catch (e) {\n            deferred.reject(e);\n            return;\n          }\n          deferred.resolve(ret);\n        });\n      }\n      function resolve(newValue) {\n        try {\n          if (newValue === this) {\n            throw new TypeError('A promise cannot be resolved with itself.');\n          }\n          if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n            var then = newValue.then;\n            if (typeof then === 'function') {\n              doResolve(bind(then, newValue), bind(resolve, this), bind(reject, this));\n              return;\n            }\n          }\n          this._state = true;\n          this._value = newValue;\n          finale.call(this);\n        } catch (e) {\n          reject.call(this, e);\n        }\n      }\n      function reject(newValue) {\n        this._state = false;\n        this._value = newValue;\n        finale.call(this);\n      }\n      function finale() {\n        for (var _i = 0, _a = this._deferreds; _i < _a.length; _i++) {\n          var deferred = _a[_i];\n          handle.call(this, deferred);\n        }\n        this._deferreds = [];\n      }\n      function Handler(onFulfilled, onRejected, resolve, reject) {\n        this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n        this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n        this.resolve = resolve;\n        this.reject = reject;\n      }\n      function doResolve(fn, onFulfilled, onRejected) {\n        var done = false;\n        try {\n          fn(function (value) {\n            if (done) {\n              return;\n            }\n            done = true;\n            onFulfilled(value);\n          }, function (reason) {\n            if (done) {\n              return;\n            }\n            done = true;\n            onRejected(reason);\n          });\n        } catch (ex) {\n          if (done) {\n            return;\n          }\n          done = true;\n          onRejected(ex);\n        }\n      }\n      Promise.prototype.catch = function (onRejected) {\n        return this.then(null, onRejected);\n      };\n      Promise.prototype.then = function (onFulfilled, onRejected) {\n        var me = this;\n        return new Promise(function (resolve, reject) {\n          handle.call(me, new Handler(onFulfilled, onRejected, resolve, reject));\n        });\n      };\n      Promise.all = function () {\n        var values = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          values[_i] = arguments[_i];\n        }\n        var args = Array.prototype.slice.call(values.length === 1 && isArray(values[0]) ? values[0] : values);\n        return new Promise(function (resolve, reject) {\n          if (args.length === 0) {\n            return resolve([]);\n          }\n          var remaining = args.length;\n          function res(i, val) {\n            try {\n              if (val && (typeof val === 'object' || typeof val === 'function')) {\n                var then = val.then;\n                if (typeof then === 'function') {\n                  then.call(val, function (val) {\n                    res(i, val);\n                  }, reject);\n                  return;\n                }\n              }\n              args[i] = val;\n              if (--remaining === 0) {\n                resolve(args);\n              }\n            } catch (ex) {\n              reject(ex);\n            }\n          }\n          for (var i = 0; i < args.length; i++) {\n            res(i, args[i]);\n          }\n        });\n      };\n      Promise.resolve = function (value) {\n        if (value && typeof value === 'object' && value.constructor === Promise) {\n          return value;\n        }\n        return new Promise(function (resolve) {\n          resolve(value);\n        });\n      };\n      Promise.reject = function (reason) {\n        return new Promise(function (resolve, reject) {\n          reject(reason);\n        });\n      };\n      Promise.race = function (values) {\n        return new Promise(function (resolve, reject) {\n          for (var _i = 0, values_1 = values; _i < values_1.length; _i++) {\n            var value = values_1[_i];\n            value.then(resolve, reject);\n          }\n        });\n      };\n      return Promise;\n    };\n    var Promise = window.Promise ? window.Promise : promise();\n\n    function blobToDataUri(blob) {\n      return new Promise(function (resolve) {\n        var reader = new domGlobals.FileReader();\n        reader.onloadend = function () {\n          resolve(reader.result);\n        };\n        reader.readAsDataURL(blob);\n      });\n    }\n    function blobToBase64(blob) {\n      return blobToDataUri(blob).then(function (dataUri) {\n        return dataUri.split(',')[1];\n      });\n    }\n\n    var blobToBase64$1 = function (blob) {\n      return blobToBase64(blob);\n    };\n\n    var addImage = function (editor, blob) {\n      blobToBase64$1(blob).then(function (base64) {\n        editor.undoManager.transact(function () {\n          var cache = editor.editorUpload.blobCache;\n          var info = cache.create(generate$1('mceu'), blob, base64);\n          cache.add(info);\n          var img = editor.dom.createHTML('img', { src: info.blobUri() });\n          editor.insertContent(img);\n        });\n      });\n    };\n    var extractBlob = function (simulatedEvent) {\n      var event = simulatedEvent.event();\n      var files = event.raw().target.files || event.raw().dataTransfer.files;\n      return Option.from(files[0]);\n    };\n    var sketch$4 = function (editor) {\n      var pickerDom = {\n        tag: 'input',\n        attributes: {\n          accept: 'image/*',\n          type: 'file',\n          title: ''\n        },\n        styles: {\n          visibility: 'hidden',\n          position: 'absolute'\n        }\n      };\n      var memPicker = record({\n        dom: pickerDom,\n        events: derive([\n          cutter(click()),\n          run(change(), function (picker, simulatedEvent) {\n            extractBlob(simulatedEvent).each(function (blob) {\n              addImage(editor, blob);\n            });\n          })\n        ])\n      });\n      return Button.sketch({\n        dom: Buttons.getToolbarIconButton('image', editor),\n        components: [memPicker.asSpec()],\n        action: function (button) {\n          var picker = memPicker.get(button);\n          picker.element().dom().click();\n        }\n      });\n    };\n\n    var get$8 = function (element) {\n      return element.dom().textContent;\n    };\n    var set$5 = function (element, value) {\n      element.dom().textContent = value;\n    };\n\n    var isNotEmpty = function (val) {\n      return val.length > 0;\n    };\n    var defaultToEmpty = function (str) {\n      return str === undefined || str === null ? '' : str;\n    };\n    var noLink = function (editor) {\n      var text = editor.selection.getContent({ format: 'text' });\n      return {\n        url: '',\n        text: text,\n        title: '',\n        target: '',\n        link: Option.none()\n      };\n    };\n    var fromLink = function (link) {\n      var text = get$8(link);\n      var url = get(link, 'href');\n      var title = get(link, 'title');\n      var target = get(link, 'target');\n      return {\n        url: defaultToEmpty(url),\n        text: text !== url ? defaultToEmpty(text) : '',\n        title: defaultToEmpty(title),\n        target: defaultToEmpty(target),\n        link: Option.some(link)\n      };\n    };\n    var getInfo = function (editor) {\n      return query(editor).fold(function () {\n        return noLink(editor);\n      }, function (link) {\n        return fromLink(link);\n      });\n    };\n    var wasSimple = function (link) {\n      var prevHref = get(link, 'href');\n      var prevText = get$8(link);\n      return prevHref === prevText;\n    };\n    var getTextToApply = function (link, url, info) {\n      return info.text.toOption().filter(isNotEmpty).fold(function () {\n        return wasSimple(link) ? Option.some(url) : Option.none();\n      }, Option.some);\n    };\n    var unlinkIfRequired = function (editor, info) {\n      var activeLink = info.link.bind(identity);\n      activeLink.each(function (link) {\n        editor.execCommand('unlink');\n      });\n    };\n    var getAttrs$1 = function (url, info) {\n      var attrs = {};\n      attrs.href = url;\n      info.title.toOption().filter(isNotEmpty).each(function (title) {\n        attrs.title = title;\n      });\n      info.target.toOption().filter(isNotEmpty).each(function (target) {\n        attrs.target = target;\n      });\n      return attrs;\n    };\n    var applyInfo = function (editor, info) {\n      info.url.toOption().filter(isNotEmpty).fold(function () {\n        unlinkIfRequired(editor, info);\n      }, function (url) {\n        var attrs = getAttrs$1(url, info);\n        var activeLink = info.link.bind(identity);\n        activeLink.fold(function () {\n          var text = info.text.toOption().filter(isNotEmpty).getOr(url);\n          editor.insertContent(editor.dom.createHTML('a', attrs, editor.dom.encode(text)));\n        }, function (link) {\n          var text = getTextToApply(link, url, info);\n          setAll(link, attrs);\n          text.each(function (newText) {\n            set$5(link, newText);\n          });\n        });\n      });\n    };\n    var query = function (editor) {\n      var start = Element.fromDom(editor.selection.getStart());\n      return closest$2(start, 'a');\n    };\n    var LinkBridge = {\n      getInfo: getInfo,\n      applyInfo: applyInfo,\n      query: query\n    };\n\n    var platform$2 = detect$3();\n    var preserve = function (f, editor) {\n      var rng = editor.selection.getRng();\n      f();\n      editor.selection.setRng(rng);\n    };\n    var forAndroid = function (editor, f) {\n      var wrapper = platform$2.os.isAndroid() ? preserve : apply;\n      wrapper(f, editor);\n    };\n    var RangePreserver = { forAndroid: forAndroid };\n\n    var events$6 = function (name, eventHandlers) {\n      var events = derive(eventHandlers);\n      return create$1({\n        fields: [strict$1('enabled')],\n        name: name,\n        active: { events: constant(events) }\n      });\n    };\n    var config = function (name, eventHandlers) {\n      var me = events$6(name, eventHandlers);\n      return {\n        key: name,\n        value: {\n          config: {},\n          me: me,\n          configAsRaw: constant({}),\n          initialConfig: {},\n          state: NoState\n        }\n      };\n    };\n\n    var getCurrent = function (component, composeConfig, composeState) {\n      return composeConfig.find(component);\n    };\n\n    var ComposeApis = /*#__PURE__*/Object.freeze({\n        getCurrent: getCurrent\n    });\n\n    var ComposeSchema = [strict$1('find')];\n\n    var Composing = create$1({\n      fields: ComposeSchema,\n      name: 'composing',\n      apis: ComposeApis\n    });\n\n    var factory$1 = function (detail) {\n      var _a = detail.dom, attributes = _a.attributes, domWithoutAttributes = __rest(_a, ['attributes']);\n      return {\n        uid: detail.uid,\n        dom: __assign({\n          tag: 'div',\n          attributes: __assign({ role: 'presentation' }, attributes)\n        }, domWithoutAttributes),\n        components: detail.components,\n        behaviours: get$5(detail.containerBehaviours),\n        events: detail.events,\n        domModification: detail.domModification,\n        eventOrder: detail.eventOrder\n      };\n    };\n    var Container = single$2({\n      name: 'Container',\n      factory: factory$1,\n      configFields: [\n        defaulted$1('components', []),\n        field$1('containerBehaviours', []),\n        defaulted$1('events', {}),\n        defaulted$1('domModification', {}),\n        defaulted$1('eventOrder', {})\n      ]\n    });\n\n    var factory$2 = function (detail) {\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        behaviours: SketchBehaviours.augment(detail.dataBehaviours, [\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: detail.getInitialValue()\n            }\n          }),\n          Composing.config({ find: Option.some })\n        ]),\n        events: derive([runOnAttached(function (component, simulatedEvent) {\n            Representing.setValue(component, detail.getInitialValue());\n          })])\n      };\n    };\n    var DataField = single$2({\n      name: 'DataField',\n      factory: factory$2,\n      configFields: [\n        strict$1('uid'),\n        strict$1('dom'),\n        strict$1('getInitialValue'),\n        SketchBehaviours.field('dataBehaviours', [\n          Representing,\n          Composing\n        ])\n      ]\n    });\n\n    var get$9 = function (element) {\n      return element.dom().value;\n    };\n    var set$6 = function (element, value) {\n      if (value === undefined) {\n        throw new Error('Value.set was undefined');\n      }\n      element.dom().value = value;\n    };\n\n    var schema$8 = constant([\n      option('data'),\n      defaulted$1('inputAttributes', {}),\n      defaulted$1('inputStyles', {}),\n      defaulted$1('tag', 'input'),\n      defaulted$1('inputClasses', []),\n      onHandler('onSetValue'),\n      defaulted$1('styles', {}),\n      defaulted$1('eventOrder', {}),\n      field$1('inputBehaviours', [\n        Representing,\n        Focusing\n      ]),\n      defaulted$1('selectOnFocus', true)\n    ]);\n    var focusBehaviours = function (detail) {\n      return derive$1([Focusing.config({\n          onFocus: detail.selectOnFocus === false ? noop : function (component) {\n            var input = component.element();\n            var value = get$9(input);\n            input.dom().setSelectionRange(0, value.length);\n          }\n        })]);\n    };\n    var behaviours = function (detail) {\n      return __assign(__assign({}, focusBehaviours(detail)), augment(detail.inputBehaviours, [Representing.config({\n          store: {\n            mode: 'manual',\n            initialValue: detail.data.getOr(undefined),\n            getValue: function (input) {\n              return get$9(input.element());\n            },\n            setValue: function (input, data) {\n              var current = get$9(input.element());\n              if (current !== data) {\n                set$6(input.element(), data);\n              }\n            }\n          },\n          onSetValue: detail.onSetValue\n        })]));\n    };\n    var dom$2 = function (detail) {\n      return {\n        tag: detail.tag,\n        attributes: __assign({ type: 'text' }, detail.inputAttributes),\n        styles: detail.inputStyles,\n        classes: detail.inputClasses\n      };\n    };\n\n    var factory$3 = function (detail, spec) {\n      return {\n        uid: detail.uid,\n        dom: dom$2(detail),\n        components: [],\n        behaviours: behaviours(detail),\n        eventOrder: detail.eventOrder\n      };\n    };\n    var Input = single$2({\n      name: 'Input',\n      configFields: schema$8(),\n      factory: factory$3\n    });\n\n    var exhibit$3 = function (base, tabConfig) {\n      return nu$5({\n        attributes: wrapAll$1([{\n            key: tabConfig.tabAttr,\n            value: 'true'\n          }])\n      });\n    };\n\n    var ActiveTabstopping = /*#__PURE__*/Object.freeze({\n        exhibit: exhibit$3\n    });\n\n    var TabstopSchema = [defaulted$1('tabAttr', 'data-alloy-tabstop')];\n\n    var Tabstopping = create$1({\n      fields: TabstopSchema,\n      name: 'tabstopping',\n      active: ActiveTabstopping\n    });\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.util.I18n');\n\n    var clearInputBehaviour = 'input-clearing';\n    var field$2 = function (name, placeholder) {\n      var inputSpec = record(Input.sketch({\n        inputAttributes: { placeholder: global$3.translate(placeholder) },\n        onSetValue: function (input$1, data) {\n          emit(input$1, input());\n        },\n        inputBehaviours: derive$1([\n          Composing.config({ find: Option.some }),\n          Tabstopping.config({}),\n          Keying.config({ mode: 'execution' })\n        ]),\n        selectOnFocus: false\n      }));\n      var buttonSpec = record(Button.sketch({\n        dom: dom$1('<button class=\"${prefix}-input-container-x ${prefix}-icon-cancel-circle ${prefix}-icon\"></button>'),\n        action: function (button) {\n          var input = inputSpec.get(button);\n          Representing.setValue(input, '');\n        }\n      }));\n      return {\n        name: name,\n        spec: Container.sketch({\n          dom: dom$1('<div class=\"${prefix}-input-container\"></div>'),\n          components: [\n            inputSpec.asSpec(),\n            buttonSpec.asSpec()\n          ],\n          containerBehaviours: derive$1([\n            Toggling.config({ toggleClass: Styles.resolve('input-container-empty') }),\n            Composing.config({\n              find: function (comp) {\n                return Option.some(inputSpec.get(comp));\n              }\n            }),\n            config(clearInputBehaviour, [run(input(), function (iContainer) {\n                var input = inputSpec.get(iContainer);\n                var val = Representing.getValue(input);\n                var f = val.length > 0 ? Toggling.off : Toggling.on;\n                f(iContainer);\n              })])\n          ])\n        })\n      };\n    };\n    var hidden = function (name) {\n      return {\n        name: name,\n        spec: DataField.sketch({\n          dom: {\n            tag: 'span',\n            styles: { display: 'none' }\n          },\n          getInitialValue: function () {\n            return Option.none();\n          }\n        })\n      };\n    };\n\n    var nativeDisabled = [\n      'input',\n      'button',\n      'textarea',\n      'select'\n    ];\n    var onLoad$5 = function (component, disableConfig, disableState) {\n      if (disableConfig.disabled) {\n        disable(component, disableConfig);\n      }\n    };\n    var hasNative = function (component, config) {\n      return config.useNative === true && contains(nativeDisabled, name(component.element()));\n    };\n    var nativeIsDisabled = function (component) {\n      return has$1(component.element(), 'disabled');\n    };\n    var nativeDisable = function (component) {\n      set(component.element(), 'disabled', 'disabled');\n    };\n    var nativeEnable = function (component) {\n      remove$1(component.element(), 'disabled');\n    };\n    var ariaIsDisabled = function (component) {\n      return get(component.element(), 'aria-disabled') === 'true';\n    };\n    var ariaDisable = function (component) {\n      set(component.element(), 'aria-disabled', 'true');\n    };\n    var ariaEnable = function (component) {\n      set(component.element(), 'aria-disabled', 'false');\n    };\n    var disable = function (component, disableConfig, disableState) {\n      disableConfig.disableClass.each(function (disableClass) {\n        add$2(component.element(), disableClass);\n      });\n      var f = hasNative(component, disableConfig) ? nativeDisable : ariaDisable;\n      f(component);\n      disableConfig.onDisabled(component);\n    };\n    var enable = function (component, disableConfig, disableState) {\n      disableConfig.disableClass.each(function (disableClass) {\n        remove$4(component.element(), disableClass);\n      });\n      var f = hasNative(component, disableConfig) ? nativeEnable : ariaEnable;\n      f(component);\n      disableConfig.onEnabled(component);\n    };\n    var isDisabled = function (component, disableConfig) {\n      return hasNative(component, disableConfig) ? nativeIsDisabled(component) : ariaIsDisabled(component);\n    };\n    var set$7 = function (component, disableConfig, disableState, disabled) {\n      var f = disabled ? disable : enable;\n      f(component, disableConfig, disableState);\n    };\n\n    var DisableApis = /*#__PURE__*/Object.freeze({\n        enable: enable,\n        disable: disable,\n        isDisabled: isDisabled,\n        onLoad: onLoad$5,\n        set: set$7\n    });\n\n    var exhibit$4 = function (base, disableConfig, disableState) {\n      return nu$5({ classes: disableConfig.disabled ? disableConfig.disableClass.map(pure).getOr([]) : [] });\n    };\n    var events$7 = function (disableConfig, disableState) {\n      return derive([\n        abort(execute(), function (component, simulatedEvent) {\n          return isDisabled(component, disableConfig);\n        }),\n        loadEvent(disableConfig, disableState, onLoad$5)\n      ]);\n    };\n\n    var ActiveDisable = /*#__PURE__*/Object.freeze({\n        exhibit: exhibit$4,\n        events: events$7\n    });\n\n    var DisableSchema = [\n      defaulted$1('disabled', false),\n      defaulted$1('useNative', true),\n      option('disableClass'),\n      onHandler('onDisabled'),\n      onHandler('onEnabled')\n    ];\n\n    var Disabling = create$1({\n      fields: DisableSchema,\n      name: 'disabling',\n      active: ActiveDisable,\n      apis: DisableApis\n    });\n\n    var owner$1 = 'form';\n    var schema$9 = [field$1('formBehaviours', [Representing])];\n    var getPartName = function (name) {\n      return '<alloy.field.' + name + '>';\n    };\n    var sketch$5 = function (fSpec) {\n      var parts = function () {\n        var record = [];\n        var field = function (name, config) {\n          record.push(name);\n          return generateOne(owner$1, getPartName(name), config);\n        };\n        return {\n          field: field,\n          record: function () {\n            return record;\n          }\n        };\n      }();\n      var spec = fSpec(parts);\n      var partNames = parts.record();\n      var fieldParts = map$1(partNames, function (n) {\n        return required({\n          name: n,\n          pname: getPartName(n)\n        });\n      });\n      return composite(owner$1, schema$9, fieldParts, make, spec);\n    };\n    var toResult$1 = function (o, e) {\n      return o.fold(function () {\n        return Result.error(e);\n      }, Result.value);\n    };\n    var make = function (detail, components, spec) {\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: augment(detail.formBehaviours, [Representing.config({\n            store: {\n              mode: 'manual',\n              getValue: function (form) {\n                var resPs = getAllParts(form, detail);\n                return map(resPs, function (resPThunk, pName) {\n                  return resPThunk().bind(function (v) {\n                    var opt = Composing.getCurrent(v);\n                    return toResult$1(opt, 'missing current');\n                  }).map(Representing.getValue);\n                });\n              },\n              setValue: function (form, values) {\n                each(values, function (newValue, key) {\n                  getPart(form, detail, key).each(function (wrapper) {\n                    Composing.getCurrent(wrapper).each(function (field) {\n                      Representing.setValue(field, newValue);\n                    });\n                  });\n                });\n              }\n            }\n          })]),\n        apis: {\n          getField: function (form, key) {\n            return getPart(form, detail, key).bind(Composing.getCurrent);\n          }\n        }\n      };\n    };\n    var Form = {\n      getField: makeApi(function (apis, component, key) {\n        return apis.getField(component, key);\n      }),\n      sketch: sketch$5\n    };\n\n    var api$2 = function () {\n      var subject = Cell(Option.none());\n      var revoke = function () {\n        subject.get().each(function (s) {\n          s.destroy();\n        });\n      };\n      var clear = function () {\n        revoke();\n        subject.set(Option.none());\n      };\n      var set = function (s) {\n        revoke();\n        subject.set(Option.some(s));\n      };\n      var run = function (f) {\n        subject.get().each(f);\n      };\n      var isSet = function () {\n        return subject.get().isSome();\n      };\n      return {\n        clear: clear,\n        isSet: isSet,\n        set: set,\n        run: run\n      };\n    };\n    var value$2 = function () {\n      var subject = Cell(Option.none());\n      var clear = function () {\n        subject.set(Option.none());\n      };\n      var set = function (s) {\n        subject.set(Option.some(s));\n      };\n      var on = function (f) {\n        subject.get().each(f);\n      };\n      var isSet = function () {\n        return subject.get().isSome();\n      };\n      return {\n        clear: clear,\n        set: set,\n        isSet: isSet,\n        on: on\n      };\n    };\n\n    var SWIPING_LEFT = 1;\n    var SWIPING_RIGHT = -1;\n    var SWIPING_NONE = 0;\n    var init$2 = function (xValue) {\n      return {\n        xValue: xValue,\n        points: []\n      };\n    };\n    var move$1 = function (model, xValue) {\n      if (xValue === model.xValue) {\n        return model;\n      }\n      var currentDirection = xValue - model.xValue > 0 ? SWIPING_LEFT : SWIPING_RIGHT;\n      var newPoint = {\n        direction: currentDirection,\n        xValue: xValue\n      };\n      var priorPoints = function () {\n        if (model.points.length === 0) {\n          return [];\n        } else {\n          var prev = model.points[model.points.length - 1];\n          return prev.direction === currentDirection ? model.points.slice(0, model.points.length - 1) : model.points;\n        }\n      }();\n      return {\n        xValue: xValue,\n        points: priorPoints.concat([newPoint])\n      };\n    };\n    var complete = function (model) {\n      if (model.points.length === 0) {\n        return SWIPING_NONE;\n      } else {\n        var firstDirection = model.points[0].direction;\n        var lastDirection = model.points[model.points.length - 1].direction;\n        return firstDirection === SWIPING_RIGHT && lastDirection === SWIPING_RIGHT ? SWIPING_RIGHT : firstDirection === SWIPING_LEFT && lastDirection === SWIPING_LEFT ? SWIPING_LEFT : SWIPING_NONE;\n      }\n    };\n    var SwipingModel = {\n      init: init$2,\n      move: move$1,\n      complete: complete\n    };\n\n    var sketch$6 = function (rawSpec) {\n      var navigateEvent = 'navigateEvent';\n      var wrapperAdhocEvents = 'serializer-wrapper-events';\n      var formAdhocEvents = 'form-events';\n      var schema = objOf([\n        strict$1('fields'),\n        defaulted$1('maxFieldIndex', rawSpec.fields.length - 1),\n        strict$1('onExecute'),\n        strict$1('getInitialValue'),\n        state$1('state', function () {\n          return {\n            dialogSwipeState: value$2(),\n            currentScreen: Cell(0)\n          };\n        })\n      ]);\n      var spec$1 = asRawOrDie('SerialisedDialog', schema, rawSpec);\n      var navigationButton = function (direction, directionName, enabled) {\n        return Button.sketch({\n          dom: dom$1('<span class=\"${prefix}-icon-' + directionName + ' ${prefix}-icon\"></span>'),\n          action: function (button) {\n            emitWith(button, navigateEvent, { direction: direction });\n          },\n          buttonBehaviours: derive$1([Disabling.config({\n              disableClass: Styles.resolve('toolbar-navigation-disabled'),\n              disabled: !enabled\n            })])\n        });\n      };\n      var reposition = function (dialog, message) {\n        descendant$1(dialog.element(), '.' + Styles.resolve('serialised-dialog-chain')).each(function (parent) {\n          set$3(parent, 'left', -spec$1.state.currentScreen.get() * message.width + 'px');\n        });\n      };\n      var navigate = function (dialog, direction) {\n        var screens = descendants(dialog.element(), '.' + Styles.resolve('serialised-dialog-screen'));\n        descendant$1(dialog.element(), '.' + Styles.resolve('serialised-dialog-chain')).each(function (parent) {\n          if (spec$1.state.currentScreen.get() + direction >= 0 && spec$1.state.currentScreen.get() + direction < screens.length) {\n            getRaw(parent, 'left').each(function (left) {\n              var currentLeft = parseInt(left, 10);\n              var w = get$6(screens[0]);\n              set$3(parent, 'left', currentLeft - direction * w + 'px');\n            });\n            spec$1.state.currentScreen.set(spec$1.state.currentScreen.get() + direction);\n          }\n        });\n      };\n      var focusInput = function (dialog) {\n        var inputs = descendants(dialog.element(), 'input');\n        var optInput = Option.from(inputs[spec$1.state.currentScreen.get()]);\n        optInput.each(function (input) {\n          dialog.getSystem().getByDom(input).each(function (inputComp) {\n            dispatchFocus(dialog, inputComp.element());\n          });\n        });\n        var dotitems = memDots.get(dialog);\n        Highlighting.highlightAt(dotitems, spec$1.state.currentScreen.get());\n      };\n      var resetState = function () {\n        spec$1.state.currentScreen.set(0);\n        spec$1.state.dialogSwipeState.clear();\n      };\n      var memForm = record(Form.sketch(function (parts) {\n        return {\n          dom: dom$1('<div class=\"${prefix}-serialised-dialog\"></div>'),\n          components: [Container.sketch({\n              dom: dom$1('<div class=\"${prefix}-serialised-dialog-chain\" style=\"left: 0px; position: absolute;\"></div>'),\n              components: map$1(spec$1.fields, function (field, i) {\n                return i <= spec$1.maxFieldIndex ? Container.sketch({\n                  dom: dom$1('<div class=\"${prefix}-serialised-dialog-screen\"></div>'),\n                  components: [\n                    navigationButton(-1, 'previous', i > 0),\n                    parts.field(field.name, field.spec),\n                    navigationButton(+1, 'next', i < spec$1.maxFieldIndex)\n                  ]\n                }) : parts.field(field.name, field.spec);\n              })\n            })],\n          formBehaviours: derive$1([\n            Receivers.orientation(function (dialog, message) {\n              reposition(dialog, message);\n            }),\n            Keying.config({\n              mode: 'special',\n              focusIn: function (dialog) {\n                focusInput(dialog);\n              },\n              onTab: function (dialog) {\n                navigate(dialog, +1);\n                return Option.some(true);\n              },\n              onShiftTab: function (dialog) {\n                navigate(dialog, -1);\n                return Option.some(true);\n              }\n            }),\n            config(formAdhocEvents, [\n              runOnAttached(function (dialog, simulatedEvent) {\n                resetState();\n                var dotitems = memDots.get(dialog);\n                Highlighting.highlightFirst(dotitems);\n                spec$1.getInitialValue(dialog).each(function (v) {\n                  Representing.setValue(dialog, v);\n                });\n              }),\n              runOnExecute(spec$1.onExecute),\n              run(transitionend(), function (dialog, simulatedEvent) {\n                var event = simulatedEvent.event();\n                if (event.raw().propertyName === 'left') {\n                  focusInput(dialog);\n                }\n              }),\n              run(navigateEvent, function (dialog, simulatedEvent) {\n                var event = simulatedEvent.event();\n                var direction = event.direction();\n                navigate(dialog, direction);\n              })\n            ])\n          ])\n        };\n      }));\n      var memDots = record({\n        dom: dom$1('<div class=\"${prefix}-dot-container\"></div>'),\n        behaviours: derive$1([Highlighting.config({\n            highlightClass: Styles.resolve('dot-active'),\n            itemClass: Styles.resolve('dot-item')\n          })]),\n        components: bind(spec$1.fields, function (_f, i) {\n          return i <= spec$1.maxFieldIndex ? [spec('<div class=\"${prefix}-dot-item ${prefix}-icon-full-dot ${prefix}-icon\"></div>')] : [];\n        })\n      });\n      return {\n        dom: dom$1('<div class=\"${prefix}-serializer-wrapper\"></div>'),\n        components: [\n          memForm.asSpec(),\n          memDots.asSpec()\n        ],\n        behaviours: derive$1([\n          Keying.config({\n            mode: 'special',\n            focusIn: function (wrapper) {\n              var form = memForm.get(wrapper);\n              Keying.focusIn(form);\n            }\n          }),\n          config(wrapperAdhocEvents, [\n            run(touchstart(), function (wrapper, simulatedEvent) {\n              var event = simulatedEvent.event();\n              spec$1.state.dialogSwipeState.set(SwipingModel.init(event.raw().touches[0].clientX));\n            }),\n            run(touchmove(), function (wrapper, simulatedEvent) {\n              var event = simulatedEvent.event();\n              spec$1.state.dialogSwipeState.on(function (state) {\n                simulatedEvent.event().prevent();\n                spec$1.state.dialogSwipeState.set(SwipingModel.move(state, event.raw().touches[0].clientX));\n              });\n            }),\n            run(touchend(), function (wrapper) {\n              spec$1.state.dialogSwipeState.on(function (state) {\n                var dialog = memForm.get(wrapper);\n                var direction = -1 * SwipingModel.complete(state);\n                navigate(dialog, direction);\n              });\n            })\n          ])\n        ])\n      };\n    };\n\n    var getGroups = cached(function (realm, editor) {\n      return [{\n          label: 'the link group',\n          items: [sketch$6({\n              fields: [\n                field$2('url', 'Type or paste URL'),\n                field$2('text', 'Link text'),\n                field$2('title', 'Link title'),\n                field$2('target', 'Link target'),\n                hidden('link')\n              ],\n              maxFieldIndex: [\n                'url',\n                'text',\n                'title',\n                'target'\n              ].length - 1,\n              getInitialValue: function () {\n                return Option.some(LinkBridge.getInfo(editor));\n              },\n              onExecute: function (dialog) {\n                var info = Representing.getValue(dialog);\n                LinkBridge.applyInfo(editor, info);\n                realm.restoreToolbar();\n                editor.focus();\n              }\n            })]\n        }];\n    });\n    var sketch$7 = function (realm, editor) {\n      return Buttons.forToolbarStateAction(editor, 'link', 'link', function () {\n        var groups = getGroups(realm, editor);\n        realm.setContextToolbar(groups);\n        RangePreserver.forAndroid(editor, function () {\n          realm.focusToolbar();\n        });\n        LinkBridge.query(editor).each(function (link) {\n          editor.selection.select(link.dom());\n        });\n      });\n    };\n\n    var DefaultStyleFormats = [\n      {\n        title: 'Headings',\n        items: [\n          {\n            title: 'Heading 1',\n            format: 'h1'\n          },\n          {\n            title: 'Heading 2',\n            format: 'h2'\n          },\n          {\n            title: 'Heading 3',\n            format: 'h3'\n          },\n          {\n            title: 'Heading 4',\n            format: 'h4'\n          },\n          {\n            title: 'Heading 5',\n            format: 'h5'\n          },\n          {\n            title: 'Heading 6',\n            format: 'h6'\n          }\n        ]\n      },\n      {\n        title: 'Inline',\n        items: [\n          {\n            title: 'Bold',\n            icon: 'bold',\n            format: 'bold'\n          },\n          {\n            title: 'Italic',\n            icon: 'italic',\n            format: 'italic'\n          },\n          {\n            title: 'Underline',\n            icon: 'underline',\n            format: 'underline'\n          },\n          {\n            title: 'Strikethrough',\n            icon: 'strikethrough',\n            format: 'strikethrough'\n          },\n          {\n            title: 'Superscript',\n            icon: 'superscript',\n            format: 'superscript'\n          },\n          {\n            title: 'Subscript',\n            icon: 'subscript',\n            format: 'subscript'\n          },\n          {\n            title: 'Code',\n            icon: 'code',\n            format: 'code'\n          }\n        ]\n      },\n      {\n        title: 'Blocks',\n        items: [\n          {\n            title: 'Paragraph',\n            format: 'p'\n          },\n          {\n            title: 'Blockquote',\n            format: 'blockquote'\n          },\n          {\n            title: 'Div',\n            format: 'div'\n          },\n          {\n            title: 'Pre',\n            format: 'pre'\n          }\n        ]\n      },\n      {\n        title: 'Alignment',\n        items: [\n          {\n            title: 'Left',\n            icon: 'alignleft',\n            format: 'alignleft'\n          },\n          {\n            title: 'Center',\n            icon: 'aligncenter',\n            format: 'aligncenter'\n          },\n          {\n            title: 'Right',\n            icon: 'alignright',\n            format: 'alignright'\n          },\n          {\n            title: 'Justify',\n            icon: 'alignjustify',\n            format: 'alignjustify'\n          }\n        ]\n      }\n    ];\n\n    var isRecursive = function (component, originator, target) {\n      return eq(originator, component.element()) && !eq(originator, target);\n    };\n    var events$8 = derive([can(focus(), function (component, simulatedEvent) {\n        var originator = simulatedEvent.event().originator();\n        var target = simulatedEvent.event().target();\n        if (isRecursive(component, originator, target)) {\n          domGlobals.console.warn(focus() + ' did not get interpreted by the desired target. ' + '\\nOriginator: ' + element(originator) + '\\nTarget: ' + element(target) + '\\nCheck the ' + focus() + ' event handlers');\n          return false;\n        } else {\n          return true;\n        }\n      })]);\n\n    var DefaultEvents = /*#__PURE__*/Object.freeze({\n        events: events$8\n    });\n\n    var make$1 = identity;\n\n    var NoContextApi = function (getComp) {\n      var fail = function (event) {\n        return function () {\n          throw new Error('The component must be in a context to send: ' + event + '\\n' + element(getComp().element()) + ' is not in context.');\n        };\n      };\n      return {\n        debugInfo: constant('fake'),\n        triggerEvent: fail('triggerEvent'),\n        triggerFocus: fail('triggerFocus'),\n        triggerEscape: fail('triggerEscape'),\n        build: fail('build'),\n        addToWorld: fail('addToWorld'),\n        removeFromWorld: fail('removeFromWorld'),\n        addToGui: fail('addToGui'),\n        removeFromGui: fail('removeFromGui'),\n        getByUid: fail('getByUid'),\n        getByDom: fail('getByDom'),\n        broadcast: fail('broadcast'),\n        broadcastOn: fail('broadcastOn'),\n        broadcastEvent: fail('broadcastEvent'),\n        isConnected: constant(false)\n      };\n    };\n    var singleton = NoContextApi();\n\n    var generateFrom = function (spec, all) {\n      var schema = map$1(all, function (a) {\n        return optionObjOf(a.name(), [\n          strict$1('config'),\n          defaulted$1('state', NoState)\n        ]);\n      });\n      var validated = asRaw('component.behaviours', objOf(schema), spec.behaviours).fold(function (errInfo) {\n        throw new Error(formatError(errInfo) + '\\nComplete spec:\\n' + JSON.stringify(spec, null, 2));\n      }, function (v) {\n        return v;\n      });\n      return {\n        list: all,\n        data: map(validated, function (optBlobThunk) {\n          var optBlob = optBlobThunk;\n          var output = optBlob.map(function (blob) {\n            return {\n              config: blob.config,\n              state: blob.state.init(blob.config)\n            };\n          });\n          return function () {\n            return output;\n          };\n        })\n      };\n    };\n    var getBehaviours = function (bData) {\n      return bData.list;\n    };\n    var getData = function (bData) {\n      return bData.data;\n    };\n\n    var byInnerKey = function (data, tuple) {\n      var r = {};\n      each(data, function (detail, key) {\n        each(detail, function (value, indexKey) {\n          var chain = readOr$1(indexKey, [])(r);\n          r[indexKey] = chain.concat([tuple(key, value)]);\n        });\n      });\n      return r;\n    };\n\n    var combine$1 = function (info, baseMod, behaviours, base) {\n      var modsByBehaviour = __assign({}, baseMod);\n      each$1(behaviours, function (behaviour) {\n        modsByBehaviour[behaviour.name()] = behaviour.exhibit(info, base);\n      });\n      var nameAndMod = function (name, modification) {\n        return {\n          name: name,\n          modification: modification\n        };\n      };\n      var byAspect = byInnerKey(modsByBehaviour, nameAndMod);\n      var combineObjects = function (objects) {\n        return foldr(objects, function (b, a) {\n          return __assign(__assign({}, a.modification), b);\n        }, {});\n      };\n      var combinedClasses = foldr(byAspect.classes, function (b, a) {\n        return a.modification.concat(b);\n      }, []);\n      var combinedAttributes = combineObjects(byAspect.attributes);\n      var combinedStyles = combineObjects(byAspect.styles);\n      return nu$5({\n        classes: combinedClasses,\n        attributes: combinedAttributes,\n        styles: combinedStyles\n      });\n    };\n\n    var sortKeys = function (label, keyName, array, order) {\n      var sliced = array.slice(0);\n      try {\n        var sorted = sliced.sort(function (a, b) {\n          var aKey = a[keyName]();\n          var bKey = b[keyName]();\n          var aIndex = order.indexOf(aKey);\n          var bIndex = order.indexOf(bKey);\n          if (aIndex === -1) {\n            throw new Error('The ordering for ' + label + ' does not have an entry for ' + aKey + '.\\nOrder specified: ' + JSON.stringify(order, null, 2));\n          }\n          if (bIndex === -1) {\n            throw new Error('The ordering for ' + label + ' does not have an entry for ' + bKey + '.\\nOrder specified: ' + JSON.stringify(order, null, 2));\n          }\n          if (aIndex < bIndex) {\n            return -1;\n          } else if (bIndex < aIndex) {\n            return 1;\n          } else {\n            return 0;\n          }\n        });\n        return Result.value(sorted);\n      } catch (err) {\n        return Result.error([err]);\n      }\n    };\n\n    var uncurried = function (handler, purpose) {\n      return {\n        handler: handler,\n        purpose: constant(purpose)\n      };\n    };\n    var curried = function (handler, purpose) {\n      return {\n        cHandler: handler,\n        purpose: constant(purpose)\n      };\n    };\n    var curryArgs = function (descHandler, extraArgs) {\n      return curried(curry.apply(undefined, [descHandler.handler].concat(extraArgs)), descHandler.purpose());\n    };\n    var getCurried = function (descHandler) {\n      return descHandler.cHandler;\n    };\n\n    var behaviourTuple = function (name, handler) {\n      return {\n        name: constant(name),\n        handler: constant(handler)\n      };\n    };\n    var nameToHandlers = function (behaviours, info) {\n      var r = {};\n      each$1(behaviours, function (behaviour) {\n        r[behaviour.name()] = behaviour.handlers(info);\n      });\n      return r;\n    };\n    var groupByEvents = function (info, behaviours, base) {\n      var behaviourEvents = __assign(__assign({}, base), nameToHandlers(behaviours, info));\n      return byInnerKey(behaviourEvents, behaviourTuple);\n    };\n    var combine$2 = function (info, eventOrder, behaviours, base) {\n      var byEventName = groupByEvents(info, behaviours, base);\n      return combineGroups(byEventName, eventOrder);\n    };\n    var assemble = function (rawHandler) {\n      var handler = read(rawHandler);\n      return function (component, simulatedEvent) {\n        var rest = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n          rest[_i - 2] = arguments[_i];\n        }\n        var args = [\n          component,\n          simulatedEvent\n        ].concat(rest);\n        if (handler.abort.apply(undefined, args)) {\n          simulatedEvent.stop();\n        } else if (handler.can.apply(undefined, args)) {\n          handler.run.apply(undefined, args);\n        }\n      };\n    };\n    var missingOrderError = function (eventName, tuples) {\n      return Result.error(['The event (' + eventName + ') has more than one behaviour that listens to it.\\nWhen this occurs, you must ' + 'specify an event ordering for the behaviours in your spec (e.g. [ \"listing\", \"toggling\" ]).\\nThe behaviours that ' + 'can trigger it are: ' + JSON.stringify(map$1(tuples, function (c) {\n          return c.name();\n        }), null, 2)]);\n    };\n    var fuse$1 = function (tuples, eventOrder, eventName) {\n      var order = eventOrder[eventName];\n      if (!order) {\n        return missingOrderError(eventName, tuples);\n      } else {\n        return sortKeys('Event: ' + eventName, 'name', tuples, order).map(function (sortedTuples) {\n          var handlers = map$1(sortedTuples, function (tuple) {\n            return tuple.handler();\n          });\n          return fuse(handlers);\n        });\n      }\n    };\n    var combineGroups = function (byEventName, eventOrder) {\n      var r = mapToArray(byEventName, function (tuples, eventName) {\n        var combined = tuples.length === 1 ? Result.value(tuples[0].handler()) : fuse$1(tuples, eventOrder, eventName);\n        return combined.map(function (handler) {\n          var assembled = assemble(handler);\n          var purpose = tuples.length > 1 ? filter(eventOrder[eventName], function (o) {\n            return exists(tuples, function (t) {\n              return t.name() === o;\n            });\n          }).join(' > ') : tuples[0].name();\n          return wrap$1(eventName, uncurried(assembled, purpose));\n        });\n      });\n      return consolidate(r, {});\n    };\n\n    var toInfo = function (spec) {\n      return asRaw('custom.definition', objOf([\n        field('dom', 'dom', strict(), objOf([\n          strict$1('tag'),\n          defaulted$1('styles', {}),\n          defaulted$1('classes', []),\n          defaulted$1('attributes', {}),\n          option('value'),\n          option('innerHtml')\n        ])),\n        strict$1('components'),\n        strict$1('uid'),\n        defaulted$1('events', {}),\n        defaulted$1('apis', {}),\n        field('eventOrder', 'eventOrder', mergeWith({\n          'alloy.execute': [\n            'disabling',\n            'alloy.base.behaviour',\n            'toggling',\n            'typeaheadevents'\n          ],\n          'alloy.focus': [\n            'alloy.base.behaviour',\n            'focusing',\n            'keying'\n          ],\n          'alloy.system.init': [\n            'alloy.base.behaviour',\n            'disabling',\n            'toggling',\n            'representing'\n          ],\n          'input': [\n            'alloy.base.behaviour',\n            'representing',\n            'streaming',\n            'invalidating'\n          ],\n          'alloy.system.detached': [\n            'alloy.base.behaviour',\n            'representing',\n            'item-events',\n            'tooltipping'\n          ],\n          'mousedown': [\n            'focusing',\n            'alloy.base.behaviour',\n            'item-type-events'\n          ],\n          'mouseover': [\n            'item-type-events',\n            'tooltipping'\n          ]\n        }), anyValue$1()),\n        option('domModification')\n      ]), spec);\n    };\n    var toDefinition = function (detail) {\n      return __assign(__assign({}, detail.dom), {\n        uid: detail.uid,\n        domChildren: map$1(detail.components, function (comp) {\n          return comp.element();\n        })\n      });\n    };\n    var toModification = function (detail) {\n      return detail.domModification.fold(function () {\n        return nu$5({});\n      }, nu$5);\n    };\n    var toEvents = function (info) {\n      return info.events;\n    };\n\n    var add$3 = function (element, classes) {\n      each$1(classes, function (x) {\n        add$2(element, x);\n      });\n    };\n    var remove$6 = function (element, classes) {\n      each$1(classes, function (x) {\n        remove$4(element, x);\n      });\n    };\n\n    var renderToDom = function (definition) {\n      var subject = Element.fromTag(definition.tag);\n      setAll(subject, definition.attributes);\n      add$3(subject, definition.classes);\n      setAll$1(subject, definition.styles);\n      definition.innerHtml.each(function (html) {\n        return set$1(subject, html);\n      });\n      var children = definition.domChildren;\n      append$1(subject, children);\n      definition.value.each(function (value) {\n        set$6(subject, value);\n      });\n      if (!definition.uid) {\n        debugger;\n      }\n      writeOnly(subject, definition.uid);\n      return subject;\n    };\n\n    var getBehaviours$1 = function (spec) {\n      var behaviours = readOr$1('behaviours', {})(spec);\n      var keys$1 = filter(keys(behaviours), function (k) {\n        return behaviours[k] !== undefined;\n      });\n      return map$1(keys$1, function (k) {\n        return behaviours[k].me;\n      });\n    };\n    var generateFrom$1 = function (spec, all) {\n      return generateFrom(spec, all);\n    };\n    var generate$4 = function (spec) {\n      var all = getBehaviours$1(spec);\n      return generateFrom$1(spec, all);\n    };\n\n    var getDomDefinition = function (info, bList, bData) {\n      var definition = toDefinition(info);\n      var infoModification = toModification(info);\n      var baseModification = { 'alloy.base.modification': infoModification };\n      var modification = bList.length > 0 ? combine$1(bData, baseModification, bList, definition) : infoModification;\n      return merge$1(definition, modification);\n    };\n    var getEvents = function (info, bList, bData) {\n      var baseEvents = { 'alloy.base.behaviour': toEvents(info) };\n      return combine$2(bData, info.eventOrder, bList, baseEvents).getOrDie();\n    };\n    var build = function (spec) {\n      var getMe = function () {\n        return me;\n      };\n      var systemApi = Cell(singleton);\n      var info = getOrDie(toInfo(spec));\n      var bBlob = generate$4(spec);\n      var bList = getBehaviours(bBlob);\n      var bData = getData(bBlob);\n      var modDefinition = getDomDefinition(info, bList, bData);\n      var item = renderToDom(modDefinition);\n      var events = getEvents(info, bList, bData);\n      var subcomponents = Cell(info.components);\n      var connect = function (newApi) {\n        systemApi.set(newApi);\n      };\n      var disconnect = function () {\n        systemApi.set(NoContextApi(getMe));\n      };\n      var syncComponents = function () {\n        var children$1 = children(item);\n        var subs = bind(children$1, function (child) {\n          return systemApi.get().getByDom(child).fold(function () {\n            return [];\n          }, function (c) {\n            return [c];\n          });\n        });\n        subcomponents.set(subs);\n      };\n      var config = function (behaviour) {\n        var b = bData;\n        var f = isFunction(b[behaviour.name()]) ? b[behaviour.name()] : function () {\n          throw new Error('Could not find ' + behaviour.name() + ' in ' + JSON.stringify(spec, null, 2));\n        };\n        return f();\n      };\n      var hasConfigured = function (behaviour) {\n        return isFunction(bData[behaviour.name()]);\n      };\n      var getApis = function () {\n        return info.apis;\n      };\n      var readState = function (behaviourName) {\n        return bData[behaviourName]().map(function (b) {\n          return b.state.readState();\n        }).getOr('not enabled');\n      };\n      var me = {\n        getSystem: systemApi.get,\n        config: config,\n        hasConfigured: hasConfigured,\n        spec: constant(spec),\n        readState: readState,\n        getApis: getApis,\n        connect: connect,\n        disconnect: disconnect,\n        element: constant(item),\n        syncComponents: syncComponents,\n        components: subcomponents.get,\n        events: constant(events)\n      };\n      return me;\n    };\n\n    var buildSubcomponents = function (spec) {\n      var components = readOr$1('components', [])(spec);\n      return map$1(components, build$1);\n    };\n    var buildFromSpec = function (userSpec) {\n      var _a = make$1(userSpec), specEvents = _a.events, spec = __rest(_a, ['events']);\n      var components = buildSubcomponents(spec);\n      var completeSpec = __assign(__assign({}, spec), {\n        events: __assign(__assign({}, DefaultEvents), specEvents),\n        components: components\n      });\n      return Result.value(build(completeSpec));\n    };\n    var text = function (textContent) {\n      var element = Element.fromText(textContent);\n      return external({ element: element });\n    };\n    var external = function (spec) {\n      var extSpec = asRawOrDie('external.component', objOfOnly([\n        strict$1('element'),\n        option('uid')\n      ]), spec);\n      var systemApi = Cell(NoContextApi());\n      var connect = function (newApi) {\n        systemApi.set(newApi);\n      };\n      var disconnect = function () {\n        systemApi.set(NoContextApi(function () {\n          return me;\n        }));\n      };\n      extSpec.uid.each(function (uid) {\n        writeOnly(extSpec.element, uid);\n      });\n      var me = {\n        getSystem: systemApi.get,\n        config: Option.none,\n        hasConfigured: constant(false),\n        connect: connect,\n        disconnect: disconnect,\n        getApis: function () {\n          return {};\n        },\n        element: constant(extSpec.element),\n        spec: constant(spec),\n        readState: constant('No state'),\n        syncComponents: noop,\n        components: constant([]),\n        events: constant({})\n      };\n      return premade(me);\n    };\n    var uids = generate$3;\n    var build$1 = function (spec) {\n      return getPremade(spec).fold(function () {\n        var userSpecWithUid = spec.hasOwnProperty('uid') ? spec : __assign({ uid: uids('') }, spec);\n        return buildFromSpec(userSpecWithUid).getOrDie();\n      }, function (prebuilt) {\n        return prebuilt;\n      });\n    };\n    var premade$1 = premade;\n\n    var hoverEvent = 'alloy.item-hover';\n    var focusEvent = 'alloy.item-focus';\n    var onHover = function (item) {\n      if (search(item.element()).isNone() || Focusing.isFocused(item)) {\n        if (!Focusing.isFocused(item)) {\n          Focusing.focus(item);\n        }\n        emitWith(item, hoverEvent, { item: item });\n      }\n    };\n    var onFocus = function (item) {\n      emitWith(item, focusEvent, { item: item });\n    };\n    var hover = constant(hoverEvent);\n    var focus$3 = constant(focusEvent);\n\n    var builder = function (detail) {\n      return {\n        dom: detail.dom,\n        domModification: __assign(__assign({}, detail.domModification), { attributes: __assign(__assign(__assign({ 'role': detail.toggling.isSome() ? 'menuitemcheckbox' : 'menuitem' }, detail.domModification.attributes), { 'aria-haspopup': detail.hasSubmenu }), detail.hasSubmenu ? { 'aria-expanded': false } : {}) }),\n        behaviours: SketchBehaviours.augment(detail.itemBehaviours, [\n          detail.toggling.fold(Toggling.revoke, function (tConfig) {\n            return Toggling.config(__assign({ aria: { mode: 'checked' } }, tConfig));\n          }),\n          Focusing.config({\n            ignore: detail.ignoreFocus,\n            stopMousedown: detail.ignoreFocus,\n            onFocus: function (component) {\n              onFocus(component);\n            }\n          }),\n          Keying.config({ mode: 'execution' }),\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: detail.data\n            }\n          }),\n          config('item-type-events', [\n            run(tapOrClick(), emitExecute),\n            cutter(mousedown()),\n            run(mouseover(), onHover),\n            run(focusItem(), Focusing.focus)\n          ])\n        ]),\n        components: detail.components,\n        eventOrder: detail.eventOrder\n      };\n    };\n    var schema$a = [\n      strict$1('data'),\n      strict$1('components'),\n      strict$1('dom'),\n      defaulted$1('hasSubmenu', false),\n      option('toggling'),\n      SketchBehaviours.field('itemBehaviours', [\n        Toggling,\n        Focusing,\n        Keying,\n        Representing\n      ]),\n      defaulted$1('ignoreFocus', false),\n      defaulted$1('domModification', {}),\n      output('builder', builder),\n      defaulted$1('eventOrder', {})\n    ];\n\n    var builder$1 = function (detail) {\n      return {\n        dom: detail.dom,\n        components: detail.components,\n        events: derive([stopper(focusItem())])\n      };\n    };\n    var schema$b = [\n      strict$1('dom'),\n      strict$1('components'),\n      output('builder', builder$1)\n    ];\n\n    var owner$2 = function () {\n      return 'item-widget';\n    };\n    var parts = constant([required({\n        name: 'widget',\n        overrides: function (detail) {\n          return {\n            behaviours: derive$1([Representing.config({\n                store: {\n                  mode: 'manual',\n                  getValue: function (component) {\n                    return detail.data;\n                  },\n                  setValue: function () {\n                  }\n                }\n              })])\n          };\n        }\n      })]);\n\n    var builder$2 = function (detail) {\n      var subs = substitutes(owner$2(), detail, parts());\n      var components$1 = components(owner$2(), detail, subs.internals());\n      var focusWidget = function (component) {\n        return getPart(component, detail, 'widget').map(function (widget) {\n          Keying.focusIn(widget);\n          return widget;\n        });\n      };\n      var onHorizontalArrow = function (component, simulatedEvent) {\n        return inside(simulatedEvent.event().target()) ? Option.none() : function () {\n          if (detail.autofocus) {\n            simulatedEvent.setSource(component.element());\n            return Option.none();\n          } else {\n            return Option.none();\n          }\n        }();\n      };\n      return {\n        dom: detail.dom,\n        components: components$1,\n        domModification: detail.domModification,\n        events: derive([\n          runOnExecute(function (component, simulatedEvent) {\n            focusWidget(component).each(function (widget) {\n              simulatedEvent.stop();\n            });\n          }),\n          run(mouseover(), onHover),\n          run(focusItem(), function (component, simulatedEvent) {\n            if (detail.autofocus) {\n              focusWidget(component);\n            } else {\n              Focusing.focus(component);\n            }\n          })\n        ]),\n        behaviours: SketchBehaviours.augment(detail.widgetBehaviours, [\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: detail.data\n            }\n          }),\n          Focusing.config({\n            ignore: detail.ignoreFocus,\n            onFocus: function (component) {\n              onFocus(component);\n            }\n          }),\n          Keying.config({\n            mode: 'special',\n            focusIn: detail.autofocus ? function (component) {\n              focusWidget(component);\n            } : revoke(),\n            onLeft: onHorizontalArrow,\n            onRight: onHorizontalArrow,\n            onEscape: function (component, simulatedEvent) {\n              if (!Focusing.isFocused(component) && !detail.autofocus) {\n                Focusing.focus(component);\n                return Option.some(true);\n              } else if (detail.autofocus) {\n                simulatedEvent.setSource(component.element());\n                return Option.none();\n              } else {\n                return Option.none();\n              }\n            }\n          })\n        ])\n      };\n    };\n    var schema$c = [\n      strict$1('uid'),\n      strict$1('data'),\n      strict$1('components'),\n      strict$1('dom'),\n      defaulted$1('autofocus', false),\n      defaulted$1('ignoreFocus', false),\n      SketchBehaviours.field('widgetBehaviours', [\n        Representing,\n        Focusing,\n        Keying\n      ]),\n      defaulted$1('domModification', {}),\n      defaultUidsSchema(parts()),\n      output('builder', builder$2)\n    ];\n\n    var itemSchema$1 = choose$1('type', {\n      widget: schema$c,\n      item: schema$a,\n      separator: schema$b\n    });\n    var configureGrid = function (detail, movementInfo) {\n      return {\n        mode: 'flatgrid',\n        selector: '.' + detail.markers.item,\n        initSize: {\n          numColumns: movementInfo.initSize.numColumns,\n          numRows: movementInfo.initSize.numRows\n        },\n        focusManager: detail.focusManager\n      };\n    };\n    var configureMatrix = function (detail, movementInfo) {\n      return {\n        mode: 'matrix',\n        selectors: {\n          row: movementInfo.rowSelector,\n          cell: '.' + detail.markers.item\n        },\n        focusManager: detail.focusManager\n      };\n    };\n    var configureMenu = function (detail, movementInfo) {\n      return {\n        mode: 'menu',\n        selector: '.' + detail.markers.item,\n        moveOnTab: movementInfo.moveOnTab,\n        focusManager: detail.focusManager\n      };\n    };\n    var parts$1 = constant([group({\n        factory: {\n          sketch: function (spec) {\n            var itemInfo = asRawOrDie('menu.spec item', itemSchema$1, spec);\n            return itemInfo.builder(itemInfo);\n          }\n        },\n        name: 'items',\n        unit: 'item',\n        defaults: function (detail, u) {\n          return u.hasOwnProperty('uid') ? u : __assign(__assign({}, u), { uid: generate$3('item') });\n        },\n        overrides: function (detail, u) {\n          return {\n            type: u.type,\n            ignoreFocus: detail.fakeFocus,\n            domModification: { classes: [detail.markers.item] }\n          };\n        }\n      })]);\n    var schema$d = constant([\n      strict$1('value'),\n      strict$1('items'),\n      strict$1('dom'),\n      strict$1('components'),\n      defaulted$1('eventOrder', {}),\n      field$1('menuBehaviours', [\n        Highlighting,\n        Representing,\n        Composing,\n        Keying\n      ]),\n      defaultedOf('movement', {\n        mode: 'menu',\n        moveOnTab: true\n      }, choose$1('mode', {\n        grid: [\n          initSize(),\n          output('config', configureGrid)\n        ],\n        matrix: [\n          output('config', configureMatrix),\n          strict$1('rowSelector')\n        ],\n        menu: [\n          defaulted$1('moveOnTab', true),\n          output('config', configureMenu)\n        ]\n      })),\n      itemMarkers(),\n      defaulted$1('fakeFocus', false),\n      defaulted$1('focusManager', dom()),\n      onHandler('onHighlight')\n    ]);\n\n    var focus$4 = constant('alloy.menu-focus');\n\n    var make$2 = function (detail, components, spec, externals) {\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        markers: detail.markers,\n        behaviours: augment(detail.menuBehaviours, [\n          Highlighting.config({\n            highlightClass: detail.markers.selectedItem,\n            itemClass: detail.markers.item,\n            onHighlight: detail.onHighlight\n          }),\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: detail.value\n            }\n          }),\n          Composing.config({ find: Option.some }),\n          Keying.config(detail.movement.config(detail, detail.movement))\n        ]),\n        events: derive([\n          run(focus$3(), function (menu, simulatedEvent) {\n            var event = simulatedEvent.event();\n            menu.getSystem().getByDom(event.target()).each(function (item) {\n              Highlighting.highlight(menu, item);\n              simulatedEvent.stop();\n              emitWith(menu, focus$4(), {\n                menu: menu,\n                item: item\n              });\n            });\n          }),\n          run(hover(), function (menu, simulatedEvent) {\n            var item = simulatedEvent.event().item();\n            Highlighting.highlight(menu, item);\n          })\n        ]),\n        components: components,\n        eventOrder: detail.eventOrder,\n        domModification: { attributes: { role: 'menu' } }\n      };\n    };\n\n    var Menu = composite$1({\n      name: 'Menu',\n      configFields: schema$d(),\n      partFields: parts$1(),\n      factory: make$2\n    });\n\n    var preserve$1 = function (f, container) {\n      var ownerDoc = owner(container);\n      var refocus = active(ownerDoc).bind(function (focused) {\n        var hasFocus = function (elem) {\n          return eq(focused, elem);\n        };\n        return hasFocus(container) ? Option.some(container) : descendant(container, hasFocus);\n      });\n      var result = f(container);\n      refocus.each(function (oldFocus) {\n        active(ownerDoc).filter(function (newFocus) {\n          return eq(newFocus, oldFocus);\n        }).fold(function () {\n          focus$1(oldFocus);\n        }, noop);\n      });\n      return result;\n    };\n\n    var set$8 = function (component, replaceConfig, replaceState, data) {\n      preserve$1(function () {\n        var newChildren = map$1(data, component.getSystem().build);\n        replaceChildren(component, newChildren);\n      }, component.element());\n    };\n    var insert = function (component, replaceConfig, insertion, childSpec) {\n      var child = component.getSystem().build(childSpec);\n      attachWith(component, child, insertion);\n    };\n    var append$2 = function (component, replaceConfig, replaceState, appendee) {\n      insert(component, replaceConfig, append, appendee);\n    };\n    var prepend$1 = function (component, replaceConfig, replaceState, prependee) {\n      insert(component, replaceConfig, prepend, prependee);\n    };\n    var remove$7 = function (component, replaceConfig, replaceState, removee) {\n      var children = contents(component);\n      var foundChild = find$2(children, function (child) {\n        return eq(removee.element(), child.element());\n      });\n      foundChild.each(detach);\n    };\n    var contents = function (component, replaceConfig) {\n      return component.components();\n    };\n    var replaceAt = function (component, replaceConfig, replaceState, replaceeIndex, replacer) {\n      var children = contents(component);\n      return Option.from(children[replaceeIndex]).map(function (replacee) {\n        remove$7(component, replaceConfig, replaceState, replacee);\n        replacer.each(function (r) {\n          insert(component, replaceConfig, function (p, c) {\n            appendAt(p, c, replaceeIndex);\n          }, r);\n        });\n        return replacee;\n      });\n    };\n    var replaceBy = function (component, replaceConfig, replaceState, replaceePred, replacer) {\n      var children = contents(component);\n      return findIndex(children, replaceePred).bind(function (replaceeIndex) {\n        return replaceAt(component, replaceConfig, replaceState, replaceeIndex, replacer);\n      });\n    };\n\n    var ReplaceApis = /*#__PURE__*/Object.freeze({\n        append: append$2,\n        prepend: prepend$1,\n        remove: remove$7,\n        replaceAt: replaceAt,\n        replaceBy: replaceBy,\n        set: set$8,\n        contents: contents\n    });\n\n    var Replacing = create$1({\n      fields: [],\n      name: 'replacing',\n      apis: ReplaceApis\n    });\n\n    var transpose = function (obj) {\n      return tupleMap(obj, function (v, k) {\n        return {\n          k: v,\n          v: k\n        };\n      });\n    };\n    var trace = function (items, byItem, byMenu, finish) {\n      return readOptFrom$1(byMenu, finish).bind(function (triggerItem) {\n        return readOptFrom$1(items, triggerItem).bind(function (triggerMenu) {\n          var rest = trace(items, byItem, byMenu, triggerMenu);\n          return Option.some([triggerMenu].concat(rest));\n        });\n      }).getOr([]);\n    };\n    var generate$5 = function (menus, expansions) {\n      var items = {};\n      each(menus, function (menuItems, menu) {\n        each$1(menuItems, function (item) {\n          items[item] = menu;\n        });\n      });\n      var byItem = expansions;\n      var byMenu = transpose(expansions);\n      var menuPaths = map(byMenu, function (_triggerItem, submenu) {\n        return [submenu].concat(trace(items, byItem, byMenu, submenu));\n      });\n      return map(items, function (menu) {\n        return readOptFrom$1(menuPaths, menu).getOr([menu]);\n      });\n    };\n\n    var init$3 = function () {\n      var expansions = Cell({});\n      var menus = Cell({});\n      var paths = Cell({});\n      var primary = Cell(Option.none());\n      var directory = Cell({});\n      var clear = function () {\n        expansions.set({});\n        menus.set({});\n        paths.set({});\n        primary.set(Option.none());\n      };\n      var isClear = function () {\n        return primary.get().isNone();\n      };\n      var setMenuBuilt = function (menuName, built) {\n        var _a;\n        menus.set(__assign(__assign({}, menus.get()), (_a = {}, _a[menuName] = {\n          type: 'prepared',\n          menu: built\n        }, _a)));\n      };\n      var setContents = function (sPrimary, sMenus, sExpansions, dir) {\n        primary.set(Option.some(sPrimary));\n        expansions.set(sExpansions);\n        menus.set(sMenus);\n        directory.set(dir);\n        var sPaths = generate$5(dir, sExpansions);\n        paths.set(sPaths);\n      };\n      var getTriggeringItem = function (menuValue) {\n        return find(expansions.get(), function (v, k) {\n          return v === menuValue;\n        });\n      };\n      var getTriggerData = function (menuValue, getItemByValue, path) {\n        return getPreparedMenu(menuValue).bind(function (menu) {\n          return getTriggeringItem(menuValue).bind(function (triggeringItemValue) {\n            return getItemByValue(triggeringItemValue).map(function (triggeredItem) {\n              return {\n                triggeredMenu: menu,\n                triggeringItem: triggeredItem,\n                triggeringPath: path\n              };\n            });\n          });\n        });\n      };\n      var getTriggeringPath = function (itemValue, getItemByValue) {\n        var extraPath = filter(lookupItem(itemValue).toArray(), function (menuValue) {\n          return getPreparedMenu(menuValue).isSome();\n        });\n        return readOptFrom$1(paths.get(), itemValue).bind(function (path) {\n          var revPath = reverse(extraPath.concat(path));\n          var triggers = bind(revPath, function (menuValue, menuIndex) {\n            return getTriggerData(menuValue, getItemByValue, revPath.slice(0, menuIndex + 1)).fold(function () {\n              return primary.get().is(menuValue) ? [] : [Option.none()];\n            }, function (data) {\n              return [Option.some(data)];\n            });\n          });\n          return sequence(triggers);\n        });\n      };\n      var expand = function (itemValue) {\n        return readOptFrom$1(expansions.get(), itemValue).map(function (menu) {\n          var current = readOptFrom$1(paths.get(), itemValue).getOr([]);\n          return [menu].concat(current);\n        });\n      };\n      var collapse = function (itemValue) {\n        return readOptFrom$1(paths.get(), itemValue).bind(function (path) {\n          return path.length > 1 ? Option.some(path.slice(1)) : Option.none();\n        });\n      };\n      var refresh = function (itemValue) {\n        return readOptFrom$1(paths.get(), itemValue);\n      };\n      var getPreparedMenu = function (menuValue) {\n        return lookupMenu(menuValue).bind(extractPreparedMenu);\n      };\n      var lookupMenu = function (menuValue) {\n        return readOptFrom$1(menus.get(), menuValue);\n      };\n      var lookupItem = function (itemValue) {\n        return readOptFrom$1(expansions.get(), itemValue);\n      };\n      var otherMenus = function (path) {\n        var menuValues = directory.get();\n        return difference(keys(menuValues), path);\n      };\n      var getPrimary = function () {\n        return primary.get().bind(getPreparedMenu);\n      };\n      var getMenus = function () {\n        return menus.get();\n      };\n      return {\n        setMenuBuilt: setMenuBuilt,\n        setContents: setContents,\n        expand: expand,\n        refresh: refresh,\n        collapse: collapse,\n        lookupMenu: lookupMenu,\n        lookupItem: lookupItem,\n        otherMenus: otherMenus,\n        getPrimary: getPrimary,\n        getMenus: getMenus,\n        clear: clear,\n        isClear: isClear,\n        getTriggeringPath: getTriggeringPath\n      };\n    };\n    var extractPreparedMenu = function (prep) {\n      return prep.type === 'prepared' ? Option.some(prep.menu) : Option.none();\n    };\n    var LayeredState = {\n      init: init$3,\n      extractPreparedMenu: extractPreparedMenu\n    };\n\n    var make$3 = function (detail, rawUiSpec) {\n      var submenuParentItems = Cell(Option.none());\n      var buildMenus = function (container, primaryName, menus) {\n        return map(menus, function (spec, name) {\n          var makeSketch = function () {\n            return Menu.sketch(__assign(__assign({ dom: spec.dom }, spec), {\n              value: name,\n              items: spec.items,\n              markers: detail.markers,\n              fakeFocus: detail.fakeFocus,\n              onHighlight: detail.onHighlight,\n              focusManager: detail.fakeFocus ? highlights() : dom()\n            }));\n          };\n          return name === primaryName ? {\n            type: 'prepared',\n            menu: container.getSystem().build(makeSketch())\n          } : {\n            type: 'notbuilt',\n            nbMenu: makeSketch\n          };\n        });\n      };\n      var layeredState = LayeredState.init();\n      var setup = function (container) {\n        var componentMap = buildMenus(container, detail.data.primary, detail.data.menus);\n        var directory = toDirectory();\n        layeredState.setContents(detail.data.primary, componentMap, detail.data.expansions, directory);\n        return layeredState.getPrimary();\n      };\n      var getItemValue = function (item) {\n        return Representing.getValue(item).value;\n      };\n      var getItemByValue = function (container, menus, itemValue) {\n        return findMap(menus, function (menu) {\n          if (!menu.getSystem().isConnected()) {\n            return Option.none();\n          }\n          var candidates = Highlighting.getCandidates(menu);\n          return find$2(candidates, function (c) {\n            return getItemValue(c) === itemValue;\n          });\n        });\n      };\n      var toDirectory = function (container) {\n        return map(detail.data.menus, function (data, menuName) {\n          return bind(data.items, function (item) {\n            return item.type === 'separator' ? [] : [item.data.value];\n          });\n        });\n      };\n      var setActiveMenu = function (container, menu) {\n        Highlighting.highlight(container, menu);\n        Highlighting.getHighlighted(menu).orThunk(function () {\n          return Highlighting.getFirst(menu);\n        }).each(function (item) {\n          dispatch(container, item.element(), focusItem());\n        });\n      };\n      var getMenus = function (state, menuValues) {\n        return cat(map$1(menuValues, function (mv) {\n          return state.lookupMenu(mv).bind(function (prep) {\n            return prep.type === 'prepared' ? Option.some(prep.menu) : Option.none();\n          });\n        }));\n      };\n      var closeOthers = function (container, state, path) {\n        var others = getMenus(state, state.otherMenus(path));\n        each$1(others, function (o) {\n          remove$6(o.element(), [detail.markers.backgroundMenu]);\n          if (!detail.stayInDom) {\n            Replacing.remove(container, o);\n          }\n        });\n      };\n      var getSubmenuParents = function (container) {\n        return submenuParentItems.get().getOrThunk(function () {\n          var r = {};\n          var items = descendants(container.element(), '.' + detail.markers.item);\n          var parentItems = filter(items, function (i) {\n            return get(i, 'aria-haspopup') === 'true';\n          });\n          each$1(parentItems, function (i) {\n            container.getSystem().getByDom(i).each(function (itemComp) {\n              var key = getItemValue(itemComp);\n              r[key] = itemComp;\n            });\n          });\n          submenuParentItems.set(Option.some(r));\n          return r;\n        });\n      };\n      var updateAriaExpansions = function (container, path) {\n        var parentItems = getSubmenuParents(container);\n        each(parentItems, function (v, k) {\n          var expanded = contains(path, k);\n          set(v.element(), 'aria-expanded', expanded);\n        });\n      };\n      var updateMenuPath = function (container, state, path) {\n        return Option.from(path[0]).bind(function (latestMenuName) {\n          return state.lookupMenu(latestMenuName).bind(function (menuPrep) {\n            if (menuPrep.type === 'notbuilt') {\n              return Option.none();\n            } else {\n              var activeMenu = menuPrep.menu;\n              var rest = getMenus(state, path.slice(1));\n              each$1(rest, function (r) {\n                add$2(r.element(), detail.markers.backgroundMenu);\n              });\n              if (!inBody(activeMenu.element())) {\n                Replacing.append(container, premade$1(activeMenu));\n              }\n              remove$6(activeMenu.element(), [detail.markers.backgroundMenu]);\n              setActiveMenu(container, activeMenu);\n              closeOthers(container, state, path);\n              return Option.some(activeMenu);\n            }\n          });\n        });\n      };\n      var ExpandHighlightDecision;\n      (function (ExpandHighlightDecision) {\n        ExpandHighlightDecision[ExpandHighlightDecision['HighlightSubmenu'] = 0] = 'HighlightSubmenu';\n        ExpandHighlightDecision[ExpandHighlightDecision['HighlightParent'] = 1] = 'HighlightParent';\n      }(ExpandHighlightDecision || (ExpandHighlightDecision = {})));\n      var buildIfRequired = function (container, menuName, menuPrep) {\n        if (menuPrep.type === 'notbuilt') {\n          var menu = container.getSystem().build(menuPrep.nbMenu());\n          layeredState.setMenuBuilt(menuName, menu);\n          return menu;\n        } else {\n          return menuPrep.menu;\n        }\n      };\n      var expandRight = function (container, item, decision) {\n        if (decision === void 0) {\n          decision = ExpandHighlightDecision.HighlightSubmenu;\n        }\n        var value = getItemValue(item);\n        return layeredState.expand(value).bind(function (path) {\n          updateAriaExpansions(container, path);\n          return Option.from(path[0]).bind(function (menuName) {\n            return layeredState.lookupMenu(menuName).bind(function (activeMenuPrep) {\n              var activeMenu = buildIfRequired(container, menuName, activeMenuPrep);\n              if (!inBody(activeMenu.element())) {\n                Replacing.append(container, premade$1(activeMenu));\n              }\n              detail.onOpenSubmenu(container, item, activeMenu, reverse(path));\n              if (decision === ExpandHighlightDecision.HighlightSubmenu) {\n                Highlighting.highlightFirst(activeMenu);\n                return updateMenuPath(container, layeredState, path);\n              } else {\n                Highlighting.dehighlightAll(activeMenu);\n                return Option.some(item);\n              }\n            });\n          });\n        });\n      };\n      var collapseLeft = function (container, item) {\n        var value = getItemValue(item);\n        return layeredState.collapse(value).bind(function (path) {\n          updateAriaExpansions(container, path);\n          return updateMenuPath(container, layeredState, path).map(function (activeMenu) {\n            detail.onCollapseMenu(container, item, activeMenu);\n            return activeMenu;\n          });\n        });\n      };\n      var updateView = function (container, item) {\n        var value = getItemValue(item);\n        return layeredState.refresh(value).bind(function (path) {\n          updateAriaExpansions(container, path);\n          return updateMenuPath(container, layeredState, path);\n        });\n      };\n      var onRight = function (container, item) {\n        return inside(item.element()) ? Option.none() : expandRight(container, item, ExpandHighlightDecision.HighlightSubmenu);\n      };\n      var onLeft = function (container, item) {\n        return inside(item.element()) ? Option.none() : collapseLeft(container, item);\n      };\n      var onEscape = function (container, item) {\n        return collapseLeft(container, item).orThunk(function () {\n          return detail.onEscape(container, item).map(function () {\n            return container;\n          });\n        });\n      };\n      var keyOnItem = function (f) {\n        return function (container, simulatedEvent) {\n          return closest$2(simulatedEvent.getSource(), '.' + detail.markers.item).bind(function (target) {\n            return container.getSystem().getByDom(target).toOption().bind(function (item) {\n              return f(container, item).map(function () {\n                return true;\n              });\n            });\n          });\n        };\n      };\n      var events = derive([\n        run(focus$4(), function (sandbox, simulatedEvent) {\n          var item = simulatedEvent.event().item();\n          layeredState.lookupItem(getItemValue(item)).each(function () {\n            var menu = simulatedEvent.event().menu();\n            Highlighting.highlight(sandbox, menu);\n            var value = getItemValue(simulatedEvent.event().item());\n            layeredState.refresh(value).each(function (path) {\n              return closeOthers(sandbox, layeredState, path);\n            });\n          });\n        }),\n        runOnExecute(function (component, simulatedEvent) {\n          var target = simulatedEvent.event().target();\n          component.getSystem().getByDom(target).each(function (item) {\n            var itemValue = getItemValue(item);\n            if (itemValue.indexOf('collapse-item') === 0) {\n              collapseLeft(component, item);\n            }\n            expandRight(component, item, ExpandHighlightDecision.HighlightSubmenu).fold(function () {\n              detail.onExecute(component, item);\n            }, function () {\n            });\n          });\n        }),\n        runOnAttached(function (container, simulatedEvent) {\n          setup(container).each(function (primary) {\n            Replacing.append(container, premade$1(primary));\n            detail.onOpenMenu(container, primary);\n            if (detail.highlightImmediately) {\n              setActiveMenu(container, primary);\n            }\n          });\n        })\n      ].concat(detail.navigateOnHover ? [run(hover(), function (sandbox, simulatedEvent) {\n          var item = simulatedEvent.event().item();\n          updateView(sandbox, item);\n          expandRight(sandbox, item, ExpandHighlightDecision.HighlightParent);\n          detail.onHover(sandbox, item);\n        })] : []));\n      var getActiveItem = function (container) {\n        return Highlighting.getHighlighted(container).bind(Highlighting.getHighlighted);\n      };\n      var collapseMenuApi = function (container) {\n        getActiveItem(container).each(function (currentItem) {\n          collapseLeft(container, currentItem);\n        });\n      };\n      var highlightPrimary = function (container) {\n        layeredState.getPrimary().each(function (primary) {\n          setActiveMenu(container, primary);\n        });\n      };\n      var extractMenuFromContainer = function (container) {\n        return Option.from(container.components()[0]).filter(function (comp) {\n          return get(comp.element(), 'role') === 'menu';\n        });\n      };\n      var repositionMenus = function (container) {\n        var maybeActivePrimary = layeredState.getPrimary().bind(function (primary) {\n          return getActiveItem(container).bind(function (currentItem) {\n            var itemValue = getItemValue(currentItem);\n            var allMenus = values(layeredState.getMenus());\n            var preparedMenus = cat(map$1(allMenus, LayeredState.extractPreparedMenu));\n            return layeredState.getTriggeringPath(itemValue, function (v) {\n              return getItemByValue(container, preparedMenus, v);\n            });\n          }).map(function (triggeringPath) {\n            return {\n              primary: primary,\n              triggeringPath: triggeringPath\n            };\n          });\n        });\n        maybeActivePrimary.fold(function () {\n          extractMenuFromContainer(container).each(function (primaryMenu) {\n            detail.onRepositionMenu(container, primaryMenu, []);\n          });\n        }, function (_a) {\n          var primary = _a.primary, triggeringPath = _a.triggeringPath;\n          detail.onRepositionMenu(container, primary, triggeringPath);\n        });\n      };\n      var apis = {\n        collapseMenu: collapseMenuApi,\n        highlightPrimary: highlightPrimary,\n        repositionMenus: repositionMenus\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        markers: detail.markers,\n        behaviours: augment(detail.tmenuBehaviours, [\n          Keying.config({\n            mode: 'special',\n            onRight: keyOnItem(onRight),\n            onLeft: keyOnItem(onLeft),\n            onEscape: keyOnItem(onEscape),\n            focusIn: function (container, keyInfo) {\n              layeredState.getPrimary().each(function (primary) {\n                dispatch(container, primary.element(), focusItem());\n              });\n            }\n          }),\n          Highlighting.config({\n            highlightClass: detail.markers.selectedMenu,\n            itemClass: detail.markers.menu\n          }),\n          Composing.config({\n            find: function (container) {\n              return Highlighting.getHighlighted(container);\n            }\n          }),\n          Replacing.config({})\n        ]),\n        eventOrder: detail.eventOrder,\n        apis: apis,\n        events: events\n      };\n    };\n    var collapseItem = constant('collapse-item');\n\n    var tieredData = function (primary, menus, expansions) {\n      return {\n        primary: primary,\n        menus: menus,\n        expansions: expansions\n      };\n    };\n    var singleData = function (name, menu) {\n      return {\n        primary: name,\n        menus: wrap$1(name, menu),\n        expansions: {}\n      };\n    };\n    var collapseItem$1 = function (text) {\n      return {\n        value: generate$1(collapseItem()),\n        meta: { text: text }\n      };\n    };\n    var tieredMenu = single$2({\n      name: 'TieredMenu',\n      configFields: [\n        onStrictKeyboardHandler('onExecute'),\n        onStrictKeyboardHandler('onEscape'),\n        onStrictHandler('onOpenMenu'),\n        onStrictHandler('onOpenSubmenu'),\n        onStrictHandler('onRepositionMenu'),\n        onHandler('onCollapseMenu'),\n        defaulted$1('highlightImmediately', true),\n        strictObjOf('data', [\n          strict$1('primary'),\n          strict$1('menus'),\n          strict$1('expansions')\n        ]),\n        defaulted$1('fakeFocus', false),\n        onHandler('onHighlight'),\n        onHandler('onHover'),\n        tieredMenuMarkers(),\n        strict$1('dom'),\n        defaulted$1('navigateOnHover', true),\n        defaulted$1('stayInDom', false),\n        field$1('tmenuBehaviours', [\n          Keying,\n          Highlighting,\n          Composing,\n          Replacing\n        ]),\n        defaulted$1('eventOrder', {})\n      ],\n      apis: {\n        collapseMenu: function (apis, tmenu) {\n          apis.collapseMenu(tmenu);\n        },\n        highlightPrimary: function (apis, tmenu) {\n          apis.highlightPrimary(tmenu);\n        },\n        repositionMenus: function (apis, tmenu) {\n          apis.repositionMenus(tmenu);\n        }\n      },\n      factory: make$3,\n      extraApis: {\n        tieredData: tieredData,\n        singleData: singleData,\n        collapseItem: collapseItem$1\n      }\n    });\n\n    var findRoute = function (component, transConfig, transState, route) {\n      return readOptFrom$1(transConfig.routes, route.start).bind(function (sConfig) {\n        return readOptFrom$1(sConfig, route.destination);\n      });\n    };\n    var getTransition = function (comp, transConfig, transState) {\n      var route = getCurrentRoute(comp, transConfig);\n      return route.bind(function (r) {\n        return getTransitionOf(comp, transConfig, transState, r);\n      });\n    };\n    var getTransitionOf = function (comp, transConfig, transState, route) {\n      return findRoute(comp, transConfig, transState, route).bind(function (r) {\n        return r.transition.map(function (t) {\n          return {\n            transition: t,\n            route: r\n          };\n        });\n      });\n    };\n    var disableTransition = function (comp, transConfig, transState) {\n      getTransition(comp, transConfig, transState).each(function (routeTransition) {\n        var t = routeTransition.transition;\n        remove$4(comp.element(), t.transitionClass);\n        remove$1(comp.element(), transConfig.destinationAttr);\n      });\n    };\n    var getNewRoute = function (comp, transConfig, transState, destination) {\n      return {\n        start: get(comp.element(), transConfig.stateAttr),\n        destination: destination\n      };\n    };\n    var getCurrentRoute = function (comp, transConfig, transState) {\n      var el = comp.element();\n      return has$1(el, transConfig.destinationAttr) ? Option.some({\n        start: get(comp.element(), transConfig.stateAttr),\n        destination: get(comp.element(), transConfig.destinationAttr)\n      }) : Option.none();\n    };\n    var jumpTo = function (comp, transConfig, transState, destination) {\n      disableTransition(comp, transConfig, transState);\n      if (has$1(comp.element(), transConfig.stateAttr) && get(comp.element(), transConfig.stateAttr) !== destination) {\n        transConfig.onFinish(comp, destination);\n      }\n      set(comp.element(), transConfig.stateAttr, destination);\n    };\n    var fasttrack = function (comp, transConfig, transState, destination) {\n      if (has$1(comp.element(), transConfig.destinationAttr)) {\n        set(comp.element(), transConfig.stateAttr, get(comp.element(), transConfig.destinationAttr));\n        remove$1(comp.element(), transConfig.destinationAttr);\n      }\n    };\n    var progressTo = function (comp, transConfig, transState, destination) {\n      fasttrack(comp, transConfig);\n      var route = getNewRoute(comp, transConfig, transState, destination);\n      getTransitionOf(comp, transConfig, transState, route).fold(function () {\n        jumpTo(comp, transConfig, transState, destination);\n      }, function (routeTransition) {\n        disableTransition(comp, transConfig, transState);\n        var t = routeTransition.transition;\n        add$2(comp.element(), t.transitionClass);\n        set(comp.element(), transConfig.destinationAttr, destination);\n      });\n    };\n    var getState$1 = function (comp, transConfig, transState) {\n      var e = comp.element();\n      return has$1(e, transConfig.stateAttr) ? Option.some(get(e, transConfig.stateAttr)) : Option.none();\n    };\n\n    var TransitionApis = /*#__PURE__*/Object.freeze({\n        findRoute: findRoute,\n        disableTransition: disableTransition,\n        getCurrentRoute: getCurrentRoute,\n        jumpTo: jumpTo,\n        progressTo: progressTo,\n        getState: getState$1\n    });\n\n    var events$9 = function (transConfig, transState) {\n      return derive([\n        run(transitionend(), function (component, simulatedEvent) {\n          var raw = simulatedEvent.event().raw();\n          getCurrentRoute(component, transConfig).each(function (route) {\n            findRoute(component, transConfig, transState, route).each(function (rInfo) {\n              rInfo.transition.each(function (rTransition) {\n                if (raw.propertyName === rTransition.property) {\n                  jumpTo(component, transConfig, transState, route.destination);\n                  transConfig.onTransition(component, route);\n                }\n              });\n            });\n          });\n        }),\n        runOnAttached(function (comp, se) {\n          jumpTo(comp, transConfig, transState, transConfig.initialState);\n        })\n      ]);\n    };\n\n    var ActiveTransitioning = /*#__PURE__*/Object.freeze({\n        events: events$9\n    });\n\n    var TransitionSchema = [\n      defaulted$1('destinationAttr', 'data-transitioning-destination'),\n      defaulted$1('stateAttr', 'data-transitioning-state'),\n      strict$1('initialState'),\n      onHandler('onTransition'),\n      onHandler('onFinish'),\n      strictOf('routes', setOf$1(Result.value, setOf$1(Result.value, objOfOnly([optionObjOfOnly('transition', [\n          strict$1('property'),\n          strict$1('transitionClass')\n        ])]))))\n    ];\n\n    var createRoutes = function (routes) {\n      var r = {};\n      each(routes, function (v, k) {\n        var waypoints = k.split('<->');\n        r[waypoints[0]] = wrap$1(waypoints[1], v);\n        r[waypoints[1]] = wrap$1(waypoints[0], v);\n      });\n      return r;\n    };\n    var createBistate = function (first, second, transitions) {\n      return wrapAll$1([\n        {\n          key: first,\n          value: wrap$1(second, transitions)\n        },\n        {\n          key: second,\n          value: wrap$1(first, transitions)\n        }\n      ]);\n    };\n    var createTristate = function (first, second, third, transitions) {\n      return wrapAll$1([\n        {\n          key: first,\n          value: wrapAll$1([\n            {\n              key: second,\n              value: transitions\n            },\n            {\n              key: third,\n              value: transitions\n            }\n          ])\n        },\n        {\n          key: second,\n          value: wrapAll$1([\n            {\n              key: first,\n              value: transitions\n            },\n            {\n              key: third,\n              value: transitions\n            }\n          ])\n        },\n        {\n          key: third,\n          value: wrapAll$1([\n            {\n              key: first,\n              value: transitions\n            },\n            {\n              key: second,\n              value: transitions\n            }\n          ])\n        }\n      ]);\n    };\n    var Transitioning = create$1({\n      fields: TransitionSchema,\n      name: 'transitioning',\n      active: ActiveTransitioning,\n      apis: TransitionApis,\n      extra: {\n        createRoutes: createRoutes,\n        createBistate: createBistate,\n        createTristate: createTristate\n      }\n    });\n\n    var scrollable = Styles.resolve('scrollable');\n    var register = function (element) {\n      add$2(element, scrollable);\n    };\n    var deregister = function (element) {\n      remove$4(element, scrollable);\n    };\n    var Scrollable = {\n      register: register,\n      deregister: deregister,\n      scrollable: constant(scrollable)\n    };\n\n    var getValue$4 = function (item) {\n      return readOptFrom$1(item, 'format').getOr(item.title);\n    };\n    var convert$1 = function (formats, memMenuThunk) {\n      var mainMenu = makeMenu('Styles', [].concat(map$1(formats.items, function (k) {\n        return makeItem(getValue$4(k), k.title, k.isSelected(), k.getPreview(), hasKey$1(formats.expansions, getValue$4(k)));\n      })), memMenuThunk, false);\n      var submenus = map(formats.menus, function (menuItems, menuName) {\n        var items = map$1(menuItems, function (item) {\n          return makeItem(getValue$4(item), item.title, item.isSelected !== undefined ? item.isSelected() : false, item.getPreview !== undefined ? item.getPreview() : '', hasKey$1(formats.expansions, getValue$4(item)));\n        });\n        return makeMenu(menuName, items, memMenuThunk, true);\n      });\n      var menus = deepMerge(submenus, wrap$1('styles', mainMenu));\n      var tmenu = tieredMenu.tieredData('styles', menus, formats.expansions);\n      return { tmenu: tmenu };\n    };\n    var makeItem = function (value, text, selected, preview, isMenu) {\n      return {\n        data: {\n          value: value,\n          text: text\n        },\n        type: 'item',\n        dom: {\n          tag: 'div',\n          classes: isMenu ? [Styles.resolve('styles-item-is-menu')] : []\n        },\n        toggling: {\n          toggleOnExecute: false,\n          toggleClass: Styles.resolve('format-matches'),\n          selected: selected\n        },\n        itemBehaviours: derive$1(isMenu ? [] : [Receivers.format(value, function (comp, status) {\n            var toggle = status ? Toggling.on : Toggling.off;\n            toggle(comp);\n          })]),\n        components: [{\n            dom: {\n              tag: 'div',\n              attributes: { style: preview },\n              innerHtml: text\n            }\n          }]\n      };\n    };\n    var makeMenu = function (value, items, memMenuThunk, collapsable) {\n      return {\n        value: value,\n        dom: { tag: 'div' },\n        components: [\n          Button.sketch({\n            dom: {\n              tag: 'div',\n              classes: [Styles.resolve('styles-collapser')]\n            },\n            components: collapsable ? [\n              {\n                dom: {\n                  tag: 'span',\n                  classes: [Styles.resolve('styles-collapse-icon')]\n                }\n              },\n              text(value)\n            ] : [text(value)],\n            action: function (item) {\n              if (collapsable) {\n                var comp = memMenuThunk().get(item);\n                tieredMenu.collapseMenu(comp);\n              }\n            }\n          }),\n          {\n            dom: {\n              tag: 'div',\n              classes: [Styles.resolve('styles-menu-items-container')]\n            },\n            components: [Menu.parts().items({})],\n            behaviours: derive$1([config('adhoc-scrollable-menu', [\n                runOnAttached(function (component, simulatedEvent) {\n                  set$3(component.element(), 'overflow-y', 'auto');\n                  set$3(component.element(), '-webkit-overflow-scrolling', 'touch');\n                  Scrollable.register(component.element());\n                }),\n                runOnDetached(function (component) {\n                  remove$5(component.element(), 'overflow-y');\n                  remove$5(component.element(), '-webkit-overflow-scrolling');\n                  Scrollable.deregister(component.element());\n                })\n              ])])\n          }\n        ],\n        items: items,\n        menuBehaviours: derive$1([Transitioning.config({\n            initialState: 'after',\n            routes: Transitioning.createTristate('before', 'current', 'after', {\n              transition: {\n                property: 'transform',\n                transitionClass: 'transitioning'\n              }\n            })\n          })])\n      };\n    };\n    var sketch$8 = function (settings) {\n      var dataset = convert$1(settings.formats, function () {\n        return memMenu;\n      });\n      var memMenu = record(tieredMenu.sketch({\n        dom: {\n          tag: 'div',\n          classes: [Styles.resolve('styles-menu')]\n        },\n        components: [],\n        fakeFocus: true,\n        stayInDom: true,\n        onExecute: function (tmenu, item) {\n          var v = Representing.getValue(item);\n          settings.handle(item, v.value);\n          return Option.none();\n        },\n        onEscape: function () {\n          return Option.none();\n        },\n        onOpenMenu: function (container, menu) {\n          var w = get$6(container.element());\n          set$4(menu.element(), w);\n          Transitioning.jumpTo(menu, 'current');\n        },\n        onOpenSubmenu: function (container, item, submenu) {\n          var w = get$6(container.element());\n          var menu = ancestor$1(item.element(), '[role=\"menu\"]').getOrDie('hacky');\n          var menuComp = container.getSystem().getByDom(menu).getOrDie();\n          set$4(submenu.element(), w);\n          Transitioning.progressTo(menuComp, 'before');\n          Transitioning.jumpTo(submenu, 'after');\n          Transitioning.progressTo(submenu, 'current');\n        },\n        onCollapseMenu: function (container, item, menu) {\n          var submenu = ancestor$1(item.element(), '[role=\"menu\"]').getOrDie('hacky');\n          var submenuComp = container.getSystem().getByDom(submenu).getOrDie();\n          Transitioning.progressTo(submenuComp, 'after');\n          Transitioning.progressTo(menu, 'current');\n        },\n        navigateOnHover: false,\n        highlightImmediately: true,\n        data: dataset.tmenu,\n        markers: {\n          backgroundMenu: Styles.resolve('styles-background-menu'),\n          menu: Styles.resolve('styles-menu'),\n          selectedMenu: Styles.resolve('styles-selected-menu'),\n          item: Styles.resolve('styles-item'),\n          selectedItem: Styles.resolve('styles-selected-item')\n        }\n      }));\n      return memMenu.asSpec();\n    };\n    var StylesMenu = { sketch: sketch$8 };\n\n    var getFromExpandingItem = function (item) {\n      var newItem = deepMerge(exclude$1(item, ['items']), { menu: true });\n      var rest = expand(item.items);\n      var newMenus = deepMerge(rest.menus, wrap$1(item.title, rest.items));\n      var newExpansions = deepMerge(rest.expansions, wrap$1(item.title, item.title));\n      return {\n        item: newItem,\n        menus: newMenus,\n        expansions: newExpansions\n      };\n    };\n    var getFromItem = function (item) {\n      return hasKey$1(item, 'items') ? getFromExpandingItem(item) : {\n        item: item,\n        menus: {},\n        expansions: {}\n      };\n    };\n    var expand = function (items) {\n      return foldr(items, function (acc, item) {\n        var newData = getFromItem(item);\n        return {\n          menus: deepMerge(acc.menus, newData.menus),\n          items: [newData.item].concat(acc.items),\n          expansions: deepMerge(acc.expansions, newData.expansions)\n        };\n      }, {\n        menus: {},\n        expansions: {},\n        items: []\n      });\n    };\n    var StyleConversions = { expand: expand };\n\n    var register$1 = function (editor, settings) {\n      var isSelectedFor = function (format) {\n        return function () {\n          return editor.formatter.match(format);\n        };\n      };\n      var getPreview = function (format) {\n        return function () {\n          var styles = editor.formatter.getCssText(format);\n          return styles;\n        };\n      };\n      var enrichSupported = function (item) {\n        return deepMerge(item, {\n          isSelected: isSelectedFor(item.format),\n          getPreview: getPreview(item.format)\n        });\n      };\n      var enrichMenu = function (item) {\n        return deepMerge(item, {\n          isSelected: constant(false),\n          getPreview: constant('')\n        });\n      };\n      var enrichCustom = function (item) {\n        var formatName = generate$1(item.title);\n        var newItem = deepMerge(item, {\n          format: formatName,\n          isSelected: isSelectedFor(formatName),\n          getPreview: getPreview(formatName)\n        });\n        editor.formatter.register(formatName, newItem);\n        return newItem;\n      };\n      var formats = readOptFrom$1(settings, 'style_formats').getOr(DefaultStyleFormats);\n      var doEnrich = function (items) {\n        return map$1(items, function (item) {\n          if (hasKey$1(item, 'items')) {\n            var newItems = doEnrich(item.items);\n            return deepMerge(enrichMenu(item), { items: newItems });\n          } else if (hasKey$1(item, 'format')) {\n            return enrichSupported(item);\n          } else {\n            return enrichCustom(item);\n          }\n        });\n      };\n      return doEnrich(formats);\n    };\n    var prune = function (editor, formats) {\n      var doPrune = function (items) {\n        return bind(items, function (item) {\n          if (item.items !== undefined) {\n            var newItems = doPrune(item.items);\n            return newItems.length > 0 ? [item] : [];\n          } else {\n            var keep = hasKey$1(item, 'format') ? editor.formatter.canApply(item.format) : true;\n            return keep ? [item] : [];\n          }\n        });\n      };\n      var prunedItems = doPrune(formats);\n      return StyleConversions.expand(prunedItems);\n    };\n    var ui = function (editor, formats, onDone) {\n      var pruned = prune(editor, formats);\n      return StylesMenu.sketch({\n        formats: pruned,\n        handle: function (item, value) {\n          editor.undoManager.transact(function () {\n            if (Toggling.isOn(item)) {\n              editor.formatter.remove(value);\n            } else {\n              editor.formatter.apply(value);\n            }\n          });\n          onDone();\n        }\n      });\n    };\n    var StyleFormats = {\n      register: register$1,\n      ui: ui\n    };\n\n    var defaults = [\n      'undo',\n      'bold',\n      'italic',\n      'link',\n      'image',\n      'bullist',\n      'styleselect'\n    ];\n    var extract$1 = function (rawToolbar) {\n      var toolbar = rawToolbar.replace(/\\|/g, ' ').trim();\n      return toolbar.length > 0 ? toolbar.split(/\\s+/) : [];\n    };\n    var identifyFromArray = function (toolbar) {\n      return bind(toolbar, function (item) {\n        return isArray(item) ? identifyFromArray(item) : extract$1(item);\n      });\n    };\n    var identify = function (settings) {\n      var toolbar = settings.toolbar !== undefined ? settings.toolbar : defaults;\n      return isArray(toolbar) ? identifyFromArray(toolbar) : extract$1(toolbar);\n    };\n    var setup = function (realm, editor) {\n      var commandSketch = function (name) {\n        return function () {\n          return Buttons.forToolbarCommand(editor, name);\n        };\n      };\n      var stateCommandSketch = function (name) {\n        return function () {\n          return Buttons.forToolbarStateCommand(editor, name);\n        };\n      };\n      var actionSketch = function (name, query, action) {\n        return function () {\n          return Buttons.forToolbarStateAction(editor, name, query, action);\n        };\n      };\n      var undo = commandSketch('undo');\n      var redo = commandSketch('redo');\n      var bold = stateCommandSketch('bold');\n      var italic = stateCommandSketch('italic');\n      var underline = stateCommandSketch('underline');\n      var removeformat = commandSketch('removeformat');\n      var link = function () {\n        return sketch$7(realm, editor);\n      };\n      var unlink = actionSketch('unlink', 'link', function () {\n        editor.execCommand('unlink', null, false);\n      });\n      var image = function () {\n        return sketch$4(editor);\n      };\n      var bullist = actionSketch('unordered-list', 'ul', function () {\n        editor.execCommand('InsertUnorderedList', null, false);\n      });\n      var numlist = actionSketch('ordered-list', 'ol', function () {\n        editor.execCommand('InsertOrderedList', null, false);\n      });\n      var fontsizeselect = function () {\n        return sketch$3(realm, editor);\n      };\n      var forecolor = function () {\n        return ColorSlider.sketch(realm, editor);\n      };\n      var styleFormats = StyleFormats.register(editor, editor.settings);\n      var styleFormatsMenu = function () {\n        return StyleFormats.ui(editor, styleFormats, function () {\n          editor.fire('scrollIntoView');\n        });\n      };\n      var styleselect = function () {\n        return Buttons.forToolbar('style-formats', function (button) {\n          editor.fire('toReading');\n          realm.dropup().appear(styleFormatsMenu, Toggling.on, button);\n        }, derive$1([\n          Toggling.config({\n            toggleClass: Styles.resolve('toolbar-button-selected'),\n            toggleOnExecute: false,\n            aria: { mode: 'pressed' }\n          }),\n          Receiving.config({\n            channels: wrapAll$1([\n              Receivers.receive(TinyChannels.orientationChanged(), Toggling.off),\n              Receivers.receive(TinyChannels.dropupDismissed(), Toggling.off)\n            ])\n          })\n        ]), editor);\n      };\n      var feature = function (prereq, sketch) {\n        return {\n          isSupported: function () {\n            var buttons = editor.ui.registry.getAll().buttons;\n            return prereq.forall(function (p) {\n              return hasKey$1(buttons, p);\n            });\n          },\n          sketch: sketch\n        };\n      };\n      return {\n        undo: feature(Option.none(), undo),\n        redo: feature(Option.none(), redo),\n        bold: feature(Option.none(), bold),\n        italic: feature(Option.none(), italic),\n        underline: feature(Option.none(), underline),\n        removeformat: feature(Option.none(), removeformat),\n        link: feature(Option.none(), link),\n        unlink: feature(Option.none(), unlink),\n        image: feature(Option.none(), image),\n        bullist: feature(Option.some('bullist'), bullist),\n        numlist: feature(Option.some('numlist'), numlist),\n        fontsizeselect: feature(Option.none(), fontsizeselect),\n        forecolor: feature(Option.none(), forecolor),\n        styleselect: feature(Option.none(), styleselect)\n      };\n    };\n    var detect$4 = function (settings, features) {\n      var itemNames = identify(settings);\n      var present = {};\n      return bind(itemNames, function (iName) {\n        var r = !hasKey$1(present, iName) && hasKey$1(features, iName) && features[iName].isSupported() ? [features[iName].sketch()] : [];\n        present[iName] = true;\n        return r;\n      });\n    };\n    var Features = {\n      identify: identify,\n      setup: setup,\n      detect: detect$4\n    };\n\n    var mkEvent = function (target, x, y, stop, prevent, kill, raw) {\n      return {\n        target: constant(target),\n        x: constant(x),\n        y: constant(y),\n        stop: stop,\n        prevent: prevent,\n        kill: kill,\n        raw: constant(raw)\n      };\n    };\n    var fromRawEvent = function (rawEvent) {\n      var target = Element.fromDom(rawEvent.target);\n      var stop = function () {\n        rawEvent.stopPropagation();\n      };\n      var prevent = function () {\n        rawEvent.preventDefault();\n      };\n      var kill = compose(prevent, stop);\n      return mkEvent(target, rawEvent.clientX, rawEvent.clientY, stop, prevent, kill, rawEvent);\n    };\n    var handle = function (filter, handler) {\n      return function (rawEvent) {\n        if (!filter(rawEvent)) {\n          return;\n        }\n        handler(fromRawEvent(rawEvent));\n      };\n    };\n    var binder = function (element, event, filter, handler, useCapture) {\n      var wrapped = handle(filter, handler);\n      element.dom().addEventListener(event, wrapped, useCapture);\n      return { unbind: curry(unbind, element, event, wrapped, useCapture) };\n    };\n    var bind$2 = function (element, event, filter, handler) {\n      return binder(element, event, filter, handler, false);\n    };\n    var capture = function (element, event, filter, handler) {\n      return binder(element, event, filter, handler, true);\n    };\n    var unbind = function (element, event, handler, useCapture) {\n      element.dom().removeEventListener(event, handler, useCapture);\n    };\n\n    var filter$1 = constant(true);\n    var bind$3 = function (element, event, handler) {\n      return bind$2(element, event, filter$1, handler);\n    };\n    var capture$1 = function (element, event, handler) {\n      return capture(element, event, filter$1, handler);\n    };\n\n    var global$4 = tinymce.util.Tools.resolve('tinymce.util.Delay');\n\n    var INTERVAL = 50;\n    var INSURANCE = 1000 / INTERVAL;\n    var get$a = function (outerWindow) {\n      var isPortrait = outerWindow.matchMedia('(orientation: portrait)').matches;\n      return { isPortrait: constant(isPortrait) };\n    };\n    var getActualWidth = function (outerWindow) {\n      var isIos = detect$3().os.isiOS();\n      var isPortrait = get$a(outerWindow).isPortrait();\n      return isIos && !isPortrait ? outerWindow.screen.height : outerWindow.screen.width;\n    };\n    var onChange = function (outerWindow, listeners) {\n      var win = Element.fromDom(outerWindow);\n      var poller = null;\n      var change = function () {\n        global$4.clearInterval(poller);\n        var orientation = get$a(outerWindow);\n        listeners.onChange(orientation);\n        onAdjustment(function () {\n          listeners.onReady(orientation);\n        });\n      };\n      var orientationHandle = bind$3(win, 'orientationchange', change);\n      var onAdjustment = function (f) {\n        global$4.clearInterval(poller);\n        var flag = outerWindow.innerHeight;\n        var insurance = 0;\n        poller = global$4.setInterval(function () {\n          if (flag !== outerWindow.innerHeight) {\n            global$4.clearInterval(poller);\n            f(Option.some(outerWindow.innerHeight));\n          } else if (insurance > INSURANCE) {\n            global$4.clearInterval(poller);\n            f(Option.none());\n          }\n          insurance++;\n        }, INTERVAL);\n      };\n      var destroy = function () {\n        orientationHandle.unbind();\n      };\n      return {\n        onAdjustment: onAdjustment,\n        destroy: destroy\n      };\n    };\n    var Orientation = {\n      get: get$a,\n      onChange: onChange,\n      getActualWidth: getActualWidth\n    };\n\n    function DelayedFunction (fun, delay) {\n      var ref = null;\n      var schedule = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        ref = domGlobals.setTimeout(function () {\n          fun.apply(null, args);\n          ref = null;\n        }, delay);\n      };\n      var cancel = function () {\n        if (ref !== null) {\n          domGlobals.clearTimeout(ref);\n          ref = null;\n        }\n      };\n      return {\n        cancel: cancel,\n        schedule: schedule\n      };\n    }\n\n    var SIGNIFICANT_MOVE = 5;\n    var LONGPRESS_DELAY = 400;\n    var getTouch = function (event) {\n      var raw = event.raw();\n      if (raw.touches === undefined || raw.touches.length !== 1) {\n        return Option.none();\n      }\n      return Option.some(raw.touches[0]);\n    };\n    var isFarEnough = function (touch, data) {\n      var distX = Math.abs(touch.clientX - data.x());\n      var distY = Math.abs(touch.clientY - data.y());\n      return distX > SIGNIFICANT_MOVE || distY > SIGNIFICANT_MOVE;\n    };\n    var monitor = function (settings) {\n      var startData = Cell(Option.none());\n      var longpressFired = Cell(false);\n      var longpress$1 = DelayedFunction(function (event) {\n        settings.triggerEvent(longpress(), event);\n        longpressFired.set(true);\n      }, LONGPRESS_DELAY);\n      var handleTouchstart = function (event) {\n        getTouch(event).each(function (touch) {\n          longpress$1.cancel();\n          var data = {\n            x: constant(touch.clientX),\n            y: constant(touch.clientY),\n            target: event.target\n          };\n          longpress$1.schedule(event);\n          longpressFired.set(false);\n          startData.set(Option.some(data));\n        });\n        return Option.none();\n      };\n      var handleTouchmove = function (event) {\n        longpress$1.cancel();\n        getTouch(event).each(function (touch) {\n          startData.get().each(function (data) {\n            if (isFarEnough(touch, data)) {\n              startData.set(Option.none());\n            }\n          });\n        });\n        return Option.none();\n      };\n      var handleTouchend = function (event) {\n        longpress$1.cancel();\n        var isSame = function (data) {\n          return eq(data.target(), event.target());\n        };\n        return startData.get().filter(isSame).map(function (data) {\n          if (longpressFired.get()) {\n            event.prevent();\n            return false;\n          } else {\n            return settings.triggerEvent(tap(), event);\n          }\n        });\n      };\n      var handlers = wrapAll$1([\n        {\n          key: touchstart(),\n          value: handleTouchstart\n        },\n        {\n          key: touchmove(),\n          value: handleTouchmove\n        },\n        {\n          key: touchend(),\n          value: handleTouchend\n        }\n      ]);\n      var fireIfReady = function (event, type) {\n        return readOptFrom$1(handlers, type).bind(function (handler) {\n          return handler(event);\n        });\n      };\n      return { fireIfReady: fireIfReady };\n    };\n\n    var monitor$1 = function (editorApi) {\n      var tapEvent = monitor({\n        triggerEvent: function (type, evt) {\n          editorApi.onTapContent(evt);\n        }\n      });\n      var onTouchend = function () {\n        return bind$3(editorApi.body(), 'touchend', function (evt) {\n          tapEvent.fireIfReady(evt, 'touchend');\n        });\n      };\n      var onTouchmove = function () {\n        return bind$3(editorApi.body(), 'touchmove', function (evt) {\n          tapEvent.fireIfReady(evt, 'touchmove');\n        });\n      };\n      var fireTouchstart = function (evt) {\n        tapEvent.fireIfReady(evt, 'touchstart');\n      };\n      return {\n        fireTouchstart: fireTouchstart,\n        onTouchend: onTouchend,\n        onTouchmove: onTouchmove\n      };\n    };\n    var TappingEvent = { monitor: monitor$1 };\n\n    var isAndroid6 = detect$3().os.version.major >= 6;\n    var initEvents = function (editorApi, toolstrip, alloy) {\n      var tapping = TappingEvent.monitor(editorApi);\n      var outerDoc = owner(toolstrip);\n      var isRanged = function (sel) {\n        return !eq(sel.start(), sel.finish()) || sel.soffset() !== sel.foffset();\n      };\n      var hasRangeInUi = function () {\n        return active(outerDoc).filter(function (input) {\n          return name(input) === 'input';\n        }).exists(function (input) {\n          return input.dom().selectionStart !== input.dom().selectionEnd;\n        });\n      };\n      var updateMargin = function () {\n        var rangeInContent = editorApi.doc().dom().hasFocus() && editorApi.getSelection().exists(isRanged);\n        alloy.getByDom(toolstrip).each((rangeInContent || hasRangeInUi()) === true ? Toggling.on : Toggling.off);\n      };\n      var listeners = [\n        bind$3(editorApi.body(), 'touchstart', function (evt) {\n          editorApi.onTouchContent();\n          tapping.fireTouchstart(evt);\n        }),\n        tapping.onTouchmove(),\n        tapping.onTouchend(),\n        bind$3(toolstrip, 'touchstart', function (evt) {\n          editorApi.onTouchToolstrip();\n        }),\n        editorApi.onToReading(function () {\n          blur(editorApi.body());\n        }),\n        editorApi.onToEditing(noop),\n        editorApi.onScrollToCursor(function (tinyEvent) {\n          tinyEvent.preventDefault();\n          editorApi.getCursorBox().each(function (bounds) {\n            var cWin = editorApi.win();\n            var isOutside = bounds.top() > cWin.innerHeight || bounds.bottom() > cWin.innerHeight;\n            var cScrollBy = isOutside ? bounds.bottom() - cWin.innerHeight + 50 : 0;\n            if (cScrollBy !== 0) {\n              cWin.scrollTo(cWin.pageXOffset, cWin.pageYOffset + cScrollBy);\n            }\n          });\n        })\n      ].concat(isAndroid6 === true ? [] : [\n        bind$3(Element.fromDom(editorApi.win()), 'blur', function () {\n          alloy.getByDom(toolstrip).each(Toggling.off);\n        }),\n        bind$3(outerDoc, 'select', updateMargin),\n        bind$3(editorApi.doc(), 'selectionchange', updateMargin)\n      ]);\n      var destroy = function () {\n        each$1(listeners, function (l) {\n          l.unbind();\n        });\n      };\n      return { destroy: destroy };\n    };\n    var AndroidEvents = { initEvents: initEvents };\n\n    var safeParse = function (element, attribute) {\n      var parsed = parseInt(get(element, attribute), 10);\n      return isNaN(parsed) ? 0 : parsed;\n    };\n    var DataAttributes = { safeParse: safeParse };\n\n    function NodeValue (is, name) {\n      var get = function (element) {\n        if (!is(element)) {\n          throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n        }\n        return getOption(element).getOr('');\n      };\n      var getOption = function (element) {\n        return is(element) ? Option.from(element.dom().nodeValue) : Option.none();\n      };\n      var set = function (element, value) {\n        if (!is(element)) {\n          throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n        }\n        element.dom().nodeValue = value;\n      };\n      return {\n        get: get,\n        getOption: getOption,\n        set: set\n      };\n    }\n\n    var api$3 = NodeValue(isText, 'text');\n    var get$b = function (element) {\n      return api$3.get(element);\n    };\n    var getOption = function (element) {\n      return api$3.getOption(element);\n    };\n\n    var getEnd = function (element) {\n      return name(element) === 'img' ? 1 : getOption(element).fold(function () {\n        return children(element).length;\n      }, function (v) {\n        return v.length;\n      });\n    };\n    var NBSP = '\\xA0';\n    var isTextNodeWithCursorPosition = function (el) {\n      return getOption(el).filter(function (text) {\n        return text.trim().length !== 0 || text.indexOf(NBSP) > -1;\n      }).isSome();\n    };\n    var elementsWithCursorPosition = [\n      'img',\n      'br'\n    ];\n    var isCursorPosition = function (elem) {\n      var hasCursorPosition = isTextNodeWithCursorPosition(elem);\n      return hasCursorPosition || contains(elementsWithCursorPosition, name(elem));\n    };\n\n    var create$3 = Immutable('start', 'soffset', 'finish', 'foffset');\n    var SimRange = { create: create$3 };\n\n    var adt$4 = Adt.generate([\n      { before: ['element'] },\n      {\n        on: [\n          'element',\n          'offset'\n        ]\n      },\n      { after: ['element'] }\n    ]);\n    var cata = function (subject, onBefore, onOn, onAfter) {\n      return subject.fold(onBefore, onOn, onAfter);\n    };\n    var getStart = function (situ) {\n      return situ.fold(identity, identity, identity);\n    };\n    var before$1 = adt$4.before;\n    var on$1 = adt$4.on;\n    var after$1 = adt$4.after;\n    var Situ = {\n      before: before$1,\n      on: on$1,\n      after: after$1,\n      cata: cata,\n      getStart: getStart\n    };\n\n    var adt$5 = Adt.generate([\n      { domRange: ['rng'] },\n      {\n        relative: [\n          'startSitu',\n          'finishSitu'\n        ]\n      },\n      {\n        exact: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      }\n    ]);\n    var exactFromRange = function (simRange) {\n      return adt$5.exact(simRange.start(), simRange.soffset(), simRange.finish(), simRange.foffset());\n    };\n    var getStart$1 = function (selection) {\n      return selection.match({\n        domRange: function (rng) {\n          return Element.fromDom(rng.startContainer);\n        },\n        relative: function (startSitu, finishSitu) {\n          return Situ.getStart(startSitu);\n        },\n        exact: function (start, soffset, finish, foffset) {\n          return start;\n        }\n      });\n    };\n    var domRange = adt$5.domRange;\n    var relative = adt$5.relative;\n    var exact = adt$5.exact;\n    var getWin = function (selection) {\n      var start = getStart$1(selection);\n      return defaultView(start);\n    };\n    var range$1 = SimRange.create;\n    var Selection = {\n      domRange: domRange,\n      relative: relative,\n      exact: exact,\n      exactFromRange: exactFromRange,\n      getWin: getWin,\n      range: range$1\n    };\n\n    var setStart = function (rng, situ) {\n      situ.fold(function (e) {\n        rng.setStartBefore(e.dom());\n      }, function (e, o) {\n        rng.setStart(e.dom(), o);\n      }, function (e) {\n        rng.setStartAfter(e.dom());\n      });\n    };\n    var setFinish = function (rng, situ) {\n      situ.fold(function (e) {\n        rng.setEndBefore(e.dom());\n      }, function (e, o) {\n        rng.setEnd(e.dom(), o);\n      }, function (e) {\n        rng.setEndAfter(e.dom());\n      });\n    };\n    var relativeToNative = function (win, startSitu, finishSitu) {\n      var range = win.document.createRange();\n      setStart(range, startSitu);\n      setFinish(range, finishSitu);\n      return range;\n    };\n    var exactToNative = function (win, start, soffset, finish, foffset) {\n      var rng = win.document.createRange();\n      rng.setStart(start.dom(), soffset);\n      rng.setEnd(finish.dom(), foffset);\n      return rng;\n    };\n    var toRect = function (rect) {\n      return {\n        left: constant(rect.left),\n        top: constant(rect.top),\n        right: constant(rect.right),\n        bottom: constant(rect.bottom),\n        width: constant(rect.width),\n        height: constant(rect.height)\n      };\n    };\n    var getFirstRect = function (rng) {\n      var rects = rng.getClientRects();\n      var rect = rects.length > 0 ? rects[0] : rng.getBoundingClientRect();\n      return rect.width > 0 || rect.height > 0 ? Option.some(rect).map(toRect) : Option.none();\n    };\n\n    var adt$6 = Adt.generate([\n      {\n        ltr: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      },\n      {\n        rtl: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      }\n    ]);\n    var fromRange = function (win, type, range) {\n      return type(Element.fromDom(range.startContainer), range.startOffset, Element.fromDom(range.endContainer), range.endOffset);\n    };\n    var getRanges = function (win, selection) {\n      return selection.match({\n        domRange: function (rng) {\n          return {\n            ltr: constant(rng),\n            rtl: Option.none\n          };\n        },\n        relative: function (startSitu, finishSitu) {\n          return {\n            ltr: cached(function () {\n              return relativeToNative(win, startSitu, finishSitu);\n            }),\n            rtl: cached(function () {\n              return Option.some(relativeToNative(win, finishSitu, startSitu));\n            })\n          };\n        },\n        exact: function (start, soffset, finish, foffset) {\n          return {\n            ltr: cached(function () {\n              return exactToNative(win, start, soffset, finish, foffset);\n            }),\n            rtl: cached(function () {\n              return Option.some(exactToNative(win, finish, foffset, start, soffset));\n            })\n          };\n        }\n      });\n    };\n    var doDiagnose = function (win, ranges) {\n      var rng = ranges.ltr();\n      if (rng.collapsed) {\n        var reversed = ranges.rtl().filter(function (rev) {\n          return rev.collapsed === false;\n        });\n        return reversed.map(function (rev) {\n          return adt$6.rtl(Element.fromDom(rev.endContainer), rev.endOffset, Element.fromDom(rev.startContainer), rev.startOffset);\n        }).getOrThunk(function () {\n          return fromRange(win, adt$6.ltr, rng);\n        });\n      } else {\n        return fromRange(win, adt$6.ltr, rng);\n      }\n    };\n    var diagnose = function (win, selection) {\n      var ranges = getRanges(win, selection);\n      return doDiagnose(win, ranges);\n    };\n    var asLtrRange = function (win, selection) {\n      var diagnosis = diagnose(win, selection);\n      return diagnosis.match({\n        ltr: function (start, soffset, finish, foffset) {\n          var rng = win.document.createRange();\n          rng.setStart(start.dom(), soffset);\n          rng.setEnd(finish.dom(), foffset);\n          return rng;\n        },\n        rtl: function (start, soffset, finish, foffset) {\n          var rng = win.document.createRange();\n          rng.setStart(finish.dom(), foffset);\n          rng.setEnd(start.dom(), soffset);\n          return rng;\n        }\n      });\n    };\n\n    var searchForPoint = function (rectForOffset, x, y, maxX, length) {\n      if (length === 0) {\n        return 0;\n      } else if (x === maxX) {\n        return length - 1;\n      }\n      var xDelta = maxX;\n      for (var i = 1; i < length; i++) {\n        var rect = rectForOffset(i);\n        var curDeltaX = Math.abs(x - rect.left);\n        if (y <= rect.bottom) {\n          if (y < rect.top || curDeltaX > xDelta) {\n            return i - 1;\n          } else {\n            xDelta = curDeltaX;\n          }\n        }\n      }\n      return 0;\n    };\n    var inRect = function (rect, x, y) {\n      return x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom;\n    };\n\n    var locateOffset = function (doc, textnode, x, y, rect) {\n      var rangeForOffset = function (o) {\n        var r = doc.dom().createRange();\n        r.setStart(textnode.dom(), o);\n        r.collapse(true);\n        return r;\n      };\n      var rectForOffset = function (o) {\n        var r = rangeForOffset(o);\n        return r.getBoundingClientRect();\n      };\n      var length = get$b(textnode).length;\n      var offset = searchForPoint(rectForOffset, x, y, rect.right, length);\n      return rangeForOffset(offset);\n    };\n    var locate$1 = function (doc, node, x, y) {\n      var r = doc.dom().createRange();\n      r.selectNode(node.dom());\n      var rects = r.getClientRects();\n      var foundRect = findMap(rects, function (rect) {\n        return inRect(rect, x, y) ? Option.some(rect) : Option.none();\n      });\n      return foundRect.map(function (rect) {\n        return locateOffset(doc, node, x, y, rect);\n      });\n    };\n\n    var searchInChildren = function (doc, node, x, y) {\n      var r = doc.dom().createRange();\n      var nodes = children(node);\n      return findMap(nodes, function (n) {\n        r.selectNode(n.dom());\n        return inRect(r.getBoundingClientRect(), x, y) ? locateNode(doc, n, x, y) : Option.none();\n      });\n    };\n    var locateNode = function (doc, node, x, y) {\n      return isText(node) ? locate$1(doc, node, x, y) : searchInChildren(doc, node, x, y);\n    };\n    var locate$2 = function (doc, node, x, y) {\n      var r = doc.dom().createRange();\n      r.selectNode(node.dom());\n      var rect = r.getBoundingClientRect();\n      var boundedX = Math.max(rect.left, Math.min(rect.right, x));\n      var boundedY = Math.max(rect.top, Math.min(rect.bottom, y));\n      return locateNode(doc, node, boundedX, boundedY);\n    };\n\n    var first$1 = function (element) {\n      return descendant(element, isCursorPosition);\n    };\n    var last = function (element) {\n      return descendantRtl(element, isCursorPosition);\n    };\n    var descendantRtl = function (scope, predicate) {\n      var descend = function (element) {\n        var children$1 = children(element);\n        for (var i = children$1.length - 1; i >= 0; i--) {\n          var child = children$1[i];\n          if (predicate(child)) {\n            return Option.some(child);\n          }\n          var res = descend(child);\n          if (res.isSome()) {\n            return res;\n          }\n        }\n        return Option.none();\n      };\n      return descend(scope);\n    };\n\n    var COLLAPSE_TO_LEFT = true;\n    var COLLAPSE_TO_RIGHT = false;\n    var getCollapseDirection = function (rect, x) {\n      return x - rect.left < rect.right - x ? COLLAPSE_TO_LEFT : COLLAPSE_TO_RIGHT;\n    };\n    var createCollapsedNode = function (doc, target, collapseDirection) {\n      var r = doc.dom().createRange();\n      r.selectNode(target.dom());\n      r.collapse(collapseDirection);\n      return r;\n    };\n    var locateInElement = function (doc, node, x) {\n      var cursorRange = doc.dom().createRange();\n      cursorRange.selectNode(node.dom());\n      var rect = cursorRange.getBoundingClientRect();\n      var collapseDirection = getCollapseDirection(rect, x);\n      var f = collapseDirection === COLLAPSE_TO_LEFT ? first$1 : last;\n      return f(node).map(function (target) {\n        return createCollapsedNode(doc, target, collapseDirection);\n      });\n    };\n    var locateInEmpty = function (doc, node, x) {\n      var rect = node.dom().getBoundingClientRect();\n      var collapseDirection = getCollapseDirection(rect, x);\n      return Option.some(createCollapsedNode(doc, node, collapseDirection));\n    };\n    var search$1 = function (doc, node, x) {\n      var f = children(node).length === 0 ? locateInEmpty : locateInElement;\n      return f(doc, node, x);\n    };\n\n    var caretPositionFromPoint = function (doc, x, y) {\n      return Option.from(doc.dom().caretPositionFromPoint(x, y)).bind(function (pos) {\n        if (pos.offsetNode === null) {\n          return Option.none();\n        }\n        var r = doc.dom().createRange();\n        r.setStart(pos.offsetNode, pos.offset);\n        r.collapse();\n        return Option.some(r);\n      });\n    };\n    var caretRangeFromPoint = function (doc, x, y) {\n      return Option.from(doc.dom().caretRangeFromPoint(x, y));\n    };\n    var searchTextNodes = function (doc, node, x, y) {\n      var r = doc.dom().createRange();\n      r.selectNode(node.dom());\n      var rect = r.getBoundingClientRect();\n      var boundedX = Math.max(rect.left, Math.min(rect.right, x));\n      var boundedY = Math.max(rect.top, Math.min(rect.bottom, y));\n      return locate$2(doc, node, boundedX, boundedY);\n    };\n    var searchFromPoint = function (doc, x, y) {\n      return Element.fromPoint(doc, x, y).bind(function (elem) {\n        var fallback = function () {\n          return search$1(doc, elem, x);\n        };\n        return children(elem).length === 0 ? fallback() : searchTextNodes(doc, elem, x, y).orThunk(fallback);\n      });\n    };\n    var availableSearch = document.caretPositionFromPoint ? caretPositionFromPoint : document.caretRangeFromPoint ? caretRangeFromPoint : searchFromPoint;\n\n    var beforeSpecial = function (element, offset) {\n      var name$1 = name(element);\n      if ('input' === name$1) {\n        return Situ.after(element);\n      } else if (!contains([\n          'br',\n          'img'\n        ], name$1)) {\n        return Situ.on(element, offset);\n      } else {\n        return offset === 0 ? Situ.before(element) : Situ.after(element);\n      }\n    };\n    var preprocessExact = function (start, soffset, finish, foffset) {\n      var startSitu = beforeSpecial(start, soffset);\n      var finishSitu = beforeSpecial(finish, foffset);\n      return Selection.relative(startSitu, finishSitu);\n    };\n\n    var makeRange = function (start, soffset, finish, foffset) {\n      var doc = owner(start);\n      var rng = doc.dom().createRange();\n      rng.setStart(start.dom(), soffset);\n      rng.setEnd(finish.dom(), foffset);\n      return rng;\n    };\n    var after$2 = function (start, soffset, finish, foffset) {\n      var r = makeRange(start, soffset, finish, foffset);\n      var same = eq(start, finish) && soffset === foffset;\n      return r.collapsed && !same;\n    };\n\n    var doSetNativeRange = function (win, rng) {\n      Option.from(win.getSelection()).each(function (selection) {\n        selection.removeAllRanges();\n        selection.addRange(rng);\n      });\n    };\n    var doSetRange = function (win, start, soffset, finish, foffset) {\n      var rng = exactToNative(win, start, soffset, finish, foffset);\n      doSetNativeRange(win, rng);\n    };\n    var setLegacyRtlRange = function (win, selection, start, soffset, finish, foffset) {\n      selection.collapse(start.dom(), soffset);\n      selection.extend(finish.dom(), foffset);\n    };\n    var setRangeFromRelative = function (win, relative) {\n      return diagnose(win, relative).match({\n        ltr: function (start, soffset, finish, foffset) {\n          doSetRange(win, start, soffset, finish, foffset);\n        },\n        rtl: function (start, soffset, finish, foffset) {\n          var selection = win.getSelection();\n          if (selection.setBaseAndExtent) {\n            selection.setBaseAndExtent(start.dom(), soffset, finish.dom(), foffset);\n          } else if (selection.extend) {\n            try {\n              setLegacyRtlRange(win, selection, start, soffset, finish, foffset);\n            } catch (e) {\n              doSetRange(win, finish, foffset, start, soffset);\n            }\n          } else {\n            doSetRange(win, finish, foffset, start, soffset);\n          }\n        }\n      });\n    };\n    var setExact = function (win, start, soffset, finish, foffset) {\n      var relative = preprocessExact(start, soffset, finish, foffset);\n      setRangeFromRelative(win, relative);\n    };\n    var readRange = function (selection) {\n      if (selection.rangeCount > 0) {\n        var firstRng = selection.getRangeAt(0);\n        var lastRng = selection.getRangeAt(selection.rangeCount - 1);\n        return Option.some(SimRange.create(Element.fromDom(firstRng.startContainer), firstRng.startOffset, Element.fromDom(lastRng.endContainer), lastRng.endOffset));\n      } else {\n        return Option.none();\n      }\n    };\n    var doGetExact = function (selection) {\n      var anchor = Element.fromDom(selection.anchorNode);\n      var focus = Element.fromDom(selection.focusNode);\n      return after$2(anchor, selection.anchorOffset, focus, selection.focusOffset) ? Option.some(SimRange.create(anchor, selection.anchorOffset, focus, selection.focusOffset)) : readRange(selection);\n    };\n    var getExact = function (win) {\n      return Option.from(win.getSelection()).filter(function (sel) {\n        return sel.rangeCount > 0;\n      }).bind(doGetExact);\n    };\n    var get$c = function (win) {\n      return getExact(win).map(function (range) {\n        return Selection.exact(range.start(), range.soffset(), range.finish(), range.foffset());\n      });\n    };\n    var getFirstRect$1 = function (win, selection) {\n      var rng = asLtrRange(win, selection);\n      return getFirstRect(rng);\n    };\n    var clear$1 = function (win) {\n      var selection = win.getSelection();\n      selection.removeAllRanges();\n    };\n\n    var COLLAPSED_WIDTH = 2;\n    var collapsedRect = function (rect) {\n      return {\n        left: rect.left,\n        top: rect.top,\n        right: rect.right,\n        bottom: rect.bottom,\n        width: constant(COLLAPSED_WIDTH),\n        height: rect.height\n      };\n    };\n    var toRect$1 = function (rawRect) {\n      return {\n        left: constant(rawRect.left),\n        top: constant(rawRect.top),\n        right: constant(rawRect.right),\n        bottom: constant(rawRect.bottom),\n        width: constant(rawRect.width),\n        height: constant(rawRect.height)\n      };\n    };\n    var getRectsFromRange = function (range) {\n      if (!range.collapsed) {\n        return map$1(range.getClientRects(), toRect$1);\n      } else {\n        var start_1 = Element.fromDom(range.startContainer);\n        return parent(start_1).bind(function (parent) {\n          var selection = Selection.exact(start_1, range.startOffset, parent, getEnd(parent));\n          var optRect = getFirstRect$1(range.startContainer.ownerDocument.defaultView, selection);\n          return optRect.map(collapsedRect).map(pure);\n        }).getOr([]);\n      }\n    };\n    var getRectangles = function (cWin) {\n      var sel = cWin.getSelection();\n      return sel !== undefined && sel.rangeCount > 0 ? getRectsFromRange(sel.getRangeAt(0)) : [];\n    };\n    var Rectangles = { getRectangles: getRectangles };\n\n    var autocompleteHack = function () {\n      return function (f) {\n        global$4.setTimeout(function () {\n          f();\n        }, 0);\n      };\n    };\n    var resume = function (cWin) {\n      cWin.focus();\n      var iBody = Element.fromDom(cWin.document.body);\n      var inInput = active().exists(function (elem) {\n        return contains([\n          'input',\n          'textarea'\n        ], name(elem));\n      });\n      var transaction = inInput ? autocompleteHack() : apply;\n      transaction(function () {\n        active().each(blur);\n        focus$1(iBody);\n      });\n    };\n    var ResumeEditing = { resume: resume };\n\n    var EXTRA_SPACING = 50;\n    var data = 'data-' + Styles.resolve('last-outer-height');\n    var setLastHeight = function (cBody, value) {\n      set(cBody, data, value);\n    };\n    var getLastHeight = function (cBody) {\n      return DataAttributes.safeParse(cBody, data);\n    };\n    var getBoundsFrom = function (rect) {\n      return {\n        top: constant(rect.top()),\n        bottom: constant(rect.top() + rect.height())\n      };\n    };\n    var getBounds$1 = function (cWin) {\n      var rects = Rectangles.getRectangles(cWin);\n      return rects.length > 0 ? Option.some(rects[0]).map(getBoundsFrom) : Option.none();\n    };\n    var findDelta = function (outerWindow, cBody) {\n      var last = getLastHeight(cBody);\n      var current = outerWindow.innerHeight;\n      return last > current ? Option.some(last - current) : Option.none();\n    };\n    var calculate = function (cWin, bounds, delta) {\n      var isOutside = bounds.top() > cWin.innerHeight || bounds.bottom() > cWin.innerHeight;\n      return isOutside ? Math.min(delta, bounds.bottom() - cWin.innerHeight + EXTRA_SPACING) : 0;\n    };\n    var setup$1 = function (outerWindow, cWin) {\n      var cBody = Element.fromDom(cWin.document.body);\n      var toEditing = function () {\n        ResumeEditing.resume(cWin);\n      };\n      var onResize = bind$3(Element.fromDom(outerWindow), 'resize', function () {\n        findDelta(outerWindow, cBody).each(function (delta) {\n          getBounds$1(cWin).each(function (bounds) {\n            var cScrollBy = calculate(cWin, bounds, delta);\n            if (cScrollBy !== 0) {\n              cWin.scrollTo(cWin.pageXOffset, cWin.pageYOffset + cScrollBy);\n            }\n          });\n        });\n        setLastHeight(cBody, outerWindow.innerHeight);\n      });\n      setLastHeight(cBody, outerWindow.innerHeight);\n      var destroy = function () {\n        onResize.unbind();\n      };\n      return {\n        toEditing: toEditing,\n        destroy: destroy\n      };\n    };\n    var AndroidSetup = { setup: setup$1 };\n\n    var getBodyFromFrame = function (frame) {\n      return Option.some(Element.fromDom(frame.dom().contentWindow.document.body));\n    };\n    var getDocFromFrame = function (frame) {\n      return Option.some(Element.fromDom(frame.dom().contentWindow.document));\n    };\n    var getWinFromFrame = function (frame) {\n      return Option.from(frame.dom().contentWindow);\n    };\n    var getSelectionFromFrame = function (frame) {\n      var optWin = getWinFromFrame(frame);\n      return optWin.bind(getExact);\n    };\n    var getFrame = function (editor) {\n      return editor.getFrame();\n    };\n    var getOrDerive = function (name, f) {\n      return function (editor) {\n        var g = editor[name].getOrThunk(function () {\n          var frame = getFrame(editor);\n          return function () {\n            return f(frame);\n          };\n        });\n        return g();\n      };\n    };\n    var getOrListen = function (editor, doc, name, type) {\n      return editor[name].getOrThunk(function () {\n        return function (handler) {\n          return bind$3(doc, type, handler);\n        };\n      });\n    };\n    var toRect$2 = function (rect) {\n      return {\n        left: constant(rect.left),\n        top: constant(rect.top),\n        right: constant(rect.right),\n        bottom: constant(rect.bottom),\n        width: constant(rect.width),\n        height: constant(rect.height)\n      };\n    };\n    var getActiveApi = function (editor) {\n      var frame = getFrame(editor);\n      var tryFallbackBox = function (win) {\n        var isCollapsed = function (sel) {\n          return eq(sel.start(), sel.finish()) && sel.soffset() === sel.foffset();\n        };\n        var toStartRect = function (sel) {\n          var rect = sel.start().dom().getBoundingClientRect();\n          return rect.width > 0 || rect.height > 0 ? Option.some(rect).map(toRect$2) : Option.none();\n        };\n        return getExact(win).filter(isCollapsed).bind(toStartRect);\n      };\n      return getBodyFromFrame(frame).bind(function (body) {\n        return getDocFromFrame(frame).bind(function (doc) {\n          return getWinFromFrame(frame).map(function (win) {\n            var html = Element.fromDom(doc.dom().documentElement);\n            var getCursorBox = editor.getCursorBox.getOrThunk(function () {\n              return function () {\n                return get$c(win).bind(function (sel) {\n                  return getFirstRect$1(win, sel).orThunk(function () {\n                    return tryFallbackBox(win);\n                  });\n                });\n              };\n            });\n            var setSelection = editor.setSelection.getOrThunk(function () {\n              return function (start, soffset, finish, foffset) {\n                setExact(win, start, soffset, finish, foffset);\n              };\n            });\n            var clearSelection = editor.clearSelection.getOrThunk(function () {\n              return function () {\n                clear$1(win);\n              };\n            });\n            return {\n              body: constant(body),\n              doc: constant(doc),\n              win: constant(win),\n              html: constant(html),\n              getSelection: curry(getSelectionFromFrame, frame),\n              setSelection: setSelection,\n              clearSelection: clearSelection,\n              frame: constant(frame),\n              onKeyup: getOrListen(editor, doc, 'onKeyup', 'keyup'),\n              onNodeChanged: getOrListen(editor, doc, 'onNodeChanged', 'SelectionChange'),\n              onDomChanged: editor.onDomChanged,\n              onScrollToCursor: editor.onScrollToCursor,\n              onScrollToElement: editor.onScrollToElement,\n              onToReading: editor.onToReading,\n              onToEditing: editor.onToEditing,\n              onToolbarScrollStart: editor.onToolbarScrollStart,\n              onTouchContent: editor.onTouchContent,\n              onTapContent: editor.onTapContent,\n              onTouchToolstrip: editor.onTouchToolstrip,\n              getCursorBox: getCursorBox\n            };\n          });\n        });\n      });\n    };\n    var PlatformEditor = {\n      getBody: getOrDerive('getBody', getBodyFromFrame),\n      getDoc: getOrDerive('getDoc', getDocFromFrame),\n      getWin: getOrDerive('getWin', getWinFromFrame),\n      getSelection: getOrDerive('getSelection', getSelectionFromFrame),\n      getFrame: getFrame,\n      getActiveApi: getActiveApi\n    };\n\n    var attr = 'data-ephox-mobile-fullscreen-style';\n    var siblingStyles = 'display:none!important;';\n    var ancestorPosition = 'position:absolute!important;';\n    var ancestorStyles = 'top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;';\n    var bgFallback = 'background-color:rgb(255,255,255)!important;';\n    var isAndroid = detect$3().os.isAndroid();\n    var matchColor = function (editorBody) {\n      var color = get$3(editorBody, 'background-color');\n      return color !== undefined && color !== '' ? 'background-color:' + color + '!important' : bgFallback;\n    };\n    var clobberStyles = function (container, editorBody) {\n      var gatherSibilings = function (element) {\n        var siblings = siblings$2(element, '*');\n        return siblings;\n      };\n      var clobber = function (clobberStyle) {\n        return function (element) {\n          var styles = get(element, 'style');\n          var backup = styles === undefined ? 'no-styles' : styles.trim();\n          if (backup === clobberStyle) {\n            return;\n          } else {\n            set(element, attr, backup);\n            set(element, 'style', clobberStyle);\n          }\n        };\n      };\n      var ancestors = ancestors$1(container, '*');\n      var siblings = bind(ancestors, gatherSibilings);\n      var bgColor = matchColor(editorBody);\n      each$1(siblings, clobber(siblingStyles));\n      each$1(ancestors, clobber(ancestorPosition + ancestorStyles + bgColor));\n      var containerStyles = isAndroid === true ? '' : ancestorPosition;\n      clobber(containerStyles + ancestorStyles + bgColor)(container);\n    };\n    var restoreStyles = function () {\n      var clobberedEls = all$2('[' + attr + ']');\n      each$1(clobberedEls, function (element) {\n        var restore = get(element, attr);\n        if (restore !== 'no-styles') {\n          set(element, 'style', restore);\n        } else {\n          remove$1(element, 'style');\n        }\n        remove$1(element, attr);\n      });\n    };\n    var Thor = {\n      clobberStyles: clobberStyles,\n      restoreStyles: restoreStyles\n    };\n\n    var tag = function () {\n      var head = first('head').getOrDie();\n      var nu = function () {\n        var meta = Element.fromTag('meta');\n        set(meta, 'name', 'viewport');\n        append(head, meta);\n        return meta;\n      };\n      var element = first('meta[name=\"viewport\"]').getOrThunk(nu);\n      var backup = get(element, 'content');\n      var maximize = function () {\n        set(element, 'content', 'width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0');\n      };\n      var restore = function () {\n        if (backup !== undefined && backup !== null && backup.length > 0) {\n          set(element, 'content', backup);\n        } else {\n          set(element, 'content', 'user-scalable=yes');\n        }\n      };\n      return {\n        maximize: maximize,\n        restore: restore\n      };\n    };\n    var MetaViewport = { tag: tag };\n\n    var create$4 = function (platform, mask) {\n      var meta = MetaViewport.tag();\n      var androidApi = api$2();\n      var androidEvents = api$2();\n      var enter = function () {\n        mask.hide();\n        add$2(platform.container, Styles.resolve('fullscreen-maximized'));\n        add$2(platform.container, Styles.resolve('android-maximized'));\n        meta.maximize();\n        add$2(platform.body, Styles.resolve('android-scroll-reload'));\n        androidApi.set(AndroidSetup.setup(platform.win, PlatformEditor.getWin(platform.editor).getOrDie('no')));\n        PlatformEditor.getActiveApi(platform.editor).each(function (editorApi) {\n          Thor.clobberStyles(platform.container, editorApi.body());\n          androidEvents.set(AndroidEvents.initEvents(editorApi, platform.toolstrip, platform.alloy));\n        });\n      };\n      var exit = function () {\n        meta.restore();\n        mask.show();\n        remove$4(platform.container, Styles.resolve('fullscreen-maximized'));\n        remove$4(platform.container, Styles.resolve('android-maximized'));\n        Thor.restoreStyles();\n        remove$4(platform.body, Styles.resolve('android-scroll-reload'));\n        androidEvents.clear();\n        androidApi.clear();\n      };\n      return {\n        enter: enter,\n        exit: exit\n      };\n    };\n    var AndroidMode = { create: create$4 };\n\n    var first$2 = function (fn, rate) {\n      var timer = null;\n      var cancel = function () {\n        if (timer !== null) {\n          domGlobals.clearTimeout(timer);\n          timer = null;\n        }\n      };\n      var throttle = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (timer === null) {\n          timer = domGlobals.setTimeout(function () {\n            fn.apply(null, args);\n            timer = null;\n          }, rate);\n        }\n      };\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n    var last$1 = function (fn, rate) {\n      var timer = null;\n      var cancel = function () {\n        if (timer !== null) {\n          domGlobals.clearTimeout(timer);\n          timer = null;\n        }\n      };\n      var throttle = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (timer !== null) {\n          domGlobals.clearTimeout(timer);\n        }\n        timer = domGlobals.setTimeout(function () {\n          fn.apply(null, args);\n          timer = null;\n        }, rate);\n      };\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n\n    var sketch$9 = function (onView, translate) {\n      var memIcon = record(Container.sketch({\n        dom: dom$1('<div aria-hidden=\"true\" class=\"${prefix}-mask-tap-icon\"></div>'),\n        containerBehaviours: derive$1([Toggling.config({\n            toggleClass: Styles.resolve('mask-tap-icon-selected'),\n            toggleOnExecute: false\n          })])\n      }));\n      var onViewThrottle = first$2(onView, 200);\n      return Container.sketch({\n        dom: dom$1('<div class=\"${prefix}-disabled-mask\"></div>'),\n        components: [Container.sketch({\n            dom: dom$1('<div class=\"${prefix}-content-container\"></div>'),\n            components: [Button.sketch({\n                dom: dom$1('<div class=\"${prefix}-content-tap-section\"></div>'),\n                components: [memIcon.asSpec()],\n                action: function (button) {\n                  onViewThrottle.throttle();\n                },\n                buttonBehaviours: derive$1([Toggling.config({ toggleClass: Styles.resolve('mask-tap-icon-selected') })])\n              })]\n          })]\n      });\n    };\n    var TapToEditMask = { sketch: sketch$9 };\n\n    var MobileSchema = objOf([\n      strictObjOf('editor', [\n        strict$1('getFrame'),\n        option('getBody'),\n        option('getDoc'),\n        option('getWin'),\n        option('getSelection'),\n        option('setSelection'),\n        option('clearSelection'),\n        option('cursorSaver'),\n        option('onKeyup'),\n        option('onNodeChanged'),\n        option('getCursorBox'),\n        strict$1('onDomChanged'),\n        defaulted$1('onTouchContent', noop),\n        defaulted$1('onTapContent', noop),\n        defaulted$1('onTouchToolstrip', noop),\n        defaulted$1('onScrollToCursor', constant({ unbind: noop })),\n        defaulted$1('onScrollToElement', constant({ unbind: noop })),\n        defaulted$1('onToEditing', constant({ unbind: noop })),\n        defaulted$1('onToReading', constant({ unbind: noop })),\n        defaulted$1('onToolbarScrollStart', identity)\n      ]),\n      strict$1('socket'),\n      strict$1('toolstrip'),\n      strict$1('dropup'),\n      strict$1('toolbar'),\n      strict$1('container'),\n      strict$1('alloy'),\n      state$1('win', function (spec) {\n        return owner(spec.socket).dom().defaultView;\n      }),\n      state$1('body', function (spec) {\n        return Element.fromDom(spec.socket.dom().ownerDocument.body);\n      }),\n      defaulted$1('translate', identity),\n      defaulted$1('setReadOnly', noop),\n      defaulted$1('readOnlyOnInit', constant(true))\n    ]);\n\n    var produce = function (raw) {\n      var mobile = asRawOrDie('Getting AndroidWebapp schema', MobileSchema, raw);\n      set$3(mobile.toolstrip, 'width', '100%');\n      var onTap = function () {\n        mobile.setReadOnly(mobile.readOnlyOnInit());\n        mode.enter();\n      };\n      var mask = build$1(TapToEditMask.sketch(onTap, mobile.translate));\n      mobile.alloy.add(mask);\n      var maskApi = {\n        show: function () {\n          mobile.alloy.add(mask);\n        },\n        hide: function () {\n          mobile.alloy.remove(mask);\n        }\n      };\n      append(mobile.container, mask.element());\n      var mode = AndroidMode.create(mobile, maskApi);\n      return {\n        setReadOnly: mobile.setReadOnly,\n        refreshStructure: noop,\n        enter: mode.enter,\n        exit: mode.exit,\n        destroy: noop\n      };\n    };\n    var AndroidWebapp = { produce: produce };\n\n    var schema$e = constant([\n      strict$1('dom'),\n      defaulted$1('shell', true),\n      field$1('toolbarBehaviours', [Replacing])\n    ]);\n    var enhanceGroups = function (detail) {\n      return { behaviours: derive$1([Replacing.config({})]) };\n    };\n    var parts$2 = constant([optional({\n        name: 'groups',\n        overrides: enhanceGroups\n      })]);\n\n    var factory$4 = function (detail, components, spec, _externals) {\n      var setGroups = function (toolbar, groups) {\n        getGroupContainer(toolbar).fold(function () {\n          domGlobals.console.error('Toolbar was defined to not be a shell, but no groups container was specified in components');\n          throw new Error('Toolbar was defined to not be a shell, but no groups container was specified in components');\n        }, function (container) {\n          Replacing.set(container, groups);\n        });\n      };\n      var getGroupContainer = function (component) {\n        return detail.shell ? Option.some(component) : getPart(component, detail, 'groups');\n      };\n      var extra = detail.shell ? {\n        behaviours: [Replacing.config({})],\n        components: []\n      } : {\n        behaviours: [],\n        components: components\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: extra.components,\n        behaviours: augment(detail.toolbarBehaviours, extra.behaviours),\n        apis: { setGroups: setGroups },\n        domModification: { attributes: { role: 'group' } }\n      };\n    };\n    var Toolbar = composite$1({\n      name: 'Toolbar',\n      configFields: schema$e(),\n      partFields: parts$2(),\n      factory: factory$4,\n      apis: {\n        setGroups: function (apis, toolbar, groups) {\n          apis.setGroups(toolbar, groups);\n        }\n      }\n    });\n\n    var schema$f = constant([\n      strict$1('items'),\n      markers(['itemSelector']),\n      field$1('tgroupBehaviours', [Keying])\n    ]);\n    var parts$3 = constant([group({\n        name: 'items',\n        unit: 'item'\n      })]);\n\n    var factory$5 = function (detail, components, spec, _externals) {\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: augment(detail.tgroupBehaviours, [Keying.config({\n            mode: 'flow',\n            selector: detail.markers.itemSelector\n          })]),\n        domModification: { attributes: { role: 'toolbar' } }\n      };\n    };\n    var ToolbarGroup = composite$1({\n      name: 'ToolbarGroup',\n      configFields: schema$f(),\n      partFields: parts$3(),\n      factory: factory$5\n    });\n\n    var dataHorizontal = 'data-' + Styles.resolve('horizontal-scroll');\n    var canScrollVertically = function (container) {\n      container.dom().scrollTop = 1;\n      var result = container.dom().scrollTop !== 0;\n      container.dom().scrollTop = 0;\n      return result;\n    };\n    var canScrollHorizontally = function (container) {\n      container.dom().scrollLeft = 1;\n      var result = container.dom().scrollLeft !== 0;\n      container.dom().scrollLeft = 0;\n      return result;\n    };\n    var hasVerticalScroll = function (container) {\n      return container.dom().scrollTop > 0 || canScrollVertically(container);\n    };\n    var hasHorizontalScroll = function (container) {\n      return container.dom().scrollLeft > 0 || canScrollHorizontally(container);\n    };\n    var markAsHorizontal = function (container) {\n      set(container, dataHorizontal, 'true');\n    };\n    var hasScroll = function (container) {\n      return get(container, dataHorizontal) === 'true' ? hasHorizontalScroll(container) : hasVerticalScroll(container);\n    };\n    var exclusive = function (scope, selector) {\n      return bind$3(scope, 'touchmove', function (event) {\n        closest$2(event.target(), selector).filter(hasScroll).fold(function () {\n          event.raw().preventDefault();\n        }, noop);\n      });\n    };\n    var Scrollables = {\n      exclusive: exclusive,\n      markAsHorizontal: markAsHorizontal\n    };\n\n    function ScrollingToolbar () {\n      var makeGroup = function (gSpec) {\n        var scrollClass = gSpec.scrollable === true ? '${prefix}-toolbar-scrollable-group' : '';\n        return {\n          dom: dom$1('<div aria-label=\"' + gSpec.label + '\" class=\"${prefix}-toolbar-group ' + scrollClass + '\"></div>'),\n          tgroupBehaviours: derive$1([config('adhoc-scrollable-toolbar', gSpec.scrollable === true ? [runOnInit(function (component, simulatedEvent) {\n                set$3(component.element(), 'overflow-x', 'auto');\n                Scrollables.markAsHorizontal(component.element());\n                Scrollable.register(component.element());\n              })] : [])]),\n          components: [Container.sketch({ components: [ToolbarGroup.parts().items({})] })],\n          markers: { itemSelector: '.' + Styles.resolve('toolbar-group-item') },\n          items: gSpec.items\n        };\n      };\n      var toolbar = build$1(Toolbar.sketch({\n        dom: dom$1('<div class=\"${prefix}-toolbar\"></div>'),\n        components: [Toolbar.parts().groups({})],\n        toolbarBehaviours: derive$1([\n          Toggling.config({\n            toggleClass: Styles.resolve('context-toolbar'),\n            toggleOnExecute: false,\n            aria: { mode: 'none' }\n          }),\n          Keying.config({ mode: 'cyclic' })\n        ]),\n        shell: true\n      }));\n      var wrapper = build$1(Container.sketch({\n        dom: { classes: [Styles.resolve('toolstrip')] },\n        components: [premade$1(toolbar)],\n        containerBehaviours: derive$1([Toggling.config({\n            toggleClass: Styles.resolve('android-selection-context-toolbar'),\n            toggleOnExecute: false\n          })])\n      }));\n      var resetGroups = function () {\n        Toolbar.setGroups(toolbar, initGroups.get());\n        Toggling.off(toolbar);\n      };\n      var initGroups = Cell([]);\n      var setGroups = function (gs) {\n        initGroups.set(gs);\n        resetGroups();\n      };\n      var createGroups = function (gs) {\n        return map$1(gs, compose(ToolbarGroup.sketch, makeGroup));\n      };\n      var refresh = function () {\n      };\n      var setContextToolbar = function (gs) {\n        Toggling.on(toolbar);\n        Toolbar.setGroups(toolbar, gs);\n      };\n      var restoreToolbar = function () {\n        if (Toggling.isOn(toolbar)) {\n          resetGroups();\n        }\n      };\n      var focus = function () {\n        Keying.focusIn(toolbar);\n      };\n      return {\n        wrapper: constant(wrapper),\n        toolbar: constant(toolbar),\n        createGroups: createGroups,\n        setGroups: setGroups,\n        setContextToolbar: setContextToolbar,\n        restoreToolbar: restoreToolbar,\n        refresh: refresh,\n        focus: focus\n      };\n    }\n\n    var makeEditSwitch = function (webapp) {\n      return build$1(Button.sketch({\n        dom: dom$1('<div class=\"${prefix}-mask-edit-icon ${prefix}-icon\"></div>'),\n        action: function () {\n          webapp.run(function (w) {\n            w.setReadOnly(false);\n          });\n        }\n      }));\n    };\n    var makeSocket = function () {\n      return build$1(Container.sketch({\n        dom: dom$1('<div class=\"${prefix}-editor-socket\"></div>'),\n        components: [],\n        containerBehaviours: derive$1([Replacing.config({})])\n      }));\n    };\n    var showEdit = function (socket, switchToEdit) {\n      Replacing.append(socket, premade$1(switchToEdit));\n    };\n    var hideEdit = function (socket, switchToEdit) {\n      Replacing.remove(socket, switchToEdit);\n    };\n    var updateMode = function (socket, switchToEdit, readOnly, root) {\n      var swap = readOnly === true ? Swapping.toAlpha : Swapping.toOmega;\n      swap(root);\n      var f = readOnly ? showEdit : hideEdit;\n      f(socket, switchToEdit);\n    };\n    var CommonRealm = {\n      makeEditSwitch: makeEditSwitch,\n      makeSocket: makeSocket,\n      updateMode: updateMode\n    };\n\n    var getAnimationRoot = function (component, slideConfig) {\n      return slideConfig.getAnimationRoot.fold(function () {\n        return component.element();\n      }, function (get) {\n        return get(component);\n      });\n    };\n\n    var getDimensionProperty = function (slideConfig) {\n      return slideConfig.dimension.property;\n    };\n    var getDimension = function (slideConfig, elem) {\n      return slideConfig.dimension.getDimension(elem);\n    };\n    var disableTransitions = function (component, slideConfig) {\n      var root = getAnimationRoot(component, slideConfig);\n      remove$6(root, [\n        slideConfig.shrinkingClass,\n        slideConfig.growingClass\n      ]);\n    };\n    var setShrunk = function (component, slideConfig) {\n      remove$4(component.element(), slideConfig.openClass);\n      add$2(component.element(), slideConfig.closedClass);\n      set$3(component.element(), getDimensionProperty(slideConfig), '0px');\n      reflow(component.element());\n    };\n    var setGrown = function (component, slideConfig) {\n      remove$4(component.element(), slideConfig.closedClass);\n      add$2(component.element(), slideConfig.openClass);\n      remove$5(component.element(), getDimensionProperty(slideConfig));\n    };\n    var doImmediateShrink = function (component, slideConfig, slideState, _calculatedSize) {\n      slideState.setCollapsed();\n      set$3(component.element(), getDimensionProperty(slideConfig), getDimension(slideConfig, component.element()));\n      reflow(component.element());\n      disableTransitions(component, slideConfig);\n      setShrunk(component, slideConfig);\n      slideConfig.onStartShrink(component);\n      slideConfig.onShrunk(component);\n    };\n    var doStartShrink = function (component, slideConfig, slideState, calculatedSize) {\n      var size = calculatedSize.getOrThunk(function () {\n        return getDimension(slideConfig, component.element());\n      });\n      slideState.setCollapsed();\n      set$3(component.element(), getDimensionProperty(slideConfig), size);\n      reflow(component.element());\n      var root = getAnimationRoot(component, slideConfig);\n      remove$4(root, slideConfig.growingClass);\n      add$2(root, slideConfig.shrinkingClass);\n      setShrunk(component, slideConfig);\n      slideConfig.onStartShrink(component);\n    };\n    var doStartSmartShrink = function (component, slideConfig, slideState) {\n      var size = getDimension(slideConfig, component.element());\n      var shrinker = size === '0px' ? doImmediateShrink : doStartShrink;\n      shrinker(component, slideConfig, slideState, Option.some(size));\n    };\n    var doStartGrow = function (component, slideConfig, slideState) {\n      var root = getAnimationRoot(component, slideConfig);\n      var wasShrinking = has$2(root, slideConfig.shrinkingClass);\n      var beforeSize = getDimension(slideConfig, component.element());\n      setGrown(component, slideConfig);\n      var fullSize = getDimension(slideConfig, component.element());\n      var startPartialGrow = function () {\n        set$3(component.element(), getDimensionProperty(slideConfig), beforeSize);\n        reflow(component.element());\n      };\n      var startCompleteGrow = function () {\n        setShrunk(component, slideConfig);\n      };\n      var setStartSize = wasShrinking ? startPartialGrow : startCompleteGrow;\n      setStartSize();\n      remove$4(root, slideConfig.shrinkingClass);\n      add$2(root, slideConfig.growingClass);\n      setGrown(component, slideConfig);\n      set$3(component.element(), getDimensionProperty(slideConfig), fullSize);\n      slideState.setExpanded();\n      slideConfig.onStartGrow(component);\n    };\n    var refresh = function (component, slideConfig, slideState) {\n      if (slideState.isExpanded()) {\n        remove$5(component.element(), getDimensionProperty(slideConfig));\n        var fullSize = getDimension(slideConfig, component.element());\n        set$3(component.element(), getDimensionProperty(slideConfig), fullSize);\n      }\n    };\n    var grow = function (component, slideConfig, slideState) {\n      if (!slideState.isExpanded()) {\n        doStartGrow(component, slideConfig, slideState);\n      }\n    };\n    var shrink = function (component, slideConfig, slideState) {\n      if (slideState.isExpanded()) {\n        doStartSmartShrink(component, slideConfig, slideState);\n      }\n    };\n    var immediateShrink = function (component, slideConfig, slideState) {\n      if (slideState.isExpanded()) {\n        doImmediateShrink(component, slideConfig, slideState);\n      }\n    };\n    var hasGrown = function (component, slideConfig, slideState) {\n      return slideState.isExpanded();\n    };\n    var hasShrunk = function (component, slideConfig, slideState) {\n      return slideState.isCollapsed();\n    };\n    var isGrowing = function (component, slideConfig, slideState) {\n      var root = getAnimationRoot(component, slideConfig);\n      return has$2(root, slideConfig.growingClass) === true;\n    };\n    var isShrinking = function (component, slideConfig, slideState) {\n      var root = getAnimationRoot(component, slideConfig);\n      return has$2(root, slideConfig.shrinkingClass) === true;\n    };\n    var isTransitioning = function (component, slideConfig, slideState) {\n      return isGrowing(component, slideConfig) === true || isShrinking(component, slideConfig) === true;\n    };\n    var toggleGrow = function (component, slideConfig, slideState) {\n      var f = slideState.isExpanded() ? doStartSmartShrink : doStartGrow;\n      f(component, slideConfig, slideState);\n    };\n\n    var SlidingApis = /*#__PURE__*/Object.freeze({\n        refresh: refresh,\n        grow: grow,\n        shrink: shrink,\n        immediateShrink: immediateShrink,\n        hasGrown: hasGrown,\n        hasShrunk: hasShrunk,\n        isGrowing: isGrowing,\n        isShrinking: isShrinking,\n        isTransitioning: isTransitioning,\n        toggleGrow: toggleGrow,\n        disableTransitions: disableTransitions\n    });\n\n    var exhibit$5 = function (base, slideConfig) {\n      var expanded = slideConfig.expanded;\n      return expanded ? nu$5({\n        classes: [slideConfig.openClass],\n        styles: {}\n      }) : nu$5({\n        classes: [slideConfig.closedClass],\n        styles: wrap$1(slideConfig.dimension.property, '0px')\n      });\n    };\n    var events$a = function (slideConfig, slideState) {\n      return derive([runOnSource(transitionend(), function (component, simulatedEvent) {\n          var raw = simulatedEvent.event().raw();\n          if (raw.propertyName === slideConfig.dimension.property) {\n            disableTransitions(component, slideConfig);\n            if (slideState.isExpanded()) {\n              remove$5(component.element(), slideConfig.dimension.property);\n            }\n            var notify = slideState.isExpanded() ? slideConfig.onGrown : slideConfig.onShrunk;\n            notify(component);\n          }\n        })]);\n    };\n\n    var ActiveSliding = /*#__PURE__*/Object.freeze({\n        exhibit: exhibit$5,\n        events: events$a\n    });\n\n    var SlidingSchema = [\n      strict$1('closedClass'),\n      strict$1('openClass'),\n      strict$1('shrinkingClass'),\n      strict$1('growingClass'),\n      option('getAnimationRoot'),\n      onHandler('onShrunk'),\n      onHandler('onStartShrink'),\n      onHandler('onGrown'),\n      onHandler('onStartGrow'),\n      defaulted$1('expanded', false),\n      strictOf('dimension', choose$1('property', {\n        width: [\n          output('property', 'width'),\n          output('getDimension', function (elem) {\n            return get$6(elem) + 'px';\n          })\n        ],\n        height: [\n          output('property', 'height'),\n          output('getDimension', function (elem) {\n            return get$4(elem) + 'px';\n          })\n        ]\n      }))\n    ];\n\n    var init$4 = function (spec) {\n      var state = Cell(spec.expanded);\n      var readState = function () {\n        return 'expanded: ' + state.get();\n      };\n      return nu$6({\n        isExpanded: function () {\n          return state.get() === true;\n        },\n        isCollapsed: function () {\n          return state.get() === false;\n        },\n        setCollapsed: curry(state.set, false),\n        setExpanded: curry(state.set, true),\n        readState: readState\n      });\n    };\n\n    var SlidingState = /*#__PURE__*/Object.freeze({\n        init: init$4\n    });\n\n    var Sliding = create$1({\n      fields: SlidingSchema,\n      name: 'sliding',\n      active: ActiveSliding,\n      apis: SlidingApis,\n      state: SlidingState\n    });\n\n    var build$2 = function (refresh, scrollIntoView) {\n      var dropup = build$1(Container.sketch({\n        dom: {\n          tag: 'div',\n          classes: [Styles.resolve('dropup')]\n        },\n        components: [],\n        containerBehaviours: derive$1([\n          Replacing.config({}),\n          Sliding.config({\n            closedClass: Styles.resolve('dropup-closed'),\n            openClass: Styles.resolve('dropup-open'),\n            shrinkingClass: Styles.resolve('dropup-shrinking'),\n            growingClass: Styles.resolve('dropup-growing'),\n            dimension: { property: 'height' },\n            onShrunk: function (component) {\n              refresh();\n              scrollIntoView();\n              Replacing.set(component, []);\n            },\n            onGrown: function (component) {\n              refresh();\n              scrollIntoView();\n            }\n          }),\n          Receivers.orientation(function (component, data) {\n            disappear(noop);\n          })\n        ])\n      }));\n      var appear = function (menu, update, component) {\n        if (Sliding.hasShrunk(dropup) === true && Sliding.isTransitioning(dropup) === false) {\n          domGlobals.window.requestAnimationFrame(function () {\n            update(component);\n            Replacing.set(dropup, [menu()]);\n            Sliding.grow(dropup);\n          });\n        }\n      };\n      var disappear = function (onReadyToShrink) {\n        domGlobals.window.requestAnimationFrame(function () {\n          onReadyToShrink();\n          Sliding.shrink(dropup);\n        });\n      };\n      return {\n        appear: appear,\n        disappear: disappear,\n        component: constant(dropup),\n        element: dropup.element\n      };\n    };\n\n    var closest$3 = function (scope, selector, isRoot) {\n      return closest$2(scope, selector, isRoot).isSome();\n    };\n\n    var isDangerous = function (event) {\n      var keyEv = event.raw();\n      return keyEv.which === BACKSPACE()[0] && !contains([\n        'input',\n        'textarea'\n      ], name(event.target())) && !closest$3(event.target(), '[contenteditable=\"true\"]');\n    };\n    var isFirefox = detect$3().browser.isFirefox();\n    var settingsSchema = objOfOnly([\n      strictFunction('triggerEvent'),\n      defaulted$1('stopBackspace', true)\n    ]);\n    var bindFocus = function (container, handler) {\n      if (isFirefox) {\n        return capture$1(container, 'focus', handler);\n      } else {\n        return bind$3(container, 'focusin', handler);\n      }\n    };\n    var bindBlur = function (container, handler) {\n      if (isFirefox) {\n        return capture$1(container, 'blur', handler);\n      } else {\n        return bind$3(container, 'focusout', handler);\n      }\n    };\n    var setup$2 = function (container, rawSettings) {\n      var settings = asRawOrDie('Getting GUI events settings', settingsSchema, rawSettings);\n      var pointerEvents = detect$3().deviceType.isTouch() ? [\n        'touchstart',\n        'touchmove',\n        'touchend',\n        'gesturestart'\n      ] : [\n        'mousedown',\n        'mouseup',\n        'mouseover',\n        'mousemove',\n        'mouseout',\n        'click'\n      ];\n      var tapEvent = monitor(settings);\n      var simpleEvents = map$1(pointerEvents.concat([\n        'selectstart',\n        'input',\n        'contextmenu',\n        'change',\n        'transitionend',\n        'drag',\n        'dragstart',\n        'dragend',\n        'dragenter',\n        'dragleave',\n        'dragover',\n        'drop',\n        'keyup'\n      ]), function (type) {\n        return bind$3(container, type, function (event) {\n          tapEvent.fireIfReady(event, type).each(function (tapStopped) {\n            if (tapStopped) {\n              event.kill();\n            }\n          });\n          var stopped = settings.triggerEvent(type, event);\n          if (stopped) {\n            event.kill();\n          }\n        });\n      });\n      var pasteTimeout = Cell(Option.none());\n      var onPaste = bind$3(container, 'paste', function (event) {\n        tapEvent.fireIfReady(event, 'paste').each(function (tapStopped) {\n          if (tapStopped) {\n            event.kill();\n          }\n        });\n        var stopped = settings.triggerEvent('paste', event);\n        if (stopped) {\n          event.kill();\n        }\n        pasteTimeout.set(Option.some(domGlobals.setTimeout(function () {\n          settings.triggerEvent(postPaste(), event);\n        }, 0)));\n      });\n      var onKeydown = bind$3(container, 'keydown', function (event) {\n        var stopped = settings.triggerEvent('keydown', event);\n        if (stopped) {\n          event.kill();\n        } else if (settings.stopBackspace === true && isDangerous(event)) {\n          event.prevent();\n        }\n      });\n      var onFocusIn = bindFocus(container, function (event) {\n        var stopped = settings.triggerEvent('focusin', event);\n        if (stopped) {\n          event.kill();\n        }\n      });\n      var focusoutTimeout = Cell(Option.none());\n      var onFocusOut = bindBlur(container, function (event) {\n        var stopped = settings.triggerEvent('focusout', event);\n        if (stopped) {\n          event.kill();\n        }\n        focusoutTimeout.set(Option.some(domGlobals.setTimeout(function () {\n          settings.triggerEvent(postBlur(), event);\n        }, 0)));\n      });\n      var unbind = function () {\n        each$1(simpleEvents, function (e) {\n          e.unbind();\n        });\n        onKeydown.unbind();\n        onFocusIn.unbind();\n        onFocusOut.unbind();\n        onPaste.unbind();\n        pasteTimeout.get().each(domGlobals.clearTimeout);\n        focusoutTimeout.get().each(domGlobals.clearTimeout);\n      };\n      return { unbind: unbind };\n    };\n\n    var derive$2 = function (rawEvent, rawTarget) {\n      var source = readOptFrom$1(rawEvent, 'target').map(function (getTarget) {\n        return getTarget();\n      }).getOr(rawTarget);\n      return Cell(source);\n    };\n\n    var fromSource = function (event, source) {\n      var stopper = Cell(false);\n      var cutter = Cell(false);\n      var stop = function () {\n        stopper.set(true);\n      };\n      var cut = function () {\n        cutter.set(true);\n      };\n      return {\n        stop: stop,\n        cut: cut,\n        isStopped: stopper.get,\n        isCut: cutter.get,\n        event: constant(event),\n        setSource: source.set,\n        getSource: source.get\n      };\n    };\n    var fromExternal = function (event) {\n      var stopper = Cell(false);\n      var stop = function () {\n        stopper.set(true);\n      };\n      return {\n        stop: stop,\n        cut: noop,\n        isStopped: stopper.get,\n        isCut: constant(false),\n        event: constant(event),\n        setSource: die('Cannot set source of a broadcasted event'),\n        getSource: die('Cannot get source of a broadcasted event')\n      };\n    };\n\n    var adt$7 = Adt.generate([\n      { stopped: [] },\n      { resume: ['element'] },\n      { complete: [] }\n    ]);\n    var doTriggerHandler = function (lookup, eventType, rawEvent, target, source, logger) {\n      var handler = lookup(eventType, target);\n      var simulatedEvent = fromSource(rawEvent, source);\n      return handler.fold(function () {\n        logger.logEventNoHandlers(eventType, target);\n        return adt$7.complete();\n      }, function (handlerInfo) {\n        var descHandler = handlerInfo.descHandler();\n        var eventHandler = getCurried(descHandler);\n        eventHandler(simulatedEvent);\n        if (simulatedEvent.isStopped()) {\n          logger.logEventStopped(eventType, handlerInfo.element(), descHandler.purpose());\n          return adt$7.stopped();\n        } else if (simulatedEvent.isCut()) {\n          logger.logEventCut(eventType, handlerInfo.element(), descHandler.purpose());\n          return adt$7.complete();\n        } else {\n          return parent(handlerInfo.element()).fold(function () {\n            logger.logNoParent(eventType, handlerInfo.element(), descHandler.purpose());\n            return adt$7.complete();\n          }, function (parent) {\n            logger.logEventResponse(eventType, handlerInfo.element(), descHandler.purpose());\n            return adt$7.resume(parent);\n          });\n        }\n      });\n    };\n    var doTriggerOnUntilStopped = function (lookup, eventType, rawEvent, rawTarget, source, logger) {\n      return doTriggerHandler(lookup, eventType, rawEvent, rawTarget, source, logger).fold(function () {\n        return true;\n      }, function (parent) {\n        return doTriggerOnUntilStopped(lookup, eventType, rawEvent, parent, source, logger);\n      }, function () {\n        return false;\n      });\n    };\n    var triggerHandler = function (lookup, eventType, rawEvent, target, logger) {\n      var source = derive$2(rawEvent, target);\n      return doTriggerHandler(lookup, eventType, rawEvent, target, source, logger);\n    };\n    var broadcast = function (listeners, rawEvent, logger) {\n      var simulatedEvent = fromExternal(rawEvent);\n      each$1(listeners, function (listener) {\n        var descHandler = listener.descHandler();\n        var handler = getCurried(descHandler);\n        handler(simulatedEvent);\n      });\n      return simulatedEvent.isStopped();\n    };\n    var triggerUntilStopped = function (lookup, eventType, rawEvent, logger) {\n      var rawTarget = rawEvent.target();\n      return triggerOnUntilStopped(lookup, eventType, rawEvent, rawTarget, logger);\n    };\n    var triggerOnUntilStopped = function (lookup, eventType, rawEvent, rawTarget, logger) {\n      var source = derive$2(rawEvent, rawTarget);\n      return doTriggerOnUntilStopped(lookup, eventType, rawEvent, rawTarget, source, logger);\n    };\n\n    var eventHandler = Immutable('element', 'descHandler');\n    var broadcastHandler = function (id, handler) {\n      return {\n        id: constant(id),\n        descHandler: constant(handler)\n      };\n    };\n    function EventRegistry () {\n      var registry = {};\n      var registerId = function (extraArgs, id, events) {\n        each(events, function (v, k) {\n          var handlers = registry[k] !== undefined ? registry[k] : {};\n          handlers[id] = curryArgs(v, extraArgs);\n          registry[k] = handlers;\n        });\n      };\n      var findHandler = function (handlers, elem) {\n        return read$2(elem).fold(function () {\n          return Option.none();\n        }, function (id) {\n          var reader = readOpt$1(id);\n          return handlers.bind(reader).map(function (descHandler) {\n            return eventHandler(elem, descHandler);\n          });\n        });\n      };\n      var filterByType = function (type) {\n        return readOptFrom$1(registry, type).map(function (handlers) {\n          return mapToArray(handlers, function (f, id) {\n            return broadcastHandler(id, f);\n          });\n        }).getOr([]);\n      };\n      var find = function (isAboveRoot, type, target) {\n        var readType = readOpt$1(type);\n        var handlers = readType(registry);\n        return closest$1(target, function (elem) {\n          return findHandler(handlers, elem);\n        }, isAboveRoot);\n      };\n      var unregisterId = function (id) {\n        each(registry, function (handlersById, eventName) {\n          if (handlersById.hasOwnProperty(id)) {\n            delete handlersById[id];\n          }\n        });\n      };\n      return {\n        registerId: registerId,\n        unregisterId: unregisterId,\n        filterByType: filterByType,\n        find: find\n      };\n    }\n\n    function Registry () {\n      var events = EventRegistry();\n      var components = {};\n      var readOrTag = function (component) {\n        var elem = component.element();\n        return read$2(elem).fold(function () {\n          return write('uid-', component.element());\n        }, function (uid) {\n          return uid;\n        });\n      };\n      var failOnDuplicate = function (component, tagId) {\n        var conflict = components[tagId];\n        if (conflict === component) {\n          unregister(component);\n        } else {\n          throw new Error('The tagId \"' + tagId + '\" is already used by: ' + element(conflict.element()) + '\\nCannot use it for: ' + element(component.element()) + '\\n' + 'The conflicting element is' + (inBody(conflict.element()) ? ' ' : ' not ') + 'already in the DOM');\n        }\n      };\n      var register = function (component) {\n        var tagId = readOrTag(component);\n        if (hasKey$1(components, tagId)) {\n          failOnDuplicate(component, tagId);\n        }\n        var extraArgs = [component];\n        events.registerId(extraArgs, tagId, component.events());\n        components[tagId] = component;\n      };\n      var unregister = function (component) {\n        read$2(component.element()).each(function (tagId) {\n          delete components[tagId];\n          events.unregisterId(tagId);\n        });\n      };\n      var filter = function (type) {\n        return events.filterByType(type);\n      };\n      var find = function (isAboveRoot, type, target) {\n        return events.find(isAboveRoot, type, target);\n      };\n      var getById = function (id) {\n        return readOpt$1(id)(components);\n      };\n      return {\n        find: find,\n        filter: filter,\n        register: register,\n        unregister: unregister,\n        getById: getById\n      };\n    }\n\n    var takeover = function (root) {\n      var isAboveRoot = function (el) {\n        return parent(root.element()).fold(function () {\n          return true;\n        }, function (parent) {\n          return eq(el, parent);\n        });\n      };\n      var registry = Registry();\n      var lookup = function (eventName, target) {\n        return registry.find(isAboveRoot, eventName, target);\n      };\n      var domEvents = setup$2(root.element(), {\n        triggerEvent: function (eventName, event) {\n          return monitorEvent(eventName, event.target(), function (logger) {\n            return triggerUntilStopped(lookup, eventName, event, logger);\n          });\n        }\n      });\n      var systemApi = {\n        debugInfo: constant('real'),\n        triggerEvent: function (eventName, target, data) {\n          monitorEvent(eventName, target, function (logger) {\n            triggerOnUntilStopped(lookup, eventName, data, target, logger);\n          });\n        },\n        triggerFocus: function (target, originator) {\n          read$2(target).fold(function () {\n            focus$1(target);\n          }, function (_alloyId) {\n            monitorEvent(focus(), target, function (logger) {\n              triggerHandler(lookup, focus(), {\n                originator: constant(originator),\n                kill: noop,\n                prevent: noop,\n                target: constant(target)\n              }, target, logger);\n            });\n          });\n        },\n        triggerEscape: function (comp, simulatedEvent) {\n          systemApi.triggerEvent('keydown', comp.element(), simulatedEvent.event());\n        },\n        getByUid: function (uid) {\n          return getByUid(uid);\n        },\n        getByDom: function (elem) {\n          return getByDom(elem);\n        },\n        build: build$1,\n        addToGui: function (c) {\n          add(c);\n        },\n        removeFromGui: function (c) {\n          remove$1(c);\n        },\n        addToWorld: function (c) {\n          addToWorld(c);\n        },\n        removeFromWorld: function (c) {\n          removeFromWorld(c);\n        },\n        broadcast: function (message) {\n          broadcast$1(message);\n        },\n        broadcastOn: function (channels, message) {\n          broadcastOn(channels, message);\n        },\n        broadcastEvent: function (eventName, event) {\n          broadcastEvent(eventName, event);\n        },\n        isConnected: constant(true)\n      };\n      var addToWorld = function (component) {\n        component.connect(systemApi);\n        if (!isText(component.element())) {\n          registry.register(component);\n          each$1(component.components(), addToWorld);\n          systemApi.triggerEvent(systemInit(), component.element(), { target: constant(component.element()) });\n        }\n      };\n      var removeFromWorld = function (component) {\n        if (!isText(component.element())) {\n          each$1(component.components(), removeFromWorld);\n          registry.unregister(component);\n        }\n        component.disconnect();\n      };\n      var add = function (component) {\n        attach$1(root, component);\n      };\n      var remove$1 = function (component) {\n        detach(component);\n      };\n      var destroy = function () {\n        domEvents.unbind();\n        remove(root.element());\n      };\n      var broadcastData = function (data) {\n        var receivers = registry.filter(receive());\n        each$1(receivers, function (receiver) {\n          var descHandler = receiver.descHandler();\n          var handler = getCurried(descHandler);\n          handler(data);\n        });\n      };\n      var broadcast$1 = function (message) {\n        broadcastData({\n          universal: constant(true),\n          data: constant(message)\n        });\n      };\n      var broadcastOn = function (channels, message) {\n        broadcastData({\n          universal: constant(false),\n          channels: constant(channels),\n          data: constant(message)\n        });\n      };\n      var broadcastEvent = function (eventName, event) {\n        var listeners = registry.filter(eventName);\n        return broadcast(listeners, event);\n      };\n      var getByUid = function (uid) {\n        return registry.getById(uid).fold(function () {\n          return Result.error(new Error('Could not find component with uid: \"' + uid + '\" in system.'));\n        }, Result.value);\n      };\n      var getByDom = function (elem) {\n        var uid = read$2(elem).getOr('not found');\n        return getByUid(uid);\n      };\n      addToWorld(root);\n      return {\n        root: constant(root),\n        element: root.element,\n        destroy: destroy,\n        add: add,\n        remove: remove$1,\n        getByUid: getByUid,\n        getByDom: getByDom,\n        addToWorld: addToWorld,\n        removeFromWorld: removeFromWorld,\n        broadcast: broadcast$1,\n        broadcastOn: broadcastOn,\n        broadcastEvent: broadcastEvent\n      };\n    };\n\n    var READ_ONLY_MODE_CLASS = constant(Styles.resolve('readonly-mode'));\n    var EDIT_MODE_CLASS = constant(Styles.resolve('edit-mode'));\n    function OuterContainer (spec) {\n      var root = build$1(Container.sketch({\n        dom: { classes: [Styles.resolve('outer-container')].concat(spec.classes) },\n        containerBehaviours: derive$1([Swapping.config({\n            alpha: READ_ONLY_MODE_CLASS(),\n            omega: EDIT_MODE_CLASS()\n          })])\n      }));\n      return takeover(root);\n    }\n\n    function AndroidRealm (scrollIntoView) {\n      var alloy = OuterContainer({ classes: [Styles.resolve('android-container')] });\n      var toolbar = ScrollingToolbar();\n      var webapp = api$2();\n      var switchToEdit = CommonRealm.makeEditSwitch(webapp);\n      var socket = CommonRealm.makeSocket();\n      var dropup = build$2(noop, scrollIntoView);\n      alloy.add(toolbar.wrapper());\n      alloy.add(socket);\n      alloy.add(dropup.component());\n      var setToolbarGroups = function (rawGroups) {\n        var groups = toolbar.createGroups(rawGroups);\n        toolbar.setGroups(groups);\n      };\n      var setContextToolbar = function (rawGroups) {\n        var groups = toolbar.createGroups(rawGroups);\n        toolbar.setContextToolbar(groups);\n      };\n      var focusToolbar = function () {\n        toolbar.focus();\n      };\n      var restoreToolbar = function () {\n        toolbar.restoreToolbar();\n      };\n      var init = function (spec) {\n        webapp.set(AndroidWebapp.produce(spec));\n      };\n      var exit = function () {\n        webapp.run(function (w) {\n          w.exit();\n          Replacing.remove(socket, switchToEdit);\n        });\n      };\n      var updateMode = function (readOnly) {\n        CommonRealm.updateMode(socket, switchToEdit, readOnly, alloy.root());\n      };\n      return {\n        system: constant(alloy),\n        element: alloy.element,\n        init: init,\n        exit: exit,\n        setToolbarGroups: setToolbarGroups,\n        setContextToolbar: setContextToolbar,\n        focusToolbar: focusToolbar,\n        restoreToolbar: restoreToolbar,\n        updateMode: updateMode,\n        socket: constant(socket),\n        dropup: constant(dropup)\n      };\n    }\n\n    var input$1 = function (parent, operation) {\n      var input = Element.fromTag('input');\n      setAll$1(input, {\n        opacity: '0',\n        position: 'absolute',\n        top: '-1000px',\n        left: '-1000px'\n      });\n      append(parent, input);\n      focus$1(input);\n      operation(input);\n      remove(input);\n    };\n    var CaptureBin = { input: input$1 };\n\n    var refreshInput = function (input) {\n      var start = input.dom().selectionStart;\n      var end = input.dom().selectionEnd;\n      var dir = input.dom().selectionDirection;\n      global$4.setTimeout(function () {\n        input.dom().setSelectionRange(start, end, dir);\n        focus$1(input);\n      }, 50);\n    };\n    var refresh$1 = function (winScope) {\n      var sel = winScope.getSelection();\n      if (sel.rangeCount > 0) {\n        var br = sel.getRangeAt(0);\n        var r = winScope.document.createRange();\n        r.setStart(br.startContainer, br.startOffset);\n        r.setEnd(br.endContainer, br.endOffset);\n        sel.removeAllRanges();\n        sel.addRange(r);\n      }\n    };\n    var CursorRefresh = {\n      refreshInput: refreshInput,\n      refresh: refresh$1\n    };\n\n    var resume$1 = function (cWin, frame) {\n      active().each(function (active) {\n        if (!eq(active, frame)) {\n          blur(active);\n        }\n      });\n      cWin.focus();\n      focus$1(Element.fromDom(cWin.document.body));\n      CursorRefresh.refresh(cWin);\n    };\n    var ResumeEditing$1 = { resume: resume$1 };\n\n    var stubborn = function (outerBody, cWin, page, frame) {\n      var toEditing = function () {\n        ResumeEditing$1.resume(cWin, frame);\n      };\n      var toReading = function () {\n        CaptureBin.input(outerBody, blur);\n      };\n      var captureInput = bind$3(page, 'keydown', function (evt) {\n        if (!contains([\n            'input',\n            'textarea'\n          ], name(evt.target()))) {\n          toEditing();\n        }\n      });\n      var onToolbarTouch = function () {\n      };\n      var destroy = function () {\n        captureInput.unbind();\n      };\n      return {\n        toReading: toReading,\n        toEditing: toEditing,\n        onToolbarTouch: onToolbarTouch,\n        destroy: destroy\n      };\n    };\n    var timid = function (outerBody, cWin, page, frame) {\n      var dismissKeyboard = function () {\n        blur(frame);\n      };\n      var onToolbarTouch = function () {\n        dismissKeyboard();\n      };\n      var toReading = function () {\n        dismissKeyboard();\n      };\n      var toEditing = function () {\n        ResumeEditing$1.resume(cWin, frame);\n      };\n      return {\n        toReading: toReading,\n        toEditing: toEditing,\n        onToolbarTouch: onToolbarTouch,\n        destroy: noop\n      };\n    };\n    var IosKeyboard = {\n      stubborn: stubborn,\n      timid: timid\n    };\n\n    var initEvents$1 = function (editorApi, iosApi, toolstrip, socket, dropup) {\n      var saveSelectionFirst = function () {\n        iosApi.run(function (api) {\n          api.highlightSelection();\n        });\n      };\n      var refreshIosSelection = function () {\n        iosApi.run(function (api) {\n          api.refreshSelection();\n        });\n      };\n      var scrollToY = function (yTop, height) {\n        var y = yTop - socket.dom().scrollTop;\n        iosApi.run(function (api) {\n          api.scrollIntoView(y, y + height);\n        });\n      };\n      var scrollToElement = function (target) {\n        scrollToY(iosApi, socket);\n      };\n      var scrollToCursor = function () {\n        editorApi.getCursorBox().each(function (box) {\n          scrollToY(box.top(), box.height());\n        });\n      };\n      var clearSelection = function () {\n        iosApi.run(function (api) {\n          api.clearSelection();\n        });\n      };\n      var clearAndRefresh = function () {\n        clearSelection();\n        refreshThrottle.throttle();\n      };\n      var refreshView = function () {\n        scrollToCursor();\n        iosApi.run(function (api) {\n          api.syncHeight();\n        });\n      };\n      var reposition = function () {\n        var toolbarHeight = get$4(toolstrip);\n        iosApi.run(function (api) {\n          api.setViewportOffset(toolbarHeight);\n        });\n        refreshIosSelection();\n        refreshView();\n      };\n      var toEditing = function () {\n        iosApi.run(function (api) {\n          api.toEditing();\n        });\n      };\n      var toReading = function () {\n        iosApi.run(function (api) {\n          api.toReading();\n        });\n      };\n      var onToolbarTouch = function (event) {\n        iosApi.run(function (api) {\n          api.onToolbarTouch(event);\n        });\n      };\n      var tapping = TappingEvent.monitor(editorApi);\n      var refreshThrottle = last$1(refreshView, 300);\n      var listeners = [\n        editorApi.onKeyup(clearAndRefresh),\n        editorApi.onNodeChanged(refreshIosSelection),\n        editorApi.onDomChanged(refreshThrottle.throttle),\n        editorApi.onDomChanged(refreshIosSelection),\n        editorApi.onScrollToCursor(function (tinyEvent) {\n          tinyEvent.preventDefault();\n          refreshThrottle.throttle();\n        }),\n        editorApi.onScrollToElement(function (event) {\n          scrollToElement(event.element());\n        }),\n        editorApi.onToEditing(toEditing),\n        editorApi.onToReading(toReading),\n        bind$3(editorApi.doc(), 'touchend', function (touchEvent) {\n          if (eq(editorApi.html(), touchEvent.target()) || eq(editorApi.body(), touchEvent.target())) ;\n        }),\n        bind$3(toolstrip, 'transitionend', function (transitionEvent) {\n          if (transitionEvent.raw().propertyName === 'height') {\n            reposition();\n          }\n        }),\n        capture$1(toolstrip, 'touchstart', function (touchEvent) {\n          saveSelectionFirst();\n          onToolbarTouch(touchEvent);\n          editorApi.onTouchToolstrip();\n        }),\n        bind$3(editorApi.body(), 'touchstart', function (evt) {\n          clearSelection();\n          editorApi.onTouchContent();\n          tapping.fireTouchstart(evt);\n        }),\n        tapping.onTouchmove(),\n        tapping.onTouchend(),\n        bind$3(editorApi.body(), 'click', function (event) {\n          event.kill();\n        }),\n        bind$3(toolstrip, 'touchmove', function () {\n          editorApi.onToolbarScrollStart();\n        })\n      ];\n      var destroy = function () {\n        each$1(listeners, function (l) {\n          l.unbind();\n        });\n      };\n      return { destroy: destroy };\n    };\n    var IosEvents = { initEvents: initEvents$1 };\n\n    function FakeSelection (win, frame) {\n      var doc = win.document;\n      var container = Element.fromTag('div');\n      add$2(container, Styles.resolve('unfocused-selections'));\n      append(Element.fromDom(doc.documentElement), container);\n      var onTouch = bind$3(container, 'touchstart', function (event) {\n        event.prevent();\n        ResumeEditing$1.resume(win, frame);\n        clear();\n      });\n      var make = function (rectangle) {\n        var span = Element.fromTag('span');\n        add$3(span, [\n          Styles.resolve('layer-editor'),\n          Styles.resolve('unfocused-selection')\n        ]);\n        setAll$1(span, {\n          left: rectangle.left() + 'px',\n          top: rectangle.top() + 'px',\n          width: rectangle.width() + 'px',\n          height: rectangle.height() + 'px'\n        });\n        return span;\n      };\n      var update = function () {\n        clear();\n        var rectangles = Rectangles.getRectangles(win);\n        var spans = map$1(rectangles, make);\n        append$1(container, spans);\n      };\n      var clear = function () {\n        empty(container);\n      };\n      var destroy = function () {\n        onTouch.unbind();\n        remove(container);\n      };\n      var isActive = function () {\n        return children(container).length > 0;\n      };\n      return {\n        update: update,\n        isActive: isActive,\n        destroy: destroy,\n        clear: clear\n      };\n    }\n\n    var exports$1 = {}, module = { exports: exports$1 };\n    (function (define, exports, module, require) {\n      (function (f) {\n        if (typeof exports === 'object' && typeof module !== 'undefined') {\n          module.exports = f();\n        } else if (typeof define === 'function' && define.amd) {\n          define([], f);\n        } else {\n          var g;\n          if (typeof window !== 'undefined') {\n            g = window;\n          } else if (typeof global !== 'undefined') {\n            g = global;\n          } else if (typeof self !== 'undefined') {\n            g = self;\n          } else {\n            g = this;\n          }\n          g.EphoxContactWrapper = f();\n        }\n      }(function () {\n        return function () {\n          function r(e, n, t) {\n            function o(i, f) {\n              if (!n[i]) {\n                if (!e[i]) {\n                  var c = 'function' == typeof require && require;\n                  if (!f && c)\n                    return c(i, !0);\n                  if (u)\n                    return u(i, !0);\n                  var a = new Error('Cannot find module \\'' + i + '\\'');\n                  throw a.code = 'MODULE_NOT_FOUND', a;\n                }\n                var p = n[i] = { exports: {} };\n                e[i][0].call(p.exports, function (r) {\n                  var n = e[i][1][r];\n                  return o(n || r);\n                }, p, p.exports, r, e, n, t);\n              }\n              return n[i].exports;\n            }\n            for (var u = 'function' == typeof require && require, i = 0; i < t.length; i++)\n              o(t[i]);\n            return o;\n          }\n          return r;\n        }()({\n          1: [\n            function (require, module, exports) {\n              var process = module.exports = {};\n              var cachedSetTimeout;\n              var cachedClearTimeout;\n              function defaultSetTimout() {\n                throw new Error('setTimeout has not been defined');\n              }\n              function defaultClearTimeout() {\n                throw new Error('clearTimeout has not been defined');\n              }\n              (function () {\n                try {\n                  if (typeof setTimeout === 'function') {\n                    cachedSetTimeout = setTimeout;\n                  } else {\n                    cachedSetTimeout = defaultSetTimout;\n                  }\n                } catch (e) {\n                  cachedSetTimeout = defaultSetTimout;\n                }\n                try {\n                  if (typeof clearTimeout === 'function') {\n                    cachedClearTimeout = clearTimeout;\n                  } else {\n                    cachedClearTimeout = defaultClearTimeout;\n                  }\n                } catch (e) {\n                  cachedClearTimeout = defaultClearTimeout;\n                }\n              }());\n              function runTimeout(fun) {\n                if (cachedSetTimeout === setTimeout) {\n                  return setTimeout(fun, 0);\n                }\n                if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n                  cachedSetTimeout = setTimeout;\n                  return setTimeout(fun, 0);\n                }\n                try {\n                  return cachedSetTimeout(fun, 0);\n                } catch (e) {\n                  try {\n                    return cachedSetTimeout.call(null, fun, 0);\n                  } catch (e) {\n                    return cachedSetTimeout.call(this, fun, 0);\n                  }\n                }\n              }\n              function runClearTimeout(marker) {\n                if (cachedClearTimeout === clearTimeout) {\n                  return clearTimeout(marker);\n                }\n                if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n                  cachedClearTimeout = clearTimeout;\n                  return clearTimeout(marker);\n                }\n                try {\n                  return cachedClearTimeout(marker);\n                } catch (e) {\n                  try {\n                    return cachedClearTimeout.call(null, marker);\n                  } catch (e) {\n                    return cachedClearTimeout.call(this, marker);\n                  }\n                }\n              }\n              var queue = [];\n              var draining = false;\n              var currentQueue;\n              var queueIndex = -1;\n              function cleanUpNextTick() {\n                if (!draining || !currentQueue) {\n                  return;\n                }\n                draining = false;\n                if (currentQueue.length) {\n                  queue = currentQueue.concat(queue);\n                } else {\n                  queueIndex = -1;\n                }\n                if (queue.length) {\n                  drainQueue();\n                }\n              }\n              function drainQueue() {\n                if (draining) {\n                  return;\n                }\n                var timeout = runTimeout(cleanUpNextTick);\n                draining = true;\n                var len = queue.length;\n                while (len) {\n                  currentQueue = queue;\n                  queue = [];\n                  while (++queueIndex < len) {\n                    if (currentQueue) {\n                      currentQueue[queueIndex].run();\n                    }\n                  }\n                  queueIndex = -1;\n                  len = queue.length;\n                }\n                currentQueue = null;\n                draining = false;\n                runClearTimeout(timeout);\n              }\n              process.nextTick = function (fun) {\n                var args = new Array(arguments.length - 1);\n                if (arguments.length > 1) {\n                  for (var i = 1; i < arguments.length; i++) {\n                    args[i - 1] = arguments[i];\n                  }\n                }\n                queue.push(new Item(fun, args));\n                if (queue.length === 1 && !draining) {\n                  runTimeout(drainQueue);\n                }\n              };\n              function Item(fun, array) {\n                this.fun = fun;\n                this.array = array;\n              }\n              Item.prototype.run = function () {\n                this.fun.apply(null, this.array);\n              };\n              process.title = 'browser';\n              process.browser = true;\n              process.env = {};\n              process.argv = [];\n              process.version = '';\n              process.versions = {};\n              function noop() {\n              }\n              process.on = noop;\n              process.addListener = noop;\n              process.once = noop;\n              process.off = noop;\n              process.removeListener = noop;\n              process.removeAllListeners = noop;\n              process.emit = noop;\n              process.prependListener = noop;\n              process.prependOnceListener = noop;\n              process.listeners = function (name) {\n                return [];\n              };\n              process.binding = function (name) {\n                throw new Error('process.binding is not supported');\n              };\n              process.cwd = function () {\n                return '/';\n              };\n              process.chdir = function (dir) {\n                throw new Error('process.chdir is not supported');\n              };\n              process.umask = function () {\n                return 0;\n              };\n            },\n            {}\n          ],\n          2: [\n            function (require, module, exports) {\n              (function (setImmediate) {\n                (function (root) {\n                  var setTimeoutFunc = setTimeout;\n                  function noop() {\n                  }\n                  function bind(fn, thisArg) {\n                    return function () {\n                      fn.apply(thisArg, arguments);\n                    };\n                  }\n                  function Promise(fn) {\n                    if (typeof this !== 'object')\n                      throw new TypeError('Promises must be constructed via new');\n                    if (typeof fn !== 'function')\n                      throw new TypeError('not a function');\n                    this._state = 0;\n                    this._handled = false;\n                    this._value = undefined;\n                    this._deferreds = [];\n                    doResolve(fn, this);\n                  }\n                  function handle(self, deferred) {\n                    while (self._state === 3) {\n                      self = self._value;\n                    }\n                    if (self._state === 0) {\n                      self._deferreds.push(deferred);\n                      return;\n                    }\n                    self._handled = true;\n                    Promise._immediateFn(function () {\n                      var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n                      if (cb === null) {\n                        (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n                        return;\n                      }\n                      var ret;\n                      try {\n                        ret = cb(self._value);\n                      } catch (e) {\n                        reject(deferred.promise, e);\n                        return;\n                      }\n                      resolve(deferred.promise, ret);\n                    });\n                  }\n                  function resolve(self, newValue) {\n                    try {\n                      if (newValue === self)\n                        throw new TypeError('A promise cannot be resolved with itself.');\n                      if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n                        var then = newValue.then;\n                        if (newValue instanceof Promise) {\n                          self._state = 3;\n                          self._value = newValue;\n                          finale(self);\n                          return;\n                        } else if (typeof then === 'function') {\n                          doResolve(bind(then, newValue), self);\n                          return;\n                        }\n                      }\n                      self._state = 1;\n                      self._value = newValue;\n                      finale(self);\n                    } catch (e) {\n                      reject(self, e);\n                    }\n                  }\n                  function reject(self, newValue) {\n                    self._state = 2;\n                    self._value = newValue;\n                    finale(self);\n                  }\n                  function finale(self) {\n                    if (self._state === 2 && self._deferreds.length === 0) {\n                      Promise._immediateFn(function () {\n                        if (!self._handled) {\n                          Promise._unhandledRejectionFn(self._value);\n                        }\n                      });\n                    }\n                    for (var i = 0, len = self._deferreds.length; i < len; i++) {\n                      handle(self, self._deferreds[i]);\n                    }\n                    self._deferreds = null;\n                  }\n                  function Handler(onFulfilled, onRejected, promise) {\n                    this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n                    this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n                    this.promise = promise;\n                  }\n                  function doResolve(fn, self) {\n                    var done = false;\n                    try {\n                      fn(function (value) {\n                        if (done)\n                          return;\n                        done = true;\n                        resolve(self, value);\n                      }, function (reason) {\n                        if (done)\n                          return;\n                        done = true;\n                        reject(self, reason);\n                      });\n                    } catch (ex) {\n                      if (done)\n                        return;\n                      done = true;\n                      reject(self, ex);\n                    }\n                  }\n                  Promise.prototype['catch'] = function (onRejected) {\n                    return this.then(null, onRejected);\n                  };\n                  Promise.prototype.then = function (onFulfilled, onRejected) {\n                    var prom = new this.constructor(noop);\n                    handle(this, new Handler(onFulfilled, onRejected, prom));\n                    return prom;\n                  };\n                  Promise.all = function (arr) {\n                    var args = Array.prototype.slice.call(arr);\n                    return new Promise(function (resolve, reject) {\n                      if (args.length === 0)\n                        return resolve([]);\n                      var remaining = args.length;\n                      function res(i, val) {\n                        try {\n                          if (val && (typeof val === 'object' || typeof val === 'function')) {\n                            var then = val.then;\n                            if (typeof then === 'function') {\n                              then.call(val, function (val) {\n                                res(i, val);\n                              }, reject);\n                              return;\n                            }\n                          }\n                          args[i] = val;\n                          if (--remaining === 0) {\n                            resolve(args);\n                          }\n                        } catch (ex) {\n                          reject(ex);\n                        }\n                      }\n                      for (var i = 0; i < args.length; i++) {\n                        res(i, args[i]);\n                      }\n                    });\n                  };\n                  Promise.resolve = function (value) {\n                    if (value && typeof value === 'object' && value.constructor === Promise) {\n                      return value;\n                    }\n                    return new Promise(function (resolve) {\n                      resolve(value);\n                    });\n                  };\n                  Promise.reject = function (value) {\n                    return new Promise(function (resolve, reject) {\n                      reject(value);\n                    });\n                  };\n                  Promise.race = function (values) {\n                    return new Promise(function (resolve, reject) {\n                      for (var i = 0, len = values.length; i < len; i++) {\n                        values[i].then(resolve, reject);\n                      }\n                    });\n                  };\n                  Promise._immediateFn = typeof setImmediate === 'function' ? function (fn) {\n                    setImmediate(fn);\n                  } : function (fn) {\n                    setTimeoutFunc(fn, 0);\n                  };\n                  Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n                    if (typeof console !== 'undefined' && console) {\n                      console.warn('Possible Unhandled Promise Rejection:', err);\n                    }\n                  };\n                  Promise._setImmediateFn = function _setImmediateFn(fn) {\n                    Promise._immediateFn = fn;\n                  };\n                  Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n                    Promise._unhandledRejectionFn = fn;\n                  };\n                  if (typeof module !== 'undefined' && module.exports) {\n                    module.exports = Promise;\n                  } else if (!root.Promise) {\n                    root.Promise = Promise;\n                  }\n                }(this));\n              }.call(this, require('timers').setImmediate));\n            },\n            { 'timers': 3 }\n          ],\n          3: [\n            function (require, module, exports) {\n              (function (setImmediate, clearImmediate) {\n                var nextTick = require('process/browser.js').nextTick;\n                var apply = Function.prototype.apply;\n                var slice = Array.prototype.slice;\n                var immediateIds = {};\n                var nextImmediateId = 0;\n                exports.setTimeout = function () {\n                  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n                };\n                exports.setInterval = function () {\n                  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n                };\n                exports.clearTimeout = exports.clearInterval = function (timeout) {\n                  timeout.close();\n                };\n                function Timeout(id, clearFn) {\n                  this._id = id;\n                  this._clearFn = clearFn;\n                }\n                Timeout.prototype.unref = Timeout.prototype.ref = function () {\n                };\n                Timeout.prototype.close = function () {\n                  this._clearFn.call(window, this._id);\n                };\n                exports.enroll = function (item, msecs) {\n                  clearTimeout(item._idleTimeoutId);\n                  item._idleTimeout = msecs;\n                };\n                exports.unenroll = function (item) {\n                  clearTimeout(item._idleTimeoutId);\n                  item._idleTimeout = -1;\n                };\n                exports._unrefActive = exports.active = function (item) {\n                  clearTimeout(item._idleTimeoutId);\n                  var msecs = item._idleTimeout;\n                  if (msecs >= 0) {\n                    item._idleTimeoutId = setTimeout(function onTimeout() {\n                      if (item._onTimeout)\n                        item._onTimeout();\n                    }, msecs);\n                  }\n                };\n                exports.setImmediate = typeof setImmediate === 'function' ? setImmediate : function (fn) {\n                  var id = nextImmediateId++;\n                  var args = arguments.length < 2 ? false : slice.call(arguments, 1);\n                  immediateIds[id] = true;\n                  nextTick(function onNextTick() {\n                    if (immediateIds[id]) {\n                      if (args) {\n                        fn.apply(null, args);\n                      } else {\n                        fn.call(null);\n                      }\n                      exports.clearImmediate(id);\n                    }\n                  });\n                  return id;\n                };\n                exports.clearImmediate = typeof clearImmediate === 'function' ? clearImmediate : function (id) {\n                  delete immediateIds[id];\n                };\n              }.call(this, require('timers').setImmediate, require('timers').clearImmediate));\n            },\n            {\n              'process/browser.js': 1,\n              'timers': 3\n            }\n          ],\n          4: [\n            function (require, module, exports) {\n              var promisePolyfill = require('promise-polyfill');\n              var Global = function () {\n                if (typeof window !== 'undefined') {\n                  return window;\n                } else {\n                  return Function('return this;')();\n                }\n              }();\n              module.exports = { boltExport: Global.Promise || promisePolyfill };\n            },\n            { 'promise-polyfill': 2 }\n          ]\n        }, {}, [4])(4);\n      }));\n    }(undefined, exports$1, module, undefined));\n    var Promise$1 = module.exports.boltExport;\n\n    var nu$7 = function (baseFn) {\n      var data = Option.none();\n      var callbacks = [];\n      var map = function (f) {\n        return nu$7(function (nCallback) {\n          get(function (data) {\n            nCallback(f(data));\n          });\n        });\n      };\n      var get = function (nCallback) {\n        if (isReady()) {\n          call(nCallback);\n        } else {\n          callbacks.push(nCallback);\n        }\n      };\n      var set = function (x) {\n        data = Option.some(x);\n        run(callbacks);\n        callbacks = [];\n      };\n      var isReady = function () {\n        return data.isSome();\n      };\n      var run = function (cbs) {\n        each$1(cbs, call);\n      };\n      var call = function (cb) {\n        data.each(function (x) {\n          domGlobals.setTimeout(function () {\n            cb(x);\n          }, 0);\n        });\n      };\n      baseFn(set);\n      return {\n        get: get,\n        map: map,\n        isReady: isReady\n      };\n    };\n    var pure$1 = function (a) {\n      return nu$7(function (callback) {\n        callback(a);\n      });\n    };\n    var LazyValue = {\n      nu: nu$7,\n      pure: pure$1\n    };\n\n    var errorReporter = function (err) {\n      domGlobals.setTimeout(function () {\n        throw err;\n      }, 0);\n    };\n    var make$4 = function (run) {\n      var get = function (callback) {\n        run().then(callback, errorReporter);\n      };\n      var map = function (fab) {\n        return make$4(function () {\n          return run().then(fab);\n        });\n      };\n      var bind = function (aFutureB) {\n        return make$4(function () {\n          return run().then(function (v) {\n            return aFutureB(v).toPromise();\n          });\n        });\n      };\n      var anonBind = function (futureB) {\n        return make$4(function () {\n          return run().then(function () {\n            return futureB.toPromise();\n          });\n        });\n      };\n      var toLazy = function () {\n        return LazyValue.nu(get);\n      };\n      var toCached = function () {\n        var cache = null;\n        return make$4(function () {\n          if (cache === null) {\n            cache = run();\n          }\n          return cache;\n        });\n      };\n      var toPromise = run;\n      return {\n        map: map,\n        bind: bind,\n        anonBind: anonBind,\n        toLazy: toLazy,\n        toCached: toCached,\n        toPromise: toPromise,\n        get: get\n      };\n    };\n    var nu$8 = function (baseFn) {\n      return make$4(function () {\n        return new Promise$1(baseFn);\n      });\n    };\n    var pure$2 = function (a) {\n      return make$4(function () {\n        return Promise$1.resolve(a);\n      });\n    };\n    var Future = {\n      nu: nu$8,\n      pure: pure$2\n    };\n\n    var adjust = function (value, destination, amount) {\n      if (Math.abs(value - destination) <= amount) {\n        return Option.none();\n      } else if (value < destination) {\n        return Option.some(value + amount);\n      } else {\n        return Option.some(value - amount);\n      }\n    };\n    var create$5 = function () {\n      var interval = null;\n      var animate = function (getCurrent, destination, amount, increment, doFinish, rate) {\n        var finished = false;\n        var finish = function (v) {\n          finished = true;\n          doFinish(v);\n        };\n        global$4.clearInterval(interval);\n        var abort = function (v) {\n          global$4.clearInterval(interval);\n          finish(v);\n        };\n        interval = global$4.setInterval(function () {\n          var value = getCurrent();\n          adjust(value, destination, amount).fold(function () {\n            global$4.clearInterval(interval);\n            finish(destination);\n          }, function (s) {\n            increment(s, abort);\n            if (!finished) {\n              var newValue = getCurrent();\n              if (newValue !== s || Math.abs(newValue - destination) > Math.abs(value - destination)) {\n                global$4.clearInterval(interval);\n                finish(destination);\n              }\n            }\n          });\n        }, rate);\n      };\n      return { animate: animate };\n    };\n    var SmoothAnimation = {\n      create: create$5,\n      adjust: adjust\n    };\n\n    var findDevice = function (deviceWidth, deviceHeight) {\n      var devices = [\n        {\n          width: 320,\n          height: 480,\n          keyboard: {\n            portrait: 300,\n            landscape: 240\n          }\n        },\n        {\n          width: 320,\n          height: 568,\n          keyboard: {\n            portrait: 300,\n            landscape: 240\n          }\n        },\n        {\n          width: 375,\n          height: 667,\n          keyboard: {\n            portrait: 305,\n            landscape: 240\n          }\n        },\n        {\n          width: 414,\n          height: 736,\n          keyboard: {\n            portrait: 320,\n            landscape: 240\n          }\n        },\n        {\n          width: 768,\n          height: 1024,\n          keyboard: {\n            portrait: 320,\n            landscape: 400\n          }\n        },\n        {\n          width: 1024,\n          height: 1366,\n          keyboard: {\n            portrait: 380,\n            landscape: 460\n          }\n        }\n      ];\n      return findMap(devices, function (device) {\n        return someIf(deviceWidth <= device.width && deviceHeight <= device.height, device.keyboard);\n      }).getOr({\n        portrait: deviceHeight / 5,\n        landscape: deviceWidth / 4\n      });\n    };\n\n    var softKeyboardLimits = function (outerWindow) {\n      return findDevice(outerWindow.screen.width, outerWindow.screen.height);\n    };\n    var accountableKeyboardHeight = function (outerWindow) {\n      var portrait = Orientation.get(outerWindow).isPortrait();\n      var limits = softKeyboardLimits(outerWindow);\n      var keyboard = portrait ? limits.portrait : limits.landscape;\n      var visualScreenHeight = portrait ? outerWindow.screen.height : outerWindow.screen.width;\n      return visualScreenHeight - outerWindow.innerHeight > keyboard ? 0 : keyboard;\n    };\n    var getGreenzone = function (socket, dropup) {\n      var outerWindow = owner(socket).dom().defaultView;\n      var viewportHeight = get$4(socket) + get$4(dropup);\n      var acc = accountableKeyboardHeight(outerWindow);\n      return viewportHeight - acc;\n    };\n    var updatePadding = function (contentBody, socket, dropup) {\n      var greenzoneHeight = getGreenzone(socket, dropup);\n      var deltaHeight = get$4(socket) + get$4(dropup) - greenzoneHeight;\n      set$3(contentBody, 'padding-bottom', deltaHeight + 'px');\n    };\n    var DeviceZones = {\n      getGreenzone: getGreenzone,\n      updatePadding: updatePadding\n    };\n\n    var fixture = Adt.generate([\n      {\n        fixed: [\n          'element',\n          'property',\n          'offsetY'\n        ]\n      },\n      {\n        scroller: [\n          'element',\n          'offsetY'\n        ]\n      }\n    ]);\n    var yFixedData = 'data-' + Styles.resolve('position-y-fixed');\n    var yFixedProperty = 'data-' + Styles.resolve('y-property');\n    var yScrollingData = 'data-' + Styles.resolve('scrolling');\n    var windowSizeData = 'data-' + Styles.resolve('last-window-height');\n    var getYFixedData = function (element) {\n      return DataAttributes.safeParse(element, yFixedData);\n    };\n    var getYFixedProperty = function (element) {\n      return get(element, yFixedProperty);\n    };\n    var getLastWindowSize = function (element) {\n      return DataAttributes.safeParse(element, windowSizeData);\n    };\n    var classifyFixed = function (element, offsetY) {\n      var prop = getYFixedProperty(element);\n      return fixture.fixed(element, prop, offsetY);\n    };\n    var classifyScrolling = function (element, offsetY) {\n      return fixture.scroller(element, offsetY);\n    };\n    var classify = function (element) {\n      var offsetY = getYFixedData(element);\n      var classifier = get(element, yScrollingData) === 'true' ? classifyScrolling : classifyFixed;\n      return classifier(element, offsetY);\n    };\n    var findFixtures = function (container) {\n      var candidates = descendants(container, '[' + yFixedData + ']');\n      return map$1(candidates, classify);\n    };\n    var takeoverToolbar = function (toolbar) {\n      var oldToolbarStyle = get(toolbar, 'style');\n      setAll$1(toolbar, {\n        position: 'absolute',\n        top: '0px'\n      });\n      set(toolbar, yFixedData, '0px');\n      set(toolbar, yFixedProperty, 'top');\n      var restore = function () {\n        set(toolbar, 'style', oldToolbarStyle || '');\n        remove$1(toolbar, yFixedData);\n        remove$1(toolbar, yFixedProperty);\n      };\n      return { restore: restore };\n    };\n    var takeoverViewport = function (toolbarHeight, height, viewport) {\n      var oldViewportStyle = get(viewport, 'style');\n      Scrollable.register(viewport);\n      setAll$1(viewport, {\n        position: 'absolute',\n        height: height + 'px',\n        width: '100%',\n        top: toolbarHeight + 'px'\n      });\n      set(viewport, yFixedData, toolbarHeight + 'px');\n      set(viewport, yScrollingData, 'true');\n      set(viewport, yFixedProperty, 'top');\n      var restore = function () {\n        Scrollable.deregister(viewport);\n        set(viewport, 'style', oldViewportStyle || '');\n        remove$1(viewport, yFixedData);\n        remove$1(viewport, yScrollingData);\n        remove$1(viewport, yFixedProperty);\n      };\n      return { restore: restore };\n    };\n    var takeoverDropup = function (dropup, toolbarHeight, viewportHeight) {\n      var oldDropupStyle = get(dropup, 'style');\n      setAll$1(dropup, {\n        position: 'absolute',\n        bottom: '0px'\n      });\n      set(dropup, yFixedData, '0px');\n      set(dropup, yFixedProperty, 'bottom');\n      var restore = function () {\n        set(dropup, 'style', oldDropupStyle || '');\n        remove$1(dropup, yFixedData);\n        remove$1(dropup, yFixedProperty);\n      };\n      return { restore: restore };\n    };\n    var deriveViewportHeight = function (viewport, toolbarHeight, dropupHeight) {\n      var outerWindow = owner(viewport).dom().defaultView;\n      var winH = outerWindow.innerHeight;\n      set(viewport, windowSizeData, winH + 'px');\n      return winH - toolbarHeight - dropupHeight;\n    };\n    var takeover$1 = function (viewport, contentBody, toolbar, dropup) {\n      var outerWindow = owner(viewport).dom().defaultView;\n      var toolbarSetup = takeoverToolbar(toolbar);\n      var toolbarHeight = get$4(toolbar);\n      var dropupHeight = get$4(dropup);\n      var viewportHeight = deriveViewportHeight(viewport, toolbarHeight, dropupHeight);\n      var viewportSetup = takeoverViewport(toolbarHeight, viewportHeight, viewport);\n      var dropupSetup = takeoverDropup(dropup);\n      var isActive = true;\n      var restore = function () {\n        isActive = false;\n        toolbarSetup.restore();\n        viewportSetup.restore();\n        dropupSetup.restore();\n      };\n      var isExpanding = function () {\n        var currentWinHeight = outerWindow.innerHeight;\n        var lastWinHeight = getLastWindowSize(viewport);\n        return currentWinHeight > lastWinHeight;\n      };\n      var refresh = function () {\n        if (isActive) {\n          var newToolbarHeight = get$4(toolbar);\n          var dropupHeight_1 = get$4(dropup);\n          var newHeight = deriveViewportHeight(viewport, newToolbarHeight, dropupHeight_1);\n          set(viewport, yFixedData, newToolbarHeight + 'px');\n          set$3(viewport, 'height', newHeight + 'px');\n          DeviceZones.updatePadding(contentBody, viewport, dropup);\n        }\n      };\n      var setViewportOffset = function (newYOffset) {\n        var offsetPx = newYOffset + 'px';\n        set(viewport, yFixedData, offsetPx);\n        refresh();\n      };\n      DeviceZones.updatePadding(contentBody, viewport, dropup);\n      return {\n        setViewportOffset: setViewportOffset,\n        isExpanding: isExpanding,\n        isShrinking: not(isExpanding),\n        refresh: refresh,\n        restore: restore\n      };\n    };\n    var IosViewport = {\n      findFixtures: findFixtures,\n      takeover: takeover$1,\n      getYFixedData: getYFixedData\n    };\n\n    var animator = SmoothAnimation.create();\n    var ANIMATION_STEP = 15;\n    var NUM_TOP_ANIMATION_FRAMES = 10;\n    var ANIMATION_RATE = 10;\n    var lastScroll = 'data-' + Styles.resolve('last-scroll-top');\n    var getTop = function (element) {\n      var raw = getRaw(element, 'top').getOr('0');\n      return parseInt(raw, 10);\n    };\n    var getScrollTop = function (element) {\n      return parseInt(element.dom().scrollTop, 10);\n    };\n    var moveScrollAndTop = function (element, destination, finalTop) {\n      return Future.nu(function (callback) {\n        var getCurrent = curry(getScrollTop, element);\n        var update = function (newScroll) {\n          element.dom().scrollTop = newScroll;\n          set$3(element, 'top', getTop(element) + ANIMATION_STEP + 'px');\n        };\n        var finish = function () {\n          element.dom().scrollTop = destination;\n          set$3(element, 'top', finalTop + 'px');\n          callback(destination);\n        };\n        animator.animate(getCurrent, destination, ANIMATION_STEP, update, finish, ANIMATION_RATE);\n      });\n    };\n    var moveOnlyScroll = function (element, destination) {\n      return Future.nu(function (callback) {\n        var getCurrent = curry(getScrollTop, element);\n        set(element, lastScroll, getCurrent());\n        var update = function (newScroll, abort) {\n          var previous = DataAttributes.safeParse(element, lastScroll);\n          if (previous !== element.dom().scrollTop) {\n            abort(element.dom().scrollTop);\n          } else {\n            element.dom().scrollTop = newScroll;\n            set(element, lastScroll, newScroll);\n          }\n        };\n        var finish = function () {\n          element.dom().scrollTop = destination;\n          set(element, lastScroll, destination);\n          callback(destination);\n        };\n        var distance = Math.abs(destination - getCurrent());\n        var step = Math.ceil(distance / NUM_TOP_ANIMATION_FRAMES);\n        animator.animate(getCurrent, destination, step, update, finish, ANIMATION_RATE);\n      });\n    };\n    var moveOnlyTop = function (element, destination) {\n      return Future.nu(function (callback) {\n        var getCurrent = curry(getTop, element);\n        var update = function (newTop) {\n          set$3(element, 'top', newTop + 'px');\n        };\n        var finish = function () {\n          update(destination);\n          callback(destination);\n        };\n        var distance = Math.abs(destination - getCurrent());\n        var step = Math.ceil(distance / NUM_TOP_ANIMATION_FRAMES);\n        animator.animate(getCurrent, destination, step, update, finish, ANIMATION_RATE);\n      });\n    };\n    var updateTop = function (element, amount) {\n      var newTop = amount + IosViewport.getYFixedData(element) + 'px';\n      set$3(element, 'top', newTop);\n    };\n    var moveWindowScroll = function (toolbar, viewport, destY) {\n      var outerWindow = owner(toolbar).dom().defaultView;\n      return Future.nu(function (callback) {\n        updateTop(toolbar, destY);\n        updateTop(viewport, destY);\n        outerWindow.scrollTo(0, destY);\n        callback(destY);\n      });\n    };\n    var IosScrolling = {\n      moveScrollAndTop: moveScrollAndTop,\n      moveOnlyScroll: moveOnlyScroll,\n      moveOnlyTop: moveOnlyTop,\n      moveWindowScroll: moveWindowScroll\n    };\n\n    function BackgroundActivity (doAction) {\n      var action = Cell(LazyValue.pure({}));\n      var start = function (value) {\n        var future = LazyValue.nu(function (callback) {\n          return doAction(value).get(callback);\n        });\n        action.set(future);\n      };\n      var idle = function (g) {\n        action.get().get(function () {\n          g();\n        });\n      };\n      return {\n        start: start,\n        idle: idle\n      };\n    }\n\n    var scrollIntoView = function (cWin, socket, dropup, top, bottom) {\n      var greenzone = DeviceZones.getGreenzone(socket, dropup);\n      var refreshCursor = curry(CursorRefresh.refresh, cWin);\n      if (top > greenzone || bottom > greenzone) {\n        IosScrolling.moveOnlyScroll(socket, socket.dom().scrollTop - greenzone + bottom).get(refreshCursor);\n      } else if (top < 0) {\n        IosScrolling.moveOnlyScroll(socket, socket.dom().scrollTop + top).get(refreshCursor);\n      }\n    };\n    var Greenzone = { scrollIntoView: scrollIntoView };\n\n    var par = function (asyncValues, nu) {\n      return nu(function (callback) {\n        var r = [];\n        var count = 0;\n        var cb = function (i) {\n          return function (value) {\n            r[i] = value;\n            count++;\n            if (count >= asyncValues.length) {\n              callback(r);\n            }\n          };\n        };\n        if (asyncValues.length === 0) {\n          callback([]);\n        } else {\n          each$1(asyncValues, function (asyncValue, i) {\n            asyncValue.get(cb(i));\n          });\n        }\n      });\n    };\n\n    var par$1 = function (futures) {\n      return par(futures, Future.nu);\n    };\n\n    var updateFixed = function (element, property, winY, offsetY) {\n      var destination = winY + offsetY;\n      set$3(element, property, destination + 'px');\n      return Future.pure(offsetY);\n    };\n    var updateScrollingFixed = function (element, winY, offsetY) {\n      var destTop = winY + offsetY;\n      var oldProp = getRaw(element, 'top').getOr(offsetY);\n      var delta = destTop - parseInt(oldProp, 10);\n      var destScroll = element.dom().scrollTop + delta;\n      return IosScrolling.moveScrollAndTop(element, destScroll, destTop);\n    };\n    var updateFixture = function (fixture, winY) {\n      return fixture.fold(function (element, property, offsetY) {\n        return updateFixed(element, property, winY, offsetY);\n      }, function (element, offsetY) {\n        return updateScrollingFixed(element, winY, offsetY);\n      });\n    };\n    var updatePositions = function (container, winY) {\n      var fixtures = IosViewport.findFixtures(container);\n      var updates = map$1(fixtures, function (fixture) {\n        return updateFixture(fixture, winY);\n      });\n      return par$1(updates);\n    };\n    var IosUpdates = { updatePositions: updatePositions };\n\n    var VIEW_MARGIN = 5;\n    var register$2 = function (toolstrip, socket, container, outerWindow, structure, cWin) {\n      var scroller = BackgroundActivity(function (y) {\n        return IosScrolling.moveWindowScroll(toolstrip, socket, y);\n      });\n      var scrollBounds = function () {\n        var rects = Rectangles.getRectangles(cWin);\n        return Option.from(rects[0]).bind(function (rect) {\n          var viewTop = rect.top() - socket.dom().scrollTop;\n          var outside = viewTop > outerWindow.innerHeight + VIEW_MARGIN || viewTop < -VIEW_MARGIN;\n          return outside ? Option.some({\n            top: constant(viewTop),\n            bottom: constant(viewTop + rect.height())\n          }) : Option.none();\n        });\n      };\n      var scrollThrottle = last$1(function () {\n        scroller.idle(function () {\n          IosUpdates.updatePositions(container, outerWindow.pageYOffset).get(function () {\n            var extraScroll = scrollBounds();\n            extraScroll.each(function (extra) {\n              socket.dom().scrollTop = socket.dom().scrollTop + extra.top();\n            });\n            scroller.start(0);\n            structure.refresh();\n          });\n        });\n      }, 1000);\n      var onScroll = bind$3(Element.fromDom(outerWindow), 'scroll', function () {\n        if (outerWindow.pageYOffset < 0) {\n          return;\n        }\n        scrollThrottle.throttle();\n      });\n      IosUpdates.updatePositions(container, outerWindow.pageYOffset).get(identity);\n      return { unbind: onScroll.unbind };\n    };\n    var setup$3 = function (bag) {\n      var cWin = bag.cWin();\n      var ceBody = bag.ceBody();\n      var socket = bag.socket();\n      var toolstrip = bag.toolstrip();\n      var toolbar = bag.toolbar();\n      var contentElement = bag.contentElement();\n      var keyboardType = bag.keyboardType();\n      var outerWindow = bag.outerWindow();\n      var dropup = bag.dropup();\n      var structure = IosViewport.takeover(socket, ceBody, toolstrip, dropup);\n      var keyboardModel = keyboardType(bag.outerBody(), cWin, body(), contentElement, toolstrip, toolbar);\n      var toEditing = function () {\n        keyboardModel.toEditing();\n        clearSelection();\n      };\n      var toReading = function () {\n        keyboardModel.toReading();\n      };\n      var onToolbarTouch = function (event) {\n        keyboardModel.onToolbarTouch(event);\n      };\n      var onOrientation = Orientation.onChange(outerWindow, {\n        onChange: noop,\n        onReady: structure.refresh\n      });\n      onOrientation.onAdjustment(function () {\n        structure.refresh();\n      });\n      var onResize = bind$3(Element.fromDom(outerWindow), 'resize', function () {\n        if (structure.isExpanding()) {\n          structure.refresh();\n        }\n      });\n      var onScroll = register$2(toolstrip, socket, bag.outerBody(), outerWindow, structure, cWin);\n      var unfocusedSelection = FakeSelection(cWin, contentElement);\n      var refreshSelection = function () {\n        if (unfocusedSelection.isActive()) {\n          unfocusedSelection.update();\n        }\n      };\n      var highlightSelection = function () {\n        unfocusedSelection.update();\n      };\n      var clearSelection = function () {\n        unfocusedSelection.clear();\n      };\n      var scrollIntoView = function (top, bottom) {\n        Greenzone.scrollIntoView(cWin, socket, dropup, top, bottom);\n      };\n      var syncHeight = function () {\n        set$3(contentElement, 'height', contentElement.dom().contentWindow.document.body.scrollHeight + 'px');\n      };\n      var setViewportOffset = function (newYOffset) {\n        structure.setViewportOffset(newYOffset);\n        IosScrolling.moveOnlyTop(socket, newYOffset).get(identity);\n      };\n      var destroy = function () {\n        structure.restore();\n        onOrientation.destroy();\n        onScroll.unbind();\n        onResize.unbind();\n        keyboardModel.destroy();\n        unfocusedSelection.destroy();\n        CaptureBin.input(body(), blur);\n      };\n      return {\n        toEditing: toEditing,\n        toReading: toReading,\n        onToolbarTouch: onToolbarTouch,\n        refreshSelection: refreshSelection,\n        clearSelection: clearSelection,\n        highlightSelection: highlightSelection,\n        scrollIntoView: scrollIntoView,\n        updateToolbarPadding: noop,\n        setViewportOffset: setViewportOffset,\n        syncHeight: syncHeight,\n        refreshStructure: structure.refresh,\n        destroy: destroy\n      };\n    };\n    var IosSetup = { setup: setup$3 };\n\n    var create$6 = function (platform, mask) {\n      var meta = MetaViewport.tag();\n      var priorState = value$2();\n      var scrollEvents = value$2();\n      var iosApi = api$2();\n      var iosEvents = api$2();\n      var enter = function () {\n        mask.hide();\n        var doc = Element.fromDom(domGlobals.document);\n        PlatformEditor.getActiveApi(platform.editor).each(function (editorApi) {\n          priorState.set({\n            socketHeight: getRaw(platform.socket, 'height'),\n            iframeHeight: getRaw(editorApi.frame(), 'height'),\n            outerScroll: domGlobals.document.body.scrollTop\n          });\n          scrollEvents.set({ exclusives: Scrollables.exclusive(doc, '.' + Scrollable.scrollable()) });\n          add$2(platform.container, Styles.resolve('fullscreen-maximized'));\n          Thor.clobberStyles(platform.container, editorApi.body());\n          meta.maximize();\n          set$3(platform.socket, 'overflow', 'scroll');\n          set$3(platform.socket, '-webkit-overflow-scrolling', 'touch');\n          focus$1(editorApi.body());\n          var setupBag = MixedBag([\n            'cWin',\n            'ceBody',\n            'socket',\n            'toolstrip',\n            'toolbar',\n            'dropup',\n            'contentElement',\n            'cursor',\n            'keyboardType',\n            'isScrolling',\n            'outerWindow',\n            'outerBody'\n          ], []);\n          iosApi.set(IosSetup.setup(setupBag({\n            cWin: editorApi.win(),\n            ceBody: editorApi.body(),\n            socket: platform.socket,\n            toolstrip: platform.toolstrip,\n            toolbar: platform.toolbar,\n            dropup: platform.dropup.element(),\n            contentElement: editorApi.frame(),\n            cursor: noop,\n            outerBody: platform.body,\n            outerWindow: platform.win,\n            keyboardType: IosKeyboard.stubborn,\n            isScrolling: function () {\n              var scrollValue = scrollEvents;\n              return scrollValue.get().exists(function (s) {\n                return s.socket.isScrolling();\n              });\n            }\n          })));\n          iosApi.run(function (api) {\n            api.syncHeight();\n          });\n          iosEvents.set(IosEvents.initEvents(editorApi, iosApi, platform.toolstrip, platform.socket, platform.dropup));\n        });\n      };\n      var exit = function () {\n        meta.restore();\n        iosEvents.clear();\n        iosApi.clear();\n        mask.show();\n        priorState.on(function (s) {\n          s.socketHeight.each(function (h) {\n            set$3(platform.socket, 'height', h);\n          });\n          s.iframeHeight.each(function (h) {\n            set$3(platform.editor.getFrame(), 'height', h);\n          });\n          domGlobals.document.body.scrollTop = s.scrollTop;\n        });\n        priorState.clear();\n        scrollEvents.on(function (s) {\n          s.exclusives.unbind();\n        });\n        scrollEvents.clear();\n        remove$4(platform.container, Styles.resolve('fullscreen-maximized'));\n        Thor.restoreStyles();\n        Scrollable.deregister(platform.toolbar);\n        remove$5(platform.socket, 'overflow');\n        remove$5(platform.socket, '-webkit-overflow-scrolling');\n        blur(platform.editor.getFrame());\n        PlatformEditor.getActiveApi(platform.editor).each(function (editorApi) {\n          editorApi.clearSelection();\n        });\n      };\n      var refreshStructure = function () {\n        iosApi.run(function (api) {\n          api.refreshStructure();\n        });\n      };\n      return {\n        enter: enter,\n        refreshStructure: refreshStructure,\n        exit: exit\n      };\n    };\n    var IosMode = { create: create$6 };\n\n    var produce$1 = function (raw) {\n      var mobile = asRawOrDie('Getting IosWebapp schema', MobileSchema, raw);\n      set$3(mobile.toolstrip, 'width', '100%');\n      set$3(mobile.container, 'position', 'relative');\n      var onView = function () {\n        mobile.setReadOnly(mobile.readOnlyOnInit());\n        mode.enter();\n      };\n      var mask = build$1(TapToEditMask.sketch(onView, mobile.translate));\n      mobile.alloy.add(mask);\n      var maskApi = {\n        show: function () {\n          mobile.alloy.add(mask);\n        },\n        hide: function () {\n          mobile.alloy.remove(mask);\n        }\n      };\n      var mode = IosMode.create(mobile, maskApi);\n      return {\n        setReadOnly: mobile.setReadOnly,\n        refreshStructure: mode.refreshStructure,\n        enter: mode.enter,\n        exit: mode.exit,\n        destroy: noop\n      };\n    };\n    var IosWebapp = { produce: produce$1 };\n\n    function IosRealm (scrollIntoView) {\n      var alloy = OuterContainer({ classes: [Styles.resolve('ios-container')] });\n      var toolbar = ScrollingToolbar();\n      var webapp = api$2();\n      var switchToEdit = CommonRealm.makeEditSwitch(webapp);\n      var socket = CommonRealm.makeSocket();\n      var dropup = build$2(function () {\n        webapp.run(function (w) {\n          w.refreshStructure();\n        });\n      }, scrollIntoView);\n      alloy.add(toolbar.wrapper());\n      alloy.add(socket);\n      alloy.add(dropup.component());\n      var setToolbarGroups = function (rawGroups) {\n        var groups = toolbar.createGroups(rawGroups);\n        toolbar.setGroups(groups);\n      };\n      var setContextToolbar = function (rawGroups) {\n        var groups = toolbar.createGroups(rawGroups);\n        toolbar.setContextToolbar(groups);\n      };\n      var focusToolbar = function () {\n        toolbar.focus();\n      };\n      var restoreToolbar = function () {\n        toolbar.restoreToolbar();\n      };\n      var init = function (spec) {\n        webapp.set(IosWebapp.produce(spec));\n      };\n      var exit = function () {\n        webapp.run(function (w) {\n          Replacing.remove(socket, switchToEdit);\n          w.exit();\n        });\n      };\n      var updateMode = function (readOnly) {\n        CommonRealm.updateMode(socket, switchToEdit, readOnly, alloy.root());\n      };\n      return {\n        system: constant(alloy),\n        element: alloy.element,\n        init: init,\n        exit: exit,\n        setToolbarGroups: setToolbarGroups,\n        setContextToolbar: setContextToolbar,\n        focusToolbar: focusToolbar,\n        restoreToolbar: restoreToolbar,\n        updateMode: updateMode,\n        socket: constant(socket),\n        dropup: constant(dropup)\n      };\n    }\n\n    var global$5 = tinymce.util.Tools.resolve('tinymce.EditorManager');\n\n    var derive$3 = function (editor) {\n      var base = readOptFrom$1(editor.settings, 'skin_url').fold(function () {\n        return global$5.baseURL + '/skins/ui/oxide';\n      }, function (url) {\n        return url;\n      });\n      return {\n        content: base + '/content.mobile.min.css',\n        ui: base + '/skin.mobile.min.css'\n      };\n    };\n    var CssUrls = { derive: derive$3 };\n\n    var fontSizes = [\n      'x-small',\n      'small',\n      'medium',\n      'large',\n      'x-large'\n    ];\n    var fireChange = function (realm, command, state) {\n      realm.system().broadcastOn([TinyChannels.formatChanged()], {\n        command: command,\n        state: state\n      });\n    };\n    var init$5 = function (realm, editor) {\n      var allFormats = keys(editor.formatter.get());\n      each$1(allFormats, function (command) {\n        editor.formatter.formatChanged(command, function (state) {\n          fireChange(realm, command, state);\n        });\n      });\n      each$1([\n        'ul',\n        'ol'\n      ], function (command) {\n        editor.selection.selectorChanged(command, function (state, data) {\n          fireChange(realm, command, state);\n        });\n      });\n    };\n    var FormatChangers = {\n      init: init$5,\n      fontSizes: constant(fontSizes)\n    };\n\n    var fireSkinLoaded = function (editor) {\n      var done = function () {\n        editor._skinLoaded = true;\n        editor.fire('SkinLoaded');\n      };\n      return function () {\n        if (editor.initialized) {\n          done();\n        } else {\n          editor.on('init', done);\n        }\n      };\n    };\n    var SkinLoaded = { fireSkinLoaded: fireSkinLoaded };\n\n    var READING = constant('toReading');\n    var EDITING = constant('toEditing');\n    var renderMobileTheme = function (editor) {\n      var renderUI = function () {\n        var targetNode = editor.getElement();\n        var cssUrls = CssUrls.derive(editor);\n        if (isSkinDisabled(editor) === false) {\n          editor.contentCSS.push(cssUrls.content);\n          global$1.DOM.styleSheetLoader.load(cssUrls.ui, SkinLoaded.fireSkinLoaded(editor));\n        } else {\n          SkinLoaded.fireSkinLoaded(editor)();\n        }\n        var doScrollIntoView = function () {\n          editor.fire('ScrollIntoView');\n        };\n        var realm = detect$3().os.isAndroid() ? AndroidRealm(doScrollIntoView) : IosRealm(doScrollIntoView);\n        var original = Element.fromDom(targetNode);\n        attachSystemAfter(original, realm.system());\n        var findFocusIn = function (elem) {\n          return search(elem).bind(function (focused) {\n            return realm.system().getByDom(focused).toOption();\n          });\n        };\n        var outerWindow = targetNode.ownerDocument.defaultView;\n        var orientation = Orientation.onChange(outerWindow, {\n          onChange: function () {\n            var alloy = realm.system();\n            alloy.broadcastOn([TinyChannels.orientationChanged()], { width: Orientation.getActualWidth(outerWindow) });\n          },\n          onReady: noop\n        });\n        var setReadOnly = function (dynamicGroup, readOnlyGroups, mainGroups, ro) {\n          if (ro === false) {\n            editor.selection.collapse();\n          }\n          var toolbars = configureToolbar(dynamicGroup, readOnlyGroups, mainGroups);\n          realm.setToolbarGroups(ro === true ? toolbars.readOnly : toolbars.main);\n          editor.setMode(ro === true ? 'readonly' : 'design');\n          editor.fire(ro === true ? READING() : EDITING());\n          realm.updateMode(ro);\n        };\n        var configureToolbar = function (dynamicGroup, readOnlyGroups, mainGroups) {\n          var dynamic = dynamicGroup.get();\n          var toolbars = {\n            readOnly: dynamic.backToMask.concat(readOnlyGroups.get()),\n            main: dynamic.backToMask.concat(mainGroups.get())\n          };\n          return toolbars;\n        };\n        var bindHandler = function (label, handler) {\n          editor.on(label, handler);\n          return {\n            unbind: function () {\n              editor.off(label);\n            }\n          };\n        };\n        editor.on('init', function () {\n          realm.init({\n            editor: {\n              getFrame: function () {\n                return Element.fromDom(editor.contentAreaContainer.querySelector('iframe'));\n              },\n              onDomChanged: function () {\n                return { unbind: noop };\n              },\n              onToReading: function (handler) {\n                return bindHandler(READING(), handler);\n              },\n              onToEditing: function (handler) {\n                return bindHandler(EDITING(), handler);\n              },\n              onScrollToCursor: function (handler) {\n                editor.on('ScrollIntoView', function (tinyEvent) {\n                  handler(tinyEvent);\n                });\n                var unbind = function () {\n                  editor.off('ScrollIntoView');\n                  orientation.destroy();\n                };\n                return { unbind: unbind };\n              },\n              onTouchToolstrip: function () {\n                hideDropup();\n              },\n              onTouchContent: function () {\n                var toolbar = Element.fromDom(editor.editorContainer.querySelector('.' + Styles.resolve('toolbar')));\n                findFocusIn(toolbar).each(emitExecute);\n                realm.restoreToolbar();\n                hideDropup();\n              },\n              onTapContent: function (evt) {\n                var target = evt.target();\n                if (name(target) === 'img') {\n                  editor.selection.select(target.dom());\n                  evt.kill();\n                } else if (name(target) === 'a') {\n                  var component = realm.system().getByDom(Element.fromDom(editor.editorContainer));\n                  component.each(function (container) {\n                    if (Swapping.isAlpha(container)) {\n                      TinyCodeDupe.openLink(target.dom());\n                    }\n                  });\n                }\n              }\n            },\n            container: Element.fromDom(editor.editorContainer),\n            socket: Element.fromDom(editor.contentAreaContainer),\n            toolstrip: Element.fromDom(editor.editorContainer.querySelector('.' + Styles.resolve('toolstrip'))),\n            toolbar: Element.fromDom(editor.editorContainer.querySelector('.' + Styles.resolve('toolbar'))),\n            dropup: realm.dropup(),\n            alloy: realm.system(),\n            translate: noop,\n            setReadOnly: function (ro) {\n              setReadOnly(dynamicGroup, readOnlyGroups, mainGroups, ro);\n            },\n            readOnlyOnInit: function () {\n              return readOnlyOnInit();\n            }\n          });\n          var hideDropup = function () {\n            realm.dropup().disappear(function () {\n              realm.system().broadcastOn([TinyChannels.dropupDismissed()], {});\n            });\n          };\n          var backToMaskGroup = {\n            label: 'The first group',\n            scrollable: false,\n            items: [Buttons.forToolbar('back', function () {\n                editor.selection.collapse();\n                realm.exit();\n              }, {}, editor)]\n          };\n          var backToReadOnlyGroup = {\n            label: 'Back to read only',\n            scrollable: false,\n            items: [Buttons.forToolbar('readonly-back', function () {\n                setReadOnly(dynamicGroup, readOnlyGroups, mainGroups, true);\n              }, {}, editor)]\n          };\n          var readOnlyGroup = {\n            label: 'The read only mode group',\n            scrollable: true,\n            items: []\n          };\n          var features = Features.setup(realm, editor);\n          var items = Features.detect(editor.settings, features);\n          var actionGroup = {\n            label: 'the action group',\n            scrollable: true,\n            items: items\n          };\n          var extraGroup = {\n            label: 'The extra group',\n            scrollable: false,\n            items: []\n          };\n          var mainGroups = Cell([\n            actionGroup,\n            extraGroup\n          ]);\n          var readOnlyGroups = Cell([\n            readOnlyGroup,\n            extraGroup\n          ]);\n          var dynamicGroup = Cell({\n            backToMask: [backToMaskGroup],\n            backToReadOnly: [backToReadOnlyGroup]\n          });\n          FormatChangers.init(realm, editor);\n        });\n        editor.on('remove', function () {\n          realm.exit();\n        });\n        editor.on('detach', function () {\n          detachSystem(realm.system());\n          realm.system().destroy();\n        });\n        return {\n          iframeContainer: realm.socket().element().dom(),\n          editorContainer: realm.element().dom()\n        };\n      };\n      return {\n        getNotificationManagerImpl: function () {\n          return {\n            open: constant({\n              progressBar: { value: noop },\n              close: noop,\n              text: noop,\n              getEl: constant(null),\n              moveTo: noop,\n              moveRel: noop,\n              settings: {}\n            }),\n            close: noop,\n            reposition: noop,\n            getArgs: constant({})\n          };\n        },\n        renderUI: renderUI\n      };\n    };\n    function Theme () {\n      global$2.add('mobile', renderMobileTheme);\n    }\n\n    Theme();\n\n}(window));\n"]}